"use strict";var _te=Object.create;var lp=Object.defineProperty;var Ste=Object.getOwnPropertyDescriptor;var bte=Object.getOwnPropertyNames;var Ete=Object.getPrototypeOf,wte=Object.prototype.hasOwnProperty;var Tte=(t,e,r)=>e in t?lp(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Cte=(t,e)=>()=>(t&&(e=t(t=0)),e);var m=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Rte=(t,e)=>{for(var r in e)lp(t,r,{get:e[r],enumerable:!0})},Q$=(t,e,r,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of bte(e))!wte.call(t,n)&&n!==r&&lp(t,n,{get:()=>e[n],enumerable:!(s=Ste(e,n))||s.enumerable});return t};var kr=(t,e,r)=>(r=t!=null?_te(Ete(t)):{},Q$(e||!t||!t.__esModule?lp(r,"default",{value:t,enumerable:!0}):r,t)),Ote=t=>Q$(lp({},"__esModule",{value:!0}),t);var F=(t,e,r)=>(Tte(t,typeof e!="symbol"?e+"":e,r),r),W$=(t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)};var Z$=(t,e,r)=>(W$(t,e,"read from private field"),r?r.call(t):e.get(t)),Y$=(t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},J$=(t,e,r,s)=>(W$(t,e,"write to private field"),s?s.call(t,r):e.set(t,r),r);var eq=m((LVe,X$)=>{"use strict";function Pte(t){var e=new t,r=e;function s(){var i=e;return i.next?e=i.next:(e=new t,r=e),i.next=null,i}function n(i){r.next=i,r=i}return{get:s,release:n}}X$.exports=Pte});var rq=m((jVe,Yw)=>{"use strict";var Ate=eq();function tq(t,e,r){if(typeof t=="function"&&(r=e,e=t,t=null),!(r>=1))throw new Error("fastqueue concurrency must be equal to or greater than 1");var s=Ate(kte),n=null,i=null,o=0,a=null,l={push:g,drain:En,saturated:En,pause:c,paused:!1,get concurrency(){return r},set concurrency(R){if(!(R>=1))throw new Error("fastqueue concurrency must be equal to or greater than 1");if(r=R,!l.paused)for(;n&&o<r;)o++,S()},running:u,resume:h,idle:p,length:d,getQueue:f,unshift:_,empty:En,kill:b,killAndDrain:v,error:y};return l;function u(){return o}function c(){l.paused=!0}function d(){for(var R=n,P=0;R;)R=R.next,P++;return P}function f(){for(var R=n,P=[];R;)P.push(R.value),R=R.next;return P}function h(){if(l.paused){if(l.paused=!1,n===null){o++,S();return}for(;n&&o<r;)o++,S()}}function p(){return o===0&&l.length()===0}function g(R,P){var w=s.get();w.context=t,w.release=S,w.value=R,w.callback=P||En,w.errorHandler=a,o>=r||l.paused?i?(i.next=w,i=w):(n=w,i=w,l.saturated()):(o++,e.call(t,w.value,w.worked))}function _(R,P){var w=s.get();w.context=t,w.release=S,w.value=R,w.callback=P||En,w.errorHandler=a,o>=r||l.paused?n?(w.next=n,n=w):(n=w,i=w,l.saturated()):(o++,e.call(t,w.value,w.worked))}function S(R){R&&s.release(R);var P=n;P&&o<=r?l.paused?o--:(i===n&&(i=null),n=P.next,P.next=null,e.call(t,P.value,P.worked),i===null&&l.empty()):--o===0&&l.drain()}function b(){n=null,i=null,l.drain=En}function v(){n=null,i=null,l.drain(),l.drain=En}function y(R){a=R}}function En(){}function kte(){this.value=null,this.callback=En,this.next=null,this.release=En,this.context=null,this.errorHandler=null;var t=this;this.worked=function(r,s){var n=t.callback,i=t.errorHandler,o=t.value;t.value=null,t.callback=En,t.errorHandler&&i(r,o),n.call(t.context,r,s),t.release(t)}}function xte(t,e,r){typeof t=="function"&&(r=e,e=t,t=null);function s(c,d){e.call(this,c).then(function(f){d(null,f)},d)}var n=tq(t,s,r),i=n.push,o=n.unshift;return n.push=a,n.unshift=l,n.drained=u,n;function a(c){var d=new Promise(function(f,h){i(c,function(p,g){if(p){h(p);return}f(g)})});return d.catch(En),d}function l(c){var d=new Promise(function(f,h){o(c,function(p,g){if(p){h(p);return}f(g)})});return d.catch(En),d}function u(){if(n.idle())return new Promise(function(f){f()});var c=n.drain,d=new Promise(function(f){n.drain=function(){c(),f()}});return d}}Yw.exports=tq;Yw.exports.promise=xte});var Xw=m((FVe,jy)=>{"use strict";var{format:Ite}=require("node:util");function Nte(){return`${this.name} [${this.code}]: ${this.message}`}function Jw(t,e,r=500,s=Error){if(!t)throw new Error("Fastify error code must not be empty");if(!e)throw new Error("Fastify error message must not be empty");t=t.toUpperCase(),!r&&(r=void 0);function n(...i){if(!new.target)return new n(...i);this.code=t,this.name="FastifyError",this.statusCode=r;let o=i.length-1;o!==-1&&i[o]&&typeof i[o]=="object"&&"cause"in i[o]&&(this.cause=i.pop().cause),this.message=Ite(e,...i),Error.stackTraceLimit!==0&&Error.captureStackTrace(this,n)}return n.prototype=Object.create(s.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),n.prototype[Symbol.toStringTag]="Error",n.prototype.toString=Nte,n}jy.exports=Jw;jy.exports.default=Jw;jy.exports.createError=Jw});var Fy=m((BVe,sq)=>{"use strict";var{createError:Ia}=Xw();sq.exports={AVV_ERR_EXPOSE_ALREADY_DEFINED:Ia("AVV_ERR_EXPOSE_ALREADY_DEFINED","'%s' is already defined, specify an expose option for '%s'"),AVV_ERR_ATTRIBUTE_ALREADY_DEFINED:Ia("AVV_ERR_ATTRIBUTE_ALREADY_DEFINED","'%s' is already defined"),AVV_ERR_CALLBACK_NOT_FN:Ia("AVV_ERR_CALLBACK_NOT_FN","Callback for '%s' hook is not a function. Received: '%s'"),AVV_ERR_PLUGIN_NOT_VALID:Ia("AVV_ERR_PLUGIN_NOT_VALID","Plugin must be a function or a promise. Received: '%s'"),AVV_ERR_ROOT_PLG_BOOTED:Ia("AVV_ERR_ROOT_PLG_BOOTED","Root plugin has already booted"),AVV_ERR_PARENT_PLG_LOADED:Ia("AVV_ERR_PARENT_PLG_LOADED","Impossible to load '%s' plugin because the parent '%s' was already loaded"),AVV_ERR_READY_TIMEOUT:Ia("AVV_ERR_READY_TIMEOUT","Plugin did not start in time: '%s'. You may have forgotten to call 'done' function or to resolve a Promise"),AVV_ERR_PLUGIN_EXEC_TIMEOUT:Ia("AVV_ERR_PLUGIN_EXEC_TIMEOUT","Plugin did not start in time: '%s'. You may have forgotten to call 'done' function or to resolve a Promise")}});var rd=m((zVe,nq)=>{"use strict";var Dte=Symbol("avvio.Boot"),Mte=Symbol("isOnCloseHandler"),$te=Symbol("avvio.ThenifyDoNotWrap"),qte=Symbol("avvio.TimeTree.untrackNode"),Lte=Symbol("avvio.TimeTree.trackNode"),jte=Symbol("avvio.TimeTree.getParent"),Fte=Symbol("avvio.TimeTree.getNode"),Bte=Symbol("avvio.TimeTree.addNode"),zte=Symbol.for("plugin-meta");nq.exports={kAvvio:Dte,kIsOnCloseHandler:Mte,kThenifyDoNotWrap:$te,kUntrackNode:qte,kTrackNode:Lte,kGetParent:jte,kGetNode:Fte,kAddNode:Bte,kPluginMeta:zte}});var dq=m((UVe,cq)=>{"use strict";var{kUntrackNode:iq,kTrackNode:eT,kGetParent:oq,kGetNode:aq,kAddNode:lq}=rd(),tT=class{constructor(){this.root=null,this.tableId=new Map,this.tableLabel=new Map}[eT](e){this.tableId.set(e.id,e),this.tableLabel.has(e.label)?this.tableLabel.get(e.label).push(e):this.tableLabel.set(e.label,[e])}[iq](e){this.tableId.delete(e.id);let r=this.tableLabel.get(e.label);r.pop(),r.length===0&&this.tableLabel.delete(e.label)}[oq](e){if(e===null)return null;if(this.tableLabel.has(e)){let r=this.tableLabel.get(e);return r[r.length-1]}else return null}[aq](e){return this.tableId.get(e)}[lq](e,r,s){let n=this[oq](e);if(n===null)return this.root={parent:null,id:"root",label:r,nodes:[],start:s,stop:null,diff:-1},this[eT](this.root),this.root.id;let o=`${r}-${Math.random()}`,a={parent:e,id:o,label:r,nodes:[],start:s,stop:null,diff:-1};return n.nodes.push(a),this[eT](a),o}start(e,r,s=Date.now()){return this[lq](e,r,s)}stop(e,r=Date.now()){let s=this[aq](e);s&&(s.stop=r,s.diff=s.stop-s.start||0,this[iq](s))}toJSON(){return Object.assign({},this.root)}prettyPrint(){return uq(this.toJSON())}};function uq(t,e=""){let r=e,s=t.nodes.length,n=s-1;r+=`${t.label} ${t.diff} ms
`;for(let i=0;i<s;++i){let o=t.nodes[i],a=e+(i===n?"  ":"\u2502 ");r+=e,r+=i===n?"\u2514\u2500":"\u251C\u2500",r+=o.nodes.length===0?"\u2500 ":"\u252C ",r+=uq(o,a).slice(e.length+2)}return r}cq.exports={TimeTree:tT}});var By=m((VVe,fq)=>{"use strict";var{debuglog:Ute}=require("node:util"),Vte=Ute("avvio");fq.exports={debug:Vte}});var pq=m((HVe,hq)=>{"use strict";function Hte(){let t={resolve:null,reject:null,promise:null};return t.promise=new Promise((e,r)=>{t.resolve=e,t.reject=r}),t}hq.exports={createPromise:Hte}});var gq=m((GVe,mq)=>{"use strict";var{kPluginMeta:rT}=rd();function Gte(t,e){return t[rT]&&t[rT].name?t[rT].name:e&&e.name?e.name:t.name?t.name:t.toString().split(`
`).slice(0,2).map(r=>r.trim()).join(" -- ")}mq.exports={getPluginName:Gte}});var zy=m((KVe,yq)=>{"use strict";function Kte(t){return t!==null&&typeof t=="object"&&typeof t.then=="function"}yq.exports={isPromiseLike:Kte}});var _q=m((QVe,vq)=>{"use strict";var{EventEmitter:Qte}=require("node:events"),{inherits:Wte}=require("node:util"),{debug:zr}=By(),{createPromise:Zte}=pq(),{AVV_ERR_PLUGIN_EXEC_TIMEOUT:Yte}=Fy(),{getPluginName:Jte}=gq(),{isPromiseLike:Xte}=zy();function sd(t,e,r,s,n){this.queue=t,this.func=e,this.options=r,this.isAfter=s,this.timeout=n,this.started=!1,this.name=Jte(e,r),this.queue.pause(),this._error=null,this.loaded=!1,this._promise=null,this.startTime=null}Wte(sd,Qte);sd.prototype.exec=function(t,e){zr("exec",this.name),this.server=t;let r=this.func,s=this.name,n=!1;this.options=typeof this.options=="function"?this.options(this.server):this.options;let i=null,o=l=>{if(n){zr("loading complete",s);return}this._error=l,zr(l?"exec errored":"exec completed",s),n=!0,i&&clearTimeout(i),e(l)};this.timeout>0&&(zr("setting up timeout",s,this.timeout),i=setTimeout(function(){zr("timed out",s),i=null;let l=new Yte(s);l.fn=r,o(l)},this.timeout)),this.started=!0,this.startTime=Date.now(),this.emit("start",this.server?this.server.name:null,this.name,Date.now());let a=r(this.server,this.options,o);Xte(a)&&(zr("exec: resolving promise",s),a.then(()=>process.nextTick(o),l=>process.nextTick(o,l)))};sd.prototype.loadedSoFar=function(){if(zr("loadedSoFar",this.name),this.loaded)return Promise.resolve();let t=()=>{this.server.after((r,s)=>{this._error=r,this.queue.pause(),this._promise&&(r?(zr("rejecting promise",this.name,r),this._promise.reject(r)):(zr("resolving promise",this.name),this._promise.resolve()),this._promise=null),process.nextTick(s,r)}),this.queue.resume()},e;return this._promise?e=Promise.resolve():(this._promise=Zte(),e=this._promise.promise,this.server?t():this.on("start",t)),e};sd.prototype.enqueue=function(t,e){zr("enqueue",this.name,t.name),this.emit("enqueue",this.server?this.server.name:null,this.name,Date.now()),this.queue.push(t,e)};sd.prototype.finish=function(t,e){zr("finish",this.name,t);let r=()=>{this.loaded||(zr("loaded",this.name),this.emit("loaded",this.server?this.server.name:null,this.name,Date.now()),this.loaded=!0,e(t))};if(t){this._promise&&(this._promise.reject(t),this._promise=null),r();return}let s=()=>{if(zr("check",this.name,this.queue.length(),this.queue.running(),this._promise),this.queue.length()===0&&this.queue.running()===0)if(this._promise){let n=()=>{zr("wrap"),queueMicrotask(s)};this._promise.resolve(),this._promise.promise.then(n,n),this._promise=null}else r();else zr("delayed",this.name),this.queue.drain=()=>{zr("drain",this.name),this.queue.drain=ere,queueMicrotask(s)}};queueMicrotask(s),this.queue.resume()};function ere(){}vq.exports={Plugin:sd}});var bq=m((WVe,Sq)=>{"use strict";var{AVV_ERR_PLUGIN_NOT_VALID:sT}=Fy();function tre(t){if(!(t&&(typeof t=="function"||typeof t.then=="function")))throw Array.isArray(t)?new sT("array"):t===null?new sT("null"):new sT(typeof t)}Sq.exports={validatePlugin:tre}});var wq=m((ZVe,Eq)=>{"use strict";function rre(t){return t!==null&&typeof t=="object"&&typeof t.default=="function"}Eq.exports={isBundledOrTypescriptPlugin:rre}});var Rq=m((YVe,Cq)=>{"use strict";var{debug:Tq}=By(),{kThenifyDoNotWrap:nT}=rd();function sre(){if(this.booted){Tq("thenify returning undefined because we are already booted");return}if(this[nT]){this[nT]=!1;return}return Tq("thenify"),(t,e)=>this._loadRegistered().then(()=>(this[nT]=!0,t(this._server)),e)}Cq.exports={thenify:sre}});var Pq=m((JVe,Oq)=>{"use strict";var{isPromiseLike:nre}=zy(),{kAvvio:ire}=rd();function ore(t,e,r){let s=t.apply(t,e);nre(s)&&!s[ire]?s.then(()=>process.nextTick(r),n=>process.nextTick(r,n)):r&&process.nextTick(r)}Oq.exports={executeWithThenable:ore}});var $q=m((XVe,oT)=>{"use strict";var Uy=rq(),are=require("node:events").EventEmitter,lre=require("node:util").inherits,{AVV_ERR_EXPOSE_ALREADY_DEFINED:up,AVV_ERR_CALLBACK_NOT_FN:nd,AVV_ERR_ROOT_PLG_BOOTED:ure,AVV_ERR_READY_TIMEOUT:cre,AVV_ERR_ATTRIBUTE_ALREADY_DEFINED:dre}=Fy(),{kAvvio:xq,kIsOnCloseHandler:Iq}=rd(),{TimeTree:fre}=dq(),{Plugin:Nq}=_q(),{debug:id}=By(),{validatePlugin:hre}=bq(),{isBundledOrTypescriptPlugin:pre}=wq(),{isPromiseLike:mre}=zy(),{thenify:Dq}=Rq(),{executeWithThenable:Aq}=Pq();function or(t,e,r){if(typeof t=="function"&&arguments.length===1&&(r=t,e={},t=null),typeof e=="function"&&(r=e,e={}),e=e||{},e.autostart=e.autostart!==!1,e.timeout=Number(e.timeout)||0,e.expose=e.expose||{},!new.target)return new or(t,e,r);this._server=t||this,this._opts=e,t&&this._expose(),this._current=[],this._error=null,this._lastUsed=null,this.setMaxListeners(0),r&&this.once("start",r),this.started=!1,this.booted=!1,this.pluginTree=new fre,this._readyQ=Uy(this,Mq,1),this._readyQ.pause(),this._readyQ.drain=()=>{this.emit("start"),this._readyQ.drain=kq},this._closeQ=Uy(this,yre,1),this._closeQ.pause(),this._closeQ.drain=()=>{this.emit("close"),this._closeQ.drain=kq},this._doStart=null;let s=this;this._root=new Nq(Uy(this,this._loadPluginNextTick,1),function(i,o,a){s._doStart=a,o.autostart&&s.start()},e,!1,0),this._trackPluginLoading(this._root),this._loadPlugin(this._root,n=>{id("root plugin ready");try{this.emit("preReady"),this._root=null}catch(i){n=n||this._error||i}if(n){if(this._error=n,this._readyQ.length()===0)throw n}else this.booted=!0;this._readyQ.resume()})}lre(or,are);or.prototype.start=function(){return this.started=!0,process.nextTick(this._doStart),this};or.prototype.override=function(t,e,r){return t};or.prototype[xq]=!0;or.prototype.use=function(t,e){return this._lastUsed=this._addPlugin(t,e,!1),this};or.prototype._loadRegistered=function(){let t=this._current[0];return!this.started&&!this.booted&&process.nextTick(()=>this._root.queue.resume()),t?t.loadedSoFar():Promise.resolve()};Object.defineProperty(or.prototype,"then",{get:Dq});or.prototype._addPlugin=function(t,e,r){if(pre(t)&&(t=t.default),hre(t),e=e||{},this.booted)throw new ure;let s=this._current[0],n=this._opts.timeout;if(!s.loaded&&s.timeout>0){let o=Date.now()-s.startTime;n=s.timeout-(o+3)}let i=new Nq(Uy(this,this._loadPluginNextTick,1),t,e,r,n);if(this._trackPluginLoading(i),s.loaded)throw new Error(i.name,s.name);return s.enqueue(i,o=>{o&&(this._error=o)}),i};or.prototype._expose=function(){let e=this,r=e._server,{use:s="use",after:n="after",ready:i="ready",onClose:o="onClose",close:a="close"}=this._opts.expose;if(r[s])throw new up(s,"use");if(r[s]=function(l,u){return e.use(l,u),this},r[n])throw new up(n,"after");if(r[n]=function(l){return typeof l!="function"?e._loadRegistered():(e.after(iT(l,this)),this)},r[i])throw new up(i,"ready");if(r[i]=function(l){if(l&&typeof l!="function")throw new nd(i,typeof l);return e.ready(l?iT(l,this):void 0)},r[o])throw new up(o,"onClose");if(r[o]=function(l){if(typeof l!="function")throw new nd(o,typeof l);return e.onClose(vre(l,this)),this},r[a])throw new up(a,"close");if(r[a]=function(l){if(l&&typeof l!="function")throw new nd(a,typeof l);return l?(e.close(iT(l,this)),this):e.close()},r.then)throw new dre("then");Object.defineProperty(r,"then",{get:Dq.bind(e)}),r[xq]=!0};or.prototype.after=function(t){if(!t)return this._loadRegistered();this._addPlugin(e.bind(this),{},!0);function e(r,s,n){Mq.call(this,t,n)}return this};or.prototype.onClose=function(t){if(typeof t!="function")throw new nd("onClose",typeof t);return t[Iq]=!0,this._closeQ.unshift(t,e=>{e&&(this._error=e)}),this};or.prototype.close=function(t){let e;if(t){if(typeof t!="function")throw new nd("close",typeof t)}else e=new Promise(function(r,s){t=function(n){if(n)return s(n);r()}});return this.ready(()=>{this._error=null,this._closeQ.push(t),process.nextTick(this._closeQ.resume.bind(this._closeQ))}),e};or.prototype.ready=function(t){if(t){if(typeof t!="function")throw new nd("ready",typeof t);this._readyQ.push(t),queueMicrotask(this.start.bind(this));return}return new Promise((e,r)=>{this._readyQ.push(n),this.start();let s=this._current[0].server;function n(i,o,a){i?r(i):e(s),process.nextTick(a)}})};or.prototype._trackPluginLoading=function(t){let e=this._current[0]?.name||null;t.once("start",(r,s,n)=>{let i=this.pluginTree.start(e||null,s,n);t.once("loaded",(o,a,l)=>{this.pluginTree.stop(i,l)})})};or.prototype.prettyPrint=function(){return this.pluginTree.prettyPrint()};or.prototype.toJSON=function(){return this.pluginTree.toJSON()};or.prototype._loadPlugin=function(t,e){let r=this;if(mre(t.func)){t.func.then(o=>{typeof o.default=="function"&&(o=o.default),t.func=o,this._loadPlugin(t,e)},e);return}let s=r._current[0];if(r._current.unshift(t),r._error&&!t.isAfter){id("skipping loading of plugin as instance errored and it is not an after",t.name),process.nextTick(i);return}let n=s&&s.server||r._server;if(!t.isAfter)try{n=r.override(n,t.func,t.options)}catch(o){return id("override errored",t.name),i(o)}t.exec(n,i);function i(o){t.finish(o,a=>{r._current.shift(),e(a)})}};or.prototype._loadPluginNextTick=function(t,e){process.nextTick(this._loadPlugin.bind(this),t,e)};function kq(){}function Mq(t,e){let r=this._server,s=this._error;if(this._error=null,t.length===0)this._error=s,Aq(t,[],e);else if(t.length===1)Aq(t,[s],e);else if(this._opts.timeout===0){let n=i=>{this._error=i,e(this._error)};t.length===2?t(s,n):t(s,r,n)}else gre.call(this,t,s,r,e)}function gre(t,e,r,s){let n=t.name;id("setting up ready timeout",n,this._opts.timeout);let i=setTimeout(()=>{id("timed out",n),i=null;let a=new cre(n);a.fn=t,this._error=a,s(a)},this._opts.timeout);t.length===2?t(e,o.bind(this)):t(e,r,o.bind(this));function o(a){i&&(clearTimeout(i),this._error=a,s(this._error))}}function yre(t,e){let r=this._server,s=t[Iq];if(t.length===0||t.length===1){let n;s?n=t(r):n=t(this._error),n&&typeof n.then=="function"?(id("resolving close/onClose promise"),n.then(()=>process.nextTick(e),i=>process.nextTick(e,i))):process.nextTick(e)}else t.length===2?t(s?r:this._error,e):s?t(r,e):t(this._error,r,e)}function vre(t,e){return r.bind(e);function r(s,n){let i;t.length===0?(i=t(),i&&i.then?i.then(function(){process.nextTick(n)},n):process.nextTick(n)):t.length===1?(i=t(this),i&&i.then?i.then(function(){process.nextTick(n)},n):process.nextTick(n)):t(this,n)}}function iT(t,e){return r.bind(e);function r(s,n){let i;t?t.length===0?(i=t(),i&&i.then?i.then(function(){process.nextTick(n,s)},n):process.nextTick(n,s)):t.length===1?(i=t(s),i&&i.then?i.then(function(){process.nextTick(n)},n):process.nextTick(n)):t.length===2?t(s,n):t(s,this,n):process.nextTick(n)}}oT.exports=or;oT.exports.express=function(t){return or(t,{expose:{use:"load"}})}});var xr=m((eHe,qq)=>{"use strict";var _re={kAvvioBoot:Symbol("fastify.avvioBoot"),kChildren:Symbol("fastify.children"),kServerBindings:Symbol("fastify.serverBindings"),kBodyLimit:Symbol("fastify.bodyLimit"),kRoutePrefix:Symbol("fastify.routePrefix"),kLogLevel:Symbol("fastify.logLevel"),kLogSerializers:Symbol("fastify.logSerializers"),kHooks:Symbol("fastify.hooks"),kContentTypeParser:Symbol("fastify.contentTypeParser"),kState:Symbol("fastify.state"),kOptions:Symbol("fastify.options"),kDisableRequestLogging:Symbol("fastify.disableRequestLogging"),kPluginNameChain:Symbol("fastify.pluginNameChain"),kRouteContext:Symbol("fastify.context"),kPublicRouteContext:Symbol("fastify.routeOptions"),kGenReqId:Symbol("fastify.genReqId"),kSchemaController:Symbol("fastify.schemaController"),kSchemaHeaders:Symbol("headers-schema"),kSchemaParams:Symbol("params-schema"),kSchemaQuerystring:Symbol("querystring-schema"),kSchemaBody:Symbol("body-schema"),kSchemaResponse:Symbol("response-schema"),kSchemaErrorFormatter:Symbol("fastify.schemaErrorFormatter"),kSchemaVisited:Symbol("fastify.schemas.visited"),kRequest:Symbol("fastify.Request"),kRequestPayloadStream:Symbol("fastify.RequestPayloadStream"),kRequestAcceptVersion:Symbol("fastify.RequestAcceptVersion"),kRequestCacheValidateFns:Symbol("fastify.request.cache.validateFns"),kRequestOriginalUrl:Symbol("fastify.request.originalUrl"),kFourOhFour:Symbol("fastify.404"),kCanSetNotFoundHandler:Symbol("fastify.canSetNotFoundHandler"),kFourOhFourLevelInstance:Symbol("fastify.404LogLevelInstance"),kFourOhFourContext:Symbol("fastify.404ContextKey"),kDefaultJsonParse:Symbol("fastify.defaultJSONParse"),kReply:Symbol("fastify.Reply"),kReplySerializer:Symbol("fastify.reply.serializer"),kReplyIsError:Symbol("fastify.reply.isError"),kReplyHeaders:Symbol("fastify.reply.headers"),kReplyTrailers:Symbol("fastify.reply.trailers"),kReplyHasStatusCode:Symbol("fastify.reply.hasStatusCode"),kReplyHijacked:Symbol("fastify.reply.hijacked"),kReplyStartTime:Symbol("fastify.reply.startTime"),kReplyNextErrorHandler:Symbol("fastify.reply.nextErrorHandler"),kReplyEndTime:Symbol("fastify.reply.endTime"),kReplyErrorHandlerCalled:Symbol("fastify.reply.errorHandlerCalled"),kReplyIsRunningOnErrorHook:Symbol("fastify.reply.isRunningOnErrorHook"),kReplySerializerDefault:Symbol("fastify.replySerializerDefault"),kReplyCacheSerializeFns:Symbol("fastify.reply.cache.serializeFns"),kTestInternals:Symbol("fastify.testInternals"),kErrorHandler:Symbol("fastify.errorHandler"),kChildLoggerFactory:Symbol("fastify.childLoggerFactory"),kHasBeenDecorated:Symbol("fastify.hasBeenDecorated"),kKeepAliveConnections:Symbol("fastify.keepAliveConnections"),kRouteByFastify:Symbol("fastify.routeByFastify")};qq.exports=_re});var uT=m((tHe,Vy)=>{"use strict";var{format:aT}=require("node:util");function Sre(t){return Lq({...t,name:"DeprecationWarning"})}function Lq({name:t,code:e,message:r,unlimited:s=!1}={}){if(!t)throw new Error("Warning name must not be empty");if(!e)throw new Error("Warning code must not be empty");if(!r)throw new Error("Warning message must not be empty");if(typeof s!="boolean")throw new Error("Warning opts.unlimited must be a boolean");e=e.toUpperCase();let n={[t]:function(o,a,l){i.emitted===!0&&i.unlimited!==!0||(i.emitted=!0,process.emitWarning(i.format(o,a,l),i.name,i.code))}};s&&(n={[t]:function(o,a,l){i.emitted=!0,process.emitWarning(i.format(o,a,l),i.name,i.code)}});let i=n[t];return i.emitted=!1,i.message=r,i.unlimited=s,i.code=e,i.format=function(o,a,l){let u;return o&&a&&l?u=aT(r,o,a,l):o&&a?u=aT(r,o,a):o?u=aT(r,o):u=r,u},i}var lT={createWarning:Lq,createDeprecation:Sre};Vy.exports=lT;Vy.exports.default=lT;Vy.exports.processWarning=lT});var zo=m((rHe,Fq)=>{"use strict";var{createDeprecation:Ur,createWarning:jq}=uT(),bre=Ur({code:"FSTDEP005",message:'You are accessing the deprecated "request.connection" property. Use "request.socket" instead.'}),Ere=Ur({code:"FSTDEP006",message:"You are decorating Request/Reply with a reference type. This reference is shared amongst all requests. Use onRequest hook instead. Property: %s"}),wre=Ur({code:"FSTDEP007",message:'You are trying to set a HEAD route using "exposeHeadRoute" route flag when a sibling route is already set. See documentation for more info.'}),Tre=Ur({code:"FSTDEP008",message:'You are using route constraints via the route { version: "..." } option, use { constraints: { version: "..." } } option instead.'}),Cre=Ur({code:"FSTDEP009",message:'You are using a custom route versioning strategy via the server { versioning: "..." } option, use { constraints: { version: "..." } } option instead.'}),Rre=Ur({code:"FSTDEP010",message:'Modifying the "reply.sent" property is deprecated. Use the "reply.hijack()" method instead.'}),Ore=Ur({code:"FSTDEP011",message:'Variadic listen method is deprecated. Please use ".listen(optionsObject)" instead. The variadic signature will be removed in `fastify@5`.'}),Pre=Ur({code:"FSTDEP012",message:'request.context property access is deprecated. Please use "request.routeOptions.config" or "request.routeOptions.schema" instead for accessing Route settings. The "request.context" will be removed in `fastify@5`.'}),Are=Ur({code:"FSTDEP013",message:'Direct return of "trailers" function is deprecated. Please use "callback" or "async-await" for return value. The support of direct return will removed in `fastify@5`.'}),kre=Ur({code:"FSTDEP014",message:"You are trying to set/access the default route. This property is deprecated. Please, use setNotFoundHandler if you want to custom a 404 handler or the wildcard (*) to match all routes."}),xre=Ur({code:"FSTDEP015",message:'You are accessing the deprecated "request.routeSchema" property. Use "request.routeOptions.schema" instead. Property "req.routeSchema" will be removed in `fastify@5`.'}),Ire=Ur({code:"FSTDEP016",message:'You are accessing the deprecated "request.routeConfig" property. Use "request.routeOptions.config" instead. Property "req.routeConfig" will be removed in `fastify@5`.'}),Nre=Ur({code:"FSTDEP017",message:'You are accessing the deprecated "request.routerPath" property. Use "request.routeOptions.url" instead. Property "req.routerPath" will be removed in `fastify@5`.'}),Dre=Ur({code:"FSTDEP018",message:'You are accessing the deprecated "request.routerMethod" property. Use "request.routeOptions.method" instead. Property "req.routerMethod" will be removed in `fastify@5`.'}),Mre=Ur({code:"FSTDEP019",message:'reply.context property access is deprecated. Please use "request.routeOptions.config" or "request.routeOptions.schema" instead for accessing Route settings. The "reply.context" will be removed in `fastify@5`.'}),$re=Ur({code:"FSTDEP020",message:'You are using the deprecated "reply.getResponseTime()" method. Use the "reply.elapsedTime" property instead. Method "reply.getResponseTime()" will be removed in `fastify@5`.'}),qre=Ur({code:"FSTDEP021",message:"The `reply.redirect()` method has a new signature: `reply.redirect(url: string, code?: number)`. It will be enforced in `fastify@v5`"}),Lre=jq({name:"FastifyWarning",code:"FSTWRN001",message:"The %s schema for %s: %s is missing. This may indicate the schema is not well specified.",unlimited:!0}),jre=jq({name:"FastifyWarning",code:"FSTWRN002",message:"The %s plugin being registered mixes async and callback styles, which will result in an error in `fastify@5`",unlimited:!0});Fq.exports={FSTDEP005:bre,FSTDEP006:Ere,FSTDEP007:wre,FSTDEP008:Tre,FSTDEP009:Cre,FSTDEP010:Rre,FSTDEP011:Ore,FSTDEP012:Pre,FSTDEP013:Are,FSTDEP014:kre,FSTDEP015:xre,FSTDEP016:Ire,FSTDEP017:Nre,FSTDEP018:Dre,FSTDEP019:Mre,FSTDEP020:$re,FSTDEP021:qre,FSTWRN001:Lre,FSTWRN002:jre}});var rs=m((sHe,Hy)=>{"use strict";var ne=Xw(),gu={FST_ERR_NOT_FOUND:ne("FST_ERR_NOT_FOUND","Not Found",404),FST_ERR_OPTIONS_NOT_OBJ:ne("FST_ERR_OPTIONS_NOT_OBJ","Options must be an object",500,TypeError),FST_ERR_QSP_NOT_FN:ne("FST_ERR_QSP_NOT_FN","querystringParser option should be a function, instead got '%s'",500,TypeError),FST_ERR_SCHEMA_CONTROLLER_BUCKET_OPT_NOT_FN:ne("FST_ERR_SCHEMA_CONTROLLER_BUCKET_OPT_NOT_FN","schemaController.bucket option should be a function, instead got '%s'",500,TypeError),FST_ERR_SCHEMA_ERROR_FORMATTER_NOT_FN:ne("FST_ERR_SCHEMA_ERROR_FORMATTER_NOT_FN","schemaErrorFormatter option should be a non async function. Instead got '%s'.",500,TypeError),FST_ERR_AJV_CUSTOM_OPTIONS_OPT_NOT_OBJ:ne("FST_ERR_AJV_CUSTOM_OPTIONS_OPT_NOT_OBJ","ajv.customOptions option should be an object, instead got '%s'",500,TypeError),FST_ERR_AJV_CUSTOM_OPTIONS_OPT_NOT_ARR:ne("FST_ERR_AJV_CUSTOM_OPTIONS_OPT_NOT_ARR","ajv.plugins option should be an array, instead got '%s'",500,TypeError),FST_ERR_VERSION_CONSTRAINT_NOT_STR:ne("FST_ERR_VERSION_CONSTRAINT_NOT_STR","Version constraint should be a string.",500,TypeError),FST_ERR_VALIDATION:ne("FST_ERR_VALIDATION","%s",400),FST_ERR_LISTEN_OPTIONS_INVALID:ne("FST_ERR_LISTEN_OPTIONS_INVALID","Invalid listen options: '%s'",500,TypeError),FST_ERR_ERROR_HANDLER_NOT_FN:ne("FST_ERR_ERROR_HANDLER_NOT_FN","Error Handler must be a function",500,TypeError),FST_ERR_CTP_ALREADY_PRESENT:ne("FST_ERR_CTP_ALREADY_PRESENT","Content type parser '%s' already present."),FST_ERR_CTP_INVALID_TYPE:ne("FST_ERR_CTP_INVALID_TYPE","The content type should be a string or a RegExp",500,TypeError),FST_ERR_CTP_EMPTY_TYPE:ne("FST_ERR_CTP_EMPTY_TYPE","The content type cannot be an empty string",500,TypeError),FST_ERR_CTP_INVALID_HANDLER:ne("FST_ERR_CTP_INVALID_HANDLER","The content type handler should be a function",500,TypeError),FST_ERR_CTP_INVALID_PARSE_TYPE:ne("FST_ERR_CTP_INVALID_PARSE_TYPE","The body parser can only parse your data as 'string' or 'buffer', you asked '%s' which is not supported.",500,TypeError),FST_ERR_CTP_BODY_TOO_LARGE:ne("FST_ERR_CTP_BODY_TOO_LARGE","Request body is too large",413,RangeError),FST_ERR_CTP_INVALID_MEDIA_TYPE:ne("FST_ERR_CTP_INVALID_MEDIA_TYPE","Unsupported Media Type: %s",415),FST_ERR_CTP_INVALID_CONTENT_LENGTH:ne("FST_ERR_CTP_INVALID_CONTENT_LENGTH","Request body size did not match Content-Length",400,RangeError),FST_ERR_CTP_EMPTY_JSON_BODY:ne("FST_ERR_CTP_EMPTY_JSON_BODY","Body cannot be empty when content-type is set to 'application/json'",400),FST_ERR_CTP_INSTANCE_ALREADY_STARTED:ne("FST_ERR_CTP_INSTANCE_ALREADY_STARTED",'Cannot call "%s" when fastify instance is already started!',400),FST_ERR_DEC_ALREADY_PRESENT:ne("FST_ERR_DEC_ALREADY_PRESENT","The decorator '%s' has already been added!"),FST_ERR_DEC_DEPENDENCY_INVALID_TYPE:ne("FST_ERR_DEC_DEPENDENCY_INVALID_TYPE","The dependencies of decorator '%s' must be of type Array.",500,TypeError),FST_ERR_DEC_MISSING_DEPENDENCY:ne("FST_ERR_DEC_MISSING_DEPENDENCY","The decorator is missing dependency '%s'."),FST_ERR_DEC_AFTER_START:ne("FST_ERR_DEC_AFTER_START","The decorator '%s' has been added after start!"),FST_ERR_HOOK_INVALID_TYPE:ne("FST_ERR_HOOK_INVALID_TYPE","The hook name must be a string",500,TypeError),FST_ERR_HOOK_INVALID_HANDLER:ne("FST_ERR_HOOK_INVALID_HANDLER","%s hook should be a function, instead got %s",500,TypeError),FST_ERR_HOOK_INVALID_ASYNC_HANDLER:ne("FST_ERR_HOOK_INVALID_ASYNC_HANDLER","Async function has too many arguments. Async hooks should not use the 'done' argument.",500,TypeError),FST_ERR_HOOK_NOT_SUPPORTED:ne("FST_ERR_HOOK_NOT_SUPPORTED","%s hook not supported!",500,TypeError),FST_ERR_MISSING_MIDDLEWARE:ne("FST_ERR_MISSING_MIDDLEWARE","You must register a plugin for handling middlewares, visit fastify.dev/docs/latest/Reference/Middleware/ for more info.",500),FST_ERR_HOOK_TIMEOUT:ne("FST_ERR_HOOK_TIMEOUT","A callback for '%s' hook timed out. You may have forgotten to call 'done' function or to resolve a Promise"),FST_ERR_LOG_INVALID_DESTINATION:ne("FST_ERR_LOG_INVALID_DESTINATION","Cannot specify both logger.stream and logger.file options"),FST_ERR_LOG_INVALID_LOGGER:ne("FST_ERR_LOG_INVALID_LOGGER","Invalid logger object provided. The logger instance should have these functions(s): '%s'.",500,TypeError),FST_ERR_REP_INVALID_PAYLOAD_TYPE:ne("FST_ERR_REP_INVALID_PAYLOAD_TYPE","Attempted to send payload of invalid type '%s'. Expected a string or Buffer.",500,TypeError),FST_ERR_REP_RESPONSE_BODY_CONSUMED:ne("FST_ERR_REP_RESPONSE_BODY_CONSUMED","Response.body is already consumed."),FST_ERR_REP_ALREADY_SENT:ne("FST_ERR_REP_ALREADY_SENT",'Reply was already sent, did you forget to "return reply" in "%s" (%s)?'),FST_ERR_REP_SENT_VALUE:ne("FST_ERR_REP_SENT_VALUE","The only possible value for reply.sent is true.",500,TypeError),FST_ERR_SEND_INSIDE_ONERR:ne("FST_ERR_SEND_INSIDE_ONERR","You cannot use `send` inside the `onError` hook"),FST_ERR_SEND_UNDEFINED_ERR:ne("FST_ERR_SEND_UNDEFINED_ERR","Undefined error has occurred"),FST_ERR_BAD_STATUS_CODE:ne("FST_ERR_BAD_STATUS_CODE","Called reply with an invalid status code: %s"),FST_ERR_BAD_TRAILER_NAME:ne("FST_ERR_BAD_TRAILER_NAME","Called reply.trailer with an invalid header name: %s"),FST_ERR_BAD_TRAILER_VALUE:ne("FST_ERR_BAD_TRAILER_VALUE","Called reply.trailer('%s', fn) with an invalid type: %s. Expected a function."),FST_ERR_FAILED_ERROR_SERIALIZATION:ne("FST_ERR_FAILED_ERROR_SERIALIZATION","Failed to serialize an error. Error: %s. Original error: %s"),FST_ERR_MISSING_SERIALIZATION_FN:ne("FST_ERR_MISSING_SERIALIZATION_FN",'Missing serialization function. Key "%s"'),FST_ERR_MISSING_CONTENTTYPE_SERIALIZATION_FN:ne("FST_ERR_MISSING_CONTENTTYPE_SERIALIZATION_FN",'Missing serialization function. Key "%s:%s"'),FST_ERR_REQ_INVALID_VALIDATION_INVOCATION:ne("FST_ERR_REQ_INVALID_VALIDATION_INVOCATION",'Invalid validation invocation. Missing validation function for HTTP part "%s" nor schema provided.'),FST_ERR_SCH_MISSING_ID:ne("FST_ERR_SCH_MISSING_ID","Missing schema $id property"),FST_ERR_SCH_ALREADY_PRESENT:ne("FST_ERR_SCH_ALREADY_PRESENT","Schema with id '%s' already declared!"),FST_ERR_SCH_CONTENT_MISSING_SCHEMA:ne("FST_ERR_SCH_CONTENT_MISSING_SCHEMA","Schema is missing for the content type '%s'"),FST_ERR_SCH_DUPLICATE:ne("FST_ERR_SCH_DUPLICATE","Schema with '%s' already present!"),FST_ERR_SCH_VALIDATION_BUILD:ne("FST_ERR_SCH_VALIDATION_BUILD","Failed building the validation schema for %s: %s, due to error %s"),FST_ERR_SCH_SERIALIZATION_BUILD:ne("FST_ERR_SCH_SERIALIZATION_BUILD","Failed building the serialization schema for %s: %s, due to error %s"),FST_ERR_SCH_RESPONSE_SCHEMA_NOT_NESTED_2XX:ne("FST_ERR_SCH_RESPONSE_SCHEMA_NOT_NESTED_2XX",'response schemas should be nested under a valid status code, e.g { 2xx: { type: "object" } }'),FST_ERR_HTTP2_INVALID_VERSION:ne("FST_ERR_HTTP2_INVALID_VERSION","HTTP2 is available only from node >= 8.8.1"),FST_ERR_INIT_OPTS_INVALID:ne("FST_ERR_INIT_OPTS_INVALID","Invalid initialization options: '%s'"),FST_ERR_FORCE_CLOSE_CONNECTIONS_IDLE_NOT_AVAILABLE:ne("FST_ERR_FORCE_CLOSE_CONNECTIONS_IDLE_NOT_AVAILABLE","Cannot set forceCloseConnections to 'idle' as your HTTP server does not support closeIdleConnections method"),FST_ERR_DUPLICATED_ROUTE:ne("FST_ERR_DUPLICATED_ROUTE","Method '%s' already declared for route '%s'"),FST_ERR_BAD_URL:ne("FST_ERR_BAD_URL","'%s' is not a valid url component",400,URIError),FST_ERR_ASYNC_CONSTRAINT:ne("FST_ERR_ASYNC_CONSTRAINT","Unexpected error from async constraint",500),FST_ERR_DEFAULT_ROUTE_INVALID_TYPE:ne("FST_ERR_DEFAULT_ROUTE_INVALID_TYPE","The defaultRoute type should be a function",500,TypeError),FST_ERR_INVALID_URL:ne("FST_ERR_INVALID_URL","URL must be a string. Received '%s'",400,TypeError),FST_ERR_ROUTE_OPTIONS_NOT_OBJ:ne("FST_ERR_ROUTE_OPTIONS_NOT_OBJ",'Options for "%s:%s" route must be an object',500,TypeError),FST_ERR_ROUTE_DUPLICATED_HANDLER:ne("FST_ERR_ROUTE_DUPLICATED_HANDLER",'Duplicate handler for "%s:%s" route is not allowed!',500),FST_ERR_ROUTE_HANDLER_NOT_FN:ne("FST_ERR_ROUTE_HANDLER_NOT_FN","Error Handler for %s:%s route, if defined, must be a function",500,TypeError),FST_ERR_ROUTE_MISSING_HANDLER:ne("FST_ERR_ROUTE_MISSING_HANDLER",'Missing handler function for "%s:%s" route.',500),FST_ERR_ROUTE_METHOD_INVALID:ne("FST_ERR_ROUTE_METHOD_INVALID","Provided method is invalid!",500,TypeError),FST_ERR_ROUTE_METHOD_NOT_SUPPORTED:ne("FST_ERR_ROUTE_METHOD_NOT_SUPPORTED","%s method is not supported.",500),FST_ERR_ROUTE_BODY_VALIDATION_SCHEMA_NOT_SUPPORTED:ne("FST_ERR_ROUTE_BODY_VALIDATION_SCHEMA_NOT_SUPPORTED","Body validation schema for %s:%s route is not supported!",500),FST_ERR_ROUTE_BODY_LIMIT_OPTION_NOT_INT:ne("FST_ERR_ROUTE_BODY_LIMIT_OPTION_NOT_INT","'bodyLimit' option must be an integer > 0. Got '%s'",500,TypeError),FST_ERR_ROUTE_REWRITE_NOT_STR:ne("FST_ERR_ROUTE_REWRITE_NOT_STR",'Rewrite url for "%s" needs to be of type "string" but received "%s"',500,TypeError),FST_ERR_REOPENED_CLOSE_SERVER:ne("FST_ERR_REOPENED_CLOSE_SERVER","Fastify has already been closed and cannot be reopened"),FST_ERR_REOPENED_SERVER:ne("FST_ERR_REOPENED_SERVER","Fastify is already listening"),FST_ERR_INSTANCE_ALREADY_LISTENING:ne("FST_ERR_INSTANCE_ALREADY_LISTENING","Fastify instance is already listening. %s"),FST_ERR_PLUGIN_VERSION_MISMATCH:ne("FST_ERR_PLUGIN_VERSION_MISMATCH","fastify-plugin: %s - expected '%s' fastify version, '%s' is installed"),FST_ERR_PLUGIN_NOT_PRESENT_IN_INSTANCE:ne("FST_ERR_PLUGIN_NOT_PRESENT_IN_INSTANCE","The decorator '%s'%s is not present in %s"),FST_ERR_PLUGIN_CALLBACK_NOT_FN:ne("FST_ERR_PLUGIN_CALLBACK_NOT_FN","fastify-plugin: %s",500,TypeError),FST_ERR_PLUGIN_NOT_VALID:ne("FST_ERR_PLUGIN_NOT_VALID","fastify-plugin: %s"),FST_ERR_ROOT_PLG_BOOTED:ne("FST_ERR_ROOT_PLG_BOOTED","fastify-plugin: %s"),FST_ERR_PARENT_PLUGIN_BOOTED:ne("FST_ERR_PARENT_PLUGIN_BOOTED","fastify-plugin: %s"),FST_ERR_PLUGIN_TIMEOUT:ne("FST_ERR_PLUGIN_TIMEOUT","fastify-plugin: %s")};function Fre(t,e){return e.cause=t,e}Hy.exports=gu;Hy.exports.appendStackTrace=Fre;Hy.exports.AVVIO_ERRORS_MAP={AVV_ERR_CALLBACK_NOT_FN:gu.FST_ERR_PLUGIN_CALLBACK_NOT_FN,AVV_ERR_PLUGIN_NOT_VALID:gu.FST_ERR_PLUGIN_NOT_VALID,AVV_ERR_ROOT_PLG_BOOTED:gu.FST_ERR_ROOT_PLG_BOOTED,AVV_ERR_PARENT_PLG_LOADED:gu.FST_ERR_PARENT_PLUGIN_BOOTED,AVV_ERR_READY_TIMEOUT:gu.FST_ERR_PLUGIN_TIMEOUT,AVV_ERR_PLUGIN_EXEC_TIMEOUT:gu.FST_ERR_PLUGIN_TIMEOUT}});var Na=m((nHe,Wq)=>{"use strict";var Bre=["onRoute","onRegister","onReady","onListen","preClose","onClose"],Vq=["onTimeout","onRequest","preParsing","preValidation","preSerialization","preHandler","onSend","onResponse","onError","onRequestAbort"],zre=Vq.concat(Bre),{FST_ERR_HOOK_INVALID_TYPE:Ure,FST_ERR_HOOK_INVALID_HANDLER:Vre,FST_ERR_SEND_UNDEFINED_ERR:Gy,FST_ERR_HOOK_TIMEOUT:Hre,FST_ERR_HOOK_NOT_SUPPORTED:Gre,AVVIO_ERRORS_MAP:Bq,appendStackTrace:zq}=rs(),{kChildren:cp,kHooks:Hq,kRequestPayloadStream:Uq}=xr();function dp(){this.onRequest=[],this.preParsing=[],this.preValidation=[],this.preSerialization=[],this.preHandler=[],this.onResponse=[],this.onSend=[],this.onError=[],this.onRoute=[],this.onRegister=[],this.onReady=[],this.onListen=[],this.onTimeout=[],this.onRequestAbort=[],this.preClose=[]}dp.prototype=Object.create(null);dp.prototype.validate=function(t,e){if(typeof t!="string")throw new Ure;if(Array.isArray(this[t])===!1)throw new Gre(t);if(typeof e!="function")throw new Vre(t,Object.prototype.toString.call(e))};dp.prototype.add=function(t,e){this.validate(t,e),this[t].push(e)};function Kre(t){let e=new dp;return e.onRequest=t.onRequest.slice(),e.preParsing=t.preParsing.slice(),e.preValidation=t.preValidation.slice(),e.preSerialization=t.preSerialization.slice(),e.preHandler=t.preHandler.slice(),e.onSend=t.onSend.slice(),e.onResponse=t.onResponse.slice(),e.onError=t.onError.slice(),e.onRoute=t.onRoute.slice(),e.onRegister=t.onRegister.slice(),e.onTimeout=t.onTimeout.slice(),e.onRequestAbort=t.onRequestAbort.slice(),e.onReady=[],e.onListen=[],e.preClose=[],e}function Gq(t,e,r,s){let n=r[Hq][t],i=0,o=0;l();function a(c){if(c){c.code==="AVV_ERR_READY_TIMEOUT"?c=zq(c,new Hre(t)):c=Bq[c.code]!=null?zq(c,new Bq[c.code](c.message)):c,s(c);return}s()}function l(c){if(c){a(c);return}if(i===n.length&&o===r[cp].length){i===0&&o===0?a():e(function(f,h){a(f),h(f)});return}if(i===n.length&&o<r[cp].length){let d=r[cp][o++];Gq(t,e,d,l);return}e(u(n[i++],r)),l()}function u(c,d){return function(f,h){if(f){h(f);return}if(c.length===1){try{c.call(d,h)}catch(p){h(p)}return}try{let p=c.call(d);if(p&&typeof p.then=="function"){p.then(h,h);return}}catch(p){f=p}h(f)}}}function Kq(t){let e=t[Hq].onListen,r=e.length,s=0,n=0;i();function i(a){if(a&&t.log.error(a),s===r){for(;n<t[cp].length;){let l=t[cp][n++];Kq(l)}return}o(e[s++],t,i)}async function o(a,l,u){if(a.length===1){try{a.call(l,u)}catch(c){u(c)}return}try{let c=a.call(l);if(c&&typeof c.then=="function"){c.then(u,u);return}u()}catch(c){u(c)}}}function od(t){return function(r,s,n,i){let o=0;function a(c){if(c||o===r.length){i(c,s,n);return}let d;try{d=t(r[o++],s,n,a)}catch(f){i(f,s,n);return}d&&typeof d.then=="function"&&d.then(l,u)}function l(){a()}function u(c){c||(c=new Gy),i(c,s,n)}a()}}function Qre(t,e,r,s){return t(e,r,s)}var Wre=od(Qre),Zre=od(fp),Yre=od(fp),Jre=od(fp),Xre=od(fp);function Qq(t,e,r,s,n){let i=0;function o(u,c){if(u){n(u,e,r,s);return}if(c!==void 0&&(s=c),i===t.length){n(null,e,r,s);return}let d;try{d=t[i++](e,r,s,o)}catch(f){n(f,e,r);return}d&&typeof d.then=="function"&&d.then(a,l)}function a(u){o(null,u)}function l(u){u||(u=new Gy),n(u,e,r,s)}o()}var ese=Qq;function tse(t,e,r,s){let n=0;function i(l,u){if(r.sent)return;if(u!==void 0&&(e[Uq]=u),l||n===t.length){s(l,e,r);return}let c;try{c=t[n++](e,r,e[Uq],i)}catch(d){s(d,e,r);return}c&&typeof c.then=="function"&&c.then(o,a)}function o(l){i(null,l)}function a(l){l||(l=new Gy),s(l,e,r)}i()}function rse(t,e,r){let s=0;function n(a){if(a||s===t.length){r(a,e);return}let l;try{l=t[s++](e,n)}catch(u){r(u,e);return}l&&typeof l.then=="function"&&l.then(i,o)}function i(){n()}function o(a){a||(a=new Gy),r(a,e)}n()}function fp(t,e,r,s){if(r.sent!==!0)return t(e,r,s)}Wq.exports={Hooks:dp,buildHooks:Kre,hookRunnerGenerator:od,preParsingHookRunner:tse,onResponseHookRunner:Wre,onSendHookRunner:Qq,preSerializationHookRunner:ese,onRequestAbortHookRunner:rse,hookIterator:fp,hookRunnerApplication:Gq,onListenHookRunner:Kq,preHandlerHookRunner:Yre,preValidationHookRunner:Zre,onRequestHookRunner:Xre,onTimeoutHookRunner:Jre,lifecycleHooks:Vq,supportedHooks:zre}});var iL=m((iHe,dT)=>{"use strict";var sse=require("node:http"),nse=require("node:https"),ise=require("node:dns"),{FSTDEP011:Zq}=zo(),{kState:ss,kOptions:ose,kServerBindings:ase}=xr(),{onListenHookRunner:Ky}=Na(),{FST_ERR_HTTP2_INVALID_VERSION:lse,FST_ERR_REOPENED_CLOSE_SERVER:Xq,FST_ERR_REOPENED_SERVER:eL,FST_ERR_LISTEN_OPTIONS_INVALID:use}=rs();dT.exports.createServer=cse;dT.exports.compileValidateHTTPVersion=fse;function tL(t){return`Server listening at ${t}`}function cse(t,e){let r=sL(t,e);function s(n,...i){let o=i.slice(-1).pop(),a=Object.prototype.toString.call(arguments[0]);if(arguments.length===0)n=cT([]);else if(arguments.length>0&&a!=="[object Object]"&&a!=="[object Function]")Zq(),n=cT(Array.from(arguments)),o=n.cb;else if(i.length>1){Zq();let u=n.path?[n.path]:[n.port??0,n.host??"localhost"];Object.assign(n,cT([...u,...i]))}else n.cb=o;if(n.signal){if(typeof n.signal.on!="function"&&typeof n.signal.addEventListener!="function")throw new use("Invalid options.signal");if(n.signal.aborted)this.close();else{let u=()=>{this.close()};n.signal.addEventListener("abort",u,{once:!0})}}let l;if(n.path==null?l=n.host??"localhost":l=n.host,Object.prototype.hasOwnProperty.call(n,"host")===!1&&(n.host=l),l==="localhost"?n.cb=(u,c)=>{if(u){o(u,c);return}Yq.call(this,r,e,t,n,()=>{this[ss].listening=!0,o(null,c),Ky(this)})}:n.cb=(u,c)=>{if(u){o(u,c);return}this[ss].listening=!0,o(null,c),Ky(this)},o===void 0)return dse.call(this,r,n).then(c=>new Promise((d,f)=>{l==="localhost"?Yq.call(this,r,e,t,n,()=>{this[ss].listening=!0,d(c),Ky(this)}):(d(c),Ky(this))}));this.ready(rL.call(this,r,n))}return{server:r,listen:s}}function Yq(t,e,r,s,n){this[ss].listening=!1,ise.lookup(s.host,{all:!0},(i,o)=>{if(i){n();return}let a=t.listening&&r.serverFactory,l=0,u=0;if(!a){let d=t.address();for(let f of o)if(f.address!==d.address){l++;let h=Object.assign({},s,{host:f.address,port:d.port,cb:_=>{u++,_||this[ase].push(p),u===l&&n()}}),p=sL(r,e),g=()=>{p.close(()=>{}),r.forceCloseConnections==="idle"?p.closeIdleConnections():typeof p.closeAllConnections=="function"&&r.forceCloseConnections&&p.closeAllConnections()};p.on("upgrade",t.emit.bind(t,"upgrade")),t.on("unref",g),t.on("close",g),t.on("error",g),this[ss].listening=!1,rL.call(this,p,h)()}}if(l===0){n();return}let c=t.unref;t.unref=function(){c.call(t),t.emit("unref")}})}function rL(t,e){let r=s=>{if(t.removeListener("error",r),s)this[ss].listening=!1,e.cb(s,null);else{let n=nL.call(this,t,e.listenTextResolver||tL);e.cb(null,n)}};return s=>{if(s!=null)return e.cb(s);if(this[ss].listening&&this[ss].closing)return e.cb(new Xq,null);if(this[ss].listening)return e.cb(new eL,null);t.once("error",r),this[ss].closing||(t.listen(e,r),this[ss].listening=!0)}}function dse(t,e){return this[ss].listening&&this[ss].closing?Promise.reject(new Xq):this[ss].listening?Promise.reject(new eL):this.ready().then(()=>{let r,s=new Promise((i,o)=>{r=a=>{this[ss].listening=!1,o(a)},t.once("error",r)}),n=new Promise((i,o)=>{t.listen(e,()=>{t.removeListener("error",r),i(nL.call(this,t,e.listenTextResolver||tL))}),this[ss].listening=!0});return Promise.race([s,n])})}function fse(t){let e=!1,r=new Map;return t.serverFactory&&(e=!0),t.http2?(r.set("2.0",!0),t.https&&t.https.allowHTTP1===!0&&(r.set("1.1",!0),r.set("1.0",!0))):(r.set("1.1",!0),r.set("1.0",!0)),function(n){return e||r.has(n)}}function sL(t,e){let r=null,s=t.https===!0?{}:t.https;return t.serverFactory?r=t.serverFactory(e,t):t.http2?(typeof s=="object"?r=Jq().createSecureServer(s,e):r=Jq().createServer(e),r.on("session",pse(t.http2SessionTimeout))):(s?r=nse.createServer(s,e):r=sse.createServer(t.http,e),r.keepAliveTimeout=t.keepAliveTimeout,r.requestTimeout=t.requestTimeout,t.maxRequestsPerSocket>0&&(r.maxRequestsPerSocket=t.maxRequestsPerSocket)),t.serverFactory||r.setTimeout(t.connectionTimeout),r}function cT(t){if(t.length===0)return{port:0,host:"localhost"};let r={cb:typeof t[t.length-1]=="function"?t.pop():void 0},s=t[0],n=t.length,i=t[n-1];return typeof s=="string"&&isNaN(s)?(r.path=s,r.backlog=n>1?i:void 0):(r.port=n>=1&&Number.isInteger(s)?s:hse(s),r.host=n>=2&&t[1]?t[1]:"localhost",r.backlog=n>=3?t[2]:void 0),r}function hse(t){let e=Number(t);return e>=0&&!Number.isNaN(e)&&Number.isInteger(e)?e:0}function nL(t,e){let r=t.address(),s=typeof r=="string";s||(r.address.indexOf(":")===-1?r=r.address+":"+r.port:r="["+r.address+"]:"+r.port),r=(s?"":"http"+(this[ose].https?"s":"")+"://")+r;let n=e(r);return this.log.info(n),r}function Jq(){try{return require("node:http2")}catch{throw new lse}}function pse(t){return function(e){e.setTimeout(t,mse)}}function mse(){this.close()}});var mT=m((oHe,aL)=>{"use strict";var{kSchemaHeaders:Zy,kSchemaParams:fT,kSchemaQuerystring:hT,kSchemaBody:pT,kSchemaResponse:oL}=xr(),gse=/^[1-5]{1}[0-9]{2}$|^[1-5]xx$|^default$/,{FST_ERR_SCH_RESPONSE_SCHEMA_NOT_NESTED_2XX:yse}=rs(),{FSTWRN001:Qy}=zo();function vse(t,e){if(!t.schema||!t.schema.response)return;let{method:r,url:s}=t.config||{};t[oL]=Object.keys(t.schema.response).reduce(function(n,i){let o=t.schema.response[i];if(i=i.toLowerCase(),!gse.exec(i))throw new yse;if(o.content){let a={};for(let l of Object.keys(o.content)){let u=o.content[l].schema;a[l]=e({schema:u,url:s,method:r,httpStatus:i,contentType:l})}n[i]=a}else n[i]=e({schema:o,url:s,method:r,httpStatus:i});return n},{})}function _se(t,e,r){let{schema:s}=t;if(!s)return;let{method:n,url:i}=t.config||{},o=s.headers;if(o&&(r||Object.getPrototypeOf(o)!==Object.prototype))t[Zy]=e({schema:o,method:n,url:i,httpPart:"headers"});else if(o){let a={};Object.keys(o).forEach(l=>{a[l]=o[l]}),a.required instanceof Array&&(a.required=a.required.map(l=>l.toLowerCase())),o.properties&&(a.properties={},Object.keys(o.properties).forEach(l=>{a.properties[l.toLowerCase()]=o.properties[l]})),t[Zy]=e({schema:a,method:n,url:i,httpPart:"headers"})}else Object.prototype.hasOwnProperty.call(s,"headers")&&Qy("headers",n,i);s.body?t[pT]=e({schema:s.body,method:n,url:i,httpPart:"body"}):Object.prototype.hasOwnProperty.call(s,"body")&&Qy("body",n,i),s.querystring?t[hT]=e({schema:s.querystring,method:n,url:i,httpPart:"querystring"}):Object.prototype.hasOwnProperty.call(s,"querystring")&&Qy("querystring",n,i),s.params?t[fT]=e({schema:s.params,method:n,url:i,httpPart:"params"}):Object.prototype.hasOwnProperty.call(s,"params")&&Qy("params",n,i)}function Wy(t,e,r){let s=e[r]===void 0,n=t&&t(s?null:e[r]);if(n?.then)return n.then(o=>i(o)).catch(o=>o);return i(n);function i(o){return o===!1?t.errors:o&&o.error?o.error:(o&&o.value&&(e[r]=o.value),!1)}}function Yy(t,e,r){let s=r===void 0;if(s||!r.skipParams){let i=Wy(t[fT],e,"params");if(i)return typeof i.then!="function"?Da(i,"params",t.schemaErrorFormatter):Sse(i,t,e)}if(s||!r.skipBody){let i=Wy(t[pT],e,"body");if(i)return typeof i.then!="function"?Da(i,"body",t.schemaErrorFormatter):bse(i,t,e)}if(s||!r.skipQuery){let i=Wy(t[hT],e,"query");if(i)return typeof i.then!="function"?Da(i,"querystring",t.schemaErrorFormatter):Ese(i,t,e)}let n=Wy(t[Zy],e,"headers");return n?typeof n.then!="function"?Da(n,"headers",t.schemaErrorFormatter):wse(n,t,e):!1}function Sse(t,e,r){return t.then(s=>s?Da(s,"params",e.schemaErrorFormatter):Yy(e,r,{skipParams:!0}))}function bse(t,e,r){return t.then(s=>s?Da(s,"body",e.schemaErrorFormatter):Yy(e,r,{skipParams:!0,skipBody:!0}))}function Ese(t,e,r){return t.then(s=>s?Da(s,"querystring",e.schemaErrorFormatter):Yy(e,r,{skipParams:!0,skipBody:!0,skipQuery:!0}))}function wse(t,e,r){return t.then(s=>s?Da(s,"headers",e.schemaErrorFormatter):!1)}function Da(t,e,r){if(t instanceof Error)return t.statusCode=t.statusCode||400,t.code=t.code||"FST_ERR_VALIDATION",t.validationContext=t.validationContext||e,t;let s=r(t,e);return s.statusCode=s.statusCode||400,s.code=s.code||"FST_ERR_VALIDATION",s.validation=t,s.validationContext=e,s}aL.exports={symbols:{bodySchema:pT,querystringSchema:hT,responseSchema:oL,paramsSchema:fT,headersSchema:Zy},compileSchemasForValidation:_se,compileSchemasForSerialization:vse,validate:Yy}});var gT=m((aHe,uL)=>{"use strict";var{kReplyIsError:lL,kReplyHijacked:Tse}=xr();function Cse(t,e){t.then(function(r){if(e[Tse]!==!0&&(r!==void 0||e.sent===!1&&e.raw.headersSent===!1&&e.request.raw.aborted===!1))try{e.send(r)}catch(s){e[lL]=!0,e.send(s)}},function(r){if(e.sent===!0){e.log.error({err:r},"Promise errored, but reply.sent = true was set");return}e[lL]=!0;try{e.send(r)}catch(s){e.send(s)}})}uL.exports=Cse});var ST=m((lHe,_T)=>{"use strict";var{validate:Rse}=mT(),{preValidationHookRunner:Ose,preHandlerHookRunner:Pse}=Na(),Ase=gT(),{kReplyIsError:Jy,kRouteContext:$a}=xr();function kse(t,e,r){if(r.sent===!0)return;if(t!=null){r[Jy]=!0,r.send(t);return}let s=e.raw.method,n=e.headers,i=e[$a];if(s==="GET"||s==="HEAD"){Ma(e,r);return}let o=n["content-type"];if(s==="POST"||s==="PUT"||s==="PATCH"||s==="TRACE"||s==="SEARCH"||s==="PROPFIND"||s==="PROPPATCH"||s==="LOCK"||s==="REPORT"||s==="MKCALENDAR"){o===void 0?n["transfer-encoding"]===void 0&&(n["content-length"]==="0"||n["content-length"]===void 0)?Ma(e,r):i.contentTypeParser.run("",Ma,e,r):i.contentTypeParser.run(o,Ma,e,r);return}if(s==="OPTIONS"||s==="DELETE"){o!==void 0&&(n["transfer-encoding"]!==void 0||n["content-length"]!==void 0)?i.contentTypeParser.run(o,Ma,e,r):Ma(e,r);return}Ma(e,r)}function Ma(t,e){try{t[$a].preValidation!==null?Ose(t[$a].preValidation,t,e,yT):yT(null,t,e)}catch(r){yT(r,t,e)}}function yT(t,e,r){if(r.sent===!0)return;if(t!=null){r[Jy]=!0,r.send(t);return}let s=Rse(r[$a],e);if(s&&typeof s.then=="function"||!1){let i=cL.bind(null,e,r);s.then(i,i)}else cL(e,r,s)}function cL(t,e,r){if(r){if(e[$a].attachValidation===!1){e.send(r);return}e.request.validationError=r}t[$a].preHandler!==null?Pse(t[$a].preHandler,t,e,vT):vT(null,t,e)}function vT(t,e,r){if(r.sent)return;if(t!=null){r[Jy]=!0,r.send(t);return}let s;try{s=e[$a].handler(e,r)}catch(n){r[Jy]=!0,r.send(n);return}s!==void 0&&(s!==null&&typeof s.then=="function"?Ase(s,r):r.send(s))}_T.exports=kse;_T.exports[Symbol.for("internals")]={handler:Ma,preHandlerCallback:vT}});var fL=m((uHe,dL)=>{"use strict";function ad(){}var xse={fatal:ad,error:ad,warn:ad,info:ad,debug:ad,trace:ad};Object.defineProperty(dL,"exports",{get(){return Object.create(xse)}})});var ET=m((cHe,mL)=>{"use strict";var hp=t=>t&&typeof t.message=="string",bT=t=>{if(!t)return;let e=t.cause;if(typeof e=="function"){let r=t.cause();return hp(r)?r:void 0}else return hp(e)?e:void 0},hL=(t,e)=>{if(!hp(t))return"";let r=t.stack||"";if(e.has(t))return r+`
causes have become circular...`;let s=bT(t);return s?(e.add(t),r+`
caused by: `+hL(s,e)):r},Ise=t=>hL(t,new Set),pL=(t,e,r)=>{if(!hp(t))return"";let s=r?"":t.message||"";if(e.has(t))return s+": ...";let n=bT(t);if(n){e.add(t);let i=typeof t.cause=="function";return s+(i?"":": ")+pL(n,e,i)}else return s},Nse=t=>pL(t,new Set);mL.exports={isErrorLike:hp,getErrorCause:bT,stackWithCauses:Ise,messageWithCauses:Nse}});var wT=m((dHe,yL)=>{"use strict";var Dse=Symbol("circular-ref-tag"),Xy=Symbol("pino-raw-err-ref"),gL=Object.create({},{type:{enumerable:!0,writable:!0,value:void 0},message:{enumerable:!0,writable:!0,value:void 0},stack:{enumerable:!0,writable:!0,value:void 0},aggregateErrors:{enumerable:!0,writable:!0,value:void 0},raw:{enumerable:!1,get:function(){return this[Xy]},set:function(t){this[Xy]=t}}});Object.defineProperty(gL,Xy,{writable:!0,value:{}});yL.exports={pinoErrProto:gL,pinoErrorSymbols:{seen:Dse,rawSymbol:Xy}}});var SL=m((fHe,_L)=>{"use strict";_L.exports=CT;var{messageWithCauses:Mse,stackWithCauses:$se,isErrorLike:vL}=ET(),{pinoErrProto:qse,pinoErrorSymbols:Lse}=wT(),{seen:TT}=Lse,{toString:jse}=Object.prototype;function CT(t){if(!vL(t))return t;t[TT]=void 0;let e=Object.create(qse);e.type=jse.call(t.constructor)==="[object Function]"?t.constructor.name:t.name,e.message=Mse(t),e.stack=$se(t),Array.isArray(t.errors)&&(e.aggregateErrors=t.errors.map(r=>CT(r)));for(let r in t)if(e[r]===void 0){let s=t[r];vL(s)?r!=="cause"&&!Object.prototype.hasOwnProperty.call(s,TT)&&(e[r]=CT(s)):e[r]=s}return delete t[TT],e.raw=t,e}});var EL=m((hHe,bL)=>{"use strict";bL.exports=t0;var{isErrorLike:RT}=ET(),{pinoErrProto:Fse,pinoErrorSymbols:Bse}=wT(),{seen:e0}=Bse,{toString:zse}=Object.prototype;function t0(t){if(!RT(t))return t;t[e0]=void 0;let e=Object.create(Fse);e.type=zse.call(t.constructor)==="[object Function]"?t.constructor.name:t.name,e.message=t.message,e.stack=t.stack,Array.isArray(t.errors)&&(e.aggregateErrors=t.errors.map(r=>t0(r))),RT(t.cause)&&!Object.prototype.hasOwnProperty.call(t.cause,e0)&&(e.cause=t0(t.cause));for(let r in t)if(e[r]===void 0){let s=t[r];RT(s)?Object.prototype.hasOwnProperty.call(s,e0)||(e[r]=t0(s)):e[r]=s}return delete t[e0],e.raw=t,e}});var RL=m((pHe,CL)=>{"use strict";CL.exports={mapHttpRequest:Use,reqSerializer:TL};var OT=Symbol("pino-raw-req-ref"),wL=Object.create({},{id:{enumerable:!0,writable:!0,value:""},method:{enumerable:!0,writable:!0,value:""},url:{enumerable:!0,writable:!0,value:""},query:{enumerable:!0,writable:!0,value:""},params:{enumerable:!0,writable:!0,value:""},headers:{enumerable:!0,writable:!0,value:{}},remoteAddress:{enumerable:!0,writable:!0,value:""},remotePort:{enumerable:!0,writable:!0,value:""},raw:{enumerable:!1,get:function(){return this[OT]},set:function(t){this[OT]=t}}});Object.defineProperty(wL,OT,{writable:!0,value:{}});function TL(t){let e=t.info||t.socket,r=Object.create(wL);if(r.id=typeof t.id=="function"?t.id():t.id||(t.info?t.info.id:void 0),r.method=t.method,t.originalUrl)r.url=t.originalUrl;else{let s=t.path;r.url=typeof s=="string"?s:t.url?t.url.path||t.url:void 0}return t.query&&(r.query=t.query),t.params&&(r.params=t.params),r.headers=t.headers,r.remoteAddress=e&&e.remoteAddress,r.remotePort=e&&e.remotePort,r.raw=t.raw||t,r}function Use(t){return{req:TL(t)}}});var kL=m((mHe,AL)=>{"use strict";AL.exports={mapHttpResponse:Vse,resSerializer:PL};var PT=Symbol("pino-raw-res-ref"),OL=Object.create({},{statusCode:{enumerable:!0,writable:!0,value:0},headers:{enumerable:!0,writable:!0,value:""},raw:{enumerable:!1,get:function(){return this[PT]},set:function(t){this[PT]=t}}});Object.defineProperty(OL,PT,{writable:!0,value:{}});function PL(t){let e=Object.create(OL);return e.statusCode=t.headersSent?t.statusCode:null,e.headers=t.getHeaders?t.getHeaders():t._headers,e.raw=t,e}function Vse(t){return{res:PL(t)}}});var kT=m((gHe,xL)=>{"use strict";var AT=SL(),Hse=EL(),r0=RL(),s0=kL();xL.exports={err:AT,errWithCause:Hse,mapHttpRequest:r0.mapHttpRequest,mapHttpResponse:s0.mapHttpResponse,req:r0.reqSerializer,res:s0.resSerializer,wrapErrorSerializer:function(e){return e===AT?e:function(s){return e(AT(s))}},wrapRequestSerializer:function(e){return e===r0.reqSerializer?e:function(s){return e(r0.reqSerializer(s))}},wrapResponseSerializer:function(e){return e===s0.resSerializer?e:function(s){return e(s0.resSerializer(s))}}}});var xT=m((yHe,IL)=>{"use strict";function Gse(t,e){return e}IL.exports=function(){let e=Error.prepareStackTrace;Error.prepareStackTrace=Gse;let r=new Error().stack;if(Error.prepareStackTrace=e,!Array.isArray(r))return;let s=r.slice(2),n=[];for(let i of s)i&&n.push(i.getFileName());return n}});var DL=m((vHe,NL)=>{"use strict";NL.exports=Kse;function Kse(t={}){let{ERR_PATHS_MUST_BE_STRINGS:e=()=>"fast-redact - Paths must be (non-empty) strings",ERR_INVALID_PATH:r=s=>`fast-redact \u2013 Invalid path (${s})`}=t;return function({paths:n}){n.forEach(i=>{if(typeof i!="string")throw Error(e());try{if(/〇/.test(i))throw Error();let o=(i[0]==="["?"":".")+i.replace(/^\*/,"\u3007").replace(/\.\*/g,".\u3007").replace(/\[\*\]/g,"[\u3007]");if(/\n|\r|;/.test(o)||/\/\*/.test(o))throw Error();Function(`
            'use strict'
            const o = new Proxy({}, { get: () => o, set: () => { throw Error() } });
            const \u3007 = null;
            o${o}
            if ([o${o}].length !== 1) throw Error()`)()}catch{throw Error(r(i))}})}}});var n0=m((_He,ML)=>{"use strict";ML.exports=/[^.[\]]+|\[((?:.)*?)\]/g});var qL=m((SHe,$L)=>{"use strict";var Qse=n0();$L.exports=Wse;function Wse({paths:t}){let e=[];var r=0;let s=t.reduce(function(n,i,o){var a=i.match(Qse).map(c=>c.replace(/'|"|`/g,""));let l=i[0]==="[";a=a.map(c=>c[0]==="["?c.substr(1,c.length-2):c);let u=a.indexOf("*");if(u>-1){let c=a.slice(0,u),d=c.join("."),f=a.slice(u+1,a.length),h=f.length>0;r++,e.push({before:c,beforeStr:d,after:f,nested:h})}else n[i]={path:a,val:void 0,precensored:!1,circle:"",escPath:JSON.stringify(i),leadingBracket:l};return n},{});return{wildcards:e,wcLen:r,secret:s}}});var jL=m((bHe,LL)=>{"use strict";var Zse=n0();LL.exports=Yse;function Yse({secret:t,serialize:e,wcLen:r,strict:s,isCensorFct:n,censorFctTakesPath:i},o){let a=Function("o",`
    if (typeof o !== 'object' || o == null) {
      ${tne(s,e)}
    }
    const { censor, secret } = this
    const originalSecret = {}
    const secretKeys = Object.keys(secret)
    for (var i = 0; i < secretKeys.length; i++) {
      originalSecret[secretKeys[i]] = secret[secretKeys[i]]
    }

    ${Jse(t,n,i)}
    this.compileRestore()
    ${Xse(r>0,n,i)}
    this.secret = originalSecret
    ${ene(e)}
  `).bind(o);return a.state=o,e===!1&&(a.restore=l=>o.restore(l)),a}function Jse(t,e,r){return Object.keys(t).map(s=>{let{escPath:n,leadingBracket:i,path:o}=t[s],a=i?1:0,l=i?"":".",u=[];for(var c;(c=Zse.exec(s))!==null;){let[,p]=c,{index:g,input:_}=c;g>a&&u.push(_.substring(0,g-(p?0:1)))}var d=u.map(p=>`o${l}${p}`).join(" && ");d.length===0?d+=`o${l}${s} != null`:d+=` && o${l}${s} != null`;let f=`
      switch (true) {
        ${u.reverse().map(p=>`
          case o${l}${p} === censor:
            secret[${n}].circle = ${JSON.stringify(p)}
            break
        `).join(`
`)}
      }
    `,h=r?`val, ${JSON.stringify(o)}`:"val";return`
      if (${d}) {
        const val = o${l}${s}
        if (val === censor) {
          secret[${n}].precensored = true
        } else {
          secret[${n}].val = val
          o${l}${s} = ${e?`censor(${h})`:"censor"}
          ${f}
        }
      }
    `}).join(`
`)}function Xse(t,e,r){return t===!0?`
    {
      const { wildcards, wcLen, groupRedact, nestedRedact } = this
      for (var i = 0; i < wcLen; i++) {
        const { before, beforeStr, after, nested } = wildcards[i]
        if (nested === true) {
          secret[beforeStr] = secret[beforeStr] || []
          nestedRedact(secret[beforeStr], o, before, after, censor, ${e}, ${r})
        } else secret[beforeStr] = groupRedact(o, before, censor, ${e}, ${r})
      }
    }
  `:""}function ene(t){return t===!1?"return o":`
    var s = this.serialize(o)
    this.restore(o)
    return s
  `}function tne(t,e){return t===!0?"throw Error('fast-redact: primitives cannot be redacted')":e===!1?"return o":"return this.serialize(o)"}});var NT=m((EHe,zL)=>{"use strict";zL.exports={groupRedact:sne,groupRestore:rne,nestedRedact:ine,nestedRestore:nne};function rne({keys:t,values:e,target:r}){if(r==null||typeof r=="string")return;let s=t.length;for(var n=0;n<s;n++){let i=t[n];r[i]=e[n]}}function sne(t,e,r,s,n){let i=FL(t,e);if(i==null||typeof i=="string")return{keys:null,values:null,target:i,flat:!0};let o=Object.keys(i),a=o.length,l=e.length,u=n?[...e]:void 0,c=new Array(a);for(var d=0;d<a;d++){let f=o[d];c[d]=i[f],n?(u[l]=f,i[f]=r(i[f],u)):s?i[f]=r(i[f]):i[f]=r}return{keys:o,values:c,target:i,flat:!0}}function nne(t){for(let e=0;e<t.length;e++){let{target:r,path:s,value:n}=t[e],i=r;for(let o=s.length-1;o>0;o--)i=i[s[o]];i[s[0]]=n}}function ine(t,e,r,s,n,i,o){let a=FL(e,r);if(a==null)return;let l=Object.keys(a),u=l.length;for(var c=0;c<u;c++){let d=l[c];one(t,a,d,r,s,n,i,o)}return t}function IT(t,e){return t!=null?"hasOwn"in Object?Object.hasOwn(t,e):Object.prototype.hasOwnProperty.call(t,e):!1}function one(t,e,r,s,n,i,o,a){let l=n.length,u=l-1,c=r;var d=-1,f,h,p,g=null,_=null,S,b,v=!1,y=0,R=0,P=ane();if(p=f=e[r],typeof f=="object"){for(;f!=null&&++d<l&&(R+=1,r=n[d],g=p,!(r!=="*"&&!_&&!(typeof f=="object"&&r in f)));)if(!(r==="*"&&(_==="*"&&(v=!0),_=r,d!==u))){if(_){let O=Object.keys(f);for(var w=0;w<O.length;w++){let $=O[w];if(b=f[$],S=r==="*",v)P=Uo(P,$,R),y=d,p=BL(b,y-1,r,s,n,i,o,a,c,f,h,p,S,$,d,u,P,t,e[c],R+1);else if(S||typeof b=="object"&&b!==null&&r in b){if(S?p=b:p=b[r],h=d!==u?p:o?a?i(p,[...s,c,...n]):i(p):i,S){let C=pp(Uo(P,$,R),p,e[c]);t.push(C),f[$]=h}else if(b[r]!==h)if(h===void 0&&i!==void 0||IT(b,r)&&h===p)P=Uo(P,$,R);else{P=Uo(P,$,R);let C=pp(Uo(P,r,R+1),p,e[c]);t.push(C),b[r]=h}}}_=null}else{if(p=f[r],P=Uo(P,r,R),h=d!==u?p:o?a?i(p,[...s,c,...n]):i(p):i,!(IT(f,r)&&h===p||h===void 0&&i!==void 0)){let O=pp(P,p,e[c]);t.push(O),f[r]=h}f=f[r]}if(typeof f!="object")break}}}function FL(t,e){for(var r=-1,s=e.length,n=t;n!=null&&++r<s;)n=n[e[r]];return n}function BL(t,e,r,s,n,i,o,a,l,u,c,d,f,h,p,g,_,S,b,v){if(e===0&&(f||typeof t=="object"&&t!==null&&r in t)){if(f?d=t:d=t[r],c=p!==g?d:o?a?i(d,[...s,l,...n]):i(d):i,f){let y=pp(_,d,b);S.push(y),u[h]=c}else if(t[r]!==c){if(!(c===void 0&&i!==void 0||IT(t,r)&&c===d)){let y=pp(Uo(_,r,v+1),d,b);S.push(y),t[r]=c}}}for(let y in t)typeof t[y]=="object"&&(_=Uo(_,y,v),BL(t[y],e-1,r,s,n,i,o,a,l,u,c,d,f,h,p,g,_,S,b,v+1))}function ane(){return{parent:null,key:null,children:[],depth:0}}function Uo(t,e,r){if(t.depth===r)return Uo(t.parent,e,r);var s={parent:t,key:e,depth:r,children:[]};return t.children.push(s),s}function pp(t,e,r){let s=t,n=[];do n.push(s.key),s=s.parent;while(s.parent!=null);return{path:n,value:e,target:r}}});var VL=m((wHe,UL)=>{"use strict";var{groupRestore:lne,nestedRestore:une}=NT();UL.exports=cne;function cne(){return function(){if(this.restore){this.restore.state.secret=this.secret;return}let{secret:e,wcLen:r}=this,s=Object.keys(e),n=dne(e,s),i=r>0,o=i?{secret:e,groupRestore:lne,nestedRestore:une}:{secret:e};this.restore=Function("o",fne(n,s,i)).bind(o),this.restore.state=o}}function dne(t,e){return e.map(r=>{let{circle:s,escPath:n,leadingBracket:i}=t[r],a=s?`o.${s} = secret[${n}].val`:`o${i?"":"."}${r} = secret[${n}].val`,l=`secret[${n}].val = undefined`;return`
      if (secret[${n}].val !== undefined) {
        try { ${a} } catch (e) {}
        ${l}
      }
    `}).join("")}function fne(t,e,r){return`
    const secret = this.secret
    ${r===!0?`
    const keys = Object.keys(secret)
    const len = keys.length
    for (var i = len - 1; i >= ${e.length}; i--) {
      const k = keys[i]
      const o = secret[k]
      if (o) {
        if (o.flat === true) this.groupRestore(o)
        else this.nestedRestore(o)
        secret[k] = null
      }
    }
  `:""}
    ${t}
    return o
  `}});var GL=m((THe,HL)=>{"use strict";HL.exports=hne;function hne(t){let{secret:e,censor:r,compileRestore:s,serialize:n,groupRedact:i,nestedRedact:o,wildcards:a,wcLen:l}=t,u=[{secret:e,censor:r,compileRestore:s}];return n!==!1&&u.push({serialize:n}),l>0&&u.push({groupRedact:i,nestedRedact:o,wildcards:a,wcLen:l}),Object.assign(...u)}});var WL=m((CHe,QL)=>{"use strict";var KL=DL(),pne=qL(),mne=jL(),gne=VL(),{groupRedact:yne,nestedRedact:vne}=NT(),_ne=GL(),Sne=n0(),bne=KL(),DT=t=>t;DT.restore=DT;var Ene="[REDACTED]";MT.rx=Sne;MT.validator=KL;QL.exports=MT;function MT(t={}){let e=Array.from(new Set(t.paths||[])),r="serialize"in t&&(t.serialize===!1||typeof t.serialize=="function")?t.serialize:JSON.stringify,s=t.remove;if(s===!0&&r!==JSON.stringify)throw Error("fast-redact \u2013 remove option may only be set when serializer is JSON.stringify");let n=s===!0?void 0:"censor"in t?t.censor:Ene,i=typeof n=="function",o=i&&n.length>1;if(e.length===0)return r||DT;bne({paths:e,serialize:r,censor:n});let{wildcards:a,wcLen:l,secret:u}=pne({paths:e,censor:n}),c=gne(),d="strict"in t?t.strict:!0;return mne({secret:u,wcLen:l,serialize:r,strict:d,isCensorFct:i,censorFctTakesPath:o},_ne({secret:u,censor:n,compileRestore:c,serialize:r,groupRedact:yne,nestedRedact:vne,wildcards:a,wcLen:l}))}});var ld=m((RHe,ZL)=>{"use strict";var wne=Symbol("pino.setLevel"),Tne=Symbol("pino.getLevel"),Cne=Symbol("pino.levelVal"),Rne=Symbol("pino.levelComp"),One=Symbol("pino.useLevelLabels"),Pne=Symbol("pino.useOnlyCustomLevels"),Ane=Symbol("pino.mixin"),kne=Symbol("pino.lsCache"),xne=Symbol("pino.chindings"),Ine=Symbol("pino.asJson"),Nne=Symbol("pino.write"),Dne=Symbol("pino.redactFmt"),Mne=Symbol("pino.time"),$ne=Symbol("pino.timeSliceIndex"),qne=Symbol("pino.stream"),Lne=Symbol("pino.stringify"),jne=Symbol("pino.stringifySafe"),Fne=Symbol("pino.stringifiers"),Bne=Symbol("pino.end"),zne=Symbol("pino.formatOpts"),Une=Symbol("pino.messageKey"),Vne=Symbol("pino.errorKey"),Hne=Symbol("pino.nestedKey"),Gne=Symbol("pino.nestedKeyStr"),Kne=Symbol("pino.mixinMergeStrategy"),Qne=Symbol("pino.msgPrefix"),Wne=Symbol("pino.wildcardFirst"),Zne=Symbol.for("pino.serializers"),Yne=Symbol.for("pino.formatters"),Jne=Symbol.for("pino.hooks"),Xne=Symbol.for("pino.metadata");ZL.exports={setLevelSym:wne,getLevelSym:Tne,levelValSym:Cne,levelCompSym:Rne,useLevelLabelsSym:One,mixinSym:Ane,lsCacheSym:kne,chindingsSym:xne,asJsonSym:Ine,writeSym:Nne,serializersSym:Zne,redactFmtSym:Dne,timeSym:Mne,timeSliceIndexSym:$ne,streamSym:qne,stringifySym:Lne,stringifySafeSym:jne,stringifiersSym:Fne,endSym:Bne,formatOptsSym:zne,messageKeySym:Une,errorKeySym:Vne,nestedKeySym:Hne,wildcardFirstSym:Wne,needsMetadataGsym:Xne,useOnlyCustomLevelsSym:Pne,formattersSym:Yne,hooksSym:Jne,nestedKeyStrSym:Gne,mixinMergeStrategySym:Kne,msgPrefixSym:Qne}});var LT=m((OHe,ej)=>{"use strict";var qT=WL(),{redactFmtSym:eie,wildcardFirstSym:i0}=ld(),{rx:$T,validator:tie}=qT,YL=tie({ERR_PATHS_MUST_BE_STRINGS:()=>"pino \u2013 redacted paths must be strings",ERR_INVALID_PATH:t=>`pino \u2013 redact paths array contains an invalid path (${t})`}),JL="[Redacted]",XL=!1;function rie(t,e){let{paths:r,censor:s}=sie(t),n=r.reduce((a,l)=>{$T.lastIndex=0;let u=$T.exec(l),c=$T.exec(l),d=u[1]!==void 0?u[1].replace(/^(?:"|'|`)(.*)(?:"|'|`)$/,"$1"):u[0];if(d==="*"&&(d=i0),c===null)return a[d]=null,a;if(a[d]===null)return a;let{index:f}=c,h=`${l.substr(f,l.length-1)}`;return a[d]=a[d]||[],d!==i0&&a[d].length===0&&a[d].push(...a[i0]||[]),d===i0&&Object.keys(a).forEach(function(p){a[p]&&a[p].push(h)}),a[d].push(h),a},{}),i={[eie]:qT({paths:r,censor:s,serialize:e,strict:XL})},o=(...a)=>e(typeof s=="function"?s(...a):s);return[...Object.keys(n),...Object.getOwnPropertySymbols(n)].reduce((a,l)=>{if(n[l]===null)a[l]=u=>o(u,[l]);else{let u=typeof s=="function"?(c,d)=>s(c,[l,...d]):s;a[l]=qT({paths:n[l],censor:u,serialize:e,strict:XL})}return a},i)}function sie(t){if(Array.isArray(t))return t={paths:t,censor:JL},YL(t),t;let{paths:e,censor:r=JL,remove:s}=t;if(Array.isArray(e)===!1)throw Error("pino \u2013 redact must contain an array of strings");return s===!0&&(r=void 0),YL({paths:e,censor:r}),{paths:e,censor:r}}ej.exports=rie});var rj=m((PHe,tj)=>{"use strict";var nie=()=>"",iie=()=>`,"time":${Date.now()}`,oie=()=>`,"time":${Math.round(Date.now()/1e3)}`,aie=()=>`,"time":"${new Date(Date.now()).toISOString()}"`;tj.exports={nullTime:nie,epochTime:iie,unixTime:oie,isoTime:aie}});var nj=m((AHe,sj)=>{"use strict";function lie(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}sj.exports=uie;function uie(t,e,r){var s=r&&r.stringify||lie,n=1;if(typeof t=="object"&&t!==null){var i=e.length+n;if(i===1)return t;var o=new Array(i);o[0]=s(t);for(var a=1;a<i;a++)o[a]=s(e[a]);return o.join(" ")}if(typeof t!="string")return t;var l=e.length;if(l===0)return t;for(var u="",c=1-n,d=-1,f=t&&t.length||0,h=0;h<f;){if(t.charCodeAt(h)===37&&h+1<f){switch(d=d>-1?d:0,t.charCodeAt(h+1)){case 100:case 102:if(c>=l||e[c]==null)break;d<h&&(u+=t.slice(d,h)),u+=Number(e[c]),d=h+2,h++;break;case 105:if(c>=l||e[c]==null)break;d<h&&(u+=t.slice(d,h)),u+=Math.floor(Number(e[c])),d=h+2,h++;break;case 79:case 111:case 106:if(c>=l||e[c]===void 0)break;d<h&&(u+=t.slice(d,h));var p=typeof e[c];if(p==="string"){u+="'"+e[c]+"'",d=h+2,h++;break}if(p==="function"){u+=e[c].name||"<anonymous>",d=h+2,h++;break}u+=s(e[c]),d=h+2,h++;break;case 115:if(c>=l)break;d<h&&(u+=t.slice(d,h)),u+=String(e[c]),d=h+2,h++;break;case 37:d<h&&(u+=t.slice(d,h)),u+="%",d=h+2,h++,c--;break}++c}++h}return d===-1?t:(d<f&&(u+=t.slice(d)),u)}});var FT=m((kHe,jT)=>{"use strict";if(typeof SharedArrayBuffer<"u"&&typeof Atomics<"u"){let e=function(r){if((r>0&&r<1/0)===!1)throw typeof r!="number"&&typeof r!="bigint"?TypeError("sleep: ms must be a number"):RangeError("sleep: ms must be a number that is greater than 0 but less than Infinity");Atomics.wait(t,0,0,Number(r))},t=new Int32Array(new SharedArrayBuffer(4));jT.exports=e}else{let t=function(e){if((e>0&&e<1/0)===!1)throw typeof e!="number"&&typeof e!="bigint"?TypeError("sleep: ms must be a number"):RangeError("sleep: ms must be a number that is greater than 0 but less than Infinity");let s=Date.now()+Number(e);for(;s>Date.now(););};jT.exports=t}});var fj=m((xHe,dj)=>{"use strict";var ar=require("fs"),cie=require("events"),die=require("util").inherits,ij=require("path"),zT=FT(),o0=100,a0=Buffer.allocUnsafe(0),fie=16*1024,oj="buffer",aj="utf8";function lj(t,e){e._opening=!0,e._writing=!0,e._asyncDrainScheduled=!1;function r(i,o){if(i){e._reopening=!1,e._writing=!1,e._opening=!1,e.sync?process.nextTick(()=>{e.listenerCount("error")>0&&e.emit("error",i)}):e.emit("error",i);return}let a=e._reopening;e.fd=o,e.file=t,e._reopening=!1,e._opening=!1,e._writing=!1,e.sync?process.nextTick(()=>e.emit("ready")):e.emit("ready"),!e.destroyed&&(!e._writing&&e._len>e.minLength||e._flushPending?e._actualWrite():a&&process.nextTick(()=>e.emit("drain")))}let s=e.append?"a":"w",n=e.mode;if(e.sync)try{e.mkdir&&ar.mkdirSync(ij.dirname(t),{recursive:!0});let i=ar.openSync(t,s,n);r(null,i)}catch(i){throw r(i),i}else e.mkdir?ar.mkdir(ij.dirname(t),{recursive:!0},i=>{if(i)return r(i);ar.open(t,s,n,r)}):ar.open(t,s,n,r)}function ui(t){if(!(this instanceof ui))return new ui(t);let{fd:e,dest:r,minLength:s,maxLength:n,maxWrite:i,sync:o,append:a=!0,mkdir:l,retryEAGAIN:u,fsync:c,contentMode:d,mode:f}=t||{};e=e||r,this._len=0,this.fd=-1,this._bufs=[],this._lens=[],this._writing=!1,this._ending=!1,this._reopening=!1,this._asyncDrainScheduled=!1,this._flushPending=!1,this._hwm=Math.max(s||0,16387),this.file=null,this.destroyed=!1,this.minLength=s||0,this.maxLength=n||0,this.maxWrite=i||fie,this.sync=o||!1,this.writable=!0,this._fsync=c||!1,this.append=a||!1,this.mode=f,this.retryEAGAIN=u||(()=>!0),this.mkdir=l||!1;let h,p;if(d===oj)this._writingBuf=a0,this.write=mie,this.flush=yie,this.flushSync=_ie,this._actualWrite=bie,h=()=>ar.writeSync(this.fd,this._writingBuf),p=()=>ar.write(this.fd,this._writingBuf,this.release);else if(d===void 0||d===aj)this._writingBuf="",this.write=pie,this.flush=gie,this.flushSync=vie,this._actualWrite=Sie,h=()=>ar.writeSync(this.fd,this._writingBuf,"utf8"),p=()=>ar.write(this.fd,this._writingBuf,"utf8",this.release);else throw new Error(`SonicBoom supports "${aj}" and "${oj}", but passed ${d}`);if(typeof e=="number")this.fd=e,process.nextTick(()=>this.emit("ready"));else if(typeof e=="string")lj(e,this);else throw new Error("SonicBoom supports only file descriptors and files");if(this.minLength>=this.maxWrite)throw new Error(`minLength should be smaller than maxWrite (${this.maxWrite})`);this.release=(g,_)=>{if(g){if((g.code==="EAGAIN"||g.code==="EBUSY")&&this.retryEAGAIN(g,this._writingBuf.length,this._len-this._writingBuf.length))if(this.sync)try{zT(o0),this.release(void 0,0)}catch(v){this.release(v)}else setTimeout(p,o0);else this._writing=!1,this.emit("error",g);return}this.emit("write",_);let S=BT(this._writingBuf,this._len,_);if(this._len=S.len,this._writingBuf=S.writingBuf,this._writingBuf.length){if(!this.sync){p();return}try{do{let v=h(),y=BT(this._writingBuf,this._len,v);this._len=y.len,this._writingBuf=y.writingBuf}while(this._writingBuf.length)}catch(v){this.release(v);return}}this._fsync&&ar.fsyncSync(this.fd);let b=this._len;this._reopening?(this._writing=!1,this._reopening=!1,this.reopen()):b>this.minLength?this._actualWrite():this._ending?b>0?this._actualWrite():(this._writing=!1,l0(this)):(this._writing=!1,this.sync?this._asyncDrainScheduled||(this._asyncDrainScheduled=!0,process.nextTick(hie,this)):this.emit("drain"))},this.on("newListener",function(g){g==="drain"&&(this._asyncDrainScheduled=!1)})}function BT(t,e,r){return typeof t=="string"&&Buffer.byteLength(t)!==r&&(r=Buffer.from(t).subarray(0,r).toString().length),e=Math.max(e-r,0),t=t.slice(r),{writingBuf:t,len:e}}function hie(t){t.listenerCount("drain")>0&&(t._asyncDrainScheduled=!1,t.emit("drain"))}die(ui,cie);function uj(t,e){return t.length===0?a0:t.length===1?t[0]:Buffer.concat(t,e)}function pie(t){if(this.destroyed)throw new Error("SonicBoom destroyed");let e=this._len+t.length,r=this._bufs;return this.maxLength&&e>this.maxLength?(this.emit("drop",t),this._len<this._hwm):(r.length===0||r[r.length-1].length+t.length>this.maxWrite?r.push(""+t):r[r.length-1]+=t,this._len=e,!this._writing&&this._len>=this.minLength&&this._actualWrite(),this._len<this._hwm)}function mie(t){if(this.destroyed)throw new Error("SonicBoom destroyed");let e=this._len+t.length,r=this._bufs,s=this._lens;return this.maxLength&&e>this.maxLength?(this.emit("drop",t),this._len<this._hwm):(r.length===0||s[s.length-1]+t.length>this.maxWrite?(r.push([t]),s.push(t.length)):(r[r.length-1].push(t),s[s.length-1]+=t.length),this._len=e,!this._writing&&this._len>=this.minLength&&this._actualWrite(),this._len<this._hwm)}function cj(t){this._flushPending=!0;let e=()=>{this._fsync?(this._flushPending=!1,t()):ar.fsync(this.fd,s=>{this._flushPending=!1,t(s)}),this.off("error",r)},r=s=>{this._flushPending=!1,t(s),this.off("drain",e)};this.once("drain",e),this.once("error",r)}function gie(t){if(t!=null&&typeof t!="function")throw new Error("flush cb must be a function");if(this.destroyed){let e=new Error("SonicBoom destroyed");if(t){t(e);return}throw e}if(this.minLength<=0){t?.();return}t&&cj.call(this,t),!this._writing&&(this._bufs.length===0&&this._bufs.push(""),this._actualWrite())}function yie(t){if(t!=null&&typeof t!="function")throw new Error("flush cb must be a function");if(this.destroyed){let e=new Error("SonicBoom destroyed");if(t){t(e);return}throw e}if(this.minLength<=0){t?.();return}t&&cj.call(this,t),!this._writing&&(this._bufs.length===0&&(this._bufs.push([]),this._lens.push(0)),this._actualWrite())}ui.prototype.reopen=function(t){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this._opening){this.once("ready",()=>{this.reopen(t)});return}if(this._ending)return;if(!this.file)throw new Error("Unable to reopen a file descriptor, you must pass a file to SonicBoom");if(t&&(this.file=t),this._reopening=!0,this._writing)return;let e=this.fd;this.once("ready",()=>{e!==this.fd&&ar.close(e,r=>{if(r)return this.emit("error",r)})}),lj(this.file,this)};ui.prototype.end=function(){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this._opening){this.once("ready",()=>{this.end()});return}this._ending||(this._ending=!0,!this._writing&&(this._len>0&&this.fd>=0?this._actualWrite():l0(this)))};function vie(){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this.fd<0)throw new Error("sonic boom is not ready yet");!this._writing&&this._writingBuf.length>0&&(this._bufs.unshift(this._writingBuf),this._writingBuf="");let t="";for(;this._bufs.length||t;){t.length<=0&&(t=this._bufs[0]);try{let e=ar.writeSync(this.fd,t,"utf8"),r=BT(t,this._len,e);t=r.writingBuf,this._len=r.len,t.length<=0&&this._bufs.shift()}catch(e){if((e.code==="EAGAIN"||e.code==="EBUSY")&&!this.retryEAGAIN(e,t.length,this._len-t.length))throw e;zT(o0)}}try{ar.fsyncSync(this.fd)}catch{}}function _ie(){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this.fd<0)throw new Error("sonic boom is not ready yet");!this._writing&&this._writingBuf.length>0&&(this._bufs.unshift([this._writingBuf]),this._writingBuf=a0);let t=a0;for(;this._bufs.length||t.length;){t.length<=0&&(t=uj(this._bufs[0],this._lens[0]));try{let e=ar.writeSync(this.fd,t);t=t.subarray(e),this._len=Math.max(this._len-e,0),t.length<=0&&(this._bufs.shift(),this._lens.shift())}catch(e){if((e.code==="EAGAIN"||e.code==="EBUSY")&&!this.retryEAGAIN(e,t.length,this._len-t.length))throw e;zT(o0)}}}ui.prototype.destroy=function(){this.destroyed||l0(this)};function Sie(){let t=this.release;if(this._writing=!0,this._writingBuf=this._writingBuf||this._bufs.shift()||"",this.sync)try{let e=ar.writeSync(this.fd,this._writingBuf,"utf8");t(null,e)}catch(e){t(e)}else ar.write(this.fd,this._writingBuf,"utf8",t)}function bie(){let t=this.release;if(this._writing=!0,this._writingBuf=this._writingBuf.length?this._writingBuf:uj(this._bufs.shift(),this._lens.shift()),this.sync)try{let e=ar.writeSync(this.fd,this._writingBuf);t(null,e)}catch(e){t(e)}else ar.write(this.fd,this._writingBuf,t)}function l0(t){if(t.fd===-1){t.once("ready",l0.bind(null,t));return}t.destroyed=!0,t._bufs=[],t._lens=[],ar.fsync(t.fd,e);function e(){t.fd!==1&&t.fd!==2?ar.close(t.fd,r):r()}function r(s){if(s){t.emit("error",s);return}t._ending&&!t._writing&&t.emit("finish"),t.emit("close")}}ui.SonicBoom=ui;ui.default=ui;dj.exports=ui});var UT=m((IHe,yj)=>{"use strict";var ci={exit:[],beforeExit:[]},hj={exit:Tie,beforeExit:Cie},ud;function Eie(){ud===void 0&&(ud=new FinalizationRegistry(Rie))}function wie(t){ci[t].length>0||process.on(t,hj[t])}function pj(t){ci[t].length>0||(process.removeListener(t,hj[t]),ci.exit.length===0&&ci.beforeExit.length===0&&(ud=void 0))}function Tie(){mj("exit")}function Cie(){mj("beforeExit")}function mj(t){for(let e of ci[t]){let r=e.deref(),s=e.fn;r!==void 0&&s(r,t)}ci[t]=[]}function Rie(t){for(let e of["exit","beforeExit"]){let r=ci[e].indexOf(t);ci[e].splice(r,r+1),pj(e)}}function gj(t,e,r){if(e===void 0)throw new Error("the object can't be undefined");wie(t);let s=new WeakRef(e);s.fn=r,Eie(),ud.register(e,s),ci[t].push(s)}function Oie(t,e){gj("exit",t,e)}function Pie(t,e){gj("beforeExit",t,e)}function Aie(t){if(ud!==void 0){ud.unregister(t);for(let e of["exit","beforeExit"])ci[e]=ci[e].filter(r=>{let s=r.deref();return s&&s!==t}),pj(e)}}yj.exports={register:Oie,registerBeforeExit:Pie,unregister:Aie}});var vj=m((NHe,kie)=>{kie.exports={name:"thread-stream",version:"3.1.0",description:"A streaming way to send data to a Node.js Worker Thread",main:"index.js",types:"index.d.ts",dependencies:{"real-require":"^0.2.0"},devDependencies:{"@types/node":"^20.1.0","@types/tap":"^15.0.0","@yao-pkg/pkg":"^5.11.5",desm:"^1.3.0",fastbench:"^1.0.1",husky:"^9.0.6","pino-elasticsearch":"^8.0.0","sonic-boom":"^4.0.1",standard:"^17.0.0",tap:"^16.2.0","ts-node":"^10.8.0",typescript:"^5.3.2","why-is-node-running":"^2.2.2"},scripts:{build:"tsc --noEmit",test:'standard && npm run build && npm run transpile && tap "test/**/*.test.*js" && tap --ts test/*.test.*ts',"test:ci":"standard && npm run transpile && npm run test:ci:js && npm run test:ci:ts","test:ci:js":'tap --no-check-coverage --timeout=120 --coverage-report=lcovonly "test/**/*.test.*js"',"test:ci:ts":'tap --ts --no-check-coverage --coverage-report=lcovonly "test/**/*.test.*ts"',"test:yarn":'npm run transpile && tap "test/**/*.test.js" --no-check-coverage',transpile:"sh ./test/ts/transpile.sh",prepare:"husky install"},standard:{ignore:["test/ts/**/*","test/syntax-error.mjs"]},repository:{type:"git",url:"git+https://github.com/mcollina/thread-stream.git"},keywords:["worker","thread","threads","stream"],author:"Matteo Collina <hello@matteocollina.com>",license:"MIT",bugs:{url:"https://github.com/mcollina/thread-stream/issues"},homepage:"https://github.com/mcollina/thread-stream#readme"}});var Sj=m((DHe,_j)=>{"use strict";function xie(t,e,r,s,n){let i=Date.now()+s,o=Atomics.load(t,e);if(o===r){n(null,"ok");return}let a=o,l=u=>{Date.now()>i?n(null,"timed-out"):setTimeout(()=>{a=o,o=Atomics.load(t,e),o===a?l(u>=1e3?1e3:u*2):o===r?n(null,"ok"):n(null,"not-equal")},u)};l(1)}function Iie(t,e,r,s,n){let i=Date.now()+s,o=Atomics.load(t,e);if(o!==r){n(null,"ok");return}let a=l=>{Date.now()>i?n(null,"timed-out"):setTimeout(()=>{o=Atomics.load(t,e),o!==r?n(null,"ok"):a(l>=1e3?1e3:l*2)},l)};a(1)}_j.exports={wait:xie,waitDiff:Iie}});var Ej=m((MHe,bj)=>{"use strict";bj.exports={WRITE_INDEX:4,READ_INDEX:8}});var Oj=m(($He,Rj)=>{"use strict";var{version:Nie}=vj(),{EventEmitter:Die}=require("events"),{Worker:Mie}=require("worker_threads"),{join:$ie}=require("path"),{pathToFileURL:qie}=require("url"),{wait:Lie}=Sj(),{WRITE_INDEX:Is,READ_INDEX:Fi}=Ej(),jie=require("buffer"),Fie=require("assert"),Z=Symbol("kImpl"),Bie=jie.constants.MAX_STRING_LENGTH,mp=class{constructor(e){this._value=e}deref(){return this._value}},c0=class{register(){}unregister(){}},zie=process.env.NODE_V8_COVERAGE?c0:global.FinalizationRegistry||c0,Uie=process.env.NODE_V8_COVERAGE?mp:global.WeakRef||mp,wj=new zie(t=>{t.exited||t.terminate()});function Vie(t,e){let{filename:r,workerData:s}=e,i=("__bundlerPathsOverrides"in globalThis?globalThis.__bundlerPathsOverrides:{})["thread-stream-worker"]||$ie(__dirname,"lib","worker.js"),o=new Mie(i,{...e.workerOpts,trackUnmanagedFds:!1,workerData:{filename:r.indexOf("file://")===0?r:qie(r).href,dataBuf:t[Z].dataBuf,stateBuf:t[Z].stateBuf,workerData:{$context:{threadStreamVersion:Nie},...s}}});return o.stream=new mp(t),o.on("message",Hie),o.on("exit",Cj),wj.register(t,o),o}function Tj(t){Fie(!t[Z].sync),t[Z].needDrain&&(t[Z].needDrain=!1,t.emit("drain"))}function u0(t){let e=Atomics.load(t[Z].state,Is),r=t[Z].data.length-e;if(r>0){if(t[Z].buf.length===0){t[Z].flushing=!1,t[Z].ending?QT(t):t[Z].needDrain&&process.nextTick(Tj,t);return}let s=t[Z].buf.slice(0,r),n=Buffer.byteLength(s);n<=r?(t[Z].buf=t[Z].buf.slice(r),d0(t,s,u0.bind(null,t))):t.flush(()=>{if(!t.destroyed){for(Atomics.store(t[Z].state,Fi,0),Atomics.store(t[Z].state,Is,0);n>t[Z].data.length;)r=r/2,s=t[Z].buf.slice(0,r),n=Buffer.byteLength(s);t[Z].buf=t[Z].buf.slice(r),d0(t,s,u0.bind(null,t))}})}else if(r===0){if(e===0&&t[Z].buf.length===0)return;t.flush(()=>{Atomics.store(t[Z].state,Fi,0),Atomics.store(t[Z].state,Is,0),u0(t)})}else Bi(t,new Error("overwritten"))}function Hie(t){let e=this.stream.deref();if(e===void 0){this.exited=!0,this.terminate();return}switch(t.code){case"READY":this.stream=new Uie(e),e.flush(()=>{e[Z].ready=!0,e.emit("ready")});break;case"ERROR":Bi(e,t.err);break;case"EVENT":Array.isArray(t.args)?e.emit(t.name,...t.args):e.emit(t.name,t.args);break;case"WARNING":process.emitWarning(t.err);break;default:Bi(e,new Error("this should not happen: "+t.code))}}function Cj(t){let e=this.stream.deref();e!==void 0&&(wj.unregister(e),e.worker.exited=!0,e.worker.off("exit",Cj),Bi(e,t!==0?new Error("the worker thread exited"):null))}var HT=class extends Die{constructor(e={}){if(super(),e.bufferSize<4)throw new Error("bufferSize must at least fit a 4-byte utf-8 char");this[Z]={},this[Z].stateBuf=new SharedArrayBuffer(128),this[Z].state=new Int32Array(this[Z].stateBuf),this[Z].dataBuf=new SharedArrayBuffer(e.bufferSize||4*1024*1024),this[Z].data=Buffer.from(this[Z].dataBuf),this[Z].sync=e.sync||!1,this[Z].ending=!1,this[Z].ended=!1,this[Z].needDrain=!1,this[Z].destroyed=!1,this[Z].flushing=!1,this[Z].ready=!1,this[Z].finished=!1,this[Z].errored=null,this[Z].closed=!1,this[Z].buf="",this.worker=Vie(this,e),this.on("message",(r,s)=>{this.worker.postMessage(r,s)})}write(e){if(this[Z].destroyed)return GT(this,new Error("the worker has exited")),!1;if(this[Z].ending)return GT(this,new Error("the worker is ending")),!1;if(this[Z].flushing&&this[Z].buf.length+e.length>=Bie)try{VT(this),this[Z].flushing=!0}catch(r){return Bi(this,r),!1}if(this[Z].buf+=e,this[Z].sync)try{return VT(this),!0}catch(r){return Bi(this,r),!1}return this[Z].flushing||(this[Z].flushing=!0,setImmediate(u0,this)),this[Z].needDrain=this[Z].data.length-this[Z].buf.length-Atomics.load(this[Z].state,Is)<=0,!this[Z].needDrain}end(){this[Z].destroyed||(this[Z].ending=!0,QT(this))}flush(e){if(this[Z].destroyed){typeof e=="function"&&process.nextTick(e,new Error("the worker has exited"));return}let r=Atomics.load(this[Z].state,Is);Lie(this[Z].state,Fi,r,1/0,(s,n)=>{if(s){Bi(this,s),process.nextTick(e,s);return}if(n==="not-equal"){this.flush(e);return}process.nextTick(e)})}flushSync(){this[Z].destroyed||(VT(this),KT(this))}unref(){this.worker.unref()}ref(){this.worker.ref()}get ready(){return this[Z].ready}get destroyed(){return this[Z].destroyed}get closed(){return this[Z].closed}get writable(){return!this[Z].destroyed&&!this[Z].ending}get writableEnded(){return this[Z].ending}get writableFinished(){return this[Z].finished}get writableNeedDrain(){return this[Z].needDrain}get writableObjectMode(){return!1}get writableErrored(){return this[Z].errored}};function GT(t,e){setImmediate(()=>{t.emit("error",e)})}function Bi(t,e){t[Z].destroyed||(t[Z].destroyed=!0,e&&(t[Z].errored=e,GT(t,e)),t.worker.exited?setImmediate(()=>{t[Z].closed=!0,t.emit("close")}):t.worker.terminate().catch(()=>{}).then(()=>{t[Z].closed=!0,t.emit("close")}))}function d0(t,e,r){let s=Atomics.load(t[Z].state,Is),n=Buffer.byteLength(e);return t[Z].data.write(e,s),Atomics.store(t[Z].state,Is,s+n),Atomics.notify(t[Z].state,Is),r(),!0}function QT(t){if(!(t[Z].ended||!t[Z].ending||t[Z].flushing)){t[Z].ended=!0;try{t.flushSync();let e=Atomics.load(t[Z].state,Fi);Atomics.store(t[Z].state,Is,-1),Atomics.notify(t[Z].state,Is);let r=0;for(;e!==-1;){if(Atomics.wait(t[Z].state,Fi,e,1e3),e=Atomics.load(t[Z].state,Fi),e===-2){Bi(t,new Error("end() failed"));return}if(++r===10){Bi(t,new Error("end() took too long (10s)"));return}}process.nextTick(()=>{t[Z].finished=!0,t.emit("finish")})}catch(e){Bi(t,e)}}}function VT(t){let e=()=>{t[Z].ending?QT(t):t[Z].needDrain&&process.nextTick(Tj,t)};for(t[Z].flushing=!1;t[Z].buf.length!==0;){let r=Atomics.load(t[Z].state,Is),s=t[Z].data.length-r;if(s===0){KT(t),Atomics.store(t[Z].state,Fi,0),Atomics.store(t[Z].state,Is,0);continue}else if(s<0)throw new Error("overwritten");let n=t[Z].buf.slice(0,s),i=Buffer.byteLength(n);if(i<=s)t[Z].buf=t[Z].buf.slice(s),d0(t,n,e);else{for(KT(t),Atomics.store(t[Z].state,Fi,0),Atomics.store(t[Z].state,Is,0);i>t[Z].buf.length;)s=s/2,n=t[Z].buf.slice(0,s),i=Buffer.byteLength(n);t[Z].buf=t[Z].buf.slice(s),d0(t,n,e)}}}function KT(t){if(t[Z].flushing)throw new Error("unable to flush while flushing");let e=Atomics.load(t[Z].state,Is),r=0;for(;;){let s=Atomics.load(t[Z].state,Fi);if(s===-2)throw Error("_flushSync failed");if(s!==e)Atomics.wait(t[Z].state,Fi,s,1e3);else break;if(++r===10)throw new Error("_flushSync took too long (10s)")}}Rj.exports=HT});var YT=m((qHe,Pj)=>{"use strict";var{createRequire:Gie}=require("module"),Kie=xT(),{join:WT,isAbsolute:Qie,sep:Wie}=require("path"),Zie=FT(),ZT=UT(),Yie=Oj();function Jie(t){ZT.register(t,eoe),ZT.registerBeforeExit(t,toe),t.on("close",function(){ZT.unregister(t)})}function Xie(t,e,r){let s=new Yie({filename:t,workerData:e,workerOpts:r});s.on("ready",n),s.on("close",function(){process.removeListener("exit",i)}),process.on("exit",i);function n(){process.removeListener("exit",i),s.unref(),r.autoEnd!==!1&&Jie(s)}function i(){s.closed||(s.flushSync(),Zie(100),s.end())}return s}function eoe(t){t.ref(),t.flushSync(),t.end(),t.once("close",function(){t.unref()})}function toe(t){t.flushSync()}function roe(t){let{pipeline:e,targets:r,levels:s,dedupe:n,worker:i={},caller:o=Kie()}=t,a={...t.options},l=typeof o=="string"?[o]:o,u="__bundlerPathsOverrides"in globalThis?globalThis.__bundlerPathsOverrides:{},c=t.target;if(c&&r)throw new Error("only one of target or targets can be specified");return r?(c=u["pino-worker"]||WT(__dirname,"worker.js"),a.targets=r.filter(f=>f.target).map(f=>({...f,target:d(f.target)})),a.pipelines=r.filter(f=>f.pipeline).map(f=>f.pipeline.map(h=>({...h,level:f.level,target:d(h.target)})))):e&&(c=u["pino-worker"]||WT(__dirname,"worker.js"),a.pipelines=[e.map(f=>({...f,target:d(f.target)}))]),s&&(a.levels=s),n&&(a.dedupe=n),a.pinoWillSendConfig=!0,Xie(d(c),a,i);function d(f){if(f=u[f]||f,Qie(f)||f.indexOf("file://")===0)return f;if(f==="pino/file")return WT(__dirname,"..","file.js");let h;for(let p of l)try{let g=p==="node:repl"?process.cwd()+Wie:p;h=Gie(g).resolve(f);break}catch{continue}if(!h)throw new Error(`unable to determine transport target for "${f}"`);return h}}Pj.exports=roe});var p0=m((LHe,jj)=>{"use strict";var Aj=nj(),{mapHttpRequest:soe,mapHttpResponse:noe}=kT(),XT=fj(),kj=UT(),{lsCacheSym:ioe,chindingsSym:Nj,writeSym:xj,serializersSym:Dj,formatOptsSym:Ij,endSym:ooe,stringifiersSym:Mj,stringifySym:$j,stringifySafeSym:eC,wildcardFirstSym:qj,nestedKeySym:aoe,formattersSym:Lj,messageKeySym:loe,errorKeySym:uoe,nestedKeyStrSym:coe,msgPrefixSym:f0}=ld(),{isMainThread:doe}=require("worker_threads"),foe=YT();function cd(){}function hoe(t,e){if(!e)return r;return function(...n){e.call(this,n,r,t)};function r(s,...n){if(typeof s=="object"){let i=s;s!==null&&(s.method&&s.headers&&s.socket?s=soe(s):typeof s.setHeader=="function"&&(s=noe(s)));let o;i===null&&n.length===0?o=[null]:(i=n.shift(),o=n),typeof this[f0]=="string"&&i!==void 0&&i!==null&&(i=this[f0]+i),this[xj](s,Aj(i,o,this[Ij]),t)}else{let i=s===void 0?n.shift():s;typeof this[f0]=="string"&&i!==void 0&&i!==null&&(i=this[f0]+i),this[xj](null,Aj(i,n,this[Ij]),t)}}}function JT(t){let e="",r=0,s=!1,n=255,i=t.length;if(i>100)return JSON.stringify(t);for(var o=0;o<i&&n>=32;o++)n=t.charCodeAt(o),(n===34||n===92)&&(e+=t.slice(r,o)+"\\",r=o,s=!0);return s?e+=t.slice(r):e=t,n<32?JSON.stringify(t):'"'+e+'"'}function poe(t,e,r,s){let n=this[$j],i=this[eC],o=this[Mj],a=this[ooe],l=this[Nj],u=this[Dj],c=this[Lj],d=this[loe],f=this[uoe],h=this[ioe][r]+s;h=h+l;let p;c.log&&(t=c.log(t));let g=o[qj],_="";for(let b in t)if(p=t[b],Object.prototype.hasOwnProperty.call(t,b)&&p!==void 0){u[b]?p=u[b](p):b===f&&u.err&&(p=u.err(p));let v=o[b]||g;switch(typeof p){case"undefined":case"function":continue;case"number":Number.isFinite(p)===!1&&(p=null);case"boolean":v&&(p=v(p));break;case"string":p=(v||JT)(p);break;default:p=(v||n)(p,i)}if(p===void 0)continue;let y=JT(b);_+=","+y+":"+p}let S="";if(e!==void 0){p=u[d]?u[d](e):e;let b=o[d]||g;switch(typeof p){case"function":break;case"number":Number.isFinite(p)===!1&&(p=null);case"boolean":b&&(p=b(p)),S=',"'+d+'":'+p;break;case"string":p=(b||JT)(p),S=',"'+d+'":'+p;break;default:p=(b||n)(p,i),S=',"'+d+'":'+p}}return this[aoe]&&_?h+this[coe]+_.slice(1)+"}"+S+a:h+_+S+a}function moe(t,e){let r,s=t[Nj],n=t[$j],i=t[eC],o=t[Mj],a=o[qj],l=t[Dj],u=t[Lj].bindings;e=u(e);for(let c in e)if(r=e[c],(c!=="level"&&c!=="serializers"&&c!=="formatters"&&c!=="customLevels"&&e.hasOwnProperty(c)&&r!==void 0)===!0){if(r=l[c]?l[c](r):r,r=(o[c]||a||n)(r,i),r===void 0)continue;s+=',"'+c+'":'+r}return s}function goe(t){return t.write!==t.constructor.prototype.write}var yoe=process.env.NODE_V8_COVERAGE||process.env.V8_COVERAGE;function h0(t){let e=new XT(t);return e.on("error",r),!yoe&&!t.sync&&doe&&(kj.register(e,voe),e.on("close",function(){kj.unregister(e)})),e;function r(s){if(s.code==="EPIPE"){e.write=cd,e.end=cd,e.flushSync=cd,e.destroy=cd;return}e.removeListener("error",r),e.emit("error",s)}}function voe(t,e){t.destroyed||(e==="beforeExit"?(t.flush(),t.on("drain",function(){t.end()})):t.flushSync())}function _oe(t){return function(r,s,n={},i){if(typeof n=="string")i=h0({dest:n}),n={};else if(typeof i=="string"){if(n&&n.transport)throw Error("only one of option.transport or stream can be specified");i=h0({dest:i})}else if(n instanceof XT||n.writable||n._writableState)i=n,n={};else if(n.transport){if(n.transport instanceof XT||n.transport.writable||n.transport._writableState)throw Error("option.transport do not allow stream, please pass to option directly. e.g. pino(transport)");if(n.transport.targets&&n.transport.targets.length&&n.formatters&&typeof n.formatters.level=="function")throw Error("option.transport.targets do not allow custom level formatters");let l;n.customLevels&&(l=n.useOnlyCustomLevels?n.customLevels:Object.assign({},n.levels,n.customLevels)),i=foe({caller:s,...n.transport,levels:l})}if(n=Object.assign({},t,n),n.serializers=Object.assign({},t.serializers,n.serializers),n.formatters=Object.assign({},t.formatters,n.formatters),n.prettyPrint)throw new Error("prettyPrint option is no longer supported, see the pino-pretty package (https://github.com/pinojs/pino-pretty)");let{enabled:o,onChild:a}=n;return o===!1&&(n.level="silent"),a||(n.onChild=cd),i||(goe(process.stdout)?i=process.stdout:i=h0({fd:process.stdout.fd||1})),{opts:n,stream:i}}}function Soe(t,e){try{return JSON.stringify(t)}catch{try{return(e||this[eC])(t)}catch{return'"[unable to serialize, circular reference is too complex to analyze]"'}}}function boe(t,e,r){return{level:t,bindings:e,log:r}}function Eoe(t){let e=Number(t);return typeof t=="string"&&Number.isFinite(e)?e:t===void 0?1:t}jj.exports={noop:cd,buildSafeSonicBoom:h0,asChindings:moe,asJson:poe,genLog:hoe,createArgsNormalizer:_oe,stringify:Soe,buildFormatters:boe,normalizeDestFileDescriptor:Eoe}});var m0=m((jHe,Fj)=>{var woe={trace:10,debug:20,info:30,warn:40,error:50,fatal:60},Toe={ASC:"ASC",DESC:"DESC"};Fj.exports={DEFAULT_LEVELS:woe,SORTING_ORDER:Toe}});var sC=m((FHe,Vj)=>{"use strict";var{lsCacheSym:Coe,levelValSym:tC,useOnlyCustomLevelsSym:Roe,streamSym:Ooe,formattersSym:Poe,hooksSym:Aoe,levelCompSym:Bj}=ld(),{noop:koe,genLog:yu}=p0(),{DEFAULT_LEVELS:zi,SORTING_ORDER:zj}=m0(),Uj={fatal:t=>{let e=yu(zi.fatal,t);return function(...r){let s=this[Ooe];if(e.call(this,...r),typeof s.flushSync=="function")try{s.flushSync()}catch{}}},error:t=>yu(zi.error,t),warn:t=>yu(zi.warn,t),info:t=>yu(zi.info,t),debug:t=>yu(zi.debug,t),trace:t=>yu(zi.trace,t)},rC=Object.keys(zi).reduce((t,e)=>(t[zi[e]]=e,t),{}),xoe=Object.keys(rC).reduce((t,e)=>(t[e]='{"level":'+Number(e),t),{});function Ioe(t){let e=t[Poe].level,{labels:r}=t.levels,s={};for(let n in r){let i=e(r[n],Number(n));s[n]=JSON.stringify(i).slice(0,-1)}return t[Coe]=s,t}function Noe(t,e){if(e)return!1;switch(t){case"fatal":case"error":case"warn":case"info":case"debug":case"trace":return!0;default:return!1}}function Doe(t){let{labels:e,values:r}=this.levels;if(typeof t=="number"){if(e[t]===void 0)throw Error("unknown level value"+t);t=e[t]}if(r[t]===void 0)throw Error("unknown level "+t);let s=this[tC],n=this[tC]=r[t],i=this[Roe],o=this[Bj],a=this[Aoe].logMethod;for(let l in r){if(o(r[l],n)===!1){this[l]=koe;continue}this[l]=Noe(l,i)?Uj[l](a):yu(r[l],a)}this.emit("level-change",t,n,e[s],s,this)}function Moe(t){let{levels:e,levelVal:r}=this;return e&&e.labels?e.labels[r]:""}function $oe(t){let{values:e}=this.levels,r=e[t];return r!==void 0&&this[Bj](r,this[tC])}function qoe(t,e,r){return t===zj.DESC?e<=r:e>=r}function Loe(t){return typeof t=="string"?qoe.bind(null,t):t}function joe(t=null,e=!1){let r=t?Object.keys(t).reduce((i,o)=>(i[t[o]]=o,i),{}):null,s=Object.assign(Object.create(Object.prototype,{Infinity:{value:"silent"}}),e?null:rC,r),n=Object.assign(Object.create(Object.prototype,{silent:{value:1/0}}),e?null:zi,t);return{labels:s,values:n}}function Foe(t,e,r){if(typeof t=="number"){if(![].concat(Object.keys(e||{}).map(i=>e[i]),r?[]:Object.keys(rC).map(i=>+i),1/0).includes(t))throw Error(`default level:${t} must be included in custom levels`);return}let s=Object.assign(Object.create(Object.prototype,{silent:{value:1/0}}),r?null:zi,e);if(!(t in s))throw Error(`default level:${t} must be included in custom levels`)}function Boe(t,e){let{labels:r,values:s}=t;for(let n in e){if(n in s)throw Error("levels cannot be overridden");if(e[n]in r)throw Error("pre-existing level values cannot be used for new levels")}}function zoe(t){if(typeof t!="function"&&!(typeof t=="string"&&Object.values(zj).includes(t)))throw new Error('Levels comparison should be one of "ASC", "DESC" or "function" type')}Vj.exports={initialLsCache:xoe,genLsCache:Ioe,levelMethods:Uj,getLevel:Moe,setLevel:Doe,isLevelEnabled:$oe,mappings:joe,assertNoLevelCollisions:Boe,assertDefaultLevelFound:Foe,genLevelComparison:Loe,assertLevelComparison:zoe}});var nC=m((BHe,Hj)=>{"use strict";Hj.exports={version:"9.2.0"}});var r2=m((UHe,t2)=>{"use strict";var{EventEmitter:Uoe}=require("events"),{lsCacheSym:Voe,levelValSym:Hoe,setLevelSym:oC,getLevelSym:Gj,chindingsSym:aC,parsedChindingsSym:Goe,mixinSym:Koe,asJsonSym:Yj,writeSym:Qoe,mixinMergeStrategySym:Woe,timeSym:Zoe,timeSliceIndexSym:Yoe,streamSym:Jj,serializersSym:vu,formattersSym:iC,errorKeySym:Joe,messageKeySym:Xoe,useOnlyCustomLevelsSym:eae,needsMetadataGsym:tae,redactFmtSym:rae,stringifySym:sae,formatOptsSym:nae,stringifiersSym:iae,msgPrefixSym:Kj}=ld(),{getLevel:oae,setLevel:aae,isLevelEnabled:lae,mappings:uae,initialLsCache:cae,genLsCache:dae,assertNoLevelCollisions:fae}=sC(),{asChindings:Xj,asJson:hae,buildFormatters:Qj,stringify:Wj}=p0(),{version:pae}=nC(),mae=LT(),gae=class{},e2={constructor:gae,child:yae,bindings:vae,setBindings:_ae,flush:wae,isLevelEnabled:lae,version:pae,get level(){return this[Gj]()},set level(t){this[oC](t)},get levelVal(){return this[Hoe]},set levelVal(t){throw Error("levelVal is read-only")},[Voe]:cae,[Qoe]:bae,[Yj]:hae,[Gj]:oae,[oC]:aae};Object.setPrototypeOf(e2,Uoe.prototype);t2.exports=function(){return Object.create(e2)};var Zj=t=>t;function yae(t,e){if(!t)throw Error("missing bindings for child Pino");e=e||{};let r=this[vu],s=this[iC],n=Object.create(this);if(e.hasOwnProperty("serializers")===!0){n[vu]=Object.create(null);for(let c in r)n[vu][c]=r[c];let l=Object.getOwnPropertySymbols(r);for(var i=0;i<l.length;i++){let c=l[i];n[vu][c]=r[c]}for(let c in e.serializers)n[vu][c]=e.serializers[c];let u=Object.getOwnPropertySymbols(e.serializers);for(var o=0;o<u.length;o++){let c=u[o];n[vu][c]=e.serializers[c]}}else n[vu]=r;if(e.hasOwnProperty("formatters")){let{level:l,bindings:u,log:c}=e.formatters;n[iC]=Qj(l||s.level,u||Zj,c||s.log)}else n[iC]=Qj(s.level,Zj,s.log);if(e.hasOwnProperty("customLevels")===!0&&(fae(this.levels,e.customLevels),n.levels=uae(e.customLevels,n[eae]),dae(n)),typeof e.redact=="object"&&e.redact!==null||Array.isArray(e.redact)){n.redact=e.redact;let l=mae(n.redact,Wj),u={stringify:l[rae]};n[sae]=Wj,n[iae]=l,n[nae]=u}typeof e.msgPrefix=="string"&&(n[Kj]=(this[Kj]||"")+e.msgPrefix),n[aC]=Xj(n,t);let a=e.level||this.level;return n[oC](a),this.onChild(n),n}function vae(){let e=`{${this[aC].substr(1)}}`,r=JSON.parse(e);return delete r.pid,delete r.hostname,r}function _ae(t){let e=Xj(this,t);this[aC]=e,delete this[Goe]}function Sae(t,e){return Object.assign(e,t)}function bae(t,e,r){let s=this[Zoe](),n=this[Koe],i=this[Joe],o=this[Xoe],a=this[Woe]||Sae,l;t==null?l={}:t instanceof Error?(l={[i]:t},e===void 0&&(e=t.message)):(l=t,e===void 0&&t[o]===void 0&&t[i]&&(e=t[i].message)),n&&(l=a(l,n(l,r,this)));let u=this[Yj](l,e,r,s),c=this[Jj];c[tae]===!0&&(c.lastLevel=r,c.lastObj=l,c.lastMsg=e,c.lastTime=s.slice(this[Yoe]),c.lastLogger=this),c.write(u)}function Eae(){}function wae(t){if(t!=null&&typeof t!="function")throw Error("callback must be a function");let e=this[Jj];typeof e.flush=="function"?e.flush(t||Eae):t&&t()}});var a2=m((dC,o2)=>{"use strict";var{hasOwnProperty:g0}=Object.prototype,Su=cC();Su.configure=cC;Su.stringify=Su;Su.default=Su;dC.stringify=Su;dC.configure=cC;o2.exports=Su;var Tae=/[\u0000-\u001f\u0022\u005c\ud800-\udfff]|[\ud800-\udbff](?![\udc00-\udfff])|(?:[^\ud800-\udbff]|^)[\udc00-\udfff]/;function qa(t){return t.length<5e3&&!Tae.test(t)?`"${t}"`:JSON.stringify(t)}function lC(t){if(t.length>200)return t.sort();for(let e=1;e<t.length;e++){let r=t[e],s=e;for(;s!==0&&t[s-1]>r;)t[s]=t[s-1],s--;t[s]=r}return t}var Cae=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(Object.getPrototypeOf(new Int8Array)),Symbol.toStringTag).get;function uC(t){return Cae.call(t)!==void 0&&t.length!==0}function s2(t,e,r){t.length<r&&(r=t.length);let s=e===","?"":" ",n=`"0":${s}${t[0]}`;for(let i=1;i<r;i++)n+=`${e}"${i}":${s}${t[i]}`;return n}function Rae(t){if(g0.call(t,"circularValue")){let e=t.circularValue;if(typeof e=="string")return`"${e}"`;if(e==null)return e;if(e===Error||e===TypeError)return{toString(){throw new TypeError("Converting circular structure to JSON")}};throw new TypeError('The "circularValue" argument must be of type string or the value null or undefined')}return'"[Circular]"'}function n2(t,e){let r;if(g0.call(t,e)&&(r=t[e],typeof r!="boolean"))throw new TypeError(`The "${e}" argument must be of type boolean`);return r===void 0?!0:r}function i2(t,e){let r;if(g0.call(t,e)){if(r=t[e],typeof r!="number")throw new TypeError(`The "${e}" argument must be of type number`);if(!Number.isInteger(r))throw new TypeError(`The "${e}" argument must be an integer`);if(r<1)throw new RangeError(`The "${e}" argument must be >= 1`)}return r===void 0?1/0:r}function _u(t){return t===1?"1 item":`${t} items`}function Oae(t){let e=new Set;for(let r of t)(typeof r=="string"||typeof r=="number")&&e.add(String(r));return e}function Pae(t){if(g0.call(t,"strict")){let e=t.strict;if(typeof e!="boolean")throw new TypeError('The "strict" argument must be of type boolean');if(e)return r=>{let s=`Object can not safely be stringified. Received type ${typeof r}`;throw typeof r!="function"&&(s+=` (${r.toString()})`),new Error(s)}}}function cC(t){t={...t};let e=Pae(t);e&&(t.bigint===void 0&&(t.bigint=!1),"circularValue"in t||(t.circularValue=Error));let r=Rae(t),s=n2(t,"bigint"),n=n2(t,"deterministic"),i=i2(t,"maximumDepth"),o=i2(t,"maximumBreadth");function a(f,h,p,g,_,S){let b=h[f];switch(typeof b=="object"&&b!==null&&typeof b.toJSON=="function"&&(b=b.toJSON(f)),b=g.call(h,f,b),typeof b){case"string":return qa(b);case"object":{if(b===null)return"null";if(p.indexOf(b)!==-1)return r;let v="",y=",",R=S;if(Array.isArray(b)){if(b.length===0)return"[]";if(i<p.length+1)return'"[Array]"';p.push(b),_!==""&&(S+=_,v+=`
${S}`,y=`,
${S}`);let k=Math.min(b.length,o),z=0;for(;z<k-1;z++){let E=a(String(z),b,p,g,_,S);v+=E!==void 0?E:"null",v+=y}let A=a(String(z),b,p,g,_,S);if(v+=A!==void 0?A:"null",b.length-1>o){let E=b.length-o-1;v+=`${y}"... ${_u(E)} not stringified"`}return _!==""&&(v+=`
${R}`),p.pop(),`[${v}]`}let P=Object.keys(b),w=P.length;if(w===0)return"{}";if(i<p.length+1)return'"[Object]"';let O="",$="";_!==""&&(S+=_,y=`,
${S}`,O=" ");let C=Math.min(w,o);n&&!uC(b)&&(P=lC(P)),p.push(b);for(let k=0;k<C;k++){let z=P[k],A=a(z,b,p,g,_,S);A!==void 0&&(v+=`${$}${qa(z)}:${O}${A}`,$=y)}if(w>o){let k=w-o;v+=`${$}"...":${O}"${_u(k)} not stringified"`,$=y}return _!==""&&$.length>1&&(v=`
${S}${v}
${R}`),p.pop(),`{${v}}`}case"number":return isFinite(b)?String(b):e?e(b):"null";case"boolean":return b===!0?"true":"false";case"undefined":return;case"bigint":if(s)return String(b);default:return e?e(b):void 0}}function l(f,h,p,g,_,S){switch(typeof h=="object"&&h!==null&&typeof h.toJSON=="function"&&(h=h.toJSON(f)),typeof h){case"string":return qa(h);case"object":{if(h===null)return"null";if(p.indexOf(h)!==-1)return r;let b=S,v="",y=",";if(Array.isArray(h)){if(h.length===0)return"[]";if(i<p.length+1)return'"[Array]"';p.push(h),_!==""&&(S+=_,v+=`
${S}`,y=`,
${S}`);let w=Math.min(h.length,o),O=0;for(;O<w-1;O++){let C=l(String(O),h[O],p,g,_,S);v+=C!==void 0?C:"null",v+=y}let $=l(String(O),h[O],p,g,_,S);if(v+=$!==void 0?$:"null",h.length-1>o){let C=h.length-o-1;v+=`${y}"... ${_u(C)} not stringified"`}return _!==""&&(v+=`
${b}`),p.pop(),`[${v}]`}p.push(h);let R="";_!==""&&(S+=_,y=`,
${S}`,R=" ");let P="";for(let w of g){let O=l(w,h[w],p,g,_,S);O!==void 0&&(v+=`${P}${qa(w)}:${R}${O}`,P=y)}return _!==""&&P.length>1&&(v=`
${S}${v}
${b}`),p.pop(),`{${v}}`}case"number":return isFinite(h)?String(h):e?e(h):"null";case"boolean":return h===!0?"true":"false";case"undefined":return;case"bigint":if(s)return String(h);default:return e?e(h):void 0}}function u(f,h,p,g,_){switch(typeof h){case"string":return qa(h);case"object":{if(h===null)return"null";if(typeof h.toJSON=="function"){if(h=h.toJSON(f),typeof h!="object")return u(f,h,p,g,_);if(h===null)return"null"}if(p.indexOf(h)!==-1)return r;let S=_;if(Array.isArray(h)){if(h.length===0)return"[]";if(i<p.length+1)return'"[Array]"';p.push(h),_+=g;let O=`
${_}`,$=`,
${_}`,C=Math.min(h.length,o),k=0;for(;k<C-1;k++){let A=u(String(k),h[k],p,g,_);O+=A!==void 0?A:"null",O+=$}let z=u(String(k),h[k],p,g,_);if(O+=z!==void 0?z:"null",h.length-1>o){let A=h.length-o-1;O+=`${$}"... ${_u(A)} not stringified"`}return O+=`
${S}`,p.pop(),`[${O}]`}let b=Object.keys(h),v=b.length;if(v===0)return"{}";if(i<p.length+1)return'"[Object]"';_+=g;let y=`,
${_}`,R="",P="",w=Math.min(v,o);uC(h)&&(R+=s2(h,y,o),b=b.slice(h.length),w-=h.length,P=y),n&&(b=lC(b)),p.push(h);for(let O=0;O<w;O++){let $=b[O],C=u($,h[$],p,g,_);C!==void 0&&(R+=`${P}${qa($)}: ${C}`,P=y)}if(v>o){let O=v-o;R+=`${P}"...": "${_u(O)} not stringified"`,P=y}return P!==""&&(R=`
${_}${R}
${S}`),p.pop(),`{${R}}`}case"number":return isFinite(h)?String(h):e?e(h):"null";case"boolean":return h===!0?"true":"false";case"undefined":return;case"bigint":if(s)return String(h);default:return e?e(h):void 0}}function c(f,h,p){switch(typeof h){case"string":return qa(h);case"object":{if(h===null)return"null";if(typeof h.toJSON=="function"){if(h=h.toJSON(f),typeof h!="object")return c(f,h,p);if(h===null)return"null"}if(p.indexOf(h)!==-1)return r;let g="";if(Array.isArray(h)){if(h.length===0)return"[]";if(i<p.length+1)return'"[Array]"';p.push(h);let y=Math.min(h.length,o),R=0;for(;R<y-1;R++){let w=c(String(R),h[R],p);g+=w!==void 0?w:"null",g+=","}let P=c(String(R),h[R],p);if(g+=P!==void 0?P:"null",h.length-1>o){let w=h.length-o-1;g+=`,"... ${_u(w)} not stringified"`}return p.pop(),`[${g}]`}let _=Object.keys(h),S=_.length;if(S===0)return"{}";if(i<p.length+1)return'"[Object]"';let b="",v=Math.min(S,o);uC(h)&&(g+=s2(h,",",o),_=_.slice(h.length),v-=h.length,b=","),n&&(_=lC(_)),p.push(h);for(let y=0;y<v;y++){let R=_[y],P=c(R,h[R],p);P!==void 0&&(g+=`${b}${qa(R)}:${P}`,b=",")}if(S>o){let y=S-o;g+=`${b}"...":"${_u(y)} not stringified"`}return p.pop(),`{${g}}`}case"number":return isFinite(h)?String(h):e?e(h):"null";case"boolean":return h===!0?"true":"false";case"undefined":return;case"bigint":if(s)return String(h);default:return e?e(h):void 0}}function d(f,h,p){if(arguments.length>1){let g="";if(typeof p=="number"?g=" ".repeat(Math.min(p,10)):typeof p=="string"&&(g=p.slice(0,10)),h!=null){if(typeof h=="function")return a("",{"":f},[],h,g,"");if(Array.isArray(h))return l("",f,[],Oae(h),g,"")}if(g.length!==0)return u("",f,[],g,"")}return c("",f,[])}return d}});var c2=m((VHe,u2)=>{"use strict";var fC=Symbol.for("pino.metadata"),{DEFAULT_LEVELS:l2}=m0(),Aae=l2.info;function kae(t,e){let r=0;t=t||[],e=e||{dedupe:!1};let s=Object.create(l2);s.silent=1/0,e.levels&&typeof e.levels=="object"&&Object.keys(e.levels).forEach(d=>{s[d]=e.levels[d]});let n={write:i,add:l,emit:o,flushSync:a,end:u,minLevel:0,streams:[],clone:c,[fC]:!0,streamLevels:s};return Array.isArray(t)?t.forEach(l,n):l.call(n,t),t=null,n;function i(d){let f,h=this.lastLevel,{streams:p}=this,g=0,_;for(let S=Iae(p.length,e.dedupe);Dae(S,p.length,e.dedupe);S=Nae(S,e.dedupe))if(f=p[S],f.level<=h){if(g!==0&&g!==f.level)break;if(_=f.stream,_[fC]){let{lastTime:b,lastMsg:v,lastObj:y,lastLogger:R}=this;_.lastLevel=h,_.lastTime=b,_.lastMsg=v,_.lastObj=y,_.lastLogger=R}_.write(d),e.dedupe&&(g=f.level)}else if(!e.dedupe)break}function o(...d){for(let{stream:f}of this.streams)typeof f.emit=="function"&&f.emit(...d)}function a(){for(let{stream:d}of this.streams)typeof d.flushSync=="function"&&d.flushSync()}function l(d){if(!d)return n;let f=typeof d.write=="function"||d.stream,h=d.write?d:d.stream;if(!f)throw Error("stream object needs to implement either StreamEntry or DestinationStream interface");let{streams:p,streamLevels:g}=this,_;typeof d.levelVal=="number"?_=d.levelVal:typeof d.level=="string"?_=g[d.level]:typeof d.level=="number"?_=d.level:_=Aae;let S={stream:h,level:_,levelVal:void 0,id:r++};return p.unshift(S),p.sort(xae),this.minLevel=p[0].level,n}function u(){for(let{stream:d}of this.streams)typeof d.flushSync=="function"&&d.flushSync(),d.end()}function c(d){let f=new Array(this.streams.length);for(let h=0;h<f.length;h++)f[h]={level:d,stream:this.streams[h].stream};return{write:i,add:l,minLevel:d,streams:f,clone:c,emit:o,flushSync:a,[fC]:!0}}}function xae(t,e){return t.level-e.level}function Iae(t,e){return e?t-1:0}function Nae(t,e){return e?t-1:t+1}function Dae(t,e,r){return r?t>=0:t<e}u2.exports=kae});var gC=m((HHe,wn)=>{function y0(t){try{return require("path").join(`${process.cwd()}${require("path").sep}build`.replace(/\\/g,"/"),t)}catch{return new Function("p","return new URL(p, import.meta.url).pathname")(t)}}globalThis.__bundlerPathsOverrides={...globalThis.__bundlerPathsOverrides||{},"thread-stream-worker":y0("./thread-stream-worker.js"),"pino-worker":y0("./pino-worker.js"),"pino/file":y0("./pino-file.js"),"pino-pretty":y0("./pino-pretty.js")};var Mae=require("os"),v2=kT(),$ae=xT(),qae=LT(),_2=rj(),Lae=r2(),S2=ld(),{configure:jae}=a2(),{assertDefaultLevelFound:Fae,mappings:b2,genLsCache:Bae,genLevelComparison:zae,assertLevelComparison:Uae}=sC(),{DEFAULT_LEVELS:Vae,SORTING_ORDER:Hae}=m0(),{createArgsNormalizer:Gae,asChindings:Kae,buildSafeSonicBoom:d2,buildFormatters:Qae,stringify:hC,normalizeDestFileDescriptor:f2,noop:Wae}=p0(),{version:Zae}=nC(),{chindingsSym:h2,redactFmtSym:Yae,serializersSym:p2,timeSym:Jae,timeSliceIndexSym:Xae,streamSym:ele,stringifySym:m2,stringifySafeSym:pC,stringifiersSym:g2,setLevelSym:tle,endSym:rle,formatOptsSym:sle,messageKeySym:nle,errorKeySym:ile,nestedKeySym:ole,mixinSym:ale,levelCompSym:lle,useOnlyCustomLevelsSym:ule,formattersSym:y2,hooksSym:cle,nestedKeyStrSym:dle,mixinMergeStrategySym:fle,msgPrefixSym:hle}=S2,{epochTime:E2,nullTime:ple}=_2,{pid:mle}=process,gle=Mae.hostname(),yle=v2.err,vle={level:"info",levelComparison:Hae.ASC,levels:Vae,messageKey:"msg",errorKey:"err",nestedKey:null,enabled:!0,base:{pid:mle,hostname:gle},serializers:Object.assign(Object.create(null),{err:yle}),formatters:Object.assign(Object.create(null),{bindings(t){return t},level(t,e){return{level:e}}}),hooks:{logMethod:void 0},timestamp:E2,name:void 0,redact:null,customLevels:null,useOnlyCustomLevels:!1,depthLimit:5,edgeLimit:100},_le=Gae(vle),Sle=Object.assign(Object.create(null),v2);function mC(...t){let e={},{opts:r,stream:s}=_le(e,$ae(),...t),{redact:n,crlf:i,serializers:o,timestamp:a,messageKey:l,errorKey:u,nestedKey:c,base:d,name:f,level:h,customLevels:p,levelComparison:g,mixin:_,mixinMergeStrategy:S,useOnlyCustomLevels:b,formatters:v,hooks:y,depthLimit:R,edgeLimit:P,onChild:w,msgPrefix:O}=r,$=jae({maximumDepth:R,maximumBreadth:P}),C=Qae(v.level,v.bindings,v.log),k=hC.bind({[pC]:$}),z=n?qae(n,k):{},A=n?{stringify:z[Yae]}:{stringify:k},E="}"+(i?`\r
`:`
`),V=Kae.bind(null,{[h2]:"",[p2]:o,[g2]:z,[m2]:hC,[pC]:$,[y2]:C}),G="";d!==null&&(f===void 0?G=V(d):G=V(Object.assign({},d,{name:f})));let X=a instanceof Function?a:a?E2:ple,pe=X().indexOf(":")+1;if(b&&!p)throw Error("customLevels is required if useOnlyCustomLevels is set true");if(_&&typeof _!="function")throw Error(`Unknown mixin type "${typeof _}" - expected "function"`);if(O&&typeof O!="string")throw Error(`Unknown msgPrefix type "${typeof O}" - expected "string"`);Fae(h,p,b);let J=b2(p,b);typeof s.emit=="function"&&s.emit("message",{code:"PINO_CONFIG",config:{levels:J,messageKey:l,errorKey:u}}),Uae(g);let ye=zae(g);return Object.assign(e,{levels:J,[lle]:ye,[ule]:b,[ele]:s,[Jae]:X,[Xae]:pe,[m2]:hC,[pC]:$,[g2]:z,[rle]:E,[sle]:A,[nle]:l,[ile]:u,[ole]:c,[dle]:c?`,${JSON.stringify(c)}:{`:"",[p2]:o,[ale]:_,[fle]:S,[h2]:G,[y2]:C,[cle]:y,silent:Wae,onChild:w,[hle]:O}),Object.setPrototypeOf(e,Lae()),Bae(e),e[tle](h),e}wn.exports=mC;wn.exports.destination=(t=process.stdout.fd)=>typeof t=="object"?(t.dest=f2(t.dest||process.stdout.fd),d2(t)):d2({dest:f2(t),minLength:0});wn.exports.transport=YT();wn.exports.multistream=c2();wn.exports.levels=b2();wn.exports.stdSerializers=Sle;wn.exports.stdTimeFunctions=Object.assign({},_2);wn.exports.symbols=S2;wn.exports.version=Zae;wn.exports.default=mC;wn.exports.pino=mC});var gp=m((GHe,O2)=>{"use strict";var ble=fL(),v0=gC(),{serializersSym:w2}=v0.symbols,{FST_ERR_LOG_INVALID_DESTINATION:Ele,FST_ERR_LOG_INVALID_LOGGER:wle}=rs();function T2(t){if(t.stream&&t.file)throw new Ele;t.file&&(t.stream=v0.destination(t.file),delete t.file);let e=t.logger,r=t.genReqId,s=null;return e?(t.logger=void 0,t.genReqId=void 0,e[w2]&&(t.serializers=Object.assign({},t.serializers,e[w2])),s=e.child({},t),t.logger=e,t.genReqId=r):s=v0(t,t.stream),s}var yC={req:function(e){return{method:e.method,url:e.url,version:e.headers&&e.headers["accept-version"],hostname:e.hostname,remoteAddress:e.ip,remotePort:e.socket?e.socket.remotePort:void 0}},err:v0.stdSerializers.err,res:function(e){return{statusCode:e.statusCode}}};function Tle(){let t=process.hrtime();return t[0]*1e3+t[1]/1e6}function Cle(t){if(!t.logger){let s=ble;return s.child=()=>s,{logger:s,hasLogger:!1}}if(C2(t.logger))return{logger:T2({logger:t.logger,serializers:Object.assign({},yC,t.logger.serializers)}),hasLogger:!0};let e={};return Object.prototype.toString.call(t.logger)==="[object Object]"&&Reflect.ownKeys(t.logger).forEach(s=>{Object.defineProperty(e,s,{value:t.logger[s],writable:!0,enumerable:!0,configurable:!0})}),e.level=e.level||"info",e.serializers=Object.assign({},yC,e.serializers),t.logger=e,{logger:T2(t.logger),hasLogger:!0}}function C2(t,e){let r=["info","error","debug","fatal","warn","trace","child"],s=t?r.filter(n=>!t[n]||typeof t[n]!="function"):r;if(s.length){if(s.length===r.length&&!e)return!1;throw wle(s.join(","))}else return!0}function Rle(t,e,r,s,n){let i={[t.requestIdLogLabel]:s},o=t.childLoggerFactory.call(t.server,e,i,n||{},r);return t.childLoggerFactory!==R2&&C2(o,!0),o}function R2(t,e,r){return t.child(e,r)}O2.exports={createLogger:Cle,createChildLogger:Rle,defaultChildLoggerFactory:R2,serializers:yC,now:Tle}});var _0=m((KHe,P2)=>{"use strict";P2.exports=Ole;function dd(t){return t instanceof Buffer?Buffer.from(t):new t.constructor(t.buffer.slice(),t.byteOffset,t.length)}function Ole(t){if(t=t||{},t.circles)return Ple(t);let e=new Map;if(e.set(Date,o=>new Date(o)),e.set(Map,(o,a)=>new Map(s(Array.from(o),a))),e.set(Set,(o,a)=>new Set(s(Array.from(o),a))),t.constructorHandlers)for(let o of t.constructorHandlers)e.set(o[0],o[1]);let r=null;return t.proto?i:n;function s(o,a){let l=Object.keys(o),u=new Array(l.length);for(let c=0;c<l.length;c++){let d=l[c],f=o[d];typeof f!="object"||f===null?u[d]=f:f.constructor!==Object&&(r=e.get(f.constructor))?u[d]=r(f,a):ArrayBuffer.isView(f)?u[d]=dd(f):u[d]=a(f)}return u}function n(o){if(typeof o!="object"||o===null)return o;if(Array.isArray(o))return s(o,n);if(o.constructor!==Object&&(r=e.get(o.constructor)))return r(o,n);let a={};for(let l in o){if(Object.hasOwnProperty.call(o,l)===!1)continue;let u=o[l];typeof u!="object"||u===null?a[l]=u:u.constructor!==Object&&(r=e.get(u.constructor))?a[l]=r(u,n):ArrayBuffer.isView(u)?a[l]=dd(u):a[l]=n(u)}return a}function i(o){if(typeof o!="object"||o===null)return o;if(Array.isArray(o))return s(o,i);if(o.constructor!==Object&&(r=e.get(o.constructor)))return r(o,i);let a={};for(let l in o){let u=o[l];typeof u!="object"||u===null?a[l]=u:u.constructor!==Object&&(r=e.get(u.constructor))?a[l]=r(u,i):ArrayBuffer.isView(u)?a[l]=dd(u):a[l]=i(u)}return a}}function Ple(t){let e=[],r=[],s=new Map;if(s.set(Date,l=>new Date(l)),s.set(Map,(l,u)=>new Map(i(Array.from(l),u))),s.set(Set,(l,u)=>new Set(i(Array.from(l),u))),t.constructorHandlers)for(let l of t.constructorHandlers)s.set(l[0],l[1]);let n=null;return t.proto?a:o;function i(l,u){let c=Object.keys(l),d=new Array(c.length);for(let f=0;f<c.length;f++){let h=c[f],p=l[h];if(typeof p!="object"||p===null)d[h]=p;else if(p.constructor!==Object&&(n=s.get(p.constructor)))d[h]=n(p,u);else if(ArrayBuffer.isView(p))d[h]=dd(p);else{let g=e.indexOf(p);g!==-1?d[h]=r[g]:d[h]=u(p)}}return d}function o(l){if(typeof l!="object"||l===null)return l;if(Array.isArray(l))return i(l,o);if(l.constructor!==Object&&(n=s.get(l.constructor)))return n(l,o);let u={};e.push(l),r.push(u);for(let c in l){if(Object.hasOwnProperty.call(l,c)===!1)continue;let d=l[c];if(typeof d!="object"||d===null)u[c]=d;else if(d.constructor!==Object&&(n=s.get(d.constructor)))u[c]=n(d,o);else if(ArrayBuffer.isView(d))u[c]=dd(d);else{let f=e.indexOf(d);f!==-1?u[c]=r[f]:u[c]=o(d)}}return e.pop(),r.pop(),u}function a(l){if(typeof l!="object"||l===null)return l;if(Array.isArray(l))return i(l,a);if(l.constructor!==Object&&(n=s.get(l.constructor)))return n(l,a);let u={};e.push(l),r.push(u);for(let c in l){let d=l[c];if(typeof d!="object"||d===null)u[c]=d;else if(d.constructor!==Object&&(n=s.get(d.constructor)))u[c]=n(d,a);else if(ArrayBuffer.isView(d))u[c]=dd(d);else{let f=e.indexOf(d);f!==-1?u[c]=r[f]:u[c]=a(d)}}return e.pop(),r.pop(),u}}});var yp=m((QHe,I2)=>{"use strict";var Ale=_0()({circles:!1,proto:!0}),{kSchemaVisited:A2,kSchemaResponse:kle}=xr(),_C=Symbol.for("fluent-schema-object"),{FST_ERR_SCH_MISSING_ID:xle,FST_ERR_SCH_ALREADY_PRESENT:Ile,FST_ERR_SCH_DUPLICATE:Nle,FST_ERR_SCH_CONTENT_MISSING_SCHEMA:Dle}=rs(),x2=["params","body","querystring","query","headers"];function S0(t){this.store=t||{}}S0.prototype.add=function(t){let e=Ale(t.isFluentSchema||t.isFluentJSONSchema||t[_C]?t.valueOf():t),r=e.$id;if(!r)throw new xle;if(this.store[r])throw new Ile(r);this.store[r]=e};S0.prototype.getSchemas=function(){return Object.assign({},this.store)};S0.prototype.getSchema=function(t){return this.store[t]};function k2(t){return typeof t=="object"&&Object.getPrototypeOf(t)!==Object.prototype}function Mle(t,e){if(t[A2])return t;if(t.query){if(t.querystring)throw new Nle("querystring");t.querystring=t.query}$le(t);for(let r of x2){let s=t[r];s&&!k2(s)&&(t[r]=vC(s,e.jsonShorthand))}if(t.response){let r=Object.keys(t.response);for(let s of r){if(k2(t.response[s]))continue;let n=t.response[s].content,i=!1;if(n){let o=Object.keys(n);for(let a=0;a<o.length;a++){let l=o[a];if(!n[l].schema){if(o.length===1)break;throw new Dle(l)}t.response[s].content[l].schema=vC(n[l].schema,e.jsonShorthand),a===o.length-1&&(i=!0)}}i||(t.response[s]=vC(t.response[s],e.jsonShorthand))}}return t[A2]=!0,t}function $le(t){for(let e of x2)t[e]&&(t[e].isFluentSchema||t[e][_C])&&(t[e]=t[e].valueOf());if(t.response){let e=Object.keys(t.response);for(let r of e)(t.response[r].isFluentSchema||t.response[r][_C])&&(t.response[r]=t.response[r].valueOf())}}function vC(t,e){return!e||t.$ref||t.oneOf||t.allOf||t.anyOf||t.$merge||t.$patch?t:!t.type&&!t.properties?{type:"object",properties:t}:t}function qle(t,e,r){let s=t[kle];if(!s)return!1;if(s[e]){if(s[e].constructor===Object&&r){let i=r.split(";",1)[0];return s[e][i]?s[e][i]:!1}return s[e]}let n=(e+"")[0]+"xx";if(s[n]){if(s[n].constructor===Object&&r){let i=r.split(";",1)[0];return s[n][i]?s[n][i]:!1}return s[n]}if(s.default){if(s.default.constructor===Object&&r){let i=r.split(";",1)[0];return s.default[i]?s.default[i]:!1}return s.default}return!1}I2.exports={buildSchemas(t){return new S0(t)},getSchemaSerializer:qle,normalizeSchema:Mle}});var b0=m((WHe,D2)=>{"use strict";var Lle=/[\u0000-\u001f\u0022\u005c\ud800-\udfff]/;D2.exports=class N2{constructor(e){switch(e&&e.rounding){case"floor":this.parseInteger=Math.floor;break;case"ceil":this.parseInteger=Math.ceil;break;case"round":this.parseInteger=Math.round;break;case"trunc":default:this.parseInteger=Math.trunc;break}this._options=e}asInteger(e){if(Number.isInteger(e))return""+e;if(typeof e=="bigint")return e.toString();let r=this.parseInteger(e);if(r===1/0||r===-1/0||r!==r)throw new Error(`The value "${e}" cannot be converted to an integer.`);return""+r}asNumber(e){let r=Number(e);if(r!==r)throw new Error(`The value "${e}" cannot be converted to a number.`);return r===1/0||r===-1/0?"null":""+r}asBoolean(e){return e&&"true"||"false"}asDateTime(e){if(e===null)return'""';if(e instanceof Date)return'"'+e.toISOString()+'"';if(typeof e=="string")return'"'+e+'"';throw new Error(`The value "${e}" cannot be converted to a date-time.`)}asDate(e){if(e===null)return'""';if(e instanceof Date)return'"'+new Date(e.getTime()-e.getTimezoneOffset()*6e4).toISOString().slice(0,10)+'"';if(typeof e=="string")return'"'+e+'"';throw new Error(`The value "${e}" cannot be converted to a date.`)}asTime(e){if(e===null)return'""';if(e instanceof Date)return'"'+new Date(e.getTime()-e.getTimezoneOffset()*6e4).toISOString().slice(11,19)+'"';if(typeof e=="string")return'"'+e+'"';throw new Error(`The value "${e}" cannot be converted to a time.`)}asString(e){let r=e.length;if(r<42){let n="",i=-1,o=255;for(var s=0;s<r;s++)if(o=e.charCodeAt(s),o===34||o===92)i===-1&&(i=0),n+=e.slice(i,s)+"\\",i=s;else if(o<32||o>=55296&&o<=57343)return JSON.stringify(e);return i===-1&&'"'+e+'"'||'"'+n+e.slice(i)+'"'}else return r<5e3&&Lle.test(e)===!1?'"'+e+'"':JSON.stringify(e)}asUnsafeString(e){return'"'+e+'"'}getState(){return this._options}static restoreFromState(e){return new N2(e)}}});var $2=m((ZHe,M2)=>{"use strict";var jle=b0(),Fle={mode:"standalone"},Ble=jle.restoreFromState(Fle),zle=null;M2.exports=function(e,r){let s="{",n="}",i="[",o="]",a=",",l=":",u='"',c=s+n,d=i+o,f=u+u,h="null";function p(_){let S=_&&typeof _.toJSON=="function"?_.toJSON():_;if(S===null)return c;let b,v=s,y=!1;return b=S.statusCode,b!==void 0&&(!y&&(y=!0)||(v+=a),v+='"statusCode":',v+=r.asNumber(b)),b=S.code,b!==void 0&&(!y&&(y=!0)||(v+=a),v+='"code":',typeof b!="string"?b===null?v+=f:b instanceof Date?v+=u+b.toISOString()+u:b instanceof RegExp?v+=r.asString(b.source):v+=r.asString(b.toString()):v+=r.asString(b)),b=S.error,b!==void 0&&(!y&&(y=!0)||(v+=a),v+='"error":',typeof b!="string"?b===null?v+=f:b instanceof Date?v+=u+b.toISOString()+u:b instanceof RegExp?v+=r.asString(b.source):v+=r.asString(b.toString()):v+=r.asString(b)),b=S.message,b!==void 0&&(!y&&(y=!0)||(v+=a),v+='"message":',typeof b!="string"?b===null?v+=f:b instanceof Date?v+=u+b.toISOString()+u:b instanceof RegExp?v+=r.asString(b.source):v+=r.asString(b.toString()):v+=r.asString(b)),v+n}return p}(zle,Ble)});var vp=m((YHe,F2)=>{"use strict";var q2=require("node:http").STATUS_CODES,Ule=gT(),{kReplyHeaders:bu,kReplyNextErrorHandler:E0,kReplyIsRunningOnErrorHook:Vle,kReplyHasStatusCode:Hle,kRouteContext:j2,kDisableRequestLogging:w0}=xr(),{FST_ERR_REP_INVALID_PAYLOAD_TYPE:Gle,FST_ERR_FAILED_ERROR_SERIALIZATION:Kle}=rs(),{getSchemaSerializer:Qle}=yp(),SC=$2(),Wle={func:Yle,toJSON(){return this.func.name.toString()+"()"}};function Zle(t,e,r){t[Vle]=!1;let s=t[j2];if(t[E0]===!1){L2(e,t,function(o,a){try{o.raw.writeHead(o.raw.statusCode,o[bu])}catch(l){o.log[w0]||o.log.warn({req:o.request,res:o,err:l},l&&l.message),o.raw.writeHead(o.raw.statusCode)}o.raw.end(a)});return}let n=t[E0]||s.errorHandler;t[E0]=Object.getPrototypeOf(n),delete t[bu]["content-type"],delete t[bu]["content-length"];let i=n.func;if(!i){t[E0]=!1,L2(e,t,r);return}try{let o=i(e,t.request,t);o!==void 0&&(o!==null&&typeof o.then=="function"?Ule(o,t):t.send(o))}catch(o){t.send(o)}}function Yle(t,e,r){if(Xle(t,r),!r[Hle]||r.statusCode===200){let s=t.statusCode||t.status;r.code(s>=400?s:500)}r.statusCode<500?r.log[w0]||r.log.info({res:r,err:t},t&&t.message):r.log[w0]||r.log.error({req:e,res:r,err:t},t&&t.message),r.send(t)}function L2(t,e,r){let s=e.raw,n=e.statusCode;e[bu]["content-type"]=e[bu]["content-type"]??"application/json; charset=utf-8";let i;try{let o=Qle(e[j2],n,e[bu]["content-type"]);i=o===!1?SC({error:q2[n+""],code:t.code,message:t.message,statusCode:n}):o(Object.create(t,{error:{value:q2[n+""]},message:{value:t.message},statusCode:{value:n}}))}catch(o){e.log[w0]||e.log.error({err:o,statusCode:s.statusCode},"The serializer for the given status code failed"),e.code(500),i=SC(new Kle(o.message,t.message))}typeof i!="string"&&!Buffer.isBuffer(i)&&(i=SC(new Gle(typeof i))),e[bu]["content-length"]=""+Buffer.byteLength(i),r(e,i)}function Jle(t=Wle,e){if(!e)return t;let r=Object.create(t);return r.func=e,r}function Xle(t,e){let r=e.raw,s=r.statusCode;s=s>=400?s:500,t!=null&&(t.headers!==void 0&&e.headers(t.headers),t.status>=400?s=t.status:t.statusCode>=400&&(s=t.statusCode)),r.statusCode=s}F2.exports={buildErrorHandler:Jle,handleError:Zle}});var A0=m((JHe,P0)=>{"use strict";var TC=require("node:stream").finished,eue=require("node:stream").Readable,{kFourOhFourContext:B2,kPublicRouteContext:z2,kReplyErrorHandlerCalled:Z2,kReplyHijacked:_p,kReplyStartTime:Sp,kReplyEndTime:RC,kReplySerializer:Vo,kReplySerializerDefault:C0,kReplyIsError:R0,kReplyHeaders:It,kReplyTrailers:Ir,kReplyHasStatusCode:OC,kReplyIsRunningOnErrorHook:PC,kReplyNextErrorHandler:tue,kDisableRequestLogging:Y2,kSchemaResponse:O0,kReplyCacheSerializeFns:La,kSchemaController:bC,kOptions:rue,kRouteContext:Ve}=xr(),{onSendHookRunner:J2,onResponseHookRunner:sue,preHandlerHookRunner:nue,preSerializationHookRunner:iue}=Na(),U2=ST()[Symbol.for("internals")],oue=gp(),CC=oue.now,{handleError:V2}=vp(),{getSchemaSerializer:aue}=yp(),EC={JSON:"application/json; charset=utf-8",PLAIN:"text/plain; charset=utf-8",OCTET:"application/octet-stream"},{FST_ERR_REP_INVALID_PAYLOAD_TYPE:lue,FST_ERR_REP_RESPONSE_BODY_CONSUMED:uue,FST_ERR_REP_ALREADY_SENT:X2,FST_ERR_REP_SENT_VALUE:cue,FST_ERR_SEND_INSIDE_ONERR:due,FST_ERR_BAD_STATUS_CODE:fue,FST_ERR_BAD_TRAILER_NAME:hue,FST_ERR_BAD_TRAILER_VALUE:pue,FST_ERR_MISSING_SERIALIZATION_FN:mue,FST_ERR_MISSING_CONTENTTYPE_SERIALIZATION_FN:gue}=rs(),{FSTDEP010:yue,FSTDEP013:vue,FSTDEP019:_ue,FSTDEP020:Sue,FSTDEP021:bue}=zo(),eF=Object.prototype.toString;function Ot(t,e,r){this.raw=t,this[Vo]=null,this[Z2]=!1,this[R0]=!1,this[PC]=!1,this.request=e,this[It]={},this[Ir]=null,this[OC]=!1,this[Sp]=void 0,this.log=r}Ot.props=[];Object.defineProperties(Ot.prototype,{[Ve]:{get(){return this.request[Ve]}},context:{get(){return _ue(),this.request[Ve]}},elapsedTime:{get(){return this[Sp]===void 0?0:(this[RC]||CC())-this[Sp]}},server:{get(){return this.request[Ve].server}},sent:{enumerable:!0,get(){return(this[_p]||this.raw.writableEnded)===!0},set(t){if(yue(),t!==!0)throw new cue;if(this.sent&&this[_p])throw new X2(this.request.url,this.request.method);this[_p]=!0}},statusCode:{get(){return this.raw.statusCode},set(t){this.code(t)}},[z2]:{get(){return this.request[z2]}}});Ot.prototype.hijack=function(){return this[_p]=!0,this};Ot.prototype.send=function(t){if(this[PC]===!0)throw new due;if(this.sent)return this.log.warn({err:new X2(this.request.url,this.request.method)}),this;if(t instanceof Error||this[R0]===!0)return this[R0]=!1,bp(this,t,Eu),this;if(t===void 0)return Eu(this,t),this;let e=this.getHeader("content-type"),r=e!==void 0;if(t!==null){if(typeof t.pipe=="function"||typeof t.getReader=="function"||eF.call(t)==="[object Response]")return Eu(this,t),this;if(t?.buffer instanceof ArrayBuffer){r===!1&&(this[It]["content-type"]=EC.OCTET);let s=Buffer.isBuffer(t)?t:Buffer.from(t.buffer,t.byteOffset,t.byteLength);return Eu(this,s),this}if(r===!1&&typeof t=="string")return this[It]["content-type"]=EC.PLAIN,Eu(this,t),this}if(this[Vo]!==null){if(typeof t!="string")return H2(this,t),this;t=this[Vo](t)}else if(r===!1||e.indexOf("json")>-1){if(r===!1)this[It]["content-type"]=EC.JSON;else if(e.indexOf("charset")===-1){let s=e.trim();s.endsWith(";")?this[It]["content-type"]=`${s} charset=utf-8`:this[It]["content-type"]=`${s}; charset=utf-8`}if(typeof t!="string")return H2(this,t),this}return Eu(this,t),this};Ot.prototype.getHeader=function(t){t=t.toLowerCase();let e=this.raw,r=this[It][t];return r===void 0&&e.hasHeader(t)&&(r=e.getHeader(t)),r};Ot.prototype.getHeaders=function(){return{...this.raw.getHeaders(),...this[It]}};Ot.prototype.hasHeader=function(t){return t=t.toLowerCase(),this[It][t]!==void 0||this.raw.hasHeader(t)};Ot.prototype.removeHeader=function(t){return delete this[It][t.toLowerCase()],this};Ot.prototype.header=function(t,e=""){return t=t.toLowerCase(),this[It][t]&&t==="set-cookie"?(typeof this[It][t]=="string"&&(this[It][t]=[this[It][t]]),Array.isArray(e)?Array.prototype.push.apply(this[It][t],e):this[It][t].push(e)):this[It][t]=e,this};Ot.prototype.headers=function(t){let e=Object.keys(t);for(var r=0;r!==e.length;++r){let s=e[r];this.header(s,t[s])}return this};var Eue=new Set(["transfer-encoding","content-length","host","cache-control","max-forwards","te","authorization","set-cookie","content-encoding","content-type","content-range","trailer"]);Ot.prototype.trailer=function(t,e){if(t=t.toLowerCase(),Eue.has(t))throw new hue(t);if(typeof e!="function")throw new pue(t,typeof e);return this[Ir]===null&&(this[Ir]={}),this[Ir][t]=e,this};Ot.prototype.hasTrailer=function(t){return this[Ir]?.[t.toLowerCase()]!==void 0};Ot.prototype.removeTrailer=function(t){return this[Ir]===null?this:(this[Ir][t.toLowerCase()]=void 0,this)};Ot.prototype.code=function(t){let e=Number(t);if(isNaN(e)||e<100||e>599)throw new fue(t||String(t));return this.raw.statusCode=e,this[OC]=!0,this};Ot.prototype.status=Ot.prototype.code;Ot.prototype.getSerializationFunction=function(t,e){let r;return typeof t=="string"||typeof t=="number"?typeof e=="string"?r=this[Ve][O0]?.[t]?.[e]:r=this[Ve][O0]?.[t]:typeof t=="object"&&(r=this[Ve][La]?.get(t)),r};Ot.prototype.compileSerializationSchema=function(t,e=null,r=null){let{request:s}=this,{method:n,url:i}=s;if(this[Ve][La]?.has(t))return this[Ve][La].get(t);let a=(this[Ve].serializerCompiler||this.server[bC].serializerCompiler||this.server[bC].setupSerializer(this.server[rue])||this.server[bC].serializerCompiler)({schema:t,method:n,url:i,httpStatus:e,contentType:r});return this[Ve][La]==null&&(this[Ve][La]=new WeakMap),this[Ve][La].set(t,a),a};Ot.prototype.serializeInput=function(t,e,r,s){let n=r,i;if(r=typeof e=="string"||typeof e=="number"?e:r,s=r&&n!==r?n:s,r!=null){if(s!=null?i=this[Ve][O0]?.[r]?.[s]:i=this[Ve][O0]?.[r],i==null)throw s?new gue(r,s):new mue(r)}else this[Ve][La]?.has(e)?i=this[Ve][La].get(e):i=this.compileSerializationSchema(e,r,s);return i(t)};Ot.prototype.serialize=function(t){return this[Vo]!==null?this[Vo](t):this[Ve]&&this[Ve][C0]?this[Ve][C0](t,this.raw.statusCode):sF(this[Ve],t,this.raw.statusCode)};Ot.prototype.serializer=function(t){return this[Vo]=t,this};Ot.prototype.type=function(t){return this[It]["content-type"]=t,this};Ot.prototype.redirect=function(t,e){if(typeof t=="number"){bue();let r=e;e=t,t=r}return e||(e=this[OC]?this.raw.statusCode:302),this.header("location",t).code(e).send()};Ot.prototype.callNotFound=function(){return Pue(this),this};Ot.prototype.getResponseTime=function(){return Sue(),this.elapsedTime};Ot.prototype.then=function(t,e){if(this.sent){t();return}TC(this.raw,r=>{r&&r.code!=="ERR_STREAM_PREMATURE_CLOSE"?e?e(r):this.log&&this.log.warn("unhandled rejection on reply.then"):t()})};function H2(t,e){t[Ve].preSerialization!==null?iue(t[Ve].preSerialization,t.request,t,e,G2):G2(null,t.request,t,e)}function G2(t,e,r,s){if(t!=null){bp(r,t);return}try{r[Vo]!==null?s=r[Vo](s):r[Ve]&&r[Ve][C0]?s=r[Ve][C0](s,r.raw.statusCode):s=sF(r[Ve],s,r.raw.statusCode,r[It]["content-type"])}catch(n){wue(n,r),bp(r,n);return}Eu(r,s)}function wue(t,e){t.serialization=e[Ve].config}function Eu(t,e){t[Ve].onSend!==null?J2(t[Ve].onSend,t.request,t,e,Tue):tF(t,e)}function Tue(t,e,r,s){t!=null?bp(r,t):tF(r,s)}function wC(t,e){let r=t.raw;try{r.writeHead(e,t[It])}catch(s){throw s.code==="ERR_HTTP_HEADERS_SENT"&&t.log.warn(`Reply was already sent, did you forget to "return reply" in the "${t.request.raw.url}" (${t.request.raw.method}) route?`),s}}function tF(t,e){let r=t.raw,s=t.request;if(t[Ir]!==null){let o=Object.keys(t[Ir]),a="";for(let l of o)typeof t[Ir][l]=="function"&&(a+=" ",a+=l);t.header("Transfer-Encoding","chunked"),t.header("Trailer",a.trim())}let n=eF.call(e)==="[object Response]";n&&typeof e.status=="number"&&t.code(e.status);let i=r.statusCode;if(e==null){i>=200&&i!==204&&i!==304&&s.method!=="HEAD"&&t[Ir]===null&&(t[It]["content-length"]="0"),wC(t,i),T0(e,r,t);return}if(i>=100&&i<200||i===204){t.removeHeader("content-type"),t.removeHeader("content-length"),wC(t,i),T0(void 0,r,t),typeof e.resume=="function"&&(e.on("error",nF),e.resume());return}if(typeof e.pipe=="function"){rF(e,r,t);return}if(typeof e.getReader=="function"){Q2(e,r,t);return}if(n){if(typeof e.headers=="object"&&typeof e.headers.forEach=="function")for(let[o,a]of e.headers)t.header(o,a);if(e.body!=null){if(e.bodyUsed)throw new uue;Q2(e.body,r,t)}return}if(typeof e!="string"&&!Buffer.isBuffer(e))throw new lue(typeof e);if(t[Ir]===null){let o=t[It]["content-length"];(!o||s.raw.method!=="HEAD"&&Number(o)!==Buffer.byteLength(e))&&(t[It]["content-length"]=""+Buffer.byteLength(e))}wC(t,i),r.write(e),T0(e,r,t)}function K2(t,e,r){e.code==="ERR_STREAM_PREMATURE_CLOSE"?t[Y2]||t.info({res:r},"stream closed prematurely"):t.warn({err:e},"response terminated with an error with headers already sent")}function Q2(t,e,r){let s=eue.fromWeb(t);rF(s,e,r)}function rF(t,e,r){let s=!0,n=!1;if(Cue(t,e,r),TC(t,{readable:!0,writable:!1},function(i){s=!1,i!=null&&(e.headersSent||r.request.raw.aborted===!0?(n||(n=!0,K2(r.log,i,e)),e.destroy()):bp(r,i))}),TC(e,function(i){s&&(i!=null&&e.headersSent&&!n&&(n=!0,K2(r.log,i,e)),typeof t.destroy=="function"?t.destroy():typeof t.close=="function"?t.close(nF):typeof t.abort=="function"?t.abort():r.log.warn("stream payload does not end properly"))}),e.headersSent)r.log.warn("response will send, but you shouldn't use res.writeHead in stream mode");else for(let i in r[It])e.setHeader(i,r[It][i]);t.pipe(e)}function T0(t,e,r){if(r[Ir]===null){e.end(null,null,null);return}let s=Object.keys(r[Ir]),n={},i=0,o=!0;function a(){i===0&&(e.addTrailers(n),e.end(null,null,null))}for(let l of s){let u=function(d,f){i++,d?r.log.debug(d):n[l]=f,process.nextTick(a)};if(typeof r[Ir][l]!="function")continue;o=!1,i--;let c=r[Ir][l](r,t,u);typeof c=="object"&&typeof c.then=="function"?c.then(d=>u(null,d),u):c!=null&&(vue(),u(null,c))}o&&e.end(null,null,null)}function Cue(t,e,r){r[Ir]!==null&&t.on("end",()=>T0(null,e,r))}function bp(t,e,r){t[Ve].onError!==null&&!t[tue]?(t[PC]=!0,J2(t[Ve].onError,t.request,t,e,()=>V2(t,e,r))):V2(t,e,r)}function Rue(t){t[Sp]=CC();let e=r=>{t[RC]=CC(),t.raw.removeListener("finish",e),t.raw.removeListener("error",e);let s=t[Ve];s&&s.onResponse!==null?sue(s.onResponse,t.request,t,W2):W2(r,t.request,t)};t.raw.on("finish",e),t.raw.on("error",e)}function W2(t,e,r){if(r.log[Y2])return;let s=r.elapsedTime;if(t!=null){r.log.error({res:r,err:t,responseTime:s},"request errored");return}r.log.info({res:r,responseTime:s},"request completed")}function Oue(t){let e=t.props.slice();function r(s,n,i){this.raw=s,this[R0]=!1,this[Z2]=!1,this[_p]=!1,this[Vo]=null,this.request=n,this[It]={},this[Ir]=null,this[Sp]=void 0,this[RC]=void 0,this.log=i;for(var o,a=0;a<e.length;a++)o=e[a],this[o.key]=o.value}return Object.setPrototypeOf(r.prototype,t.prototype),Object.setPrototypeOf(r,t),r.parent=t,r.props=e,r}function Pue(t){if(t[Ve][B2]===null){t.log.warn("Trying to send a NotFound error inside a 404 handler. Sending basic 404 response."),t.code(404).send("404 Not Found");return}t.request[Ve]=t[Ve][B2],t[Ve].preHandler!==null?nue(t[Ve].preHandler,t.request,t,U2.preHandlerCallback):U2.preHandlerCallback(null,t.request,t)}function sF(t,e,r,s){let n=aue(t,r,s);return n?n(e):JSON.stringify(e)}function nF(){}P0.exports=Ot;P0.exports.buildReply=Oue;P0.exports.setupResponseListeners=Rue});var oF=m((XHe,iF)=>{"use strict";iF.exports=Aue;function Aue(t){if(!t)throw new TypeError("argument req is required");var e=xue(t.headers["x-forwarded-for"]||""),r=kue(t),s=[r].concat(e);return s}function kue(t){return t.socket?t.socket.remoteAddress:t.connection.remoteAddress}function xue(t){for(var e=t.length,r=[],s=t.length,n=t.length-1;n>=0;n--)switch(t.charCodeAt(n)){case 32:s===e&&(s=e=n);break;case 44:s!==e&&r.push(t.substring(s,e)),s=e=n;break;default:s=n;break}return s!==e&&r.push(t.substring(s,e)),r}});var lF=m((aF,Ep)=>{(function(){var t,e,r,s,n,i,o,a,l;e={},a=this,typeof Ep<"u"&&Ep!==null&&Ep.exports?Ep.exports=e:a.ipaddr=e,o=function(u,c,d,f){var h,p;if(u.length!==c.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");for(h=0;f>0;){if(p=d-f,p<0&&(p=0),u[h]>>p!==c[h]>>p)return!1;f-=d,h+=1}return!0},e.subnetMatch=function(u,c,d){var f,h,p,g,_;d==null&&(d="unicast");for(p in c)for(g=c[p],g[0]&&!(g[0]instanceof Array)&&(g=[g]),f=0,h=g.length;f<h;f++)if(_=g[f],u.kind()===_[0].kind()&&u.match.apply(u,_))return p;return d},e.IPv4=function(){function u(c){var d,f,h;if(c.length!==4)throw new Error("ipaddr: ipv4 octet count should be 4");for(d=0,f=c.length;d<f;d++)if(h=c[d],!(0<=h&&h<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=c}return u.prototype.kind=function(){return"ipv4"},u.prototype.toString=function(){return this.octets.join(".")},u.prototype.toNormalizedString=function(){return this.toString()},u.prototype.toByteArray=function(){return this.octets.slice(0)},u.prototype.match=function(c,d){var f;if(d===void 0&&(f=c,c=f[0],d=f[1]),c.kind()!=="ipv4")throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return o(this.octets,c.octets,8,d)},u.prototype.SpecialRanges={unspecified:[[new u([0,0,0,0]),8]],broadcast:[[new u([255,255,255,255]),32]],multicast:[[new u([224,0,0,0]),4]],linkLocal:[[new u([169,254,0,0]),16]],loopback:[[new u([127,0,0,0]),8]],carrierGradeNat:[[new u([100,64,0,0]),10]],private:[[new u([10,0,0,0]),8],[new u([172,16,0,0]),12],[new u([192,168,0,0]),16]],reserved:[[new u([192,0,0,0]),24],[new u([192,0,2,0]),24],[new u([192,88,99,0]),24],[new u([198,51,100,0]),24],[new u([203,0,113,0]),24],[new u([240,0,0,0]),4]]},u.prototype.range=function(){return e.subnetMatch(this,this.SpecialRanges)},u.prototype.toIPv4MappedAddress=function(){return e.IPv6.parse("::ffff:"+this.toString())},u.prototype.prefixLengthFromSubnetMask=function(){var c,d,f,h,p,g,_;for(_={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0},c=0,p=!1,d=f=3;f>=0;d=f+=-1)if(h=this.octets[d],h in _){if(g=_[h],p&&g!==0)return null;g!==8&&(p=!0),c+=g}else return null;return 32-c},u}(),r="(0?\\d+|0x[a-f0-9]+)",s={fourOctet:new RegExp("^"+r+"\\."+r+"\\."+r+"\\."+r+"$","i"),longValue:new RegExp("^"+r+"$","i")},e.IPv4.parser=function(u){var c,d,f,h,p;if(d=function(g){return g[0]==="0"&&g[1]!=="x"?parseInt(g,8):parseInt(g)},c=u.match(s.fourOctet))return function(){var g,_,S,b;for(S=c.slice(1,6),b=[],g=0,_=S.length;g<_;g++)f=S[g],b.push(d(f));return b}();if(c=u.match(s.longValue)){if(p=d(c[1]),p>4294967295||p<0)throw new Error("ipaddr: address outside defined range");return function(){var g,_;for(_=[],h=g=0;g<=24;h=g+=8)_.push(p>>h&255);return _}().reverse()}else return null},e.IPv6=function(){function u(c,d){var f,h,p,g,_,S;if(c.length===16)for(this.parts=[],f=h=0;h<=14;f=h+=2)this.parts.push(c[f]<<8|c[f+1]);else if(c.length===8)this.parts=c;else throw new Error("ipaddr: ipv6 part count should be 8 or 16");for(S=this.parts,p=0,g=S.length;p<g;p++)if(_=S[p],!(0<=_&&_<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");d&&(this.zoneId=d)}return u.prototype.kind=function(){return"ipv6"},u.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},u.prototype.toRFC5952String=function(){var c,d,f,h,p;for(h=/((^|:)(0(:|$)){2,})/g,p=this.toNormalizedString(),c=0,d=-1;f=h.exec(p);)f[0].length>d&&(c=f.index,d=f[0].length);return d<0?p:p.substring(0,c)+"::"+p.substring(c+d)},u.prototype.toByteArray=function(){var c,d,f,h,p;for(c=[],p=this.parts,d=0,f=p.length;d<f;d++)h=p[d],c.push(h>>8),c.push(h&255);return c},u.prototype.toNormalizedString=function(){var c,d,f;return c=function(){var h,p,g,_;for(g=this.parts,_=[],h=0,p=g.length;h<p;h++)d=g[h],_.push(d.toString(16));return _}.call(this).join(":"),f="",this.zoneId&&(f="%"+this.zoneId),c+f},u.prototype.toFixedLengthString=function(){var c,d,f;return c=function(){var h,p,g,_;for(g=this.parts,_=[],h=0,p=g.length;h<p;h++)d=g[h],_.push(d.toString(16).padStart(4,"0"));return _}.call(this).join(":"),f="",this.zoneId&&(f="%"+this.zoneId),c+f},u.prototype.match=function(c,d){var f;if(d===void 0&&(f=c,c=f[0],d=f[1]),c.kind()!=="ipv6")throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return o(this.parts,c.parts,16,d)},u.prototype.SpecialRanges={unspecified:[new u([0,0,0,0,0,0,0,0]),128],linkLocal:[new u([65152,0,0,0,0,0,0,0]),10],multicast:[new u([65280,0,0,0,0,0,0,0]),8],loopback:[new u([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new u([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new u([0,0,0,0,0,65535,0,0]),96],rfc6145:[new u([0,0,0,0,65535,0,0,0]),96],rfc6052:[new u([100,65435,0,0,0,0,0,0]),96],"6to4":[new u([8194,0,0,0,0,0,0,0]),16],teredo:[new u([8193,0,0,0,0,0,0,0]),32],reserved:[[new u([8193,3512,0,0,0,0,0,0]),32]]},u.prototype.range=function(){return e.subnetMatch(this,this.SpecialRanges)},u.prototype.isIPv4MappedAddress=function(){return this.range()==="ipv4Mapped"},u.prototype.toIPv4Address=function(){var c,d,f;if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");return f=this.parts.slice(-2),c=f[0],d=f[1],new e.IPv4([c>>8,c&255,d>>8,d&255])},u.prototype.prefixLengthFromSubnetMask=function(){var c,d,f,h,p,g,_;for(_={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0},c=0,p=!1,d=f=7;f>=0;d=f+=-1)if(h=this.parts[d],h in _){if(g=_[h],p&&g!==0)return null;g!==16&&(p=!0),c+=g}else return null;return 128-c},u}(),n="(?:[0-9a-f]+::?)+",l="%[0-9a-z]{1,}",i={zoneIndex:new RegExp(l,"i"),native:new RegExp("^(::)?("+n+")?([0-9a-f]+)?(::)?("+l+")?$","i"),transitional:new RegExp("^((?:"+n+")|(?:::)(?:"+n+")?)"+(r+"\\."+r+"\\."+r+"\\."+r)+("("+l+")?$"),"i")},t=function(u,c){var d,f,h,p,g,_;if(u.indexOf("::")!==u.lastIndexOf("::"))return null;for(_=(u.match(i.zoneIndex)||[])[0],_&&(_=_.substring(1),u=u.replace(/%.+$/,"")),d=0,f=-1;(f=u.indexOf(":",f+1))>=0;)d++;if(u.substr(0,2)==="::"&&d--,u.substr(-2,2)==="::"&&d--,d>c)return null;for(g=c-d,p=":";g--;)p+="0:";return u=u.replace("::",p),u[0]===":"&&(u=u.slice(1)),u[u.length-1]===":"&&(u=u.slice(0,-1)),c=function(){var S,b,v,y;for(v=u.split(":"),y=[],S=0,b=v.length;S<b;S++)h=v[S],y.push(parseInt(h,16));return y}(),{parts:c,zoneId:_}},e.IPv6.parser=function(u){var c,d,f,h,p,g,_;if(i.native.test(u))return t(u,8);if((h=u.match(i.transitional))&&(_=h[6]||"",c=t(h[1].slice(0,-1)+_,6),c.parts)){for(g=[parseInt(h[2]),parseInt(h[3]),parseInt(h[4]),parseInt(h[5])],d=0,f=g.length;d<f;d++)if(p=g[d],!(0<=p&&p<=255))return null;return c.parts.push(g[0]<<8|g[1]),c.parts.push(g[2]<<8|g[3]),{parts:c.parts,zoneId:c.zoneId}}return null},e.IPv4.isIPv4=e.IPv6.isIPv6=function(u){return this.parser(u)!==null},e.IPv4.isValid=function(u){var c;try{return new this(this.parser(u)),!0}catch(d){return c=d,!1}},e.IPv4.isValidFourPartDecimal=function(u){return!!(e.IPv4.isValid(u)&&u.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},e.IPv6.isValid=function(u){var c,d;if(typeof u=="string"&&u.indexOf(":")===-1)return!1;try{return c=this.parser(u),new this(c.parts,c.zoneId),!0}catch(f){return d=f,!1}},e.IPv4.parse=function(u){var c;if(c=this.parser(u),c===null)throw new Error("ipaddr: string is not formatted like ip address");return new this(c)},e.IPv6.parse=function(u){var c;if(c=this.parser(u),c.parts===null)throw new Error("ipaddr: string is not formatted like ip address");return new this(c.parts,c.zoneId)},e.IPv4.parseCIDR=function(u){var c,d,f;if((d=u.match(/^(.+)\/(\d+)$/))&&(c=parseInt(d[2]),c>=0&&c<=32))return f=[this.parse(d[1]),c],Object.defineProperty(f,"toString",{value:function(){return this.join("/")}}),f;throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},e.IPv4.subnetMaskFromPrefixLength=function(u){var c,d,f;if(u=parseInt(u),u<0||u>32)throw new Error("ipaddr: invalid IPv4 prefix length");for(f=[0,0,0,0],d=0,c=Math.floor(u/8);d<c;)f[d]=255,d++;return c<4&&(f[c]=Math.pow(2,u%8)-1<<8-u%8),new this(f)},e.IPv4.broadcastAddressFromCIDR=function(u){var c,d,f,h,p,g;try{for(c=this.parseCIDR(u),h=c[0].toByteArray(),g=this.subnetMaskFromPrefixLength(c[1]).toByteArray(),p=[],f=0;f<4;)p.push(parseInt(h[f],10)|parseInt(g[f],10)^255),f++;return new this(p)}catch(_){throw d=_,new Error("ipaddr: the address does not have IPv4 CIDR format")}},e.IPv4.networkAddressFromCIDR=function(u){var c,d,f,h,p,g;try{for(c=this.parseCIDR(u),h=c[0].toByteArray(),g=this.subnetMaskFromPrefixLength(c[1]).toByteArray(),p=[],f=0;f<4;)p.push(parseInt(h[f],10)&parseInt(g[f],10)),f++;return new this(p)}catch(_){throw d=_,new Error("ipaddr: the address does not have IPv4 CIDR format")}},e.IPv6.parseCIDR=function(u){var c,d,f;if((d=u.match(/^(.+)\/(\d+)$/))&&(c=parseInt(d[2]),c>=0&&c<=128))return f=[this.parse(d[1]),c],Object.defineProperty(f,"toString",{value:function(){return this.join("/")}}),f;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},e.isValid=function(u){return e.IPv6.isValid(u)||e.IPv4.isValid(u)},e.parse=function(u){if(e.IPv6.isValid(u))return e.IPv6.parse(u);if(e.IPv4.isValid(u))return e.IPv4.parse(u);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},e.parseCIDR=function(u){var c;try{return e.IPv6.parseCIDR(u)}catch(d){c=d;try{return e.IPv4.parseCIDR(u)}catch(f){throw c=f,new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},e.fromByteArray=function(u){var c;if(c=u.length,c===4)return new e.IPv4(u);if(c===16)return new e.IPv6(u);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},e.process=function(u){var c;return c=this.parse(u),c.kind()==="ipv6"&&c.isIPv4MappedAddress()?c.toIPv4Address():c}}).call(aF)});var hF=m((e6e,I0)=>{"use strict";I0.exports=Lue;I0.exports.all=dF;I0.exports.compile=fF;var Iue=oF(),cF=lF(),Nue=/^[0-9]+$/,k0=cF.isValid,x0=cF.parse,uF={linklocal:["169.254.0.0/16","fe80::/10"],loopback:["127.0.0.1/8","::1/128"],uniquelocal:["10.0.0.0/8","172.16.0.0/12","192.168.0.0/16","fc00::/7"]};function dF(t,e){var r=Iue(t);if(!e)return r;typeof e!="function"&&(e=fF(e));for(var s=0;s<r.length-1;s++)e(r[s],s)||(r.length=s+1);return r}function fF(t){if(!t)throw new TypeError("argument is required");var e;if(typeof t=="string")e=[t];else if(Array.isArray(t))e=t.slice();else throw new TypeError("unsupported trust argument");for(var r=0;r<e.length;r++)t=e[r],Object.prototype.hasOwnProperty.call(uF,t)&&(t=uF[t],e.splice.apply(e,[r,1].concat(t)),r+=t.length-1);return Mue(Due(e))}function Due(t){for(var e=new Array(t.length),r=0;r<t.length;r++)e[r]=$ue(t[r]);return e}function Mue(t){var e=t.length;return e===0?jue:e===1?Bue(t[0]):Fue(t)}function $ue(t){var e=t.lastIndexOf("/"),r=e!==-1?t.substring(0,e):t;if(!k0(r))throw new TypeError("invalid IP address: "+r);var s=x0(r);e===-1&&s.kind()==="ipv6"&&s.isIPv4MappedAddress()&&(s=s.toIPv4Address());var n=s.kind()==="ipv6"?128:32,i=e!==-1?t.substring(e+1,t.length):null;if(i===null?i=n:Nue.test(i)?i=parseInt(i,10):s.kind()==="ipv4"&&k0(i)?i=que(i):i=null,i<=0||i>n)throw new TypeError("invalid range on address: "+t);return[s,i]}function que(t){var e=x0(t),r=e.kind();return r==="ipv4"?e.prefixLengthFromSubnetMask():null}function Lue(t,e){if(!t)throw new TypeError("req argument is required");if(!e)throw new TypeError("trust argument is required");var r=dF(t,e),s=r[r.length-1];return s}function jue(){return!1}function Fue(t){return function(r){if(!k0(r))return!1;for(var s=x0(r),n,i=s.kind(),o=0;o<t.length;o++){var a=t[o],l=a[0],u=l.kind(),c=a[1],d=s;if(i!==u){if(u==="ipv4"&&!s.isIPv4MappedAddress())continue;n||(n=u==="ipv4"?s.toIPv4Address():s.toIPv4MappedAddress()),d=n}if(d.match(l,c))return!0}return!1}}function Bue(t){var e=t[0],r=e.kind(),s=r==="ipv4",n=t[1];return function(o){if(!k0(o))return!1;var a=x0(o),l=a.kind();if(l!==r){if(s&&!a.isIPv4MappedAddress())return!1;a=s?a.toIPv4Address():a.toIPv4MappedAddress()}return a.match(e,n)}}});var wp=m((t6e,pF)=>{var zue="2.0.0",Uue=Number.MAX_SAFE_INTEGER||9007199254740991,Vue=16,Hue=256-6,Gue=["major","premajor","minor","preminor","patch","prepatch","prerelease"];pF.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:Vue,MAX_SAFE_BUILD_LENGTH:Hue,MAX_SAFE_INTEGER:Uue,RELEASE_TYPES:Gue,SEMVER_SPEC_VERSION:zue,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var Tp=m((r6e,mF)=>{var Kue=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{};mF.exports=Kue});var fd=m((Ho,gF)=>{var{MAX_SAFE_COMPONENT_LENGTH:AC,MAX_SAFE_BUILD_LENGTH:Que,MAX_LENGTH:Wue}=wp(),Zue=Tp();Ho=gF.exports={};var Yue=Ho.re=[],Jue=Ho.safeRe=[],fe=Ho.src=[],he=Ho.t={},Xue=0,kC="[a-zA-Z0-9-]",ece=[["\\s",1],["\\d",Wue],[kC,Que]],tce=t=>{for(let[e,r]of ece)t=t.split(`${e}*`).join(`${e}{0,${r}}`).split(`${e}+`).join(`${e}{1,${r}}`);return t},De=(t,e,r)=>{let s=tce(e),n=Xue++;Zue(t,n,e),he[t]=n,fe[n]=e,Yue[n]=new RegExp(e,r?"g":void 0),Jue[n]=new RegExp(s,r?"g":void 0)};De("NUMERICIDENTIFIER","0|[1-9]\\d*");De("NUMERICIDENTIFIERLOOSE","\\d+");De("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${kC}*`);De("MAINVERSION",`(${fe[he.NUMERICIDENTIFIER]})\\.(${fe[he.NUMERICIDENTIFIER]})\\.(${fe[he.NUMERICIDENTIFIER]})`);De("MAINVERSIONLOOSE",`(${fe[he.NUMERICIDENTIFIERLOOSE]})\\.(${fe[he.NUMERICIDENTIFIERLOOSE]})\\.(${fe[he.NUMERICIDENTIFIERLOOSE]})`);De("PRERELEASEIDENTIFIER",`(?:${fe[he.NUMERICIDENTIFIER]}|${fe[he.NONNUMERICIDENTIFIER]})`);De("PRERELEASEIDENTIFIERLOOSE",`(?:${fe[he.NUMERICIDENTIFIERLOOSE]}|${fe[he.NONNUMERICIDENTIFIER]})`);De("PRERELEASE",`(?:-(${fe[he.PRERELEASEIDENTIFIER]}(?:\\.${fe[he.PRERELEASEIDENTIFIER]})*))`);De("PRERELEASELOOSE",`(?:-?(${fe[he.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${fe[he.PRERELEASEIDENTIFIERLOOSE]})*))`);De("BUILDIDENTIFIER",`${kC}+`);De("BUILD",`(?:\\+(${fe[he.BUILDIDENTIFIER]}(?:\\.${fe[he.BUILDIDENTIFIER]})*))`);De("FULLPLAIN",`v?${fe[he.MAINVERSION]}${fe[he.PRERELEASE]}?${fe[he.BUILD]}?`);De("FULL",`^${fe[he.FULLPLAIN]}$`);De("LOOSEPLAIN",`[v=\\s]*${fe[he.MAINVERSIONLOOSE]}${fe[he.PRERELEASELOOSE]}?${fe[he.BUILD]}?`);De("LOOSE",`^${fe[he.LOOSEPLAIN]}$`);De("GTLT","((?:<|>)?=?)");De("XRANGEIDENTIFIERLOOSE",`${fe[he.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);De("XRANGEIDENTIFIER",`${fe[he.NUMERICIDENTIFIER]}|x|X|\\*`);De("XRANGEPLAIN",`[v=\\s]*(${fe[he.XRANGEIDENTIFIER]})(?:\\.(${fe[he.XRANGEIDENTIFIER]})(?:\\.(${fe[he.XRANGEIDENTIFIER]})(?:${fe[he.PRERELEASE]})?${fe[he.BUILD]}?)?)?`);De("XRANGEPLAINLOOSE",`[v=\\s]*(${fe[he.XRANGEIDENTIFIERLOOSE]})(?:\\.(${fe[he.XRANGEIDENTIFIERLOOSE]})(?:\\.(${fe[he.XRANGEIDENTIFIERLOOSE]})(?:${fe[he.PRERELEASELOOSE]})?${fe[he.BUILD]}?)?)?`);De("XRANGE",`^${fe[he.GTLT]}\\s*${fe[he.XRANGEPLAIN]}$`);De("XRANGELOOSE",`^${fe[he.GTLT]}\\s*${fe[he.XRANGEPLAINLOOSE]}$`);De("COERCEPLAIN",`(^|[^\\d])(\\d{1,${AC}})(?:\\.(\\d{1,${AC}}))?(?:\\.(\\d{1,${AC}}))?`);De("COERCE",`${fe[he.COERCEPLAIN]}(?:$|[^\\d])`);De("COERCEFULL",fe[he.COERCEPLAIN]+`(?:${fe[he.PRERELEASE]})?(?:${fe[he.BUILD]})?(?:$|[^\\d])`);De("COERCERTL",fe[he.COERCE],!0);De("COERCERTLFULL",fe[he.COERCEFULL],!0);De("LONETILDE","(?:~>?)");De("TILDETRIM",`(\\s*)${fe[he.LONETILDE]}\\s+`,!0);Ho.tildeTrimReplace="$1~";De("TILDE",`^${fe[he.LONETILDE]}${fe[he.XRANGEPLAIN]}$`);De("TILDELOOSE",`^${fe[he.LONETILDE]}${fe[he.XRANGEPLAINLOOSE]}$`);De("LONECARET","(?:\\^)");De("CARETTRIM",`(\\s*)${fe[he.LONECARET]}\\s+`,!0);Ho.caretTrimReplace="$1^";De("CARET",`^${fe[he.LONECARET]}${fe[he.XRANGEPLAIN]}$`);De("CARETLOOSE",`^${fe[he.LONECARET]}${fe[he.XRANGEPLAINLOOSE]}$`);De("COMPARATORLOOSE",`^${fe[he.GTLT]}\\s*(${fe[he.LOOSEPLAIN]})$|^$`);De("COMPARATOR",`^${fe[he.GTLT]}\\s*(${fe[he.FULLPLAIN]})$|^$`);De("COMPARATORTRIM",`(\\s*)${fe[he.GTLT]}\\s*(${fe[he.LOOSEPLAIN]}|${fe[he.XRANGEPLAIN]})`,!0);Ho.comparatorTrimReplace="$1$2$3";De("HYPHENRANGE",`^\\s*(${fe[he.XRANGEPLAIN]})\\s+-\\s+(${fe[he.XRANGEPLAIN]})\\s*$`);De("HYPHENRANGELOOSE",`^\\s*(${fe[he.XRANGEPLAINLOOSE]})\\s+-\\s+(${fe[he.XRANGEPLAINLOOSE]})\\s*$`);De("STAR","(<|>)?=?\\s*\\*");De("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");De("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var N0=m((s6e,yF)=>{var rce=Object.freeze({loose:!0}),sce=Object.freeze({}),nce=t=>t?typeof t!="object"?rce:t:sce;yF.exports=nce});var xC=m((n6e,SF)=>{var vF=/^[0-9]+$/,_F=(t,e)=>{let r=vF.test(t),s=vF.test(e);return r&&s&&(t=+t,e=+e),t===e?0:r&&!s?-1:s&&!r?1:t<e?-1:1},ice=(t,e)=>_F(e,t);SF.exports={compareIdentifiers:_F,rcompareIdentifiers:ice}});var ns=m((i6e,TF)=>{var D0=Tp(),{MAX_LENGTH:bF,MAX_SAFE_INTEGER:M0}=wp(),{safeRe:EF,t:wF}=fd(),oce=N0(),{compareIdentifiers:hd}=xC(),Xs=class{constructor(e,r){if(r=oce(r),e instanceof Xs){if(e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>bF)throw new TypeError(`version is longer than ${bF} characters`);D0("SemVer",e,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;let s=e.trim().match(r.loose?EF[wF.LOOSE]:EF[wF.FULL]);if(!s)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+s[1],this.minor=+s[2],this.patch=+s[3],this.major>M0||this.major<0)throw new TypeError("Invalid major version");if(this.minor>M0||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>M0||this.patch<0)throw new TypeError("Invalid patch version");s[4]?this.prerelease=s[4].split(".").map(n=>{if(/^[0-9]+$/.test(n)){let i=+n;if(i>=0&&i<M0)return i}return n}):this.prerelease=[],this.build=s[5]?s[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(D0("SemVer.compare",this.version,this.options,e),!(e instanceof Xs)){if(typeof e=="string"&&e===this.version)return 0;e=new Xs(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof Xs||(e=new Xs(e,this.options)),hd(this.major,e.major)||hd(this.minor,e.minor)||hd(this.patch,e.patch)}comparePre(e){if(e instanceof Xs||(e=new Xs(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let r=0;do{let s=this.prerelease[r],n=e.prerelease[r];if(D0("prerelease compare",r,s,n),s===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(s===void 0)return-1;if(s===n)continue;return hd(s,n)}while(++r)}compareBuild(e){e instanceof Xs||(e=new Xs(e,this.options));let r=0;do{let s=this.build[r],n=e.build[r];if(D0("build compare",r,s,n),s===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(s===void 0)return-1;if(s===n)continue;return hd(s,n)}while(++r)}inc(e,r,s){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",r,s);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",r,s);break;case"prepatch":this.prerelease.length=0,this.inc("patch",r,s),this.inc("pre",r,s);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",r,s),this.inc("pre",r,s);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let n=Number(s)?1:0;if(!r&&s===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[n];else{let i=this.prerelease.length;for(;--i>=0;)typeof this.prerelease[i]=="number"&&(this.prerelease[i]++,i=-2);if(i===-1){if(r===this.prerelease.join(".")&&s===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(n)}}if(r){let i=[r,n];s===!1&&(i=[r]),hd(this.prerelease[0],r)===0?isNaN(this.prerelease[1])&&(this.prerelease=i):this.prerelease=i}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};TF.exports=Xs});var wu=m((o6e,RF)=>{var CF=ns(),ace=(t,e,r=!1)=>{if(t instanceof CF)return t;try{return new CF(t,e)}catch(s){if(!r)return null;throw s}};RF.exports=ace});var PF=m((a6e,OF)=>{var lce=wu(),uce=(t,e)=>{let r=lce(t,e);return r?r.version:null};OF.exports=uce});var kF=m((l6e,AF)=>{var cce=wu(),dce=(t,e)=>{let r=cce(t.trim().replace(/^[=v]+/,""),e);return r?r.version:null};AF.exports=dce});var NF=m((u6e,IF)=>{var xF=ns(),fce=(t,e,r,s,n)=>{typeof r=="string"&&(n=s,s=r,r=void 0);try{return new xF(t instanceof xF?t.version:t,r).inc(e,s,n).version}catch{return null}};IF.exports=fce});var $F=m((c6e,MF)=>{var DF=wu(),hce=(t,e)=>{let r=DF(t,null,!0),s=DF(e,null,!0),n=r.compare(s);if(n===0)return null;let i=n>0,o=i?r:s,a=i?s:r,l=!!o.prerelease.length;if(!!a.prerelease.length&&!l)return!a.patch&&!a.minor?"major":o.patch?"patch":o.minor?"minor":"major";let c=l?"pre":"";return r.major!==s.major?c+"major":r.minor!==s.minor?c+"minor":r.patch!==s.patch?c+"patch":"prerelease"};MF.exports=hce});var LF=m((d6e,qF)=>{var pce=ns(),mce=(t,e)=>new pce(t,e).major;qF.exports=mce});var FF=m((f6e,jF)=>{var gce=ns(),yce=(t,e)=>new gce(t,e).minor;jF.exports=yce});var zF=m((h6e,BF)=>{var vce=ns(),_ce=(t,e)=>new vce(t,e).patch;BF.exports=_ce});var VF=m((p6e,UF)=>{var Sce=wu(),bce=(t,e)=>{let r=Sce(t,e);return r&&r.prerelease.length?r.prerelease:null};UF.exports=bce});var Tn=m((m6e,GF)=>{var HF=ns(),Ece=(t,e,r)=>new HF(t,r).compare(new HF(e,r));GF.exports=Ece});var QF=m((g6e,KF)=>{var wce=Tn(),Tce=(t,e,r)=>wce(e,t,r);KF.exports=Tce});var ZF=m((y6e,WF)=>{var Cce=Tn(),Rce=(t,e)=>Cce(t,e,!0);WF.exports=Rce});var $0=m((v6e,JF)=>{var YF=ns(),Oce=(t,e,r)=>{let s=new YF(t,r),n=new YF(e,r);return s.compare(n)||s.compareBuild(n)};JF.exports=Oce});var eB=m((_6e,XF)=>{var Pce=$0(),Ace=(t,e)=>t.sort((r,s)=>Pce(r,s,e));XF.exports=Ace});var rB=m((S6e,tB)=>{var kce=$0(),xce=(t,e)=>t.sort((r,s)=>kce(s,r,e));tB.exports=xce});var Cp=m((b6e,sB)=>{var Ice=Tn(),Nce=(t,e,r)=>Ice(t,e,r)>0;sB.exports=Nce});var q0=m((E6e,nB)=>{var Dce=Tn(),Mce=(t,e,r)=>Dce(t,e,r)<0;nB.exports=Mce});var IC=m((w6e,iB)=>{var $ce=Tn(),qce=(t,e,r)=>$ce(t,e,r)===0;iB.exports=qce});var NC=m((T6e,oB)=>{var Lce=Tn(),jce=(t,e,r)=>Lce(t,e,r)!==0;oB.exports=jce});var L0=m((C6e,aB)=>{var Fce=Tn(),Bce=(t,e,r)=>Fce(t,e,r)>=0;aB.exports=Bce});var j0=m((R6e,lB)=>{var zce=Tn(),Uce=(t,e,r)=>zce(t,e,r)<=0;lB.exports=Uce});var DC=m((O6e,uB)=>{var Vce=IC(),Hce=NC(),Gce=Cp(),Kce=L0(),Qce=q0(),Wce=j0(),Zce=(t,e,r,s)=>{switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t===r;case"!==":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t!==r;case"":case"=":case"==":return Vce(t,r,s);case"!=":return Hce(t,r,s);case">":return Gce(t,r,s);case">=":return Kce(t,r,s);case"<":return Qce(t,r,s);case"<=":return Wce(t,r,s);default:throw new TypeError(`Invalid operator: ${e}`)}};uB.exports=Zce});var dB=m((P6e,cB)=>{var Yce=ns(),Jce=wu(),{safeRe:F0,t:B0}=fd(),Xce=(t,e)=>{if(t instanceof Yce)return t;if(typeof t=="number"&&(t=String(t)),typeof t!="string")return null;e=e||{};let r=null;if(!e.rtl)r=t.match(e.includePrerelease?F0[B0.COERCEFULL]:F0[B0.COERCE]);else{let l=e.includePrerelease?F0[B0.COERCERTLFULL]:F0[B0.COERCERTL],u;for(;(u=l.exec(t))&&(!r||r.index+r[0].length!==t.length);)(!r||u.index+u[0].length!==r.index+r[0].length)&&(r=u),l.lastIndex=u.index+u[1].length+u[2].length;l.lastIndex=-1}if(r===null)return null;let s=r[2],n=r[3]||"0",i=r[4]||"0",o=e.includePrerelease&&r[5]?`-${r[5]}`:"",a=e.includePrerelease&&r[6]?`+${r[6]}`:"";return Jce(`${s}.${n}.${i}${o}${a}`,e)};cB.exports=Xce});var hB=m((A6e,fB)=>{var MC=class{constructor(){this.max=1e3,this.map=new Map}get(e){let r=this.map.get(e);if(r!==void 0)return this.map.delete(e),this.map.set(e,r),r}delete(e){return this.map.delete(e)}set(e,r){if(!this.delete(e)&&r!==void 0){if(this.map.size>=this.max){let n=this.map.keys().next().value;this.delete(n)}this.map.set(e,r)}return this}};fB.exports=MC});var Cn=m((k6e,yB)=>{var Tu=class{constructor(e,r){if(r=tde(r),e instanceof Tu)return e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease?e:new Tu(e.raw,r);if(e instanceof $C)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease,this.raw=e.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(s=>this.parseRange(s.trim())).filter(s=>s.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let s=this.set[0];if(this.set=this.set.filter(n=>!mB(n[0])),this.set.length===0)this.set=[s];else if(this.set.length>1){for(let n of this.set)if(n.length===1&&lde(n[0])){this.set=[n];break}}}this.format()}format(){return this.range=this.set.map(e=>e.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(e){let s=((this.options.includePrerelease&&ode)|(this.options.loose&&ade))+":"+e,n=pB.get(s);if(n)return n;let i=this.options.loose,o=i?Ns[vs.HYPHENRANGELOOSE]:Ns[vs.HYPHENRANGE];e=e.replace(o,vde(this.options.includePrerelease)),Lt("hyphen replace",e),e=e.replace(Ns[vs.COMPARATORTRIM],sde),Lt("comparator trim",e),e=e.replace(Ns[vs.TILDETRIM],nde),Lt("tilde trim",e),e=e.replace(Ns[vs.CARETTRIM],ide),Lt("caret trim",e);let a=e.split(" ").map(d=>ude(d,this.options)).join(" ").split(/\s+/).map(d=>yde(d,this.options));i&&(a=a.filter(d=>(Lt("loose invalid filter",d,this.options),!!d.match(Ns[vs.COMPARATORLOOSE])))),Lt("range list",a);let l=new Map,u=a.map(d=>new $C(d,this.options));for(let d of u){if(mB(d))return[d];l.set(d.value,d)}l.size>1&&l.has("")&&l.delete("");let c=[...l.values()];return pB.set(s,c),c}intersects(e,r){if(!(e instanceof Tu))throw new TypeError("a Range is required");return this.set.some(s=>gB(s,r)&&e.set.some(n=>gB(n,r)&&s.every(i=>n.every(o=>i.intersects(o,r)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new rde(e,this.options)}catch{return!1}for(let r=0;r<this.set.length;r++)if(_de(this.set[r],e,this.options))return!0;return!1}};yB.exports=Tu;var ede=hB(),pB=new ede,tde=N0(),$C=Rp(),Lt=Tp(),rde=ns(),{safeRe:Ns,t:vs,comparatorTrimReplace:sde,tildeTrimReplace:nde,caretTrimReplace:ide}=fd(),{FLAG_INCLUDE_PRERELEASE:ode,FLAG_LOOSE:ade}=wp(),mB=t=>t.value==="<0.0.0-0",lde=t=>t.value==="",gB=(t,e)=>{let r=!0,s=t.slice(),n=s.pop();for(;r&&s.length;)r=s.every(i=>n.intersects(i,e)),n=s.pop();return r},ude=(t,e)=>(Lt("comp",t,e),t=fde(t,e),Lt("caret",t),t=cde(t,e),Lt("tildes",t),t=pde(t,e),Lt("xrange",t),t=gde(t,e),Lt("stars",t),t),_s=t=>!t||t.toLowerCase()==="x"||t==="*",cde=(t,e)=>t.trim().split(/\s+/).map(r=>dde(r,e)).join(" "),dde=(t,e)=>{let r=e.loose?Ns[vs.TILDELOOSE]:Ns[vs.TILDE];return t.replace(r,(s,n,i,o,a)=>{Lt("tilde",t,s,n,i,o,a);let l;return _s(n)?l="":_s(i)?l=`>=${n}.0.0 <${+n+1}.0.0-0`:_s(o)?l=`>=${n}.${i}.0 <${n}.${+i+1}.0-0`:a?(Lt("replaceTilde pr",a),l=`>=${n}.${i}.${o}-${a} <${n}.${+i+1}.0-0`):l=`>=${n}.${i}.${o} <${n}.${+i+1}.0-0`,Lt("tilde return",l),l})},fde=(t,e)=>t.trim().split(/\s+/).map(r=>hde(r,e)).join(" "),hde=(t,e)=>{Lt("caret",t,e);let r=e.loose?Ns[vs.CARETLOOSE]:Ns[vs.CARET],s=e.includePrerelease?"-0":"";return t.replace(r,(n,i,o,a,l)=>{Lt("caret",t,n,i,o,a,l);let u;return _s(i)?u="":_s(o)?u=`>=${i}.0.0${s} <${+i+1}.0.0-0`:_s(a)?i==="0"?u=`>=${i}.${o}.0${s} <${i}.${+o+1}.0-0`:u=`>=${i}.${o}.0${s} <${+i+1}.0.0-0`:l?(Lt("replaceCaret pr",l),i==="0"?o==="0"?u=`>=${i}.${o}.${a}-${l} <${i}.${o}.${+a+1}-0`:u=`>=${i}.${o}.${a}-${l} <${i}.${+o+1}.0-0`:u=`>=${i}.${o}.${a}-${l} <${+i+1}.0.0-0`):(Lt("no pr"),i==="0"?o==="0"?u=`>=${i}.${o}.${a}${s} <${i}.${o}.${+a+1}-0`:u=`>=${i}.${o}.${a}${s} <${i}.${+o+1}.0-0`:u=`>=${i}.${o}.${a} <${+i+1}.0.0-0`),Lt("caret return",u),u})},pde=(t,e)=>(Lt("replaceXRanges",t,e),t.split(/\s+/).map(r=>mde(r,e)).join(" ")),mde=(t,e)=>{t=t.trim();let r=e.loose?Ns[vs.XRANGELOOSE]:Ns[vs.XRANGE];return t.replace(r,(s,n,i,o,a,l)=>{Lt("xRange",t,s,n,i,o,a,l);let u=_s(i),c=u||_s(o),d=c||_s(a),f=d;return n==="="&&f&&(n=""),l=e.includePrerelease?"-0":"",u?n===">"||n==="<"?s="<0.0.0-0":s="*":n&&f?(c&&(o=0),a=0,n===">"?(n=">=",c?(i=+i+1,o=0,a=0):(o=+o+1,a=0)):n==="<="&&(n="<",c?i=+i+1:o=+o+1),n==="<"&&(l="-0"),s=`${n+i}.${o}.${a}${l}`):c?s=`>=${i}.0.0${l} <${+i+1}.0.0-0`:d&&(s=`>=${i}.${o}.0${l} <${i}.${+o+1}.0-0`),Lt("xRange return",s),s})},gde=(t,e)=>(Lt("replaceStars",t,e),t.trim().replace(Ns[vs.STAR],"")),yde=(t,e)=>(Lt("replaceGTE0",t,e),t.trim().replace(Ns[e.includePrerelease?vs.GTE0PRE:vs.GTE0],"")),vde=t=>(e,r,s,n,i,o,a,l,u,c,d,f)=>(_s(s)?r="":_s(n)?r=`>=${s}.0.0${t?"-0":""}`:_s(i)?r=`>=${s}.${n}.0${t?"-0":""}`:o?r=`>=${r}`:r=`>=${r}${t?"-0":""}`,_s(u)?l="":_s(c)?l=`<${+u+1}.0.0-0`:_s(d)?l=`<${u}.${+c+1}.0-0`:f?l=`<=${u}.${c}.${d}-${f}`:t?l=`<${u}.${c}.${+d+1}-0`:l=`<=${l}`,`${r} ${l}`.trim()),_de=(t,e,r)=>{for(let s=0;s<t.length;s++)if(!t[s].test(e))return!1;if(e.prerelease.length&&!r.includePrerelease){for(let s=0;s<t.length;s++)if(Lt(t[s].semver),t[s].semver!==$C.ANY&&t[s].semver.prerelease.length>0){let n=t[s].semver;if(n.major===e.major&&n.minor===e.minor&&n.patch===e.patch)return!0}return!1}return!0}});var Rp=m((x6e,wB)=>{var Op=Symbol("SemVer ANY"),pd=class{static get ANY(){return Op}constructor(e,r){if(r=vB(r),e instanceof pd){if(e.loose===!!r.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),LC("comparator",e,r),this.options=r,this.loose=!!r.loose,this.parse(e),this.semver===Op?this.value="":this.value=this.operator+this.semver.version,LC("comp",this)}parse(e){let r=this.options.loose?_B[SB.COMPARATORLOOSE]:_B[SB.COMPARATOR],s=e.match(r);if(!s)throw new TypeError(`Invalid comparator: ${e}`);this.operator=s[1]!==void 0?s[1]:"",this.operator==="="&&(this.operator=""),s[2]?this.semver=new bB(s[2],this.options.loose):this.semver=Op}toString(){return this.value}test(e){if(LC("Comparator.test",e,this.options.loose),this.semver===Op||e===Op)return!0;if(typeof e=="string")try{e=new bB(e,this.options)}catch{return!1}return qC(e,this.operator,this.semver,this.options)}intersects(e,r){if(!(e instanceof pd))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new EB(e.value,r).test(this.value):e.operator===""?e.value===""?!0:new EB(this.value,r).test(e.semver):(r=vB(r),r.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!r.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||qC(this.semver,"<",e.semver,r)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||qC(this.semver,">",e.semver,r)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};wB.exports=pd;var vB=N0(),{safeRe:_B,t:SB}=fd(),qC=DC(),LC=Tp(),bB=ns(),EB=Cn()});var Pp=m((I6e,TB)=>{var Sde=Cn(),bde=(t,e,r)=>{try{e=new Sde(e,r)}catch{return!1}return e.test(t)};TB.exports=bde});var RB=m((N6e,CB)=>{var Ede=Cn(),wde=(t,e)=>new Ede(t,e).set.map(r=>r.map(s=>s.value).join(" ").trim().split(" "));CB.exports=wde});var PB=m((D6e,OB)=>{var Tde=ns(),Cde=Cn(),Rde=(t,e,r)=>{let s=null,n=null,i=null;try{i=new Cde(e,r)}catch{return null}return t.forEach(o=>{i.test(o)&&(!s||n.compare(o)===-1)&&(s=o,n=new Tde(s,r))}),s};OB.exports=Rde});var kB=m((M6e,AB)=>{var Ode=ns(),Pde=Cn(),Ade=(t,e,r)=>{let s=null,n=null,i=null;try{i=new Pde(e,r)}catch{return null}return t.forEach(o=>{i.test(o)&&(!s||n.compare(o)===1)&&(s=o,n=new Ode(s,r))}),s};AB.exports=Ade});var NB=m(($6e,IB)=>{var jC=ns(),kde=Cn(),xB=Cp(),xde=(t,e)=>{t=new kde(t,e);let r=new jC("0.0.0");if(t.test(r)||(r=new jC("0.0.0-0"),t.test(r)))return r;r=null;for(let s=0;s<t.set.length;++s){let n=t.set[s],i=null;n.forEach(o=>{let a=new jC(o.semver.version);switch(o.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!i||xB(a,i))&&(i=a);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${o.operator}`)}}),i&&(!r||xB(r,i))&&(r=i)}return r&&t.test(r)?r:null};IB.exports=xde});var MB=m((q6e,DB)=>{var Ide=Cn(),Nde=(t,e)=>{try{return new Ide(t,e).range||"*"}catch{return null}};DB.exports=Nde});var z0=m((L6e,jB)=>{var Dde=ns(),LB=Rp(),{ANY:Mde}=LB,$de=Cn(),qde=Pp(),$B=Cp(),qB=q0(),Lde=j0(),jde=L0(),Fde=(t,e,r,s)=>{t=new Dde(t,s),e=new $de(e,s);let n,i,o,a,l;switch(r){case">":n=$B,i=Lde,o=qB,a=">",l=">=";break;case"<":n=qB,i=jde,o=$B,a="<",l="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(qde(t,e,s))return!1;for(let u=0;u<e.set.length;++u){let c=e.set[u],d=null,f=null;if(c.forEach(h=>{h.semver===Mde&&(h=new LB(">=0.0.0")),d=d||h,f=f||h,n(h.semver,d.semver,s)?d=h:o(h.semver,f.semver,s)&&(f=h)}),d.operator===a||d.operator===l||(!f.operator||f.operator===a)&&i(t,f.semver))return!1;if(f.operator===l&&o(t,f.semver))return!1}return!0};jB.exports=Fde});var BB=m((j6e,FB)=>{var Bde=z0(),zde=(t,e,r)=>Bde(t,e,">",r);FB.exports=zde});var UB=m((F6e,zB)=>{var Ude=z0(),Vde=(t,e,r)=>Ude(t,e,"<",r);zB.exports=Vde});var GB=m((B6e,HB)=>{var VB=Cn(),Hde=(t,e,r)=>(t=new VB(t,r),e=new VB(e,r),t.intersects(e,r));HB.exports=Hde});var QB=m((z6e,KB)=>{var Gde=Pp(),Kde=Tn();KB.exports=(t,e,r)=>{let s=[],n=null,i=null,o=t.sort((c,d)=>Kde(c,d,r));for(let c of o)Gde(c,e,r)?(i=c,n||(n=c)):(i&&s.push([n,i]),i=null,n=null);n&&s.push([n,null]);let a=[];for(let[c,d]of s)c===d?a.push(c):!d&&c===o[0]?a.push("*"):d?c===o[0]?a.push(`<=${d}`):a.push(`${c} - ${d}`):a.push(`>=${c}`);let l=a.join(" || "),u=typeof e.raw=="string"?e.raw:String(e);return l.length<u.length?l:e}});var ez=m((U6e,XB)=>{var WB=Cn(),BC=Rp(),{ANY:FC}=BC,Ap=Pp(),zC=Tn(),Qde=(t,e,r={})=>{if(t===e)return!0;t=new WB(t,r),e=new WB(e,r);let s=!1;e:for(let n of t.set){for(let i of e.set){let o=Zde(n,i,r);if(s=s||o!==null,o)continue e}if(s)return!1}return!0},Wde=[new BC(">=0.0.0-0")],ZB=[new BC(">=0.0.0")],Zde=(t,e,r)=>{if(t===e)return!0;if(t.length===1&&t[0].semver===FC){if(e.length===1&&e[0].semver===FC)return!0;r.includePrerelease?t=Wde:t=ZB}if(e.length===1&&e[0].semver===FC){if(r.includePrerelease)return!0;e=ZB}let s=new Set,n,i;for(let h of t)h.operator===">"||h.operator===">="?n=YB(n,h,r):h.operator==="<"||h.operator==="<="?i=JB(i,h,r):s.add(h.semver);if(s.size>1)return null;let o;if(n&&i){if(o=zC(n.semver,i.semver,r),o>0)return null;if(o===0&&(n.operator!==">="||i.operator!=="<="))return null}for(let h of s){if(n&&!Ap(h,String(n),r)||i&&!Ap(h,String(i),r))return null;for(let p of e)if(!Ap(h,String(p),r))return!1;return!0}let a,l,u,c,d=i&&!r.includePrerelease&&i.semver.prerelease.length?i.semver:!1,f=n&&!r.includePrerelease&&n.semver.prerelease.length?n.semver:!1;d&&d.prerelease.length===1&&i.operator==="<"&&d.prerelease[0]===0&&(d=!1);for(let h of e){if(c=c||h.operator===">"||h.operator===">=",u=u||h.operator==="<"||h.operator==="<=",n){if(f&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===f.major&&h.semver.minor===f.minor&&h.semver.patch===f.patch&&(f=!1),h.operator===">"||h.operator===">="){if(a=YB(n,h,r),a===h&&a!==n)return!1}else if(n.operator===">="&&!Ap(n.semver,String(h),r))return!1}if(i){if(d&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===d.major&&h.semver.minor===d.minor&&h.semver.patch===d.patch&&(d=!1),h.operator==="<"||h.operator==="<="){if(l=JB(i,h,r),l===h&&l!==i)return!1}else if(i.operator==="<="&&!Ap(i.semver,String(h),r))return!1}if(!h.operator&&(i||n)&&o!==0)return!1}return!(n&&u&&!i&&o!==0||i&&c&&!n&&o!==0||f||d)},YB=(t,e,r)=>{if(!t)return e;let s=zC(t.semver,e.semver,r);return s>0?t:s<0||e.operator===">"&&t.operator===">="?e:t},JB=(t,e,r)=>{if(!t)return e;let s=zC(t.semver,e.semver,r);return s<0?t:s>0||e.operator==="<"&&t.operator==="<="?e:t};XB.exports=Qde});var VC=m((V6e,sz)=>{var UC=fd(),tz=wp(),Yde=ns(),rz=xC(),Jde=wu(),Xde=PF(),efe=kF(),tfe=NF(),rfe=$F(),sfe=LF(),nfe=FF(),ife=zF(),ofe=VF(),afe=Tn(),lfe=QF(),ufe=ZF(),cfe=$0(),dfe=eB(),ffe=rB(),hfe=Cp(),pfe=q0(),mfe=IC(),gfe=NC(),yfe=L0(),vfe=j0(),_fe=DC(),Sfe=dB(),bfe=Rp(),Efe=Cn(),wfe=Pp(),Tfe=RB(),Cfe=PB(),Rfe=kB(),Ofe=NB(),Pfe=MB(),Afe=z0(),kfe=BB(),xfe=UB(),Ife=GB(),Nfe=QB(),Dfe=ez();sz.exports={parse:Jde,valid:Xde,clean:efe,inc:tfe,diff:rfe,major:sfe,minor:nfe,patch:ife,prerelease:ofe,compare:afe,rcompare:lfe,compareLoose:ufe,compareBuild:cfe,sort:dfe,rsort:ffe,gt:hfe,lt:pfe,eq:mfe,neq:gfe,gte:yfe,lte:vfe,cmp:_fe,coerce:Sfe,Comparator:bfe,Range:Efe,satisfies:wfe,toComparators:Tfe,maxSatisfying:Cfe,minSatisfying:Rfe,minVersion:Ofe,validRange:Pfe,outside:Afe,gtr:kfe,ltr:xfe,intersects:Ife,simplifyRange:Nfe,subset:Dfe,SemVer:Yde,re:UC.re,src:UC.src,tokens:UC.t,SEMVER_SPEC_VERSION:tz.SEMVER_SPEC_VERSION,RELEASE_TYPES:tz.RELEASE_TYPES,compareIdentifiers:rz.compareIdentifiers,rcompareIdentifiers:rz.rcompareIdentifiers}});var V0=m((H6e,QC)=>{"use strict";var U0=hF(),Mfe=VC(),{FSTDEP005:$fe,FSTDEP012:qfe,FSTDEP015:Lfe,FSTDEP016:jfe,FSTDEP017:Ffe,FSTDEP018:Bfe}=zo(),{kHasBeenDecorated:zfe,kSchemaBody:Ufe,kSchemaHeaders:Vfe,kSchemaParams:Hfe,kSchemaQuerystring:nz,kSchemaController:HC,kOptions:Gfe,kRequestCacheValidateFns:ja,kRouteContext:lr,kPublicRouteContext:iz,kRequestOriginalUrl:GC}=xr(),{FST_ERR_REQ_INVALID_VALIDATION_INVOCATION:Kfe}=rs(),oz={body:Ufe,headers:Vfe,params:Hfe,querystring:nz,query:nz};function KC(t,e,r,s,n,i){this.id=t,this[lr]=i,this.params=e,this.raw=r,this.query=s,this.log=n,this.body=void 0}KC.props=[];function Qfe(t){if(typeof t=="function")return t;if(t===!0)return function(){return!0};if(typeof t=="number")return function(e,r){return r<t};if(typeof t=="string"){let e=t.split(",").map(r=>r.trim());return U0.compile(e)}return U0.compile(t)}function Wfe(t,e){return e?Zfe(t,e):lz(t)}function lz(t){let e=t.props.slice();function r(s,n,i,o,a,l){this.id=s,this[lr]=l,this.params=n,this.raw=i,this.query=o,this.log=a,this.body=void 0;for(var u,c=0;c<e.length;c++)u=e[c],this[u.key]=u.value}return Object.setPrototypeOf(r.prototype,t.prototype),Object.setPrototypeOf(r,t),r.props=e,r.parent=t,r}function az(t){let e=t.lastIndexOf(",");return e===-1?t.trim():t.slice(e+1).trim()}function Zfe(t,e){let r=lz(t),s=Qfe(e);return r[zfe]=!0,Object.defineProperties(r.prototype,{ip:{get(){return U0(this.raw,s)}},ips:{get(){return U0.all(this.raw,s)}},hostname:{get(){return this.ip!==void 0&&this.headers["x-forwarded-host"]?az(this.headers["x-forwarded-host"]):this.headers.host||this.headers[":authority"]}},protocol:{get(){if(this.headers["x-forwarded-proto"])return az(this.headers["x-forwarded-proto"]);if(this.socket)return this.socket.encrypted?"https":"http"}}}),r}Object.defineProperties(KC.prototype,{server:{get(){return this[lr].server}},url:{get(){return this.raw.url}},originalUrl:{get(){return this[GC]||(this[GC]=this.raw.originalUrl||this.raw.url),this[GC]}},method:{get(){return this.raw.method}},context:{get(){return qfe(),this[lr]}},routerPath:{get(){return Ffe(),this[lr].config?.url}},routeOptions:{get(){let t=this[lr],e=t._parserOptions.limit,r=t.server.initialConfig.bodyLimit,s=t.server.hasConstraintStrategy("version")?this.raw.headers["accept-version"]:void 0,n={method:t.config?.method,url:t.config?.url,bodyLimit:e||r,attachValidation:t.attachValidation,logLevel:t.logLevel,exposeHeadRoute:t.exposeHeadRoute,prefixTrailingSlash:t.prefixTrailingSlash,handler:t.handler,version:s};return Object.defineProperties(n,{config:{get:()=>t.config},schema:{get:()=>t.schema}}),Object.freeze(n)}},routerMethod:{get(){return Bfe(),this[lr].config?.method}},routeConfig:{get(){return jfe(),this[lr][iz]?.config}},routeSchema:{get(){return Lfe(),this[lr][iz].schema}},is404:{get(){return this[lr].config?.url===void 0}},connection:{get(){return Mfe.gte(process.versions.node,"13.0.0")&&$fe(),this.raw.connection}},socket:{get(){return this.raw.socket}},ip:{get(){if(this.socket)return this.socket.remoteAddress}},hostname:{get(){return this.raw.headers.host||this.raw.headers[":authority"]}},protocol:{get(){if(this.socket)return this.socket.encrypted?"https":"http"}},headers:{get(){return this.additionalHeaders?Object.assign({},this.raw.headers,this.additionalHeaders):this.raw.headers},set(t){this.additionalHeaders=t}},getValidationFunction:{value:function(t){if(typeof t=="string"){let e=oz[t];return this[lr][e]}else if(typeof t=="object")return this[lr][ja]?.get(t)}},compileValidationSchema:{value:function(t,e=null){let{method:r,url:s}=this;if(this[lr][ja]?.has(t))return this[lr][ja].get(t);let i=(this[lr].validatorCompiler||this.server[HC].validatorCompiler||this.server[HC].setupValidator(this.server[Gfe])||this.server[HC].validatorCompiler)({schema:t,method:r,url:s,httpPart:e});return this[lr][ja]==null&&(this[lr][ja]=new WeakMap),this[lr][ja].set(t,i),i}},validateInput:{value:function(t,e,r){r=typeof e=="string"?e:r;let s=r!=null&&typeof r=="string"&&oz[r],n;if(s&&(n=this[lr][s]),n==null&&(e==null||typeof e!="object"||Array.isArray(e)))throw new Kfe(r);return n==null&&(this[lr][ja]?.has(e)?n=this[lr][ja].get(e):n=this.compileValidationSchema(e,r)),n(t)}}});QC.exports=KC;QC.exports.buildRequest=Wfe});var H0=m((G6e,uz)=>{"use strict";var{kFourOhFourContext:Yfe,kReplySerializerDefault:Jfe,kSchemaErrorFormatter:Xfe,kErrorHandler:ehe,kChildLoggerFactory:the,kOptions:rhe,kReply:she,kRequest:nhe,kBodyLimit:ihe,kLogLevel:ohe,kContentTypeParser:ahe,kRouteByFastify:lhe,kRequestCacheValidateFns:uhe,kReplyCacheSerializeFns:che,kPublicRouteContext:dhe}=xr();function fhe({schema:t,handler:e,config:r,requestIdLogLabel:s,childLoggerFactory:n,errorHandler:i,bodyLimit:o,logLevel:a,logSerializers:l,attachValidation:u,validatorCompiler:c,serializerCompiler:d,replySerializer:f,schemaErrorFormatter:h,exposeHeadRoute:p,prefixTrailingSlash:g,server:_,isFastify:S}){this.schema=t,this.handler=e,this.Reply=_[she],this.Request=_[nhe],this.contentTypeParser=_[ahe],this.onRequest=null,this.onSend=null,this.onError=null,this.onTimeout=null,this.preHandler=null,this.onResponse=null,this.preSerialization=null,this.onRequestAbort=null,this.config=r,this.errorHandler=i||_[ehe],this.requestIdLogLabel=s||_[rhe].requestIdLogLabel,this.childLoggerFactory=n||_[the],this._middie=null,this._parserOptions={limit:o||_[ihe]},this.exposeHeadRoute=p,this.prefixTrailingSlash=g,this.logLevel=a||_[ohe],this.logSerializers=l,this[Yfe]=null,this.attachValidation=u,this[Jfe]=f,this.schemaErrorFormatter=h||_[Xfe]||phe,this[lhe]=S,this[uhe]=null,this[che]=null,this.validatorCompiler=c||null,this.serializerCompiler=d||null,this[dhe]=hhe(this),this.server=_}function hhe(t){return Object.create(null,{schema:{enumerable:!0,get(){return t.schema}},config:{enumerable:!0,get(){return t.config}}})}function phe(t,e){let r="",s=", ";for(var n=0;n!==t.length;++n){let i=t[n];r+=e+(i.instancePath||"")+" "+i.message+s}return new Error(r.slice(0,-s.length))}uz.exports=fhe});var WC=m((K6e,cz)=>{"use strict";cz.exports={supportedMethods:["DELETE","GET","HEAD","PATCH","POST","PUT","OPTIONS","PROPFIND","PROPPATCH","MKCOL","COPY","MOVE","LOCK","UNLOCK","TRACE","SEARCH","REPORT","MKCALENDAR"]}});var eR=m((Q6e,pz)=>{"use strict";var{kReply:ZC,kRequest:YC,kState:mhe,kHasBeenDecorated:ghe}=xr(),{FST_ERR_DEC_ALREADY_PRESENT:dz,FST_ERR_DEC_MISSING_DEPENDENCY:yhe,FST_ERR_DEC_AFTER_START:vhe,FST_ERR_DEC_DEPENDENCY_INVALID_TYPE:_he}=rs(),{FSTDEP006:She}=zo();function bhe(t,e,r,s){if(Object.prototype.hasOwnProperty.call(t,e))throw new dz(e);JC(t,e,s),r&&(typeof r.getter=="function"||typeof r.setter=="function")?Object.defineProperty(t,e,{get:r.getter,set:r.setter}):t[e]=r}function fz(t,e,r,s){let n=t.prototype;if(Object.prototype.hasOwnProperty.call(n,e)||K0(t,e))throw new dz(e);t[ghe]=!0,JC(t,e,s),r&&(typeof r.getter=="function"||typeof r.setter=="function")?Object.defineProperty(n,e,{get:r.getter,set:r.setter}):typeof r=="function"?n[e]=r:t.props.push({key:e,value:r})}function hz(t,e){typeof e=="object"&&e&&!(typeof e.getter=="function"||typeof e.setter=="function")&&She(t)}function Ehe(t,e,r){return XC(this,t),bhe(this,t,e,r),this}function G0(t,e){return e?e in t||t.prototype&&e in t.prototype||K0(t,e):t in this}function K0(t,e){return t.props?t.props.find(({key:r})=>r===e):!1}function whe(t){return t&&K0(this[YC],t)?!0:G0(this[YC].prototype,t)}function The(t){return t&&K0(this[ZC],t)?!0:G0(this[ZC].prototype,t)}function JC(t,e,r){if(r!=null){if(!Array.isArray(r))throw new _he(e);for(var s=0;s!==r.length;++s)if(!G0(t,r[s]))throw new yhe(r[s])}}function Che(t,e,r){return XC(this,t),hz(t,e),fz(this[ZC],t,e,r),this}function Rhe(t,e,r){return XC(this,t),hz(t,e),fz(this[YC],t,e,r),this}function XC(t,e){if(t[mhe].started)throw new vhe(e)}pz.exports={add:Ehe,exist:G0,existRequest:whe,existReply:The,dependencies:JC,decorateReply:Che,decorateRequest:Rhe}});var gz=m(Ui=>{"use strict";var tR=class{constructor(e=1e3,r=0){if(isNaN(e)||e<0)throw new Error("Invalid max value");if(isNaN(r)||r<0)throw new Error("Invalid ttl value");this.first=null,this.items=new Map,this.last=null,this.max=e,this.ttl=r}get size(){return this.items.size}clear(){this.items=new Map,this.first=null,this.last=null}delete(e){if(this.items.has(e)){let r=this.items.get(e);this.items.delete(e),r.prev!==null&&(r.prev.next=r.next),r.next!==null&&(r.next.prev=r.prev),this.first===r&&(this.first=r.next),this.last===r&&(this.last=r.prev)}}deleteMany(e){for(var r=0;r<e.length;r++)this.delete(e[r])}evict(){if(this.size>0){let e=this.first;this.items.delete(e.key),this.size===0?(this.first=null,this.last=null):(this.first=e.next,this.first.prev=null)}}expiresAt(e){if(this.items.has(e))return this.items.get(e).expiry}get(e){if(this.items.has(e)){let r=this.items.get(e);if(this.ttl>0&&r.expiry<=Date.now()){this.delete(e);return}return r.value}}getMany(e){let r=[];for(var s=0;s<e.length;s++)r.push(this.get(e[s]));return r}keys(){return this.items.keys()}set(e,r){if(this.items.has(e)){let n=this.items.get(e);n.value=r,n.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl;return}this.max>0&&this.size===this.max&&this.evict();let s={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:e,prev:this.last,next:null,value:r};this.items.set(e,s),this.size===1?this.first=s:this.last.next=s,this.last=s}},rR=class{constructor(e=1e3,r=0){if(isNaN(e)||e<0)throw new Error("Invalid max value");if(isNaN(r)||r<0)throw new Error("Invalid ttl value");this.first=null,this.items=new Map,this.last=null,this.max=e,this.ttl=r}get size(){return this.items.size}bumpLru(e){if(this.last===e)return;let r=this.last,s=e.next,n=e.prev;this.first===e&&(this.first=s),e.next=null,e.prev=r,r.next=e,n!==null&&(n.next=s),s!==null&&(s.prev=n),this.last=e}clear(){this.items=new Map,this.first=null,this.last=null}delete(e){if(this.items.has(e)){let r=this.items.get(e);this.items.delete(e),r.prev!==null&&(r.prev.next=r.next),r.next!==null&&(r.next.prev=r.prev),this.first===r&&(this.first=r.next),this.last===r&&(this.last=r.prev)}}deleteMany(e){for(var r=0;r<e.length;r++)this.delete(e[r])}evict(){if(this.size>0){let e=this.first;this.items.delete(e.key),this.size===0?(this.first=null,this.last=null):(this.first=e.next,this.first.prev=null)}}expiresAt(e){if(this.items.has(e))return this.items.get(e).expiry}get(e){if(this.items.has(e)){let r=this.items.get(e);if(this.ttl>0&&r.expiry<=Date.now()){this.delete(e);return}return this.bumpLru(r),r.value}}getMany(e){let r=[];for(var s=0;s<e.length;s++)r.push(this.get(e[s]));return r}keys(){return this.items.keys()}set(e,r){if(this.items.has(e)){let n=this.items.get(e);n.value=r,n.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl,this.last!==n&&this.bumpLru(n);return}this.max>0&&this.size===this.max&&this.evict();let s={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:e,prev:this.last,next:null,value:r};this.items.set(e,s),this.size===1?this.first=s:this.last.next=s,this.last=s}},kp=class{constructor(e=1e3,r=0){if(isNaN(e)||e<0)throw new Error("Invalid max value");if(isNaN(r)||r<0)throw new Error("Invalid ttl value");this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this.max=e,this.ttl=r}bumpLru(e){if(this.last===e)return;let r=this.last,s=e.next,n=e.prev;this.first===e&&(this.first=s),e.next=null,e.prev=r,r.next=e,n!==null&&(n.next=s),s!==null&&(s.prev=n),this.last=e}clear(){this.items=Object.create(null),this.first=null,this.last=null,this.size=0}delete(e){if(Object.prototype.hasOwnProperty.call(this.items,e)){let r=this.items[e];delete this.items[e],this.size--,r.prev!==null&&(r.prev.next=r.next),r.next!==null&&(r.next.prev=r.prev),this.first===r&&(this.first=r.next),this.last===r&&(this.last=r.prev)}}deleteMany(e){for(var r=0;r<e.length;r++)this.delete(e[r])}evict(){if(this.size>0){let e=this.first;delete this.items[e.key],--this.size===0?(this.first=null,this.last=null):(this.first=e.next,this.first.prev=null)}}expiresAt(e){if(Object.prototype.hasOwnProperty.call(this.items,e))return this.items[e].expiry}get(e){if(Object.prototype.hasOwnProperty.call(this.items,e)){let r=this.items[e];if(this.ttl>0&&r.expiry<=Date.now()){this.delete(e);return}return this.bumpLru(r),r.value}}getMany(e){let r=[];for(var s=0;s<e.length;s++)r.push(this.get(e[s]));return r}keys(){return Object.keys(this.items)}set(e,r){if(Object.prototype.hasOwnProperty.call(this.items,e)){let n=this.items[e];n.value=r,n.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl,this.last!==n&&this.bumpLru(n);return}this.max>0&&this.size===this.max&&this.evict();let s={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:e,prev:this.last,next:null,value:r};this.items[e]=s,++this.size===1?this.first=s:this.last.next=s,this.last=s}},Q0=class{constructor(){this.records={}}initForCache(e,r){this.records[e]={[r]:{cacheSize:0,hits:0,falsyHits:0,emptyHits:0,misses:0,expirations:0,evictions:0,invalidateOne:0,invalidateAll:0,sets:0}}}resetForCache(e){for(let r of Object.keys(this.records[e]))this.records[e][r]={cacheSize:0,hits:0,falsyHits:0,emptyHits:0,misses:0,expirations:0,evictions:0,invalidateOne:0,invalidateAll:0,sets:0}}getStatistics(){return this.records}};function mz(t){return`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getDate().toString().padStart(2,"0")}`}var sR=class{constructor(e,r,s){this.cacheId=e,this.statisticTtlInHours=r,this.collectionStart=new Date,this.currentTimeStamp=mz(this.collectionStart),this.records=s||new Q0,this.records.initForCache(this.cacheId,this.currentTimeStamp)}get currentRecord(){return this.records.records[this.cacheId][this.currentTimeStamp]||(this.records.records[this.cacheId][this.currentTimeStamp]={cacheSize:0,hits:0,falsyHits:0,emptyHits:0,misses:0,expirations:0,evictions:0,sets:0,invalidateOne:0,invalidateAll:0}),this.records.records[this.cacheId][this.currentTimeStamp]}hoursPassed(){return(Date.now()-this.collectionStart)/1e3/60/60}addHit(){this.archiveIfNeeded(),this.currentRecord.hits++}addFalsyHit(){this.archiveIfNeeded(),this.currentRecord.falsyHits++}addEmptyHit(){this.archiveIfNeeded(),this.currentRecord.emptyHits++}addMiss(){this.archiveIfNeeded(),this.currentRecord.misses++}addEviction(){this.archiveIfNeeded(),this.currentRecord.evictions++}setCacheSize(e){this.archiveIfNeeded(),this.currentRecord.cacheSize=e}addExpiration(){this.archiveIfNeeded(),this.currentRecord.expirations++}addSet(){this.archiveIfNeeded(),this.currentRecord.sets++}addInvalidateOne(){this.archiveIfNeeded(),this.currentRecord.invalidateOne++}addInvalidateAll(){this.archiveIfNeeded(),this.currentRecord.invalidateAll++}getStatistics(){return this.records.getStatistics()}archiveIfNeeded(){this.hoursPassed()>=this.statisticTtlInHours&&(this.collectionStart=new Date,this.currentTimeStamp=mz(this.collectionStart),this.records.initForCache(this.cacheId,this.currentTimeStamp))}},W0=class extends kp{constructor(e,r,s,n,i){if(super(e||1e3,r||0),!s)throw new Error("Cache id is mandatory");this.hitStatistics=new sR(s,i!==void 0?i:24,n)}getStatistics(){return this.hitStatistics.getStatistics()}set(e,r){super.set(e,r),this.hitStatistics.addSet(),this.hitStatistics.setCacheSize(this.size)}evict(){super.evict(),this.hitStatistics.addEviction(),this.hitStatistics.setCacheSize(this.size)}delete(e,r=!1){super.delete(e),r||this.hitStatistics.addInvalidateOne(),this.hitStatistics.setCacheSize(this.size)}clear(){super.clear(),this.hitStatistics.addInvalidateAll(),this.hitStatistics.setCacheSize(this.size)}get(e){if(Object.prototype.hasOwnProperty.call(this.items,e)){let r=this.items[e];if(this.ttl>0&&r.expiry<=Date.now()){this.delete(e,!0),this.hitStatistics.addExpiration();return}return this.bumpLru(r),r.value||this.hitStatistics.addFalsyHit(),(r.value===void 0||r.value===null||r.value==="")&&this.hitStatistics.addEmptyHit(),this.hitStatistics.addHit(),r.value}this.hitStatistics.addMiss()}},Z0=class{constructor(e=1e3,r=0){if(isNaN(e)||e<0)throw new Error("Invalid max value");if(isNaN(r)||r<0)throw new Error("Invalid ttl value");this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this.max=e,this.ttl=r}clear(){this.items=Object.create(null),this.first=null,this.last=null,this.size=0}delete(e){if(Object.prototype.hasOwnProperty.call(this.items,e)){let r=this.items[e];delete this.items[e],this.size--,r.prev!==null&&(r.prev.next=r.next),r.next!==null&&(r.next.prev=r.prev),this.first===r&&(this.first=r.next),this.last===r&&(this.last=r.prev)}}deleteMany(e){for(var r=0;r<e.length;r++)this.delete(e[r])}evict(){if(this.size>0){let e=this.first;delete this.items[e.key],--this.size===0?(this.first=null,this.last=null):(this.first=e.next,this.first.prev=null)}}expiresAt(e){if(Object.prototype.hasOwnProperty.call(this.items,e))return this.items[e].expiry}get(e){if(Object.prototype.hasOwnProperty.call(this.items,e)){let r=this.items[e];if(this.ttl>0&&r.expiry<=Date.now()){this.delete(e);return}return r.value}}getMany(e){let r=[];for(var s=0;s<e.length;s++)r.push(this.get(e[s]));return r}keys(){return Object.keys(this.items)}set(e,r){if(Object.prototype.hasOwnProperty.call(this.items,e)){let n=this.items[e];n.value=r,n.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl;return}this.max>0&&this.size===this.max&&this.evict();let s={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:e,prev:this.last,next:null,value:r};this.items[e]=s,++this.size===1?this.first=s:this.last.next=s,this.last=s}};Ui.Fifo=Z0;Ui.FifoMap=tR;Ui.FifoObject=Z0;Ui.HitStatisticsRecord=Q0;Ui.Lru=kp;Ui.LruHitStatistics=W0;Ui.LruMap=rR;Ui.LruObject=kp;Ui.LruObjectHitStatistics=W0});var Sz=m((Z6e,xp)=>{"use strict";var X0=function(){};X0.prototype=Object.create(null);var Y0=/; *([!#$%&'*+.^\w`|~-]+)=("(?:[\v\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\v\u0020-\u00ff])*"|[!#$%&'*+.^\w`|~-]+) */gu,J0=/\\([\v\u0020-\u00ff])/gu,yz=/^[!#$%&'*+.^\w|~-]+\/[!#$%&'*+.^\w|~-]+$/u,Cu={type:"",parameters:new X0};Object.freeze(Cu.parameters);Object.freeze(Cu);function vz(t){if(typeof t!="string")throw new TypeError("argument header is required and must be a string");let e=t.indexOf(";"),r=e!==-1?t.slice(0,e).trim():t.trim();if(yz.test(r)===!1)throw new TypeError("invalid media type");let s={type:r.toLowerCase(),parameters:new X0};if(e===-1)return s;let n,i,o;for(Y0.lastIndex=e;i=Y0.exec(t);){if(i.index!==e)throw new TypeError("invalid parameter format");e+=i[0].length,n=i[1].toLowerCase(),o=i[2],o[0]==='"'&&(o=o.slice(1,o.length-1),J0.test(o)&&(o=o.replace(J0,"$1"))),s.parameters[n]=o}if(e!==t.length)throw new TypeError("invalid parameter format");return s}function _z(t){if(typeof t!="string")return Cu;let e=t.indexOf(";"),r=e!==-1?t.slice(0,e).trim():t.trim();if(yz.test(r)===!1)return Cu;let s={type:r.toLowerCase(),parameters:new X0};if(e===-1)return s;let n,i,o;for(Y0.lastIndex=e;i=Y0.exec(t);){if(i.index!==e)return Cu;e+=i[0].length,n=i[1].toLowerCase(),o=i[2],o[0]==='"'&&(o=o.slice(1,o.length-1),J0.test(o)&&(o=o.replace(J0,"$1"))),s.parameters[n]=o}return e!==t.length?Cu:s}xp.exports.default={parse:vz,safeParse:_z};xp.exports.parse=vz;xp.exports.safeParse=_z;xp.exports.defaultContentType=Cu});var Cz=m((Y6e,md)=>{"use strict";var Ohe=typeof Buffer<"u",bz=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,Ez=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function wz(t,e,r){r==null&&e!==null&&typeof e=="object"&&(r=e,e=void 0),Ohe&&Buffer.isBuffer(t)&&(t=t.toString()),t&&t.charCodeAt(0)===65279&&(t=t.slice(1));let s=JSON.parse(t,e);if(s===null||typeof s!="object")return s;let n=r&&r.protoAction||"error",i=r&&r.constructorAction||"error";if(n==="ignore"&&i==="ignore")return s;if(n!=="ignore"&&i!=="ignore"){if(bz.test(t)===!1&&Ez.test(t)===!1)return s}else if(n!=="ignore"&&i==="ignore"){if(bz.test(t)===!1)return s}else if(Ez.test(t)===!1)return s;return Tz(s,{protoAction:n,constructorAction:i,safe:r&&r.safe})}function Tz(t,{protoAction:e="error",constructorAction:r="error",safe:s}={}){let n=[t];for(;n.length;){let i=n;n=[];for(let o of i){if(e!=="ignore"&&Object.prototype.hasOwnProperty.call(o,"__proto__")){if(s===!0)return null;if(e==="error")throw new SyntaxError("Object contains forbidden prototype property");delete o.__proto__}if(r!=="ignore"&&Object.prototype.hasOwnProperty.call(o,"constructor")&&Object.prototype.hasOwnProperty.call(o.constructor,"prototype")){if(s===!0)return null;if(r==="error")throw new SyntaxError("Object contains forbidden prototype property");delete o.constructor}for(let a in o){let l=o[a];l&&typeof l=="object"&&n.push(l)}}}return t}function nR(t,e,r){let s=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return wz(t,e,r)}finally{Error.stackTraceLimit=s}}function Phe(t,e){let r=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return wz(t,e,{safe:!0})}catch{return null}finally{Error.stackTraceLimit=r}}md.exports=nR;md.exports.default=nR;md.exports.parse=nR;md.exports.safeParse=Phe;md.exports.scan=Tz});var uR=m((J6e,Np)=>{"use strict";var{AsyncResource:Ahe}=require("node:async_hooks"),{FifoMap:Oz}=gz(),{safeParse:Pz,defaultContentType:khe}=Sz(),xhe=Cz(),{kDefaultJsonParse:Ip,kContentTypeParser:gd,kBodyLimit:Ihe,kRequestPayloadStream:Az,kState:oR,kTestInternals:Nhe,kReplyIsError:kz,kRouteContext:Dhe}=xr(),{FST_ERR_CTP_INVALID_TYPE:xz,FST_ERR_CTP_EMPTY_TYPE:Mhe,FST_ERR_CTP_ALREADY_PRESENT:$he,FST_ERR_CTP_INVALID_HANDLER:qhe,FST_ERR_CTP_INVALID_PARSE_TYPE:Lhe,FST_ERR_CTP_BODY_TOO_LARGE:Rz,FST_ERR_CTP_INVALID_MEDIA_TYPE:jhe,FST_ERR_CTP_INVALID_CONTENT_LENGTH:Fhe,FST_ERR_CTP_EMPTY_JSON_BODY:Bhe,FST_ERR_CTP_INSTANCE_ALREADY_STARTED:aR}=rs();function Go(t,e,r){this[Ip]=Nz(e,r),this.customParsers=new Map,this.customParsers.set("application/json",new iR(!0,!1,t,this[Ip])),this.customParsers.set("text/plain",new iR(!0,!1,t,lR)),this.parserList=[new ev("application/json"),new ev("text/plain")],this.parserRegExpList=[],this.cache=new Oz(100)}Go.prototype.add=function(t,e,r){let s=typeof t=="string";if(!s&&!(t instanceof RegExp))throw new xz;if(s&&t.length===0)throw new Mhe;if(typeof r!="function")throw new qhe;if(this.existingParser(t))throw new $he(t);if(e.parseAs!==void 0&&e.parseAs!=="string"&&e.parseAs!=="buffer")throw new Lhe(e.parseAs);let n=new iR(e.parseAs==="string",e.parseAs==="buffer",e.bodyLimit,r);s&&t==="*"?this.customParsers.set("",n):(s?this.parserList.unshift(new ev(t)):(t.isEssence=t.source.indexOf(";")===-1,this.parserRegExpList.unshift(t)),this.customParsers.set(t.toString(),n))};Go.prototype.hasParser=function(t){return this.customParsers.has(typeof t=="string"?t:t.toString())};Go.prototype.existingParser=function(t){return t==="application/json"&&this.customParsers.has(t)?this.customParsers.get(t).fn!==this[Ip]:t==="text/plain"&&this.customParsers.has(t)?this.customParsers.get(t).fn!==lR:this.hasParser(t)};Go.prototype.getParser=function(t){if(this.hasParser(t))return this.customParsers.get(t);let e=this.cache.get(t);if(e!==void 0)return e;let r=Pz(t);if(r===khe)return this.customParsers.get("");for(var s=0;s!==this.parserList.length;++s){let i=this.parserList[s];if(Khe(r,i)){let o=this.customParsers.get(i.name);return this.cache.set(t,o),o}}for(var n=0;n!==this.parserRegExpList.length;++n){let i=this.parserRegExpList[n];if(Qhe(t,r.type,i)){let o=this.customParsers.get(i.toString());return this.cache.set(t,o),o}}return this.customParsers.get("")};Go.prototype.removeAll=function(){this.customParsers=new Map,this.parserRegExpList=[],this.parserList=[],this.cache=new Oz(100)};Go.prototype.remove=function(t){if(!(typeof t=="string"||t instanceof RegExp))throw new xz;let e=this.customParsers.delete(t.toString()),r=typeof t=="string"?this.parserList:this.parserRegExpList,s=r.findIndex(n=>n.toString()===t.toString());return s>-1&&r.splice(s,1),e||s>-1};Go.prototype.run=function(t,e,r,s){let n=this.getParser(t);if(n===void 0){r.is404?e(r,s):s.send(new jhe(t||void 0));return}let i=new Ahe("content-type-parser:run",r);if(n.asString===!0||n.asBuffer===!0)Iz(r,s,s[Dhe]._parserOptions,n,o);else{let a=n.fn(r,r[Az],o);a&&typeof a.then=="function"&&a.then(l=>o(null,l),o)}function o(a,l){i.runInAsyncScope(()=>{i.emitDestroy(),a?(s[kz]=!0,s.send(a)):(r.body=l,e(r,s))})}};function Iz(t,e,r,s,n){let i=s.asString,o=r.limit===null?s.bodyLimit:r.limit,a=t.headers["content-length"]===void 0?NaN:Number(t.headers["content-length"]);if(a>o){e.header("connection","close"),e.send(new Rz);return}let l=0,u=i===!0?"":[],c=t[Az]||t.raw;i===!0&&c.setEncoding("utf8"),c.on("data",d),c.on("end",f),c.on("error",f),c.resume();function d(h){l+=h.length;let{receivedEncodedLength:p=0}=c;if(l>o||p>o){c.removeListener("data",d),c.removeListener("end",f),c.removeListener("error",f),e.send(new Rz);return}i===!0?u+=h:u.push(h)}function f(h){if(c.removeListener("data",d),c.removeListener("end",f),c.removeListener("error",f),h!==void 0){typeof h.statusCode=="number"&&h.statusCode>=400||(h.statusCode=400),e[kz]=!0,e.code(h.statusCode).send(h);return}if(i===!0&&(l=Buffer.byteLength(u)),!Number.isNaN(a)&&(c.receivedEncodedLength||l)!==a){e.header("connection","close"),e.send(new Fhe);return}i===!1&&(u=Buffer.concat(u));let p=s.fn(t,u,n);p&&typeof p.then=="function"&&p.then(g=>n(null,g),n)}}function Nz(t,e){return r;function r(s,n,i){if(n===""||n==null||Buffer.isBuffer(n)&&n.length===0)return i(new Bhe,void 0);let o;try{o=xhe.parse(n,{protoAction:t,constructorAction:e})}catch(a){return a.statusCode=400,i(a,void 0)}i(null,o)}}function lR(t,e,r){r(null,e)}function iR(t,e,r,s){this.asString=t,this.asBuffer=e,this.bodyLimit=r,this.fn=s}function zhe(t){let e=new Go;return e[Ip]=t[Ip],e.customParsers=new Map(t.customParsers.entries()),e.parserList=t.parserList.slice(),e.parserRegExpList=t.parserRegExpList.slice(),e}function Uhe(t,e,r){if(this[oR].started)throw new aR("addContentTypeParser");return typeof e=="function"&&(r=e,e={}),e||(e={}),e.bodyLimit||(e.bodyLimit=this[Ihe]),Array.isArray(t)?t.forEach(s=>this[gd].add(s,e,r)):this[gd].add(t,e,r),this}function Vhe(t){return this[gd].hasParser(t)}function Hhe(t){if(this[oR].started)throw new aR("removeContentTypeParser");if(Array.isArray(t))for(let e of t)this[gd].remove(e);else this[gd].remove(t)}function Ghe(){if(this[oR].started)throw new aR("removeAllContentTypeParsers");this[gd].removeAll()}function Khe(t,e){if(e.isEssence)return t.type.indexOf(e)!==-1;if(t.type.indexOf(e.type)===-1)return!1;for(let r of e.parameterKeys)if(!(r in t.parameters)||t.parameters[r]!==e.parameters[r])return!1;return!0}function Qhe(t,e,r){return r.isEssence?r.test(e):r.test(t)}function ev(t){this.name=t;let e=Pz(t);if(this.isEssence=t.indexOf(";")===-1,this.isEssence===!1&&e.type===""){let r=t.split(";",1)[0];this.type=r===""?t:r}else this.type=e.type;this.parameters=e.parameters,this.parameterKeys=Object.keys(e.parameters)}ev.prototype.toString=function(){return this.name};Np.exports=Go;Np.exports.helpers={buildContentTypeParser:zhe,addContentTypeParser:Uhe,hasContentTypeParser:Vhe,removeContentTypeParser:Hhe,removeAllContentTypeParsers:Ghe};Np.exports.defaultParsers={getDefaultJsonParser:Nz,defaultTextParser:lR};Np.exports[Nhe]={rawBody:Iz}});var Fa=m((X6e,Dz)=>{"use strict";Dz.exports=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var s,n,i;if(Array.isArray(e)){if(s=e.length,s!=r.length)return!1;for(n=s;n--!==0;)if(!t(e[n],r[n]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(i=Object.keys(e),s=i.length,s!==Object.keys(r).length)return!1;for(n=s;n--!==0;)if(!Object.prototype.hasOwnProperty.call(r,i[n]))return!1;for(n=s;n--!==0;){var o=i[n];if(!t(e[o],r[o]))return!1}return!0}return e!==e&&r!==r}});var Lz=m((e9e,qz)=>{"use strict";var Mz=Fa(),Whe=Symbol.for("json-schema-ref"),cR=class{#e;#t;#s;#n;#i;constructor(e={}){this.#e={},this.#t={},this.#s=e.insertRefSymbol??!1,this.#n=e.allowEqualDuplicates??!0,this.#i=e.cloneSchemaWithoutRefs??!1}addSchema(e,r){e.$id!==void 0&&e.$id.charAt(0)!=="#"?r=e.$id:this.#u(e,r),this.#a(e,r)}getSchema(e,r="#"){let s=this.#e[e];if(s===void 0)throw new Error(`Cannot resolve ref "${e}${r}". Schema with id "${e}" is not found.`);return s.anchors[r]!==void 0?s.anchors[r]:$z(s.schema,r)}hasSchema(e){return this.#e[e]!==void 0}getSchemaRefs(e){let r=this.#e[e];if(r===void 0)throw new Error(`Schema with id "${e}" is not found.`);return r.refs}getSchemaDependencies(e,r={}){let s=this.#e[e];for(let n of s.refs){let i=n.schemaId;r[i]===void 0&&(r[i]=this.getSchema(i),this.getSchemaDependencies(i,r))}return r}derefSchema(e){if(this.#t[e]!==void 0)return;let r=this.#e[e];if(r===void 0)throw new Error(`Schema with id "${e}" is not found.`);!this.#i&&r.refs.length===0&&(this.#t[e]={schema:r.schema,anchors:r.anchors});let s=[];this.#r(r.schema,e,s);let n=this.getSchemaDependencies(e);for(let i in n){let o=n[i];this.#r(o,i,s)}for(let i of s){let{refSchemaId:o,refJsonPointer:a}=this.#o(i.ref,i.sourceSchemaId),l=this.getDerefSchema(o,a);if(l===null)throw new Error(`Cannot resolve ref "${i.ref}". Ref "${a}" is not found in schema "${o}".`);i.targetSchema=l,i.targetSchemaId=o}for(let i of s)this.#l(i,s)}getDerefSchema(e,r="#"){let s=this.#t[e];return s===void 0&&(this.derefSchema(e),s=this.#t[e]),s.anchors[r]!==void 0?s.anchors[r]:$z(s.schema,r)}#o(e,r){let s=e.indexOf("#");return s===-1?{refSchemaId:e,refJsonPointer:"#"}:s===0?{refSchemaId:r,refJsonPointer:e}:{refSchemaId:e.slice(0,s),refJsonPointer:e.slice(s)}}#a(e,r){let s=e.$id;s!==void 0&&typeof s=="string"&&(s.charAt(0)==="#"?this.#c(e,r,s):(this.#u(e,s),r=s));let n=e.$ref;if(n!==void 0&&typeof n=="string"){let{refSchemaId:i,refJsonPointer:o}=this.#o(n,r);this.#e[r].refs.push({schemaId:i,jsonPointer:o})}for(let i in e)typeof e[i]=="object"&&e[i]!==null&&this.#a(e[i],r)}#r(e,r,s=[]){let n=Array.isArray(e)?[...e]:{...e},i=n.$id;i!==void 0&&typeof i=="string"&&(i.charAt(0)==="#"?this.#f(n,r,i):(this.#d(n,i),r=i)),n.$ref!==void 0&&s.push({ref:n.$ref,sourceSchemaId:r,sourceSchema:n});for(let o in n){let a=n[o];typeof a=="object"&&a!==null&&(n[o]=this.#r(a,r,s))}return n}#l(e,r){let{sourceSchema:s,targetSchema:n}=e;if(s.$ref){if(this.#s&&(s[Whe]=s.$ref),delete s.$ref,n.$ref){let i=r.find(o=>o.sourceSchema===n);this.#l(i,r)}for(let i in n)if(i!=="$id"){if(s[i]!==void 0){if(Mz(s[i],n[i]))continue;throw new Error(`Cannot resolve ref "${e.ref}". Property "${i}" is already exist in schema "${e.sourceSchemaId}".`)}s[i]=n[i]}e.isResolved=!0}}#u(e,r){let s=this.#e[r];if(s!==void 0){if(this.#n&&Mz(e,s.schema))return;throw new Error(`There is already another schema with id "${r}".`)}this.#e[r]={schema:e,anchors:{},refs:[]}}#c(e,r,s){let{anchors:n}=this.#e[r];if(n[s]!==void 0)throw new Error(`There is already another anchor "${s}" in a schema "${r}".`);n[s]=e}#d(e,r){this.#t[r]===void 0&&(this.#t[r]={schema:e,anchors:{}})}#f(e,r,s){let{anchors:n}=this.#t[r];n[s]=e}};function $z(t,e){let r=e.split("/"),s=t;for(let n of r)if(!(n===""||n==="#")){if(typeof s!="object"||s===null)return null;s=s[n]}return s??null}qz.exports={RefResolver:cR}});var yd=m(ct=>{"use strict";Object.defineProperty(ct,"__esModule",{value:!0});ct.regexpCode=ct.getEsmExportName=ct.getProperty=ct.safeStringify=ct.stringify=ct.strConcat=ct.addCodeArg=ct.str=ct._=ct.nil=ct._Code=ct.Name=ct.IDENTIFIER=ct._CodeOrName=void 0;var Dp=class{};ct._CodeOrName=Dp;ct.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;var Ru=class extends Dp{constructor(e){if(super(),!ct.IDENTIFIER.test(e))throw new Error("CodeGen: name must be a valid identifier");this.str=e}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}};ct.Name=Ru;var Rn=class extends Dp{constructor(e){super(),this._items=typeof e=="string"?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;let e=this._items[0];return e===""||e==='""'}get str(){var e;return(e=this._str)!==null&&e!==void 0?e:this._str=this._items.reduce((r,s)=>`${r}${s}`,"")}get names(){var e;return(e=this._names)!==null&&e!==void 0?e:this._names=this._items.reduce((r,s)=>(s instanceof Ru&&(r[s.str]=(r[s.str]||0)+1),r),{})}};ct._Code=Rn;ct.nil=new Rn("");function jz(t,...e){let r=[t[0]],s=0;for(;s<e.length;)fR(r,e[s]),r.push(t[++s]);return new Rn(r)}ct._=jz;var dR=new Rn("+");function Fz(t,...e){let r=[Mp(t[0])],s=0;for(;s<e.length;)r.push(dR),fR(r,e[s]),r.push(dR,Mp(t[++s]));return Zhe(r),new Rn(r)}ct.str=Fz;function fR(t,e){e instanceof Rn?t.push(...e._items):e instanceof Ru?t.push(e):t.push(Xhe(e))}ct.addCodeArg=fR;function Zhe(t){let e=1;for(;e<t.length-1;){if(t[e]===dR){let r=Yhe(t[e-1],t[e+1]);if(r!==void 0){t.splice(e-1,3,r);continue}t[e++]="+"}e++}}function Yhe(t,e){if(e==='""')return t;if(t==='""')return e;if(typeof t=="string")return e instanceof Ru||t[t.length-1]!=='"'?void 0:typeof e!="string"?`${t.slice(0,-1)}${e}"`:e[0]==='"'?t.slice(0,-1)+e.slice(1):void 0;if(typeof e=="string"&&e[0]==='"'&&!(t instanceof Ru))return`"${t}${e.slice(1)}`}function Jhe(t,e){return e.emptyStr()?t:t.emptyStr()?e:Fz`${t}${e}`}ct.strConcat=Jhe;function Xhe(t){return typeof t=="number"||typeof t=="boolean"||t===null?t:Mp(Array.isArray(t)?t.join(","):t)}function epe(t){return new Rn(Mp(t))}ct.stringify=epe;function Mp(t){return JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}ct.safeStringify=Mp;function tpe(t){return typeof t=="string"&&ct.IDENTIFIER.test(t)?new Rn(`.${t}`):jz`[${t}]`}ct.getProperty=tpe;function rpe(t){if(typeof t=="string"&&ct.IDENTIFIER.test(t))return new Rn(`${t}`);throw new Error(`CodeGen: invalid export name: ${t}, use explicit $id name mapping`)}ct.getEsmExportName=rpe;function spe(t){return new Rn(t.toString())}ct.regexpCode=spe});var nv=m(Ms=>{"use strict";Object.defineProperty(Ms,"__esModule",{value:!0});Ms.ValueScope=Ms.ValueScopeName=Ms.Scope=Ms.varKinds=Ms.UsedValueState=void 0;var Ds=yd(),hR=class extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`),this.value=e.value}},tv;(function(t){t[t.Started=0]="Started",t[t.Completed=1]="Completed"})(tv||(Ms.UsedValueState=tv={}));Ms.varKinds={const:new Ds.Name("const"),let:new Ds.Name("let"),var:new Ds.Name("var")};var rv=class{constructor({prefixes:e,parent:r}={}){this._names={},this._prefixes=e,this._parent=r}toName(e){return e instanceof Ds.Name?e:this.name(e)}name(e){return new Ds.Name(this._newName(e))}_newName(e){let r=this._names[e]||this._nameGroup(e);return`${e}${r.index++}`}_nameGroup(e){var r,s;if(!((s=(r=this._parent)===null||r===void 0?void 0:r._prefixes)===null||s===void 0)&&s.has(e)||this._prefixes&&!this._prefixes.has(e))throw new Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}};Ms.Scope=rv;var sv=class extends Ds.Name{constructor(e,r){super(r),this.prefix=e}setValue(e,{property:r,itemIndex:s}){this.value=e,this.scopePath=(0,Ds._)`.${new Ds.Name(r)}[${s}]`}};Ms.ValueScopeName=sv;var npe=(0,Ds._)`\n`,pR=class extends rv{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts={...e,_n:e.lines?npe:Ds.nil}}get(){return this._scope}name(e){return new sv(e,this._newName(e))}value(e,r){var s;if(r.ref===void 0)throw new Error("CodeGen: ref must be passed in value");let n=this.toName(e),{prefix:i}=n,o=(s=r.key)!==null&&s!==void 0?s:r.ref,a=this._values[i];if(a){let c=a.get(o);if(c)return c}else a=this._values[i]=new Map;a.set(o,n);let l=this._scope[i]||(this._scope[i]=[]),u=l.length;return l[u]=r.ref,n.setValue(r,{property:i,itemIndex:u}),n}getValue(e,r){let s=this._values[e];if(s)return s.get(r)}scopeRefs(e,r=this._values){return this._reduceValues(r,s=>{if(s.scopePath===void 0)throw new Error(`CodeGen: name "${s}" has no value`);return(0,Ds._)`${e}${s.scopePath}`})}scopeCode(e=this._values,r,s){return this._reduceValues(e,n=>{if(n.value===void 0)throw new Error(`CodeGen: name "${n}" has no value`);return n.value.code},r,s)}_reduceValues(e,r,s={},n){let i=Ds.nil;for(let o in e){let a=e[o];if(!a)continue;let l=s[o]=s[o]||new Map;a.forEach(u=>{if(l.has(u))return;l.set(u,tv.Started);let c=r(u);if(c){let d=this.opts.es5?Ms.varKinds.var:Ms.varKinds.const;i=(0,Ds._)`${i}${d} ${u} = ${c};${this.opts._n}`}else if(c=n?.(u))i=(0,Ds._)`${i}${c}${this.opts._n}`;else throw new hR(u);l.set(u,tv.Completed)})}return i}};Ms.ValueScope=pR});var Te=m(Ue=>{"use strict";Object.defineProperty(Ue,"__esModule",{value:!0});Ue.or=Ue.and=Ue.not=Ue.CodeGen=Ue.operators=Ue.varKinds=Ue.ValueScopeName=Ue.ValueScope=Ue.Scope=Ue.Name=Ue.regexpCode=Ue.stringify=Ue.getProperty=Ue.nil=Ue.strConcat=Ue.str=Ue._=void 0;var et=yd(),di=nv(),Ba=yd();Object.defineProperty(Ue,"_",{enumerable:!0,get:function(){return Ba._}});Object.defineProperty(Ue,"str",{enumerable:!0,get:function(){return Ba.str}});Object.defineProperty(Ue,"strConcat",{enumerable:!0,get:function(){return Ba.strConcat}});Object.defineProperty(Ue,"nil",{enumerable:!0,get:function(){return Ba.nil}});Object.defineProperty(Ue,"getProperty",{enumerable:!0,get:function(){return Ba.getProperty}});Object.defineProperty(Ue,"stringify",{enumerable:!0,get:function(){return Ba.stringify}});Object.defineProperty(Ue,"regexpCode",{enumerable:!0,get:function(){return Ba.regexpCode}});Object.defineProperty(Ue,"Name",{enumerable:!0,get:function(){return Ba.Name}});var lv=nv();Object.defineProperty(Ue,"Scope",{enumerable:!0,get:function(){return lv.Scope}});Object.defineProperty(Ue,"ValueScope",{enumerable:!0,get:function(){return lv.ValueScope}});Object.defineProperty(Ue,"ValueScopeName",{enumerable:!0,get:function(){return lv.ValueScopeName}});Object.defineProperty(Ue,"varKinds",{enumerable:!0,get:function(){return lv.varKinds}});Ue.operators={GT:new et._Code(">"),GTE:new et._Code(">="),LT:new et._Code("<"),LTE:new et._Code("<="),EQ:new et._Code("==="),NEQ:new et._Code("!=="),NOT:new et._Code("!"),OR:new et._Code("||"),AND:new et._Code("&&"),ADD:new et._Code("+")};var Ko=class{optimizeNodes(){return this}optimizeNames(e,r){return this}},mR=class extends Ko{constructor(e,r,s){super(),this.varKind=e,this.name=r,this.rhs=s}render({es5:e,_n:r}){let s=e?di.varKinds.var:this.varKind,n=this.rhs===void 0?"":` = ${this.rhs}`;return`${s} ${this.name}${n};`+r}optimizeNames(e,r){if(e[this.name.str])return this.rhs&&(this.rhs=_d(this.rhs,e,r)),this}get names(){return this.rhs instanceof et._CodeOrName?this.rhs.names:{}}},iv=class extends Ko{constructor(e,r,s){super(),this.lhs=e,this.rhs=r,this.sideEffects=s}render({_n:e}){return`${this.lhs} = ${this.rhs};`+e}optimizeNames(e,r){if(!(this.lhs instanceof et.Name&&!e[this.lhs.str]&&!this.sideEffects))return this.rhs=_d(this.rhs,e,r),this}get names(){let e=this.lhs instanceof et.Name?{}:{...this.lhs.names};return av(e,this.rhs)}},gR=class extends iv{constructor(e,r,s,n){super(e,s,n),this.op=r}render({_n:e}){return`${this.lhs} ${this.op}= ${this.rhs};`+e}},yR=class extends Ko{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`${this.label}:`+e}},vR=class extends Ko{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`break${this.label?` ${this.label}`:""};`+e}},_R=class extends Ko{constructor(e){super(),this.error=e}render({_n:e}){return`throw ${this.error};`+e}get names(){return this.error.names}},SR=class extends Ko{constructor(e){super(),this.code=e}render({_n:e}){return`${this.code};`+e}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(e,r){return this.code=_d(this.code,e,r),this}get names(){return this.code instanceof et._CodeOrName?this.code.names:{}}},$p=class extends Ko{constructor(e=[]){super(),this.nodes=e}render(e){return this.nodes.reduce((r,s)=>r+s.render(e),"")}optimizeNodes(){let{nodes:e}=this,r=e.length;for(;r--;){let s=e[r].optimizeNodes();Array.isArray(s)?e.splice(r,1,...s):s?e[r]=s:e.splice(r,1)}return e.length>0?this:void 0}optimizeNames(e,r){let{nodes:s}=this,n=s.length;for(;n--;){let i=s[n];i.optimizeNames(e,r)||(ipe(e,i.names),s.splice(n,1))}return s.length>0?this:void 0}get names(){return this.nodes.reduce((e,r)=>Pu(e,r.names),{})}},Qo=class extends $p{render(e){return"{"+e._n+super.render(e)+"}"+e._n}},bR=class extends $p{},vd=class extends Qo{};vd.kind="else";var fi=class extends Qo{constructor(e,r){super(r),this.condition=e}render(e){let r=`if(${this.condition})`+super.render(e);return this.else&&(r+="else "+this.else.render(e)),r}optimizeNodes(){super.optimizeNodes();let e=this.condition;if(e===!0)return this.nodes;let r=this.else;if(r){let s=r.optimizeNodes();r=this.else=Array.isArray(s)?new vd(s):s}if(r)return e===!1?r instanceof fi?r:r.nodes:this.nodes.length?this:new fi(Bz(e),r instanceof fi?[r]:r.nodes);if(!(e===!1||!this.nodes.length))return this}optimizeNames(e,r){var s;if(this.else=(s=this.else)===null||s===void 0?void 0:s.optimizeNames(e,r),!!(super.optimizeNames(e,r)||this.else))return this.condition=_d(this.condition,e,r),this}get names(){let e=super.names;return av(e,this.condition),this.else&&Pu(e,this.else.names),e}};fi.kind="if";var Ou=class extends Qo{};Ou.kind="for";var ER=class extends Ou{constructor(e){super(),this.iteration=e}render(e){return`for(${this.iteration})`+super.render(e)}optimizeNames(e,r){if(super.optimizeNames(e,r))return this.iteration=_d(this.iteration,e,r),this}get names(){return Pu(super.names,this.iteration.names)}},wR=class extends Ou{constructor(e,r,s,n){super(),this.varKind=e,this.name=r,this.from=s,this.to=n}render(e){let r=e.es5?di.varKinds.var:this.varKind,{name:s,from:n,to:i}=this;return`for(${r} ${s}=${n}; ${s}<${i}; ${s}++)`+super.render(e)}get names(){let e=av(super.names,this.from);return av(e,this.to)}},ov=class extends Ou{constructor(e,r,s,n){super(),this.loop=e,this.varKind=r,this.name=s,this.iterable=n}render(e){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(e)}optimizeNames(e,r){if(super.optimizeNames(e,r))return this.iterable=_d(this.iterable,e,r),this}get names(){return Pu(super.names,this.iterable.names)}},qp=class extends Qo{constructor(e,r,s){super(),this.name=e,this.args=r,this.async=s}render(e){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(e)}};qp.kind="func";var Lp=class extends $p{render(e){return"return "+super.render(e)}};Lp.kind="return";var TR=class extends Qo{render(e){let r="try"+super.render(e);return this.catch&&(r+=this.catch.render(e)),this.finally&&(r+=this.finally.render(e)),r}optimizeNodes(){var e,r;return super.optimizeNodes(),(e=this.catch)===null||e===void 0||e.optimizeNodes(),(r=this.finally)===null||r===void 0||r.optimizeNodes(),this}optimizeNames(e,r){var s,n;return super.optimizeNames(e,r),(s=this.catch)===null||s===void 0||s.optimizeNames(e,r),(n=this.finally)===null||n===void 0||n.optimizeNames(e,r),this}get names(){let e=super.names;return this.catch&&Pu(e,this.catch.names),this.finally&&Pu(e,this.finally.names),e}},jp=class extends Qo{constructor(e){super(),this.error=e}render(e){return`catch(${this.error})`+super.render(e)}};jp.kind="catch";var Fp=class extends Qo{render(e){return"finally"+super.render(e)}};Fp.kind="finally";var CR=class{constructor(e,r={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...r,_n:r.lines?`
`:""},this._extScope=e,this._scope=new di.Scope({parent:e}),this._nodes=[new bR]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,r){let s=this._extScope.value(e,r);return(this._values[s.prefix]||(this._values[s.prefix]=new Set)).add(s),s}getScopeValue(e,r){return this._extScope.getValue(e,r)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,r,s,n){let i=this._scope.toName(r);return s!==void 0&&n&&(this._constants[i.str]=s),this._leafNode(new mR(e,i,s)),i}const(e,r,s){return this._def(di.varKinds.const,e,r,s)}let(e,r,s){return this._def(di.varKinds.let,e,r,s)}var(e,r,s){return this._def(di.varKinds.var,e,r,s)}assign(e,r,s){return this._leafNode(new iv(e,r,s))}add(e,r){return this._leafNode(new gR(e,Ue.operators.ADD,r))}code(e){return typeof e=="function"?e():e!==et.nil&&this._leafNode(new SR(e)),this}object(...e){let r=["{"];for(let[s,n]of e)r.length>1&&r.push(","),r.push(s),(s!==n||this.opts.es5)&&(r.push(":"),(0,et.addCodeArg)(r,n));return r.push("}"),new et._Code(r)}if(e,r,s){if(this._blockNode(new fi(e)),r&&s)this.code(r).else().code(s).endIf();else if(r)this.code(r).endIf();else if(s)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new fi(e))}else(){return this._elseNode(new vd)}endIf(){return this._endBlockNode(fi,vd)}_for(e,r){return this._blockNode(e),r&&this.code(r).endFor(),this}for(e,r){return this._for(new ER(e),r)}forRange(e,r,s,n,i=this.opts.es5?di.varKinds.var:di.varKinds.let){let o=this._scope.toName(e);return this._for(new wR(i,o,r,s),()=>n(o))}forOf(e,r,s,n=di.varKinds.const){let i=this._scope.toName(e);if(this.opts.es5){let o=r instanceof et.Name?r:this.var("_arr",r);return this.forRange("_i",0,(0,et._)`${o}.length`,a=>{this.var(i,(0,et._)`${o}[${a}]`),s(i)})}return this._for(new ov("of",n,i,r),()=>s(i))}forIn(e,r,s,n=this.opts.es5?di.varKinds.var:di.varKinds.const){if(this.opts.ownProperties)return this.forOf(e,(0,et._)`Object.keys(${r})`,s);let i=this._scope.toName(e);return this._for(new ov("in",n,i,r),()=>s(i))}endFor(){return this._endBlockNode(Ou)}label(e){return this._leafNode(new yR(e))}break(e){return this._leafNode(new vR(e))}return(e){let r=new Lp;if(this._blockNode(r),this.code(e),r.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(Lp)}try(e,r,s){if(!r&&!s)throw new Error('CodeGen: "try" without "catch" and "finally"');let n=new TR;if(this._blockNode(n),this.code(e),r){let i=this.name("e");this._currNode=n.catch=new jp(i),r(i)}return s&&(this._currNode=n.finally=new Fp,this.code(s)),this._endBlockNode(jp,Fp)}throw(e){return this._leafNode(new _R(e))}block(e,r){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(r),this}endBlock(e){let r=this._blockStarts.pop();if(r===void 0)throw new Error("CodeGen: not in self-balancing block");let s=this._nodes.length-r;if(s<0||e!==void 0&&s!==e)throw new Error(`CodeGen: wrong number of nodes: ${s} vs ${e} expected`);return this._nodes.length=r,this}func(e,r=et.nil,s,n){return this._blockNode(new qp(e,r,s)),n&&this.code(n).endFunc(),this}endFunc(){return this._endBlockNode(qp)}optimize(e=1){for(;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,r){let s=this._currNode;if(s instanceof e||r&&s instanceof r)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${r?`${e.kind}/${r.kind}`:e.kind}"`)}_elseNode(e){let r=this._currNode;if(!(r instanceof fi))throw new Error('CodeGen: "else" without "if"');return this._currNode=r.else=e,this}get _root(){return this._nodes[0]}get _currNode(){let e=this._nodes;return e[e.length-1]}set _currNode(e){let r=this._nodes;r[r.length-1]=e}};Ue.CodeGen=CR;function Pu(t,e){for(let r in e)t[r]=(t[r]||0)+(e[r]||0);return t}function av(t,e){return e instanceof et._CodeOrName?Pu(t,e.names):t}function _d(t,e,r){if(t instanceof et.Name)return s(t);if(!n(t))return t;return new et._Code(t._items.reduce((i,o)=>(o instanceof et.Name&&(o=s(o)),o instanceof et._Code?i.push(...o._items):i.push(o),i),[]));function s(i){let o=r[i.str];return o===void 0||e[i.str]!==1?i:(delete e[i.str],o)}function n(i){return i instanceof et._Code&&i._items.some(o=>o instanceof et.Name&&e[o.str]===1&&r[o.str]!==void 0)}}function ipe(t,e){for(let r in e)t[r]=(t[r]||0)-(e[r]||0)}function Bz(t){return typeof t=="boolean"||typeof t=="number"||t===null?!t:(0,et._)`!${RR(t)}`}Ue.not=Bz;var ope=zz(Ue.operators.AND);function ape(...t){return t.reduce(ope)}Ue.and=ape;var lpe=zz(Ue.operators.OR);function upe(...t){return t.reduce(lpe)}Ue.or=upe;function zz(t){return(e,r)=>e===et.nil?r:r===et.nil?e:(0,et._)`${RR(e)} ${t} ${RR(r)}`}function RR(t){return t instanceof et.Name?t:(0,et._)`(${t})`}});var ze=m(He=>{"use strict";Object.defineProperty(He,"__esModule",{value:!0});He.checkStrictMode=He.getErrorPath=He.Type=He.useFunc=He.setEvaluated=He.evaluatedPropsToName=He.mergeEvaluated=He.eachItem=He.unescapeJsonPointer=He.escapeJsonPointer=He.escapeFragment=He.unescapeFragment=He.schemaRefOrVal=He.schemaHasRulesButRef=He.schemaHasRules=He.checkUnknownRules=He.alwaysValidSchema=He.toHash=void 0;var Pt=Te(),cpe=yd();function dpe(t){let e={};for(let r of t)e[r]=!0;return e}He.toHash=dpe;function fpe(t,e){return typeof e=="boolean"?e:Object.keys(e).length===0?!0:(Hz(t,e),!Gz(e,t.self.RULES.all))}He.alwaysValidSchema=fpe;function Hz(t,e=t.schema){let{opts:r,self:s}=t;if(!r.strictSchema||typeof e=="boolean")return;let n=s.RULES.keywords;for(let i in e)n[i]||Wz(t,`unknown keyword: "${i}"`)}He.checkUnknownRules=Hz;function Gz(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(e[r])return!0;return!1}He.schemaHasRules=Gz;function hpe(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(r!=="$ref"&&e.all[r])return!0;return!1}He.schemaHasRulesButRef=hpe;function ppe({topSchemaRef:t,schemaPath:e},r,s,n){if(!n){if(typeof r=="number"||typeof r=="boolean")return r;if(typeof r=="string")return(0,Pt._)`${r}`}return(0,Pt._)`${t}${e}${(0,Pt.getProperty)(s)}`}He.schemaRefOrVal=ppe;function mpe(t){return Kz(decodeURIComponent(t))}He.unescapeFragment=mpe;function gpe(t){return encodeURIComponent(PR(t))}He.escapeFragment=gpe;function PR(t){return typeof t=="number"?`${t}`:t.replace(/~/g,"~0").replace(/\//g,"~1")}He.escapeJsonPointer=PR;function Kz(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}He.unescapeJsonPointer=Kz;function ype(t,e){if(Array.isArray(t))for(let r of t)e(r);else e(t)}He.eachItem=ype;function Uz({mergeNames:t,mergeToName:e,mergeValues:r,resultToName:s}){return(n,i,o,a)=>{let l=o===void 0?i:o instanceof Pt.Name?(i instanceof Pt.Name?t(n,i,o):e(n,i,o),o):i instanceof Pt.Name?(e(n,o,i),i):r(i,o);return a===Pt.Name&&!(l instanceof Pt.Name)?s(n,l):l}}He.mergeEvaluated={props:Uz({mergeNames:(t,e,r)=>t.if((0,Pt._)`${r} !== true && ${e} !== undefined`,()=>{t.if((0,Pt._)`${e} === true`,()=>t.assign(r,!0),()=>t.assign(r,(0,Pt._)`${r} || {}`).code((0,Pt._)`Object.assign(${r}, ${e})`))}),mergeToName:(t,e,r)=>t.if((0,Pt._)`${r} !== true`,()=>{e===!0?t.assign(r,!0):(t.assign(r,(0,Pt._)`${r} || {}`),AR(t,r,e))}),mergeValues:(t,e)=>t===!0?!0:{...t,...e},resultToName:Qz}),items:Uz({mergeNames:(t,e,r)=>t.if((0,Pt._)`${r} !== true && ${e} !== undefined`,()=>t.assign(r,(0,Pt._)`${e} === true ? true : ${r} > ${e} ? ${r} : ${e}`)),mergeToName:(t,e,r)=>t.if((0,Pt._)`${r} !== true`,()=>t.assign(r,e===!0?!0:(0,Pt._)`${r} > ${e} ? ${r} : ${e}`)),mergeValues:(t,e)=>t===!0?!0:Math.max(t,e),resultToName:(t,e)=>t.var("items",e)})};function Qz(t,e){if(e===!0)return t.var("props",!0);let r=t.var("props",(0,Pt._)`{}`);return e!==void 0&&AR(t,r,e),r}He.evaluatedPropsToName=Qz;function AR(t,e,r){Object.keys(r).forEach(s=>t.assign((0,Pt._)`${e}${(0,Pt.getProperty)(s)}`,!0))}He.setEvaluated=AR;var Vz={};function vpe(t,e){return t.scopeValue("func",{ref:e,code:Vz[e.code]||(Vz[e.code]=new cpe._Code(e.code))})}He.useFunc=vpe;var OR;(function(t){t[t.Num=0]="Num",t[t.Str=1]="Str"})(OR||(He.Type=OR={}));function _pe(t,e,r){if(t instanceof Pt.Name){let s=e===OR.Num;return r?s?(0,Pt._)`"[" + ${t} + "]"`:(0,Pt._)`"['" + ${t} + "']"`:s?(0,Pt._)`"/" + ${t}`:(0,Pt._)`"/" + ${t}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return r?(0,Pt.getProperty)(t).toString():"/"+PR(t)}He.getErrorPath=_pe;function Wz(t,e,r=t.opts.strictSchema){if(r){if(e=`strict mode: ${e}`,r===!0)throw new Error(e);t.self.logger.warn(e)}}He.checkStrictMode=Wz});var On=m(kR=>{"use strict";Object.defineProperty(kR,"__esModule",{value:!0});var is=Te(),Spe={data:new is.Name("data"),valCxt:new is.Name("valCxt"),instancePath:new is.Name("instancePath"),parentData:new is.Name("parentData"),parentDataProperty:new is.Name("parentDataProperty"),rootData:new is.Name("rootData"),dynamicAnchors:new is.Name("dynamicAnchors"),vErrors:new is.Name("vErrors"),errors:new is.Name("errors"),this:new is.Name("this"),self:new is.Name("self"),scope:new is.Name("scope"),json:new is.Name("json"),jsonPos:new is.Name("jsonPos"),jsonLen:new is.Name("jsonLen"),jsonPart:new is.Name("jsonPart")};kR.default=Spe});var Bp=m(os=>{"use strict";Object.defineProperty(os,"__esModule",{value:!0});os.extendErrors=os.resetErrorsCount=os.reportExtraError=os.reportError=os.keyword$DataError=os.keywordError=void 0;var it=Te(),uv=ze(),Ss=On();os.keywordError={message:({keyword:t})=>(0,it.str)`must pass "${t}" keyword validation`};os.keyword$DataError={message:({keyword:t,schemaType:e})=>e?(0,it.str)`"${t}" keyword must be ${e} ($data)`:(0,it.str)`"${t}" keyword is invalid ($data)`};function bpe(t,e=os.keywordError,r,s){let{it:n}=t,{gen:i,compositeRule:o,allErrors:a}=n,l=Jz(t,e,r);s??(o||a)?Zz(i,l):Yz(n,(0,it._)`[${l}]`)}os.reportError=bpe;function Epe(t,e=os.keywordError,r){let{it:s}=t,{gen:n,compositeRule:i,allErrors:o}=s,a=Jz(t,e,r);Zz(n,a),i||o||Yz(s,Ss.default.vErrors)}os.reportExtraError=Epe;function wpe(t,e){t.assign(Ss.default.errors,e),t.if((0,it._)`${Ss.default.vErrors} !== null`,()=>t.if(e,()=>t.assign((0,it._)`${Ss.default.vErrors}.length`,e),()=>t.assign(Ss.default.vErrors,null)))}os.resetErrorsCount=wpe;function Tpe({gen:t,keyword:e,schemaValue:r,data:s,errsCount:n,it:i}){if(n===void 0)throw new Error("ajv implementation error");let o=t.name("err");t.forRange("i",n,Ss.default.errors,a=>{t.const(o,(0,it._)`${Ss.default.vErrors}[${a}]`),t.if((0,it._)`${o}.instancePath === undefined`,()=>t.assign((0,it._)`${o}.instancePath`,(0,it.strConcat)(Ss.default.instancePath,i.errorPath))),t.assign((0,it._)`${o}.schemaPath`,(0,it.str)`${i.errSchemaPath}/${e}`),i.opts.verbose&&(t.assign((0,it._)`${o}.schema`,r),t.assign((0,it._)`${o}.data`,s))})}os.extendErrors=Tpe;function Zz(t,e){let r=t.const("err",e);t.if((0,it._)`${Ss.default.vErrors} === null`,()=>t.assign(Ss.default.vErrors,(0,it._)`[${r}]`),(0,it._)`${Ss.default.vErrors}.push(${r})`),t.code((0,it._)`${Ss.default.errors}++`)}function Yz(t,e){let{gen:r,validateName:s,schemaEnv:n}=t;n.$async?r.throw((0,it._)`new ${t.ValidationError}(${e})`):(r.assign((0,it._)`${s}.errors`,e),r.return(!1))}var Au={keyword:new it.Name("keyword"),schemaPath:new it.Name("schemaPath"),params:new it.Name("params"),propertyName:new it.Name("propertyName"),message:new it.Name("message"),schema:new it.Name("schema"),parentSchema:new it.Name("parentSchema")};function Jz(t,e,r){let{createErrors:s}=t.it;return s===!1?(0,it._)`{}`:Cpe(t,e,r)}function Cpe(t,e,r={}){let{gen:s,it:n}=t,i=[Rpe(n,r),Ope(t,r)];return Ppe(t,e,i),s.object(...i)}function Rpe({errorPath:t},{instancePath:e}){let r=e?(0,it.str)`${t}${(0,uv.getErrorPath)(e,uv.Type.Str)}`:t;return[Ss.default.instancePath,(0,it.strConcat)(Ss.default.instancePath,r)]}function Ope({keyword:t,it:{errSchemaPath:e}},{schemaPath:r,parentSchema:s}){let n=s?e:(0,it.str)`${e}/${t}`;return r&&(n=(0,it.str)`${n}${(0,uv.getErrorPath)(r,uv.Type.Str)}`),[Au.schemaPath,n]}function Ppe(t,{params:e,message:r},s){let{keyword:n,data:i,schemaValue:o,it:a}=t,{opts:l,propertyName:u,topSchemaRef:c,schemaPath:d}=a;s.push([Au.keyword,n],[Au.params,typeof e=="function"?e(t):e||(0,it._)`{}`]),l.messages&&s.push([Au.message,typeof r=="function"?r(t):r]),l.verbose&&s.push([Au.schema,o],[Au.parentSchema,(0,it._)`${c}${d}`],[Ss.default.data,i]),u&&s.push([Au.propertyName,u])}});var eU=m(Sd=>{"use strict";Object.defineProperty(Sd,"__esModule",{value:!0});Sd.boolOrEmptySchema=Sd.topBoolOrEmptySchema=void 0;var Ape=Bp(),kpe=Te(),xpe=On(),Ipe={message:"boolean schema is false"};function Npe(t){let{gen:e,schema:r,validateName:s}=t;r===!1?Xz(t,!1):typeof r=="object"&&r.$async===!0?e.return(xpe.default.data):(e.assign((0,kpe._)`${s}.errors`,null),e.return(!0))}Sd.topBoolOrEmptySchema=Npe;function Dpe(t,e){let{gen:r,schema:s}=t;s===!1?(r.var(e,!1),Xz(t)):r.var(e,!0)}Sd.boolOrEmptySchema=Dpe;function Xz(t,e){let{gen:r,data:s}=t,n={gen:r,keyword:"false schema",data:s,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:t};(0,Ape.reportError)(n,Ipe,void 0,e)}});var xR=m(bd=>{"use strict";Object.defineProperty(bd,"__esModule",{value:!0});bd.getRules=bd.isJSONType=void 0;var Mpe=["string","number","integer","boolean","null","object","array"],$pe=new Set(Mpe);function qpe(t){return typeof t=="string"&&$pe.has(t)}bd.isJSONType=qpe;function Lpe(){let t={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...t,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},t.number,t.string,t.array,t.object],post:{rules:[]},all:{},keywords:{}}}bd.getRules=Lpe});var IR=m(za=>{"use strict";Object.defineProperty(za,"__esModule",{value:!0});za.shouldUseRule=za.shouldUseGroup=za.schemaHasRulesForType=void 0;function jpe({schema:t,self:e},r){let s=e.RULES.types[r];return s&&s!==!0&&tU(t,s)}za.schemaHasRulesForType=jpe;function tU(t,e){return e.rules.some(r=>rU(t,r))}za.shouldUseGroup=tU;function rU(t,e){var r;return t[e.keyword]!==void 0||((r=e.definition.implements)===null||r===void 0?void 0:r.some(s=>t[s]!==void 0))}za.shouldUseRule=rU});var zp=m(as=>{"use strict";Object.defineProperty(as,"__esModule",{value:!0});as.reportTypeError=as.checkDataTypes=as.checkDataType=as.coerceAndCheckDataType=as.getJSONTypes=as.getSchemaTypes=as.DataType=void 0;var Fpe=xR(),Bpe=IR(),zpe=Bp(),Be=Te(),sU=ze(),Ed;(function(t){t[t.Correct=0]="Correct",t[t.Wrong=1]="Wrong"})(Ed||(as.DataType=Ed={}));function Upe(t){let e=nU(t.type);if(e.includes("null")){if(t.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!e.length&&t.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');t.nullable===!0&&e.push("null")}return e}as.getSchemaTypes=Upe;function nU(t){let e=Array.isArray(t)?t:t?[t]:[];if(e.every(Fpe.isJSONType))return e;throw new Error("type must be JSONType or JSONType[]: "+e.join(","))}as.getJSONTypes=nU;function Vpe(t,e){let{gen:r,data:s,opts:n}=t,i=Hpe(e,n.coerceTypes),o=e.length>0&&!(i.length===0&&e.length===1&&(0,Bpe.schemaHasRulesForType)(t,e[0]));if(o){let a=DR(e,s,n.strictNumbers,Ed.Wrong);r.if(a,()=>{i.length?Gpe(t,e,i):MR(t)})}return o}as.coerceAndCheckDataType=Vpe;var iU=new Set(["string","number","integer","boolean","null"]);function Hpe(t,e){return e?t.filter(r=>iU.has(r)||e==="array"&&r==="array"):[]}function Gpe(t,e,r){let{gen:s,data:n,opts:i}=t,o=s.let("dataType",(0,Be._)`typeof ${n}`),a=s.let("coerced",(0,Be._)`undefined`);i.coerceTypes==="array"&&s.if((0,Be._)`${o} == 'object' && Array.isArray(${n}) && ${n}.length == 1`,()=>s.assign(n,(0,Be._)`${n}[0]`).assign(o,(0,Be._)`typeof ${n}`).if(DR(e,n,i.strictNumbers),()=>s.assign(a,n))),s.if((0,Be._)`${a} !== undefined`);for(let u of r)(iU.has(u)||u==="array"&&i.coerceTypes==="array")&&l(u);s.else(),MR(t),s.endIf(),s.if((0,Be._)`${a} !== undefined`,()=>{s.assign(n,a),Kpe(t,a)});function l(u){switch(u){case"string":s.elseIf((0,Be._)`${o} == "number" || ${o} == "boolean"`).assign(a,(0,Be._)`"" + ${n}`).elseIf((0,Be._)`${n} === null`).assign(a,(0,Be._)`""`);return;case"number":s.elseIf((0,Be._)`${o} == "boolean" || ${n} === null
              || (${o} == "string" && ${n} && ${n} == +${n})`).assign(a,(0,Be._)`+${n}`);return;case"integer":s.elseIf((0,Be._)`${o} === "boolean" || ${n} === null
              || (${o} === "string" && ${n} && ${n} == +${n} && !(${n} % 1))`).assign(a,(0,Be._)`+${n}`);return;case"boolean":s.elseIf((0,Be._)`${n} === "false" || ${n} === 0 || ${n} === null`).assign(a,!1).elseIf((0,Be._)`${n} === "true" || ${n} === 1`).assign(a,!0);return;case"null":s.elseIf((0,Be._)`${n} === "" || ${n} === 0 || ${n} === false`),s.assign(a,null);return;case"array":s.elseIf((0,Be._)`${o} === "string" || ${o} === "number"
              || ${o} === "boolean" || ${n} === null`).assign(a,(0,Be._)`[${n}]`)}}}function Kpe({gen:t,parentData:e,parentDataProperty:r},s){t.if((0,Be._)`${e} !== undefined`,()=>t.assign((0,Be._)`${e}[${r}]`,s))}function NR(t,e,r,s=Ed.Correct){let n=s===Ed.Correct?Be.operators.EQ:Be.operators.NEQ,i;switch(t){case"null":return(0,Be._)`${e} ${n} null`;case"array":i=(0,Be._)`Array.isArray(${e})`;break;case"object":i=(0,Be._)`${e} && typeof ${e} == "object" && !Array.isArray(${e})`;break;case"integer":i=o((0,Be._)`!(${e} % 1) && !isNaN(${e})`);break;case"number":i=o();break;default:return(0,Be._)`typeof ${e} ${n} ${t}`}return s===Ed.Correct?i:(0,Be.not)(i);function o(a=Be.nil){return(0,Be.and)((0,Be._)`typeof ${e} == "number"`,a,r?(0,Be._)`isFinite(${e})`:Be.nil)}}as.checkDataType=NR;function DR(t,e,r,s){if(t.length===1)return NR(t[0],e,r,s);let n,i=(0,sU.toHash)(t);if(i.array&&i.object){let o=(0,Be._)`typeof ${e} != "object"`;n=i.null?o:(0,Be._)`!${e} || ${o}`,delete i.null,delete i.array,delete i.object}else n=Be.nil;i.number&&delete i.integer;for(let o in i)n=(0,Be.and)(n,NR(o,e,r,s));return n}as.checkDataTypes=DR;var Qpe={message:({schema:t})=>`must be ${t}`,params:({schema:t,schemaValue:e})=>typeof t=="string"?(0,Be._)`{type: ${t}}`:(0,Be._)`{type: ${e}}`};function MR(t){let e=Wpe(t);(0,zpe.reportError)(e,Qpe)}as.reportTypeError=MR;function Wpe(t){let{gen:e,data:r,schema:s}=t,n=(0,sU.schemaRefOrVal)(t,s,"type");return{gen:e,keyword:"type",data:r,schema:s.type,schemaCode:n,schemaValue:n,parentSchema:s,params:{},it:t}}});var aU=m(cv=>{"use strict";Object.defineProperty(cv,"__esModule",{value:!0});cv.assignDefaults=void 0;var wd=Te(),Zpe=ze();function Ype(t,e){let{properties:r,items:s}=t.schema;if(e==="object"&&r)for(let n in r)oU(t,n,r[n].default);else e==="array"&&Array.isArray(s)&&s.forEach((n,i)=>oU(t,i,n.default))}cv.assignDefaults=Ype;function oU(t,e,r){let{gen:s,compositeRule:n,data:i,opts:o}=t;if(r===void 0)return;let a=(0,wd._)`${i}${(0,wd.getProperty)(e)}`;if(n){(0,Zpe.checkStrictMode)(t,`default is ignored for: ${a}`);return}let l=(0,wd._)`${a} === undefined`;o.useDefaults==="empty"&&(l=(0,wd._)`${l} || ${a} === null || ${a} === ""`),s.if(l,(0,wd._)`${a} = ${(0,wd.stringify)(r)}`)}});var Vr=m(wt=>{"use strict";Object.defineProperty(wt,"__esModule",{value:!0});wt.validateUnion=wt.validateArray=wt.usePattern=wt.callValidateCode=wt.schemaProperties=wt.allSchemaProperties=wt.noPropertyInData=wt.propertyInData=wt.isOwnProperty=wt.hasPropFunc=wt.reportMissingProp=wt.checkMissingProp=wt.checkReportMissingProp=void 0;var jt=Te(),$R=ze(),Ua=On(),Jpe=ze();function Xpe(t,e){let{gen:r,data:s,it:n}=t;r.if(LR(r,s,e,n.opts.ownProperties),()=>{t.setParams({missingProperty:(0,jt._)`${e}`},!0),t.error()})}wt.checkReportMissingProp=Xpe;function eme({gen:t,data:e,it:{opts:r}},s,n){return(0,jt.or)(...s.map(i=>(0,jt.and)(LR(t,e,i,r.ownProperties),(0,jt._)`${n} = ${i}`)))}wt.checkMissingProp=eme;function tme(t,e){t.setParams({missingProperty:e},!0),t.error()}wt.reportMissingProp=tme;function lU(t){return t.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,jt._)`Object.prototype.hasOwnProperty`})}wt.hasPropFunc=lU;function qR(t,e,r){return(0,jt._)`${lU(t)}.call(${e}, ${r})`}wt.isOwnProperty=qR;function rme(t,e,r,s){let n=(0,jt._)`${e}${(0,jt.getProperty)(r)} !== undefined`;return s?(0,jt._)`${n} && ${qR(t,e,r)}`:n}wt.propertyInData=rme;function LR(t,e,r,s){let n=(0,jt._)`${e}${(0,jt.getProperty)(r)} === undefined`;return s?(0,jt.or)(n,(0,jt.not)(qR(t,e,r))):n}wt.noPropertyInData=LR;function uU(t){return t?Object.keys(t).filter(e=>e!=="__proto__"):[]}wt.allSchemaProperties=uU;function sme(t,e){return uU(e).filter(r=>!(0,$R.alwaysValidSchema)(t,e[r]))}wt.schemaProperties=sme;function nme({schemaCode:t,data:e,it:{gen:r,topSchemaRef:s,schemaPath:n,errorPath:i},it:o},a,l,u){let c=u?(0,jt._)`${t}, ${e}, ${s}${n}`:e,d=[[Ua.default.instancePath,(0,jt.strConcat)(Ua.default.instancePath,i)],[Ua.default.parentData,o.parentData],[Ua.default.parentDataProperty,o.parentDataProperty],[Ua.default.rootData,Ua.default.rootData]];o.opts.dynamicRef&&d.push([Ua.default.dynamicAnchors,Ua.default.dynamicAnchors]);let f=(0,jt._)`${c}, ${r.object(...d)}`;return l!==jt.nil?(0,jt._)`${a}.call(${l}, ${f})`:(0,jt._)`${a}(${f})`}wt.callValidateCode=nme;var ime=(0,jt._)`new RegExp`;function ome({gen:t,it:{opts:e}},r){let s=e.unicodeRegExp?"u":"",{regExp:n}=e.code,i=n(r,s);return t.scopeValue("pattern",{key:i.toString(),ref:i,code:(0,jt._)`${n.code==="new RegExp"?ime:(0,Jpe.useFunc)(t,n)}(${r}, ${s})`})}wt.usePattern=ome;function ame(t){let{gen:e,data:r,keyword:s,it:n}=t,i=e.name("valid");if(n.allErrors){let a=e.let("valid",!0);return o(()=>e.assign(a,!1)),a}return e.var(i,!0),o(()=>e.break()),i;function o(a){let l=e.const("len",(0,jt._)`${r}.length`);e.forRange("i",0,l,u=>{t.subschema({keyword:s,dataProp:u,dataPropType:$R.Type.Num},i),e.if((0,jt.not)(i),a)})}}wt.validateArray=ame;function lme(t){let{gen:e,schema:r,keyword:s,it:n}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some(l=>(0,$R.alwaysValidSchema)(n,l))&&!n.opts.unevaluated)return;let o=e.let("valid",!1),a=e.name("_valid");e.block(()=>r.forEach((l,u)=>{let c=t.subschema({keyword:s,schemaProp:u,compositeRule:!0},a);e.assign(o,(0,jt._)`${o} || ${a}`),t.mergeValidEvaluated(c,a)||e.if((0,jt.not)(o))})),t.result(o,()=>t.reset(),()=>t.error(!0))}wt.validateUnion=lme});var fU=m(Vi=>{"use strict";Object.defineProperty(Vi,"__esModule",{value:!0});Vi.validateKeywordUsage=Vi.validSchemaType=Vi.funcKeywordCode=Vi.macroKeywordCode=void 0;var bs=Te(),ku=On(),ume=Vr(),cme=Bp();function dme(t,e){let{gen:r,keyword:s,schema:n,parentSchema:i,it:o}=t,a=e.macro.call(o.self,n,i,o),l=dU(r,s,a);o.opts.validateSchema!==!1&&o.self.validateSchema(a,!0);let u=r.name("valid");t.subschema({schema:a,schemaPath:bs.nil,errSchemaPath:`${o.errSchemaPath}/${s}`,topSchemaRef:l,compositeRule:!0},u),t.pass(u,()=>t.error(!0))}Vi.macroKeywordCode=dme;function fme(t,e){var r;let{gen:s,keyword:n,schema:i,parentSchema:o,$data:a,it:l}=t;pme(l,e);let u=!a&&e.compile?e.compile.call(l.self,i,o,l):e.validate,c=dU(s,n,u),d=s.let("valid");t.block$data(d,f),t.ok((r=e.valid)!==null&&r!==void 0?r:d);function f(){if(e.errors===!1)g(),e.modifying&&cU(t),_(()=>t.error());else{let S=e.async?h():p();e.modifying&&cU(t),_(()=>hme(t,S))}}function h(){let S=s.let("ruleErrs",null);return s.try(()=>g((0,bs._)`await `),b=>s.assign(d,!1).if((0,bs._)`${b} instanceof ${l.ValidationError}`,()=>s.assign(S,(0,bs._)`${b}.errors`),()=>s.throw(b))),S}function p(){let S=(0,bs._)`${c}.errors`;return s.assign(S,null),g(bs.nil),S}function g(S=e.async?(0,bs._)`await `:bs.nil){let b=l.opts.passContext?ku.default.this:ku.default.self,v=!("compile"in e&&!a||e.schema===!1);s.assign(d,(0,bs._)`${S}${(0,ume.callValidateCode)(t,c,b,v)}`,e.modifying)}function _(S){var b;s.if((0,bs.not)((b=e.valid)!==null&&b!==void 0?b:d),S)}}Vi.funcKeywordCode=fme;function cU(t){let{gen:e,data:r,it:s}=t;e.if(s.parentData,()=>e.assign(r,(0,bs._)`${s.parentData}[${s.parentDataProperty}]`))}function hme(t,e){let{gen:r}=t;r.if((0,bs._)`Array.isArray(${e})`,()=>{r.assign(ku.default.vErrors,(0,bs._)`${ku.default.vErrors} === null ? ${e} : ${ku.default.vErrors}.concat(${e})`).assign(ku.default.errors,(0,bs._)`${ku.default.vErrors}.length`),(0,cme.extendErrors)(t)},()=>t.error())}function pme({schemaEnv:t},e){if(e.async&&!t.$async)throw new Error("async keyword in sync schema")}function dU(t,e,r){if(r===void 0)throw new Error(`keyword "${e}" failed to compile`);return t.scopeValue("keyword",typeof r=="function"?{ref:r}:{ref:r,code:(0,bs.stringify)(r)})}function mme(t,e,r=!1){return!e.length||e.some(s=>s==="array"?Array.isArray(t):s==="object"?t&&typeof t=="object"&&!Array.isArray(t):typeof t==s||r&&typeof t>"u")}Vi.validSchemaType=mme;function gme({schema:t,opts:e,self:r,errSchemaPath:s},n,i){if(Array.isArray(n.keyword)?!n.keyword.includes(i):n.keyword!==i)throw new Error("ajv implementation error");let o=n.dependencies;if(o?.some(a=>!Object.prototype.hasOwnProperty.call(t,a)))throw new Error(`parent schema must have dependencies of ${i}: ${o.join(",")}`);if(n.validateSchema&&!n.validateSchema(t[i])){let l=`keyword "${i}" value is invalid at path "${s}": `+r.errorsText(n.validateSchema.errors);if(e.validateSchema==="log")r.logger.error(l);else throw new Error(l)}}Vi.validateKeywordUsage=gme});var pU=m(Va=>{"use strict";Object.defineProperty(Va,"__esModule",{value:!0});Va.extendSubschemaMode=Va.extendSubschemaData=Va.getSubschema=void 0;var Hi=Te(),hU=ze();function yme(t,{keyword:e,schemaProp:r,schema:s,schemaPath:n,errSchemaPath:i,topSchemaRef:o}){if(e!==void 0&&s!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(e!==void 0){let a=t.schema[e];return r===void 0?{schema:a,schemaPath:(0,Hi._)`${t.schemaPath}${(0,Hi.getProperty)(e)}`,errSchemaPath:`${t.errSchemaPath}/${e}`}:{schema:a[r],schemaPath:(0,Hi._)`${t.schemaPath}${(0,Hi.getProperty)(e)}${(0,Hi.getProperty)(r)}`,errSchemaPath:`${t.errSchemaPath}/${e}/${(0,hU.escapeFragment)(r)}`}}if(s!==void 0){if(n===void 0||i===void 0||o===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:s,schemaPath:n,topSchemaRef:o,errSchemaPath:i}}throw new Error('either "keyword" or "schema" must be passed')}Va.getSubschema=yme;function vme(t,e,{dataProp:r,dataPropType:s,data:n,dataTypes:i,propertyName:o}){if(n!==void 0&&r!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');let{gen:a}=e;if(r!==void 0){let{errorPath:u,dataPathArr:c,opts:d}=e,f=a.let("data",(0,Hi._)`${e.data}${(0,Hi.getProperty)(r)}`,!0);l(f),t.errorPath=(0,Hi.str)`${u}${(0,hU.getErrorPath)(r,s,d.jsPropertySyntax)}`,t.parentDataProperty=(0,Hi._)`${r}`,t.dataPathArr=[...c,t.parentDataProperty]}if(n!==void 0){let u=n instanceof Hi.Name?n:a.let("data",n,!0);l(u),o!==void 0&&(t.propertyName=o)}i&&(t.dataTypes=i);function l(u){t.data=u,t.dataLevel=e.dataLevel+1,t.dataTypes=[],e.definedProperties=new Set,t.parentData=e.data,t.dataNames=[...e.dataNames,u]}}Va.extendSubschemaData=vme;function _me(t,{jtdDiscriminator:e,jtdMetadata:r,compositeRule:s,createErrors:n,allErrors:i}){s!==void 0&&(t.compositeRule=s),n!==void 0&&(t.createErrors=n),i!==void 0&&(t.allErrors=i),t.jtdDiscriminator=e,t.jtdMetadata=r}Va.extendSubschemaMode=_me});var gU=m((m9e,mU)=>{"use strict";var Ha=mU.exports=function(t,e,r){typeof e=="function"&&(r=e,e={}),r=e.cb||r;var s=typeof r=="function"?r:r.pre||function(){},n=r.post||function(){};dv(e,s,n,t,"",t)};Ha.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};Ha.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};Ha.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};Ha.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function dv(t,e,r,s,n,i,o,a,l,u){if(s&&typeof s=="object"&&!Array.isArray(s)){e(s,n,i,o,a,l,u);for(var c in s){var d=s[c];if(Array.isArray(d)){if(c in Ha.arrayKeywords)for(var f=0;f<d.length;f++)dv(t,e,r,d[f],n+"/"+c+"/"+f,i,n,c,s,f)}else if(c in Ha.propsKeywords){if(d&&typeof d=="object")for(var h in d)dv(t,e,r,d[h],n+"/"+c+"/"+Sme(h),i,n,c,s,h)}else(c in Ha.keywords||t.allKeys&&!(c in Ha.skipKeywords))&&dv(t,e,r,d,n+"/"+c,i,n,c,s)}r(s,n,i,o,a,l,u)}}function Sme(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}});var Up=m($s=>{"use strict";Object.defineProperty($s,"__esModule",{value:!0});$s.getSchemaRefs=$s.resolveUrl=$s.normalizeId=$s._getFullPath=$s.getFullPath=$s.inlineRef=void 0;var bme=ze(),Eme=Fa(),wme=gU(),Tme=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function Cme(t,e=!0){return typeof t=="boolean"?!0:e===!0?!jR(t):e?yU(t)<=e:!1}$s.inlineRef=Cme;var Rme=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function jR(t){for(let e in t){if(Rme.has(e))return!0;let r=t[e];if(Array.isArray(r)&&r.some(jR)||typeof r=="object"&&jR(r))return!0}return!1}function yU(t){let e=0;for(let r in t){if(r==="$ref")return 1/0;if(e++,!Tme.has(r)&&(typeof t[r]=="object"&&(0,bme.eachItem)(t[r],s=>e+=yU(s)),e===1/0))return 1/0}return e}function vU(t,e="",r){r!==!1&&(e=Td(e));let s=t.parse(e);return _U(t,s)}$s.getFullPath=vU;function _U(t,e){return t.serialize(e).split("#")[0]+"#"}$s._getFullPath=_U;var Ome=/#\/?$/;function Td(t){return t?t.replace(Ome,""):""}$s.normalizeId=Td;function Pme(t,e,r){return r=Td(r),t.resolve(e,r)}$s.resolveUrl=Pme;var Ame=/^[a-z_][-a-z0-9._]*$/i;function kme(t,e){if(typeof t=="boolean")return{};let{schemaId:r,uriResolver:s}=this.opts,n=Td(t[r]||e),i={"":n},o=vU(s,n,!1),a={},l=new Set;return wme(t,{allKeys:!0},(d,f,h,p)=>{if(p===void 0)return;let g=o+f,_=i[p];typeof d[r]=="string"&&(_=S.call(this,d[r])),b.call(this,d.$anchor),b.call(this,d.$dynamicAnchor),i[f]=_;function S(v){let y=this.opts.uriResolver.resolve;if(v=Td(_?y(_,v):v),l.has(v))throw c(v);l.add(v);let R=this.refs[v];return typeof R=="string"&&(R=this.refs[R]),typeof R=="object"?u(d,R.schema,v):v!==Td(g)&&(v[0]==="#"?(u(d,a[v],v),a[v]=d):this.refs[v]=g),v}function b(v){if(typeof v=="string"){if(!Ame.test(v))throw new Error(`invalid anchor "${v}"`);S.call(this,`#${v}`)}}}),a;function u(d,f,h){if(f!==void 0&&!Eme(d,f))throw c(h)}function c(d){return new Error(`reference "${d}" resolves to more than one schema`)}}$s.getSchemaRefs=kme});var Cd=m(Ga=>{"use strict";Object.defineProperty(Ga,"__esModule",{value:!0});Ga.getData=Ga.KeywordCxt=Ga.validateFunctionCode=void 0;var TU=eU(),SU=zp(),BR=IR(),fv=zp(),xme=aU(),Hp=fU(),FR=pU(),ge=Te(),Ie=On(),Ime=Up(),Wo=ze(),Vp=Bp();function Nme(t){if(OU(t)&&(PU(t),RU(t))){$me(t);return}CU(t,()=>(0,TU.topBoolOrEmptySchema)(t))}Ga.validateFunctionCode=Nme;function CU({gen:t,validateName:e,schema:r,schemaEnv:s,opts:n},i){n.code.es5?t.func(e,(0,ge._)`${Ie.default.data}, ${Ie.default.valCxt}`,s.$async,()=>{t.code((0,ge._)`"use strict"; ${bU(r,n)}`),Mme(t,n),t.code(i)}):t.func(e,(0,ge._)`${Ie.default.data}, ${Dme(n)}`,s.$async,()=>t.code(bU(r,n)).code(i))}function Dme(t){return(0,ge._)`{${Ie.default.instancePath}="", ${Ie.default.parentData}, ${Ie.default.parentDataProperty}, ${Ie.default.rootData}=${Ie.default.data}${t.dynamicRef?(0,ge._)`, ${Ie.default.dynamicAnchors}={}`:ge.nil}}={}`}function Mme(t,e){t.if(Ie.default.valCxt,()=>{t.var(Ie.default.instancePath,(0,ge._)`${Ie.default.valCxt}.${Ie.default.instancePath}`),t.var(Ie.default.parentData,(0,ge._)`${Ie.default.valCxt}.${Ie.default.parentData}`),t.var(Ie.default.parentDataProperty,(0,ge._)`${Ie.default.valCxt}.${Ie.default.parentDataProperty}`),t.var(Ie.default.rootData,(0,ge._)`${Ie.default.valCxt}.${Ie.default.rootData}`),e.dynamicRef&&t.var(Ie.default.dynamicAnchors,(0,ge._)`${Ie.default.valCxt}.${Ie.default.dynamicAnchors}`)},()=>{t.var(Ie.default.instancePath,(0,ge._)`""`),t.var(Ie.default.parentData,(0,ge._)`undefined`),t.var(Ie.default.parentDataProperty,(0,ge._)`undefined`),t.var(Ie.default.rootData,Ie.default.data),e.dynamicRef&&t.var(Ie.default.dynamicAnchors,(0,ge._)`{}`)})}function $me(t){let{schema:e,opts:r,gen:s}=t;CU(t,()=>{r.$comment&&e.$comment&&kU(t),Bme(t),s.let(Ie.default.vErrors,null),s.let(Ie.default.errors,0),r.unevaluated&&qme(t),AU(t),Vme(t)})}function qme(t){let{gen:e,validateName:r}=t;t.evaluated=e.const("evaluated",(0,ge._)`${r}.evaluated`),e.if((0,ge._)`${t.evaluated}.dynamicProps`,()=>e.assign((0,ge._)`${t.evaluated}.props`,(0,ge._)`undefined`)),e.if((0,ge._)`${t.evaluated}.dynamicItems`,()=>e.assign((0,ge._)`${t.evaluated}.items`,(0,ge._)`undefined`))}function bU(t,e){let r=typeof t=="object"&&t[e.schemaId];return r&&(e.code.source||e.code.process)?(0,ge._)`/*# sourceURL=${r} */`:ge.nil}function Lme(t,e){if(OU(t)&&(PU(t),RU(t))){jme(t,e);return}(0,TU.boolOrEmptySchema)(t,e)}function RU({schema:t,self:e}){if(typeof t=="boolean")return!t;for(let r in t)if(e.RULES.all[r])return!0;return!1}function OU(t){return typeof t.schema!="boolean"}function jme(t,e){let{schema:r,gen:s,opts:n}=t;n.$comment&&r.$comment&&kU(t),zme(t),Ume(t);let i=s.const("_errs",Ie.default.errors);AU(t,i),s.var(e,(0,ge._)`${i} === ${Ie.default.errors}`)}function PU(t){(0,Wo.checkUnknownRules)(t),Fme(t)}function AU(t,e){if(t.opts.jtd)return EU(t,[],!1,e);let r=(0,SU.getSchemaTypes)(t.schema),s=(0,SU.coerceAndCheckDataType)(t,r);EU(t,r,!s,e)}function Fme(t){let{schema:e,errSchemaPath:r,opts:s,self:n}=t;e.$ref&&s.ignoreKeywordsWithRef&&(0,Wo.schemaHasRulesButRef)(e,n.RULES)&&n.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}function Bme(t){let{schema:e,opts:r}=t;e.default!==void 0&&r.useDefaults&&r.strictSchema&&(0,Wo.checkStrictMode)(t,"default is ignored in the schema root")}function zme(t){let e=t.schema[t.opts.schemaId];e&&(t.baseId=(0,Ime.resolveUrl)(t.opts.uriResolver,t.baseId,e))}function Ume(t){if(t.schema.$async&&!t.schemaEnv.$async)throw new Error("async schema in sync schema")}function kU({gen:t,schemaEnv:e,schema:r,errSchemaPath:s,opts:n}){let i=r.$comment;if(n.$comment===!0)t.code((0,ge._)`${Ie.default.self}.logger.log(${i})`);else if(typeof n.$comment=="function"){let o=(0,ge.str)`${s}/$comment`,a=t.scopeValue("root",{ref:e.root});t.code((0,ge._)`${Ie.default.self}.opts.$comment(${i}, ${o}, ${a}.schema)`)}}function Vme(t){let{gen:e,schemaEnv:r,validateName:s,ValidationError:n,opts:i}=t;r.$async?e.if((0,ge._)`${Ie.default.errors} === 0`,()=>e.return(Ie.default.data),()=>e.throw((0,ge._)`new ${n}(${Ie.default.vErrors})`)):(e.assign((0,ge._)`${s}.errors`,Ie.default.vErrors),i.unevaluated&&Hme(t),e.return((0,ge._)`${Ie.default.errors} === 0`))}function Hme({gen:t,evaluated:e,props:r,items:s}){r instanceof ge.Name&&t.assign((0,ge._)`${e}.props`,r),s instanceof ge.Name&&t.assign((0,ge._)`${e}.items`,s)}function EU(t,e,r,s){let{gen:n,schema:i,data:o,allErrors:a,opts:l,self:u}=t,{RULES:c}=u;if(i.$ref&&(l.ignoreKeywordsWithRef||!(0,Wo.schemaHasRulesButRef)(i,c))){n.block(()=>IU(t,"$ref",c.all.$ref.definition));return}l.jtd||Gme(t,e),n.block(()=>{for(let f of c.rules)d(f);d(c.post)});function d(f){(0,BR.shouldUseGroup)(i,f)&&(f.type?(n.if((0,fv.checkDataType)(f.type,o,l.strictNumbers)),wU(t,f),e.length===1&&e[0]===f.type&&r&&(n.else(),(0,fv.reportTypeError)(t)),n.endIf()):wU(t,f),a||n.if((0,ge._)`${Ie.default.errors} === ${s||0}`))}}function wU(t,e){let{gen:r,schema:s,opts:{useDefaults:n}}=t;n&&(0,xme.assignDefaults)(t,e.type),r.block(()=>{for(let i of e.rules)(0,BR.shouldUseRule)(s,i)&&IU(t,i.keyword,i.definition,e.type)})}function Gme(t,e){t.schemaEnv.meta||!t.opts.strictTypes||(Kme(t,e),t.opts.allowUnionTypes||Qme(t,e),Wme(t,t.dataTypes))}function Kme(t,e){if(e.length){if(!t.dataTypes.length){t.dataTypes=e;return}e.forEach(r=>{xU(t.dataTypes,r)||zR(t,`type "${r}" not allowed by context "${t.dataTypes.join(",")}"`)}),Yme(t,e)}}function Qme(t,e){e.length>1&&!(e.length===2&&e.includes("null"))&&zR(t,"use allowUnionTypes to allow union type keyword")}function Wme(t,e){let r=t.self.RULES.all;for(let s in r){let n=r[s];if(typeof n=="object"&&(0,BR.shouldUseRule)(t.schema,n)){let{type:i}=n.definition;i.length&&!i.some(o=>Zme(e,o))&&zR(t,`missing type "${i.join(",")}" for keyword "${s}"`)}}}function Zme(t,e){return t.includes(e)||e==="number"&&t.includes("integer")}function xU(t,e){return t.includes(e)||e==="integer"&&t.includes("number")}function Yme(t,e){let r=[];for(let s of t.dataTypes)xU(e,s)?r.push(s):e.includes("integer")&&s==="number"&&r.push("integer");t.dataTypes=r}function zR(t,e){let r=t.schemaEnv.baseId+t.errSchemaPath;e+=` at "${r}" (strictTypes)`,(0,Wo.checkStrictMode)(t,e,t.opts.strictTypes)}var hv=class{constructor(e,r,s){if((0,Hp.validateKeywordUsage)(e,r,s),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=s,this.data=e.data,this.schema=e.schema[s],this.$data=r.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,Wo.schemaRefOrVal)(e,this.schema,s,this.$data),this.schemaType=r.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=r,this.$data)this.schemaCode=e.gen.const("vSchema",NU(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,Hp.validSchemaType)(this.schema,r.schemaType,r.allowUndefined))throw new Error(`${s} value must be ${JSON.stringify(r.schemaType)}`);("code"in r?r.trackErrors:r.errors!==!1)&&(this.errsCount=e.gen.const("_errs",Ie.default.errors))}result(e,r,s){this.failResult((0,ge.not)(e),r,s)}failResult(e,r,s){this.gen.if(e),s?s():this.error(),r?(this.gen.else(),r(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,r){this.failResult((0,ge.not)(e),void 0,r)}fail(e){if(e===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);let{schemaCode:r}=this;this.fail((0,ge._)`${r} !== undefined && (${(0,ge.or)(this.invalid$data(),e)})`)}error(e,r,s){if(r){this.setParams(r),this._error(e,s),this.setParams({});return}this._error(e,s)}_error(e,r){(e?Vp.reportExtraError:Vp.reportError)(this,this.def.error,r)}$dataError(){(0,Vp.reportError)(this,this.def.$dataError||Vp.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,Vp.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,r){r?Object.assign(this.params,e):this.params=e}block$data(e,r,s=ge.nil){this.gen.block(()=>{this.check$data(e,s),r()})}check$data(e=ge.nil,r=ge.nil){if(!this.$data)return;let{gen:s,schemaCode:n,schemaType:i,def:o}=this;s.if((0,ge.or)((0,ge._)`${n} === undefined`,r)),e!==ge.nil&&s.assign(e,!0),(i.length||o.validateSchema)&&(s.elseIf(this.invalid$data()),this.$dataError(),e!==ge.nil&&s.assign(e,!1)),s.else()}invalid$data(){let{gen:e,schemaCode:r,schemaType:s,def:n,it:i}=this;return(0,ge.or)(o(),a());function o(){if(s.length){if(!(r instanceof ge.Name))throw new Error("ajv implementation error");let l=Array.isArray(s)?s:[s];return(0,ge._)`${(0,fv.checkDataTypes)(l,r,i.opts.strictNumbers,fv.DataType.Wrong)}`}return ge.nil}function a(){if(n.validateSchema){let l=e.scopeValue("validate$data",{ref:n.validateSchema});return(0,ge._)`!${l}(${r})`}return ge.nil}}subschema(e,r){let s=(0,FR.getSubschema)(this.it,e);(0,FR.extendSubschemaData)(s,this.it,e),(0,FR.extendSubschemaMode)(s,e);let n={...this.it,...s,items:void 0,props:void 0};return Lme(n,r),n}mergeEvaluated(e,r){let{it:s,gen:n}=this;s.opts.unevaluated&&(s.props!==!0&&e.props!==void 0&&(s.props=Wo.mergeEvaluated.props(n,e.props,s.props,r)),s.items!==!0&&e.items!==void 0&&(s.items=Wo.mergeEvaluated.items(n,e.items,s.items,r)))}mergeValidEvaluated(e,r){let{it:s,gen:n}=this;if(s.opts.unevaluated&&(s.props!==!0||s.items!==!0))return n.if(r,()=>this.mergeEvaluated(e,ge.Name)),!0}};Ga.KeywordCxt=hv;function IU(t,e,r,s){let n=new hv(t,r,e);"code"in r?r.code(n,s):n.$data&&r.validate?(0,Hp.funcKeywordCode)(n,r):"macro"in r?(0,Hp.macroKeywordCode)(n,r):(r.compile||r.validate)&&(0,Hp.funcKeywordCode)(n,r)}var Jme=/^\/(?:[^~]|~0|~1)*$/,Xme=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function NU(t,{dataLevel:e,dataNames:r,dataPathArr:s}){let n,i;if(t==="")return Ie.default.rootData;if(t[0]==="/"){if(!Jme.test(t))throw new Error(`Invalid JSON-pointer: ${t}`);n=t,i=Ie.default.rootData}else{let u=Xme.exec(t);if(!u)throw new Error(`Invalid JSON-pointer: ${t}`);let c=+u[1];if(n=u[2],n==="#"){if(c>=e)throw new Error(l("property/index",c));return s[e-c]}if(c>e)throw new Error(l("data",c));if(i=r[e-c],!n)return i}let o=i,a=n.split("/");for(let u of a)u&&(i=(0,ge._)`${i}${(0,ge.getProperty)((0,Wo.unescapeJsonPointer)(u))}`,o=(0,ge._)`${o} && ${i}`);return o;function l(u,c){return`Cannot access ${u} ${c} levels up, current level is ${e}`}}Ga.getData=NU});var Gp=m(VR=>{"use strict";Object.defineProperty(VR,"__esModule",{value:!0});var UR=class extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}};VR.default=UR});var Zo=m(KR=>{"use strict";Object.defineProperty(KR,"__esModule",{value:!0});var HR=Up(),GR=class extends Error{constructor(e,r,s,n){super(n||`can't resolve reference ${s} from id ${r}`),this.missingRef=(0,HR.resolveUrl)(e,r,s),this.missingSchema=(0,HR.normalizeId)((0,HR.getFullPath)(e,this.missingRef))}};KR.default=GR});var Iu=m(Pn=>{"use strict";Object.defineProperty(Pn,"__esModule",{value:!0});Pn.resolveSchema=Pn.getCompilingSchema=Pn.resolveRef=Pn.compileSchema=Pn.SchemaEnv=void 0;var hi=Te(),ege=Gp(),xu=On(),pi=Up(),DU=ze(),tge=Cd(),Rd=class{constructor(e){var r;this.refs={},this.dynamicAnchors={};let s;typeof e.schema=="object"&&(s=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=(r=e.baseId)!==null&&r!==void 0?r:(0,pi.normalizeId)(s?.[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=s?.$async,this.refs={}}};Pn.SchemaEnv=Rd;function WR(t){let e=MU.call(this,t);if(e)return e;let r=(0,pi.getFullPath)(this.opts.uriResolver,t.root.baseId),{es5:s,lines:n}=this.opts.code,{ownProperties:i}=this.opts,o=new hi.CodeGen(this.scope,{es5:s,lines:n,ownProperties:i}),a;t.$async&&(a=o.scopeValue("Error",{ref:ege.default,code:(0,hi._)`require("ajv/dist/runtime/validation_error").default`}));let l=o.scopeName("validate");t.validateName=l;let u={gen:o,allErrors:this.opts.allErrors,data:xu.default.data,parentData:xu.default.parentData,parentDataProperty:xu.default.parentDataProperty,dataNames:[xu.default.data],dataPathArr:[hi.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:o.scopeValue("schema",this.opts.code.source===!0?{ref:t.schema,code:(0,hi.stringify)(t.schema)}:{ref:t.schema}),validateName:l,ValidationError:a,schema:t.schema,schemaEnv:t,rootId:r,baseId:t.baseId||r,schemaPath:hi.nil,errSchemaPath:t.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,hi._)`""`,opts:this.opts,self:this},c;try{this._compilations.add(t),(0,tge.validateFunctionCode)(u),o.optimize(this.opts.code.optimize);let d=o.toString();c=`${o.scopeRefs(xu.default.scope)}return ${d}`,this.opts.code.process&&(c=this.opts.code.process(c,t));let h=new Function(`${xu.default.self}`,`${xu.default.scope}`,c)(this,this.scope.get());if(this.scope.value(l,{ref:h}),h.errors=null,h.schema=t.schema,h.schemaEnv=t,t.$async&&(h.$async=!0),this.opts.code.source===!0&&(h.source={validateName:l,validateCode:d,scopeValues:o._values}),this.opts.unevaluated){let{props:p,items:g}=u;h.evaluated={props:p instanceof hi.Name?void 0:p,items:g instanceof hi.Name?void 0:g,dynamicProps:p instanceof hi.Name,dynamicItems:g instanceof hi.Name},h.source&&(h.source.evaluated=(0,hi.stringify)(h.evaluated))}return t.validate=h,t}catch(d){throw delete t.validate,delete t.validateName,c&&this.logger.error("Error compiling schema, function code:",c),d}finally{this._compilations.delete(t)}}Pn.compileSchema=WR;function rge(t,e,r){var s;r=(0,pi.resolveUrl)(this.opts.uriResolver,e,r);let n=t.refs[r];if(n)return n;let i=ige.call(this,t,r);if(i===void 0){let o=(s=t.localRefs)===null||s===void 0?void 0:s[r],{schemaId:a}=this.opts;o&&(i=new Rd({schema:o,schemaId:a,root:t,baseId:e}))}if(i!==void 0)return t.refs[r]=sge.call(this,i)}Pn.resolveRef=rge;function sge(t){return(0,pi.inlineRef)(t.schema,this.opts.inlineRefs)?t.schema:t.validate?t:WR.call(this,t)}function MU(t){for(let e of this._compilations)if(nge(e,t))return e}Pn.getCompilingSchema=MU;function nge(t,e){return t.schema===e.schema&&t.root===e.root&&t.baseId===e.baseId}function ige(t,e){let r;for(;typeof(r=this.refs[e])=="string";)e=r;return r||this.schemas[e]||pv.call(this,t,e)}function pv(t,e){let r=this.opts.uriResolver.parse(e),s=(0,pi._getFullPath)(this.opts.uriResolver,r),n=(0,pi.getFullPath)(this.opts.uriResolver,t.baseId,void 0);if(Object.keys(t.schema).length>0&&s===n)return QR.call(this,r,t);let i=(0,pi.normalizeId)(s),o=this.refs[i]||this.schemas[i];if(typeof o=="string"){let a=pv.call(this,t,o);return typeof a?.schema!="object"?void 0:QR.call(this,r,a)}if(typeof o?.schema=="object"){if(o.validate||WR.call(this,o),i===(0,pi.normalizeId)(e)){let{schema:a}=o,{schemaId:l}=this.opts,u=a[l];return u&&(n=(0,pi.resolveUrl)(this.opts.uriResolver,n,u)),new Rd({schema:a,schemaId:l,root:t,baseId:n})}return QR.call(this,r,o)}}Pn.resolveSchema=pv;var oge=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function QR(t,{baseId:e,schema:r,root:s}){var n;if(((n=t.fragment)===null||n===void 0?void 0:n[0])!=="/")return;for(let a of t.fragment.slice(1).split("/")){if(typeof r=="boolean")return;let l=r[(0,DU.unescapeFragment)(a)];if(l===void 0)return;r=l;let u=typeof r=="object"&&r[this.opts.schemaId];!oge.has(a)&&u&&(e=(0,pi.resolveUrl)(this.opts.uriResolver,e,u))}let i;if(typeof r!="boolean"&&r.$ref&&!(0,DU.schemaHasRulesButRef)(r,this.RULES)){let a=(0,pi.resolveUrl)(this.opts.uriResolver,e,r.$ref);i=pv.call(this,s,a)}let{schemaId:o}=this.opts;if(i=i||new Rd({schema:r,schemaId:o,root:s,baseId:e}),i.schema!==i.root.schema)return i}});var $U=m((b9e,age)=>{age.exports={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}});var LU=m((mv,qU)=>{(function(t,e){typeof mv=="object"&&typeof qU<"u"?e(mv):typeof define=="function"&&define.amd?define(["exports"],e):e(t.URI=t.URI||{})})(mv,function(t){"use strict";function e(){for(var I=arguments.length,T=Array(I),D=0;D<I;D++)T[D]=arguments[D];if(T.length>1){T[0]=T[0].slice(0,-1);for(var B=T.length-1,U=1;U<B;++U)T[U]=T[U].slice(1,-1);return T[B]=T[B].slice(1),T.join("")}else return T[0]}function r(I){return"(?:"+I+")"}function s(I){return I===void 0?"undefined":I===null?"null":Object.prototype.toString.call(I).split(" ").pop().split("]").shift().toLowerCase()}function n(I){return I.toUpperCase()}function i(I){return I!=null?I instanceof Array?I:typeof I.length!="number"||I.split||I.setInterval||I.call?[I]:Array.prototype.slice.call(I):[]}function o(I,T){var D=I;if(T)for(var B in T)D[B]=T[B];return D}function a(I){var T="[A-Za-z]",D="[\\x0D]",B="[0-9]",U="[\\x22]",ce=e(B,"[A-Fa-f]"),Fe="[\\x0A]",ut="[\\x20]",_t=r(r("%[EFef]"+ce+"%"+ce+ce+"%"+ce+ce)+"|"+r("%[89A-Fa-f]"+ce+"%"+ce+ce)+"|"+r("%"+ce+ce)),gr="[\\:\\/\\?\\#\\[\\]\\@]",nt="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",Gt=e(gr,nt),yr=I?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",Vt=I?"[\\uE000-\\uF8FF]":"[]",gt=e(T,B,"[\\-\\.\\_\\~]",yr),Kt=r(T+e(T,B,"[\\+\\-\\.]")+"*"),Et=r(r(_t+"|"+e(gt,nt,"[\\:]"))+"*"),hu=r(r("25[0-5]")+"|"+r("2[0-4]"+B)+"|"+r("1"+B+B)+"|"+r("[1-9]"+B)+"|"+B),Ys=r(r("25[0-5]")+"|"+r("2[0-4]"+B)+"|"+r("1"+B+B)+"|"+r("0?[1-9]"+B)+"|0?0?"+B),Sn=r(Ys+"\\."+Ys+"\\."+Ys+"\\."+Ys),Rt=r(ce+"{1,4}"),Js=r(r(Rt+"\\:"+Rt)+"|"+Sn),bn=r(r(Rt+"\\:")+"{6}"+Js),ji=r("\\:\\:"+r(Rt+"\\:")+"{5}"+Js),pu=r(r(Rt)+"?\\:\\:"+r(Rt+"\\:")+"{4}"+Js),jo=r(r(r(Rt+"\\:")+"{0,1}"+Rt)+"?\\:\\:"+r(Rt+"\\:")+"{3}"+Js),sp=r(r(r(Rt+"\\:")+"{0,2}"+Rt)+"?\\:\\:"+r(Rt+"\\:")+"{2}"+Js),$y=r(r(r(Rt+"\\:")+"{0,3}"+Rt)+"?\\:\\:"+Rt+"\\:"+Js),qy=r(r(r(Rt+"\\:")+"{0,4}"+Rt)+"?\\:\\:"+Js),Zc=r(r(r(Rt+"\\:")+"{0,5}"+Rt)+"?\\:\\:"+Rt),Yc=r(r(r(Rt+"\\:")+"{0,6}"+Rt)+"?\\:\\:"),Fo=r([bn,ji,pu,jo,sp,$y,qy,Zc,Yc].join("|")),Jc=r(r(gt+"|"+_t)+"+"),Ww=r(Fo+"\\%25"+Jc),mu=r(Fo+r("\\%25|\\%(?!"+ce+"{2})")+Jc),fte=r("[vV]"+ce+"+\\."+e(gt,nt,"[\\:]")+"+"),hte=r("\\["+r(mu+"|"+Fo+"|"+fte)+"\\]"),V$=r(r(_t+"|"+e(gt,nt))+"*"),np=r(hte+"|"+Sn+"(?!"+V$+")|"+V$),ip=r(B+"*"),H$=r(r(Et+"@")+"?"+np+r("\\:"+ip)+"?"),op=r(_t+"|"+e(gt,nt,"[\\:\\@]")),pte=r(op+"*"),G$=r(op+"+"),mte=r(r(_t+"|"+e(gt,nt,"[\\@]"))+"+"),Bo=r(r("\\/"+pte)+"*"),Xc=r("\\/"+r(G$+Bo)+"?"),Zw=r(mte+Bo),Ly=r(G$+Bo),ed="(?!"+op+")",AVe=r(Bo+"|"+Xc+"|"+Zw+"|"+Ly+"|"+ed),td=r(r(op+"|"+e("[\\/\\?]",Vt))+"*"),ap=r(r(op+"|[\\/\\?]")+"*"),K$=r(r("\\/\\/"+H$+Bo)+"|"+Xc+"|"+Ly+"|"+ed),gte=r(Kt+"\\:"+K$+r("\\?"+td)+"?"+r("\\#"+ap)+"?"),yte=r(r("\\/\\/"+H$+Bo)+"|"+Xc+"|"+Zw+"|"+ed),vte=r(yte+r("\\?"+td)+"?"+r("\\#"+ap)+"?"),kVe=r(gte+"|"+vte),xVe=r(Kt+"\\:"+K$+r("\\?"+td)+"?"),IVe="^("+Kt+")\\:"+r(r("\\/\\/("+r("("+Et+")@")+"?("+np+")"+r("\\:("+ip+")")+"?)")+"?("+Bo+"|"+Xc+"|"+Ly+"|"+ed+")")+r("\\?("+td+")")+"?"+r("\\#("+ap+")")+"?$",NVe="^(){0}"+r(r("\\/\\/("+r("("+Et+")@")+"?("+np+")"+r("\\:("+ip+")")+"?)")+"?("+Bo+"|"+Xc+"|"+Zw+"|"+ed+")")+r("\\?("+td+")")+"?"+r("\\#("+ap+")")+"?$",DVe="^("+Kt+")\\:"+r(r("\\/\\/("+r("("+Et+")@")+"?("+np+")"+r("\\:("+ip+")")+"?)")+"?("+Bo+"|"+Xc+"|"+Ly+"|"+ed+")")+r("\\?("+td+")")+"?$",MVe="^"+r("\\#("+ap+")")+"?$",$Ve="^"+r("("+Et+")@")+"?("+np+")"+r("\\:("+ip+")")+"?$";return{NOT_SCHEME:new RegExp(e("[^]",T,B,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(e("[^\\%\\:]",gt,nt),"g"),NOT_HOST:new RegExp(e("[^\\%\\[\\]\\:]",gt,nt),"g"),NOT_PATH:new RegExp(e("[^\\%\\/\\:\\@]",gt,nt),"g"),NOT_PATH_NOSCHEME:new RegExp(e("[^\\%\\/\\@]",gt,nt),"g"),NOT_QUERY:new RegExp(e("[^\\%]",gt,nt,"[\\:\\@\\/\\?]",Vt),"g"),NOT_FRAGMENT:new RegExp(e("[^\\%]",gt,nt,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(e("[^]",gt,nt),"g"),UNRESERVED:new RegExp(gt,"g"),OTHER_CHARS:new RegExp(e("[^\\%]",gt,Gt),"g"),PCT_ENCODED:new RegExp(_t,"g"),IPV4ADDRESS:new RegExp("^("+Sn+")$"),IPV6ADDRESS:new RegExp("^\\[?("+Fo+")"+r(r("\\%25|\\%(?!"+ce+"{2})")+"("+Jc+")")+"?\\]?$")}}var l=a(!1),u=a(!0),c=function(){function I(T,D){var B=[],U=!0,ce=!1,Fe=void 0;try{for(var ut=T[Symbol.iterator](),_t;!(U=(_t=ut.next()).done)&&(B.push(_t.value),!(D&&B.length===D));U=!0);}catch(gr){ce=!0,Fe=gr}finally{try{!U&&ut.return&&ut.return()}finally{if(ce)throw Fe}}return B}return function(T,D){if(Array.isArray(T))return T;if(Symbol.iterator in Object(T))return I(T,D);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),d=function(I){if(Array.isArray(I)){for(var T=0,D=Array(I.length);T<I.length;T++)D[T]=I[T];return D}else return Array.from(I)},f=2147483647,h=36,p=1,g=26,_=38,S=700,b=72,v=128,y="-",R=/^xn--/,P=/[^\0-\x7E]/,w=/[\x2E\u3002\uFF0E\uFF61]/g,O={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},$=h-p,C=Math.floor,k=String.fromCharCode;function z(I){throw new RangeError(O[I])}function A(I,T){for(var D=[],B=I.length;B--;)D[B]=T(I[B]);return D}function E(I,T){var D=I.split("@"),B="";D.length>1&&(B=D[0]+"@",I=D[1]),I=I.replace(w,".");var U=I.split("."),ce=A(U,T).join(".");return B+ce}function V(I){for(var T=[],D=0,B=I.length;D<B;){var U=I.charCodeAt(D++);if(U>=55296&&U<=56319&&D<B){var ce=I.charCodeAt(D++);(ce&64512)==56320?T.push(((U&1023)<<10)+(ce&1023)+65536):(T.push(U),D--)}else T.push(U)}return T}var G=function(T){return String.fromCodePoint.apply(String,d(T))},X=function(T){return T-48<10?T-22:T-65<26?T-65:T-97<26?T-97:h},pe=function(T,D){return T+22+75*(T<26)-((D!=0)<<5)},J=function(T,D,B){var U=0;for(T=B?C(T/S):T>>1,T+=C(T/D);T>$*g>>1;U+=h)T=C(T/$);return C(U+($+1)*T/(T+_))},ye=function(T){var D=[],B=T.length,U=0,ce=v,Fe=b,ut=T.lastIndexOf(y);ut<0&&(ut=0);for(var _t=0;_t<ut;++_t)T.charCodeAt(_t)>=128&&z("not-basic"),D.push(T.charCodeAt(_t));for(var gr=ut>0?ut+1:0;gr<B;){for(var nt=U,Gt=1,yr=h;;yr+=h){gr>=B&&z("invalid-input");var Vt=X(T.charCodeAt(gr++));(Vt>=h||Vt>C((f-U)/Gt))&&z("overflow"),U+=Vt*Gt;var gt=yr<=Fe?p:yr>=Fe+g?g:yr-Fe;if(Vt<gt)break;var Kt=h-gt;Gt>C(f/Kt)&&z("overflow"),Gt*=Kt}var Et=D.length+1;Fe=J(U-nt,Et,nt==0),C(U/Et)>f-ce&&z("overflow"),ce+=C(U/Et),U%=Et,D.splice(U++,0,ce)}return String.fromCodePoint.apply(String,D)},st=function(T){var D=[];T=V(T);var B=T.length,U=v,ce=0,Fe=b,ut=!0,_t=!1,gr=void 0;try{for(var nt=T[Symbol.iterator](),Gt;!(ut=(Gt=nt.next()).done);ut=!0){var yr=Gt.value;yr<128&&D.push(k(yr))}}catch(mu){_t=!0,gr=mu}finally{try{!ut&&nt.return&&nt.return()}finally{if(_t)throw gr}}var Vt=D.length,gt=Vt;for(Vt&&D.push(y);gt<B;){var Kt=f,Et=!0,hu=!1,Ys=void 0;try{for(var Sn=T[Symbol.iterator](),Rt;!(Et=(Rt=Sn.next()).done);Et=!0){var Js=Rt.value;Js>=U&&Js<Kt&&(Kt=Js)}}catch(mu){hu=!0,Ys=mu}finally{try{!Et&&Sn.return&&Sn.return()}finally{if(hu)throw Ys}}var bn=gt+1;Kt-U>C((f-ce)/bn)&&z("overflow"),ce+=(Kt-U)*bn,U=Kt;var ji=!0,pu=!1,jo=void 0;try{for(var sp=T[Symbol.iterator](),$y;!(ji=($y=sp.next()).done);ji=!0){var qy=$y.value;if(qy<U&&++ce>f&&z("overflow"),qy==U){for(var Zc=ce,Yc=h;;Yc+=h){var Fo=Yc<=Fe?p:Yc>=Fe+g?g:Yc-Fe;if(Zc<Fo)break;var Jc=Zc-Fo,Ww=h-Fo;D.push(k(pe(Fo+Jc%Ww,0))),Zc=C(Jc/Ww)}D.push(k(pe(Zc,0))),Fe=J(ce,bn,gt==Vt),ce=0,++gt}}}catch(mu){pu=!0,jo=mu}finally{try{!ji&&sp.return&&sp.return()}finally{if(pu)throw jo}}++ce,++U}return D.join("")},ve=function(T){return E(T,function(D){return R.test(D)?ye(D.slice(4).toLowerCase()):D})},pt=function(T){return E(T,function(D){return P.test(D)?"xn--"+st(D):D})},Ze={version:"2.1.0",ucs2:{decode:V,encode:G},decode:ye,encode:st,toASCII:pt,toUnicode:ve},_e={};function Ye(I){var T=I.charCodeAt(0),D=void 0;return T<16?D="%0"+T.toString(16).toUpperCase():T<128?D="%"+T.toString(16).toUpperCase():T<2048?D="%"+(T>>6|192).toString(16).toUpperCase()+"%"+(T&63|128).toString(16).toUpperCase():D="%"+(T>>12|224).toString(16).toUpperCase()+"%"+(T>>6&63|128).toString(16).toUpperCase()+"%"+(T&63|128).toString(16).toUpperCase(),D}function Re(I){for(var T="",D=0,B=I.length;D<B;){var U=parseInt(I.substr(D+1,2),16);if(U<128)T+=String.fromCharCode(U),D+=3;else if(U>=194&&U<224){if(B-D>=6){var ce=parseInt(I.substr(D+4,2),16);T+=String.fromCharCode((U&31)<<6|ce&63)}else T+=I.substr(D,6);D+=6}else if(U>=224){if(B-D>=9){var Fe=parseInt(I.substr(D+4,2),16),ut=parseInt(I.substr(D+7,2),16);T+=String.fromCharCode((U&15)<<12|(Fe&63)<<6|ut&63)}else T+=I.substr(D,9);D+=9}else T+=I.substr(D,3),D+=3}return T}function Pe(I,T){function D(B){var U=Re(B);return U.match(T.UNRESERVED)?U:B}return I.scheme&&(I.scheme=String(I.scheme).replace(T.PCT_ENCODED,D).toLowerCase().replace(T.NOT_SCHEME,"")),I.userinfo!==void 0&&(I.userinfo=String(I.userinfo).replace(T.PCT_ENCODED,D).replace(T.NOT_USERINFO,Ye).replace(T.PCT_ENCODED,n)),I.host!==void 0&&(I.host=String(I.host).replace(T.PCT_ENCODED,D).toLowerCase().replace(T.NOT_HOST,Ye).replace(T.PCT_ENCODED,n)),I.path!==void 0&&(I.path=String(I.path).replace(T.PCT_ENCODED,D).replace(I.scheme?T.NOT_PATH:T.NOT_PATH_NOSCHEME,Ye).replace(T.PCT_ENCODED,n)),I.query!==void 0&&(I.query=String(I.query).replace(T.PCT_ENCODED,D).replace(T.NOT_QUERY,Ye).replace(T.PCT_ENCODED,n)),I.fragment!==void 0&&(I.fragment=String(I.fragment).replace(T.PCT_ENCODED,D).replace(T.NOT_FRAGMENT,Ye).replace(T.PCT_ENCODED,n)),I}function W(I){return I.replace(/^0*(.*)/,"$1")||"0"}function H(I,T){var D=I.match(T.IPV4ADDRESS)||[],B=c(D,2),U=B[1];return U?U.split(".").map(W).join("."):I}function Q(I,T){var D=I.match(T.IPV6ADDRESS)||[],B=c(D,3),U=B[1],ce=B[2];if(U){for(var Fe=U.toLowerCase().split("::").reverse(),ut=c(Fe,2),_t=ut[0],gr=ut[1],nt=gr?gr.split(":").map(W):[],Gt=_t.split(":").map(W),yr=T.IPV4ADDRESS.test(Gt[Gt.length-1]),Vt=yr?7:8,gt=Gt.length-Vt,Kt=Array(Vt),Et=0;Et<Vt;++Et)Kt[Et]=nt[Et]||Gt[gt+Et]||"";yr&&(Kt[Vt-1]=H(Kt[Vt-1],T));var hu=Kt.reduce(function(bn,ji,pu){if(!ji||ji==="0"){var jo=bn[bn.length-1];jo&&jo.index+jo.length===pu?jo.length++:bn.push({index:pu,length:1})}return bn},[]),Ys=hu.sort(function(bn,ji){return ji.length-bn.length})[0],Sn=void 0;if(Ys&&Ys.length>1){var Rt=Kt.slice(0,Ys.index),Js=Kt.slice(Ys.index+Ys.length);Sn=Rt.join(":")+"::"+Js.join(":")}else Sn=Kt.join(":");return ce&&(Sn+="%"+ce),Sn}else return I}var N=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,q="".match(/(){0}/)[1]===void 0;function K(I){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},D={},B=T.iri!==!1?u:l;T.reference==="suffix"&&(I=(T.scheme?T.scheme+":":"")+"//"+I);var U=I.match(N);if(U){q?(D.scheme=U[1],D.userinfo=U[3],D.host=U[4],D.port=parseInt(U[5],10),D.path=U[6]||"",D.query=U[7],D.fragment=U[8],isNaN(D.port)&&(D.port=U[5])):(D.scheme=U[1]||void 0,D.userinfo=I.indexOf("@")!==-1?U[3]:void 0,D.host=I.indexOf("//")!==-1?U[4]:void 0,D.port=parseInt(U[5],10),D.path=U[6]||"",D.query=I.indexOf("?")!==-1?U[7]:void 0,D.fragment=I.indexOf("#")!==-1?U[8]:void 0,isNaN(D.port)&&(D.port=I.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?U[4]:void 0)),D.host&&(D.host=Q(H(D.host,B),B)),D.scheme===void 0&&D.userinfo===void 0&&D.host===void 0&&D.port===void 0&&!D.path&&D.query===void 0?D.reference="same-document":D.scheme===void 0?D.reference="relative":D.fragment===void 0?D.reference="absolute":D.reference="uri",T.reference&&T.reference!=="suffix"&&T.reference!==D.reference&&(D.error=D.error||"URI is not a "+T.reference+" reference.");var ce=_e[(T.scheme||D.scheme||"").toLowerCase()];if(!T.unicodeSupport&&(!ce||!ce.unicodeSupport)){if(D.host&&(T.domainHost||ce&&ce.domainHost))try{D.host=Ze.toASCII(D.host.replace(B.PCT_ENCODED,Re).toLowerCase())}catch(Fe){D.error=D.error||"Host's domain name can not be converted to ASCII via punycode: "+Fe}Pe(D,l)}else Pe(D,B);ce&&ce.parse&&ce.parse(D,T)}else D.error=D.error||"URI can not be parsed.";return D}function se(I,T){var D=T.iri!==!1?u:l,B=[];return I.userinfo!==void 0&&(B.push(I.userinfo),B.push("@")),I.host!==void 0&&B.push(Q(H(String(I.host),D),D).replace(D.IPV6ADDRESS,function(U,ce,Fe){return"["+ce+(Fe?"%25"+Fe:"")+"]"})),(typeof I.port=="number"||typeof I.port=="string")&&(B.push(":"),B.push(String(I.port))),B.length?B.join(""):void 0}var ke=/^\.\.?\//,le=/^\/\.(\/|$)/,lt=/^\/\.\.(\/|$)/,_n=/^\/?(?:.|\n)*?(?=\/|$)/;function mt(I){for(var T=[];I.length;)if(I.match(ke))I=I.replace(ke,"");else if(I.match(le))I=I.replace(le,"/");else if(I.match(lt))I=I.replace(lt,"/"),T.pop();else if(I==="."||I==="..")I="";else{var D=I.match(_n);if(D){var B=D[0];I=I.slice(B.length),T.push(B)}else throw new Error("Unexpected dot segment condition")}return T.join("")}function ir(I){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},D=T.iri?u:l,B=[],U=_e[(T.scheme||I.scheme||"").toLowerCase()];if(U&&U.serialize&&U.serialize(I,T),I.host&&!D.IPV6ADDRESS.test(I.host)){if(T.domainHost||U&&U.domainHost)try{I.host=T.iri?Ze.toUnicode(I.host):Ze.toASCII(I.host.replace(D.PCT_ENCODED,Re).toLowerCase())}catch(ut){I.error=I.error||"Host's domain name can not be converted to "+(T.iri?"Unicode":"ASCII")+" via punycode: "+ut}}Pe(I,D),T.reference!=="suffix"&&I.scheme&&(B.push(I.scheme),B.push(":"));var ce=se(I,T);if(ce!==void 0&&(T.reference!=="suffix"&&B.push("//"),B.push(ce),I.path&&I.path.charAt(0)!=="/"&&B.push("/")),I.path!==void 0){var Fe=I.path;!T.absolutePath&&(!U||!U.absolutePath)&&(Fe=mt(Fe)),ce===void 0&&(Fe=Fe.replace(/^\/\//,"/%2F")),B.push(Fe)}return I.query!==void 0&&(B.push("?"),B.push(I.query)),I.fragment!==void 0&&(B.push("#"),B.push(I.fragment)),B.join("")}function z$(I,T){var D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},B=arguments[3],U={};return B||(I=K(ir(I,D),D),T=K(ir(T,D),D)),D=D||{},!D.tolerant&&T.scheme?(U.scheme=T.scheme,U.userinfo=T.userinfo,U.host=T.host,U.port=T.port,U.path=mt(T.path||""),U.query=T.query):(T.userinfo!==void 0||T.host!==void 0||T.port!==void 0?(U.userinfo=T.userinfo,U.host=T.host,U.port=T.port,U.path=mt(T.path||""),U.query=T.query):(T.path?(T.path.charAt(0)==="/"?U.path=mt(T.path):((I.userinfo!==void 0||I.host!==void 0||I.port!==void 0)&&!I.path?U.path="/"+T.path:I.path?U.path=I.path.slice(0,I.path.lastIndexOf("/")+1)+T.path:U.path=T.path,U.path=mt(U.path)),U.query=T.query):(U.path=I.path,T.query!==void 0?U.query=T.query:U.query=I.query),U.userinfo=I.userinfo,U.host=I.host,U.port=I.port),U.scheme=I.scheme),U.fragment=T.fragment,U}function oi(I,T,D){var B=o({scheme:"null"},D);return ir(z$(K(I,B),K(T,B),B,!0),B)}function qo(I,T){return typeof I=="string"?I=ir(K(I,T),T):s(I)==="object"&&(I=K(ir(I,T),T)),I}function tp(I,T,D){return typeof I=="string"?I=ir(K(I,D),D):s(I)==="object"&&(I=ir(I,D)),typeof T=="string"?T=ir(K(T,D),D):s(T)==="object"&&(T=ir(T,D)),I===T}function Aa(I,T){return I&&I.toString().replace(!T||!T.iri?l.ESCAPE:u.ESCAPE,Ye)}function ai(I,T){return I&&I.toString().replace(!T||!T.iri?l.PCT_ENCODED:u.PCT_ENCODED,Re)}var rp={scheme:"http",domainHost:!0,parse:function(T,D){return T.host||(T.error=T.error||"HTTP URIs must have a host."),T},serialize:function(T,D){var B=String(T.scheme).toLowerCase()==="https";return(T.port===(B?443:80)||T.port==="")&&(T.port=void 0),T.path||(T.path="/"),T}},es={scheme:"https",domainHost:rp.domainHost,parse:rp.parse,serialize:rp.serialize};function Ny(I){return typeof I.secure=="boolean"?I.secure:String(I.scheme).toLowerCase()==="wss"}var ka={scheme:"ws",domainHost:!0,parse:function(T,D){var B=T;return B.secure=Ny(B),B.resourceName=(B.path||"/")+(B.query?"?"+B.query:""),B.path=void 0,B.query=void 0,B},serialize:function(T,D){if((T.port===(Ny(T)?443:80)||T.port==="")&&(T.port=void 0),typeof T.secure=="boolean"&&(T.scheme=T.secure?"wss":"ws",T.secure=void 0),T.resourceName){var B=T.resourceName.split("?"),U=c(B,2),ce=U[0],Fe=U[1];T.path=ce&&ce!=="/"?ce:void 0,T.query=Fe,T.resourceName=void 0}return T.fragment=void 0,T}},qt={scheme:"wss",domainHost:ka.domainHost,parse:ka.parse,serialize:ka.serialize},Ws={},lte=!0,Zs="[A-Za-z0-9\\-\\.\\_\\~"+(lte?"\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF":"")+"]",Ar="[0-9A-Fa-f]",ute=r(r("%[EFef]"+Ar+"%"+Ar+Ar+"%"+Ar+Ar)+"|"+r("%[89A-Fa-f]"+Ar+"%"+Ar+Ar)+"|"+r("%"+Ar+Ar)),ts="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",Qw="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",cte=e(Qw,'[\\"\\\\]'),mr="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",fu=new RegExp(Zs,"g"),Wc=new RegExp(ute,"g"),li=new RegExp(e("[^]",ts,"[\\.]",'[\\"]',cte),"g"),xs=new RegExp(e("[^]",Zs,mr),"g"),Dy=xs;function Li(I){var T=Re(I);return T.match(fu)?T:I}var xa={scheme:"mailto",parse:function(T,D){var B=T,U=B.to=B.path?B.path.split(","):[];if(B.path=void 0,B.query){for(var ce=!1,Fe={},ut=B.query.split("&"),_t=0,gr=ut.length;_t<gr;++_t){var nt=ut[_t].split("=");switch(nt[0]){case"to":for(var Gt=nt[1].split(","),yr=0,Vt=Gt.length;yr<Vt;++yr)U.push(Gt[yr]);break;case"subject":B.subject=ai(nt[1],D);break;case"body":B.body=ai(nt[1],D);break;default:ce=!0,Fe[ai(nt[0],D)]=ai(nt[1],D);break}}ce&&(B.headers=Fe)}B.query=void 0;for(var gt=0,Kt=U.length;gt<Kt;++gt){var Et=U[gt].split("@");if(Et[0]=ai(Et[0]),D.unicodeSupport)Et[1]=ai(Et[1],D).toLowerCase();else try{Et[1]=Ze.toASCII(ai(Et[1],D).toLowerCase())}catch(hu){B.error=B.error||"Email address's domain name can not be converted to ASCII via punycode: "+hu}U[gt]=Et.join("@")}return B},serialize:function(T,D){var B=T,U=i(T.to);if(U){for(var ce=0,Fe=U.length;ce<Fe;++ce){var ut=String(U[ce]),_t=ut.lastIndexOf("@"),gr=ut.slice(0,_t).replace(Wc,Li).replace(Wc,n).replace(li,Ye),nt=ut.slice(_t+1);try{nt=D.iri?Ze.toUnicode(nt):Ze.toASCII(ai(nt,D).toLowerCase())}catch(gt){B.error=B.error||"Email address's domain name can not be converted to "+(D.iri?"Unicode":"ASCII")+" via punycode: "+gt}U[ce]=gr+"@"+nt}B.path=U.join(",")}var Gt=T.headers=T.headers||{};T.subject&&(Gt.subject=T.subject),T.body&&(Gt.body=T.body);var yr=[];for(var Vt in Gt)Gt[Vt]!==Ws[Vt]&&yr.push(Vt.replace(Wc,Li).replace(Wc,n).replace(xs,Ye)+"="+Gt[Vt].replace(Wc,Li).replace(Wc,n).replace(Dy,Ye));return yr.length&&(B.query=yr.join("&")),B}},My=/^([^\:]+)\:(.*)/,Lo={scheme:"urn",parse:function(T,D){var B=T.path&&T.path.match(My),U=T;if(B){var ce=D.scheme||U.scheme||"urn",Fe=B[1].toLowerCase(),ut=B[2],_t=ce+":"+(D.nid||Fe),gr=_e[_t];U.nid=Fe,U.nss=ut,U.path=void 0,gr&&(U=gr.parse(U,D))}else U.error=U.error||"URN can not be parsed.";return U},serialize:function(T,D){var B=D.scheme||T.scheme||"urn",U=T.nid,ce=B+":"+(D.nid||U),Fe=_e[ce];Fe&&(T=Fe.serialize(T,D));var ut=T,_t=T.nss;return ut.path=(U||D.nid)+":"+_t,ut}},dte=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,U$={scheme:"urn:uuid",parse:function(T,D){var B=T;return B.uuid=B.nss,B.nss=void 0,!D.tolerant&&(!B.uuid||!B.uuid.match(dte))&&(B.error=B.error||"UUID is not valid."),B},serialize:function(T,D){var B=T;return B.nss=(T.uuid||"").toLowerCase(),B}};_e[rp.scheme]=rp,_e[es.scheme]=es,_e[ka.scheme]=ka,_e[qt.scheme]=qt,_e[xa.scheme]=xa,_e[Lo.scheme]=Lo,_e[U$.scheme]=U$,t.SCHEMES=_e,t.pctEncChar=Ye,t.pctDecChars=Re,t.parse=K,t.removeDotSegments=mt,t.serialize=ir,t.resolveComponents=z$,t.resolve=oi,t.normalize=qo,t.equal=tp,t.escapeComponent=Aa,t.unescapeComponent=ai,Object.defineProperty(t,"__esModule",{value:!0})})});var FU=m(ZR=>{"use strict";Object.defineProperty(ZR,"__esModule",{value:!0});var jU=LU();jU.code='require("ajv/dist/runtime/uri").default';ZR.default=jU});var XR=m(Hr=>{"use strict";Object.defineProperty(Hr,"__esModule",{value:!0});Hr.CodeGen=Hr.Name=Hr.nil=Hr.stringify=Hr.str=Hr._=Hr.KeywordCxt=void 0;var lge=Cd();Object.defineProperty(Hr,"KeywordCxt",{enumerable:!0,get:function(){return lge.KeywordCxt}});var Od=Te();Object.defineProperty(Hr,"_",{enumerable:!0,get:function(){return Od._}});Object.defineProperty(Hr,"str",{enumerable:!0,get:function(){return Od.str}});Object.defineProperty(Hr,"stringify",{enumerable:!0,get:function(){return Od.stringify}});Object.defineProperty(Hr,"nil",{enumerable:!0,get:function(){return Od.nil}});Object.defineProperty(Hr,"Name",{enumerable:!0,get:function(){return Od.Name}});Object.defineProperty(Hr,"CodeGen",{enumerable:!0,get:function(){return Od.CodeGen}});var uge=Gp(),HU=Zo(),cge=xR(),Kp=Iu(),dge=Te(),Qp=Up(),gv=zp(),JR=ze(),BU=$U(),fge=FU(),GU=(t,e)=>new RegExp(t,e);GU.code="new RegExp";var hge=["removeAdditional","useDefaults","coerceTypes"],pge=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),mge={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},gge={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},zU=200;function yge(t){var e,r,s,n,i,o,a,l,u,c,d,f,h,p,g,_,S,b,v,y,R,P,w,O,$;let C=t.strict,k=(e=t.code)===null||e===void 0?void 0:e.optimize,z=k===!0||k===void 0?1:k||0,A=(s=(r=t.code)===null||r===void 0?void 0:r.regExp)!==null&&s!==void 0?s:GU,E=(n=t.uriResolver)!==null&&n!==void 0?n:fge.default;return{strictSchema:(o=(i=t.strictSchema)!==null&&i!==void 0?i:C)!==null&&o!==void 0?o:!0,strictNumbers:(l=(a=t.strictNumbers)!==null&&a!==void 0?a:C)!==null&&l!==void 0?l:!0,strictTypes:(c=(u=t.strictTypes)!==null&&u!==void 0?u:C)!==null&&c!==void 0?c:"log",strictTuples:(f=(d=t.strictTuples)!==null&&d!==void 0?d:C)!==null&&f!==void 0?f:"log",strictRequired:(p=(h=t.strictRequired)!==null&&h!==void 0?h:C)!==null&&p!==void 0?p:!1,code:t.code?{...t.code,optimize:z,regExp:A}:{optimize:z,regExp:A},loopRequired:(g=t.loopRequired)!==null&&g!==void 0?g:zU,loopEnum:(_=t.loopEnum)!==null&&_!==void 0?_:zU,meta:(S=t.meta)!==null&&S!==void 0?S:!0,messages:(b=t.messages)!==null&&b!==void 0?b:!0,inlineRefs:(v=t.inlineRefs)!==null&&v!==void 0?v:!0,schemaId:(y=t.schemaId)!==null&&y!==void 0?y:"$id",addUsedSchema:(R=t.addUsedSchema)!==null&&R!==void 0?R:!0,validateSchema:(P=t.validateSchema)!==null&&P!==void 0?P:!0,validateFormats:(w=t.validateFormats)!==null&&w!==void 0?w:!0,unicodeRegExp:(O=t.unicodeRegExp)!==null&&O!==void 0?O:!0,int32range:($=t.int32range)!==null&&$!==void 0?$:!0,uriResolver:E}}var Wp=class{constructor(e={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts={...e,...yge(e)};let{es5:r,lines:s}=this.opts.code;this.scope=new dge.ValueScope({scope:{},prefixes:pge,es5:r,lines:s}),this.logger=wge(e.logger);let n=e.validateFormats;e.validateFormats=!1,this.RULES=(0,cge.getRules)(),UU.call(this,mge,e,"NOT SUPPORTED"),UU.call(this,gge,e,"DEPRECATED","warn"),this._metaOpts=bge.call(this),e.formats&&_ge.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&Sge.call(this,e.keywords),typeof e.meta=="object"&&this.addMetaSchema(e.meta),vge.call(this),e.validateFormats=n}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){let{$data:e,meta:r,schemaId:s}=this.opts,n=BU;s==="id"&&(n={...BU},n.id=n.$id,delete n.$id),r&&e&&this.addMetaSchema(n,n[s],!1)}defaultMeta(){let{meta:e,schemaId:r}=this.opts;return this.opts.defaultMeta=typeof e=="object"?e[r]||e:void 0}validate(e,r){let s;if(typeof e=="string"){if(s=this.getSchema(e),!s)throw new Error(`no schema with key or ref "${e}"`)}else s=this.compile(e);let n=s(r);return"$async"in s||(this.errors=s.errors),n}compile(e,r){let s=this._addSchema(e,r);return s.validate||this._compileSchemaEnv(s)}compileAsync(e,r){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");let{loadSchema:s}=this.opts;return n.call(this,e,r);async function n(c,d){await i.call(this,c.$schema);let f=this._addSchema(c,d);return f.validate||o.call(this,f)}async function i(c){c&&!this.getSchema(c)&&await n.call(this,{$ref:c},!0)}async function o(c){try{return this._compileSchemaEnv(c)}catch(d){if(!(d instanceof HU.default))throw d;return a.call(this,d),await l.call(this,d.missingSchema),o.call(this,c)}}function a({missingSchema:c,missingRef:d}){if(this.refs[c])throw new Error(`AnySchema ${c} is loaded but ${d} cannot be resolved`)}async function l(c){let d=await u.call(this,c);this.refs[c]||await i.call(this,d.$schema),this.refs[c]||this.addSchema(d,c,r)}async function u(c){let d=this._loading[c];if(d)return d;try{return await(this._loading[c]=s(c))}finally{delete this._loading[c]}}}addSchema(e,r,s,n=this.opts.validateSchema){if(Array.isArray(e)){for(let o of e)this.addSchema(o,void 0,s,n);return this}let i;if(typeof e=="object"){let{schemaId:o}=this.opts;if(i=e[o],i!==void 0&&typeof i!="string")throw new Error(`schema ${o} must be string`)}return r=(0,Qp.normalizeId)(r||i),this._checkUnique(r),this.schemas[r]=this._addSchema(e,s,r,n,!0),this}addMetaSchema(e,r,s=this.opts.validateSchema){return this.addSchema(e,r,!0,s),this}validateSchema(e,r){if(typeof e=="boolean")return!0;let s;if(s=e.$schema,s!==void 0&&typeof s!="string")throw new Error("$schema must be a string");if(s=s||this.opts.defaultMeta||this.defaultMeta(),!s)return this.logger.warn("meta-schema not available"),this.errors=null,!0;let n=this.validate(s,e);if(!n&&r){let i="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(i);else throw new Error(i)}return n}getSchema(e){let r;for(;typeof(r=VU.call(this,e))=="string";)e=r;if(r===void 0){let{schemaId:s}=this.opts,n=new Kp.SchemaEnv({schema:{},schemaId:s});if(r=Kp.resolveSchema.call(this,n,e),!r)return;this.refs[e]=r}return r.validate||this._compileSchemaEnv(r)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{let r=VU.call(this,e);return typeof r=="object"&&this._cache.delete(r.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{let r=e;this._cache.delete(r);let s=e[this.opts.schemaId];return s&&(s=(0,Qp.normalizeId)(s),delete this.schemas[s],delete this.refs[s]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(let r of e)this.addKeyword(r);return this}addKeyword(e,r){let s;if(typeof e=="string")s=e,typeof r=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),r.keyword=s);else if(typeof e=="object"&&r===void 0){if(r=e,s=r.keyword,Array.isArray(s)&&!s.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(Cge.call(this,s,r),!r)return(0,JR.eachItem)(s,i=>YR.call(this,i)),this;Oge.call(this,r);let n={...r,type:(0,gv.getJSONTypes)(r.type),schemaType:(0,gv.getJSONTypes)(r.schemaType)};return(0,JR.eachItem)(s,n.type.length===0?i=>YR.call(this,i,n):i=>n.type.forEach(o=>YR.call(this,i,n,o))),this}getKeyword(e){let r=this.RULES.all[e];return typeof r=="object"?r.definition:!!r}removeKeyword(e){let{RULES:r}=this;delete r.keywords[e],delete r.all[e];for(let s of r.rules){let n=s.rules.findIndex(i=>i.keyword===e);n>=0&&s.rules.splice(n,1)}return this}addFormat(e,r){return typeof r=="string"&&(r=new RegExp(r)),this.formats[e]=r,this}errorsText(e=this.errors,{separator:r=", ",dataVar:s="data"}={}){return!e||e.length===0?"No errors":e.map(n=>`${s}${n.instancePath} ${n.message}`).reduce((n,i)=>n+r+i)}$dataMetaSchema(e,r){let s=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(let n of r){let i=n.split("/").slice(1),o=e;for(let a of i)o=o[a];for(let a in s){let l=s[a];if(typeof l!="object")continue;let{$data:u}=l.definition,c=o[a];u&&c&&(o[a]=KU(c))}}return e}_removeAllSchemas(e,r){for(let s in e){let n=e[s];(!r||r.test(s))&&(typeof n=="string"?delete e[s]:n&&!n.meta&&(this._cache.delete(n.schema),delete e[s]))}}_addSchema(e,r,s,n=this.opts.validateSchema,i=this.opts.addUsedSchema){let o,{schemaId:a}=this.opts;if(typeof e=="object")o=e[a];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof e!="boolean")throw new Error("schema must be object or boolean")}let l=this._cache.get(e);if(l!==void 0)return l;s=(0,Qp.normalizeId)(o||s);let u=Qp.getSchemaRefs.call(this,e,s);return l=new Kp.SchemaEnv({schema:e,schemaId:a,meta:r,baseId:s,localRefs:u}),this._cache.set(l.schema,l),i&&!s.startsWith("#")&&(s&&this._checkUnique(s),this.refs[s]=l),n&&this.validateSchema(e,!0),l}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error(`schema with key or id "${e}" already exists`)}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):Kp.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}_compileMetaSchema(e){let r=this.opts;this.opts=this._metaOpts;try{Kp.compileSchema.call(this,e)}finally{this.opts=r}}};Wp.ValidationError=uge.default;Wp.MissingRefError=HU.default;Hr.default=Wp;function UU(t,e,r,s="error"){for(let n in t){let i=n;i in e&&this.logger[s](`${r}: option ${n}. ${t[i]}`)}}function VU(t){return t=(0,Qp.normalizeId)(t),this.schemas[t]||this.refs[t]}function vge(){let t=this.opts.schemas;if(t)if(Array.isArray(t))this.addSchema(t);else for(let e in t)this.addSchema(t[e],e)}function _ge(){for(let t in this.opts.formats){let e=this.opts.formats[t];e&&this.addFormat(t,e)}}function Sge(t){if(Array.isArray(t)){this.addVocabulary(t);return}this.logger.warn("keywords option as map is deprecated, pass array");for(let e in t){let r=t[e];r.keyword||(r.keyword=e),this.addKeyword(r)}}function bge(){let t={...this.opts};for(let e of hge)delete t[e];return t}var Ege={log(){},warn(){},error(){}};function wge(t){if(t===!1)return Ege;if(t===void 0)return console;if(t.log&&t.warn&&t.error)return t;throw new Error("logger must implement log, warn and error methods")}var Tge=/^[a-z_$][a-z0-9_$:-]*$/i;function Cge(t,e){let{RULES:r}=this;if((0,JR.eachItem)(t,s=>{if(r.keywords[s])throw new Error(`Keyword ${s} is already defined`);if(!Tge.test(s))throw new Error(`Keyword ${s} has invalid name`)}),!!e&&e.$data&&!("code"in e||"validate"in e))throw new Error('$data keyword must have "code" or "validate" function')}function YR(t,e,r){var s;let n=e?.post;if(r&&n)throw new Error('keyword with "post" flag cannot have "type"');let{RULES:i}=this,o=n?i.post:i.rules.find(({type:l})=>l===r);if(o||(o={type:r,rules:[]},i.rules.push(o)),i.keywords[t]=!0,!e)return;let a={keyword:t,definition:{...e,type:(0,gv.getJSONTypes)(e.type),schemaType:(0,gv.getJSONTypes)(e.schemaType)}};e.before?Rge.call(this,o,a,e.before):o.rules.push(a),i.all[t]=a,(s=e.implements)===null||s===void 0||s.forEach(l=>this.addKeyword(l))}function Rge(t,e,r){let s=t.rules.findIndex(n=>n.keyword===r);s>=0?t.rules.splice(s,0,e):(t.rules.push(e),this.logger.warn(`rule ${r} is not defined`))}function Oge(t){let{metaSchema:e}=t;e!==void 0&&(t.$data&&this.opts.$data&&(e=KU(e)),t.validateSchema=this.compile(e,!0))}var Pge={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function KU(t){return{anyOf:[t,Pge]}}});var QU=m(e1=>{"use strict";Object.defineProperty(e1,"__esModule",{value:!0});var Age={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};e1.default=Age});var t1=m(Nu=>{"use strict";Object.defineProperty(Nu,"__esModule",{value:!0});Nu.callRef=Nu.getValidate=void 0;var kge=Zo(),WU=Vr(),qs=Te(),Pd=On(),ZU=Iu(),yv=ze(),xge={keyword:"$ref",schemaType:"string",code(t){let{gen:e,schema:r,it:s}=t,{baseId:n,schemaEnv:i,validateName:o,opts:a,self:l}=s,{root:u}=i;if((r==="#"||r==="#/")&&n===u.baseId)return d();let c=ZU.resolveRef.call(l,u,n,r);if(c===void 0)throw new kge.default(s.opts.uriResolver,n,r);if(c instanceof ZU.SchemaEnv)return f(c);return h(c);function d(){if(i===u)return vv(t,o,i,i.$async);let p=e.scopeValue("root",{ref:u});return vv(t,(0,qs._)`${p}.validate`,u,u.$async)}function f(p){let g=YU(t,p);vv(t,g,p,p.$async)}function h(p){let g=e.scopeValue("schema",a.code.source===!0?{ref:p,code:(0,qs.stringify)(p)}:{ref:p}),_=e.name("valid"),S=t.subschema({schema:p,dataTypes:[],schemaPath:qs.nil,topSchemaRef:g,errSchemaPath:r},_);t.mergeEvaluated(S),t.ok(_)}}};function YU(t,e){let{gen:r}=t;return e.validate?r.scopeValue("validate",{ref:e.validate}):(0,qs._)`${r.scopeValue("wrapper",{ref:e})}.validate`}Nu.getValidate=YU;function vv(t,e,r,s){let{gen:n,it:i}=t,{allErrors:o,schemaEnv:a,opts:l}=i,u=l.passContext?Pd.default.this:qs.nil;s?c():d();function c(){if(!a.$async)throw new Error("async schema referenced by sync schema");let p=n.let("valid");n.try(()=>{n.code((0,qs._)`await ${(0,WU.callValidateCode)(t,e,u)}`),h(e),o||n.assign(p,!0)},g=>{n.if((0,qs._)`!(${g} instanceof ${i.ValidationError})`,()=>n.throw(g)),f(g),o||n.assign(p,!1)}),t.ok(p)}function d(){t.result((0,WU.callValidateCode)(t,e,u),()=>h(e),()=>f(e))}function f(p){let g=(0,qs._)`${p}.errors`;n.assign(Pd.default.vErrors,(0,qs._)`${Pd.default.vErrors} === null ? ${g} : ${Pd.default.vErrors}.concat(${g})`),n.assign(Pd.default.errors,(0,qs._)`${Pd.default.vErrors}.length`)}function h(p){var g;if(!i.opts.unevaluated)return;let _=(g=r?.validate)===null||g===void 0?void 0:g.evaluated;if(i.props!==!0)if(_&&!_.dynamicProps)_.props!==void 0&&(i.props=yv.mergeEvaluated.props(n,_.props,i.props));else{let S=n.var("props",(0,qs._)`${p}.evaluated.props`);i.props=yv.mergeEvaluated.props(n,S,i.props,qs.Name)}if(i.items!==!0)if(_&&!_.dynamicItems)_.items!==void 0&&(i.items=yv.mergeEvaluated.items(n,_.items,i.items));else{let S=n.var("items",(0,qs._)`${p}.evaluated.items`);i.items=yv.mergeEvaluated.items(n,S,i.items,qs.Name)}}}Nu.callRef=vv;Nu.default=xge});var JU=m(r1=>{"use strict";Object.defineProperty(r1,"__esModule",{value:!0});var Ige=QU(),Nge=t1(),Dge=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",Ige.default,Nge.default];r1.default=Dge});var XU=m(s1=>{"use strict";Object.defineProperty(s1,"__esModule",{value:!0});var _v=Te(),Ka=_v.operators,Sv={maximum:{okStr:"<=",ok:Ka.LTE,fail:Ka.GT},minimum:{okStr:">=",ok:Ka.GTE,fail:Ka.LT},exclusiveMaximum:{okStr:"<",ok:Ka.LT,fail:Ka.GTE},exclusiveMinimum:{okStr:">",ok:Ka.GT,fail:Ka.LTE}},Mge={message:({keyword:t,schemaCode:e})=>(0,_v.str)`must be ${Sv[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,_v._)`{comparison: ${Sv[t].okStr}, limit: ${e}}`},$ge={keyword:Object.keys(Sv),type:"number",schemaType:"number",$data:!0,error:Mge,code(t){let{keyword:e,data:r,schemaCode:s}=t;t.fail$data((0,_v._)`${r} ${Sv[e].fail} ${s} || isNaN(${r})`)}};s1.default=$ge});var e3=m(n1=>{"use strict";Object.defineProperty(n1,"__esModule",{value:!0});var Zp=Te(),qge={message:({schemaCode:t})=>(0,Zp.str)`must be multiple of ${t}`,params:({schemaCode:t})=>(0,Zp._)`{multipleOf: ${t}}`},Lge={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:qge,code(t){let{gen:e,data:r,schemaCode:s,it:n}=t,i=n.opts.multipleOfPrecision,o=e.let("res"),a=i?(0,Zp._)`Math.abs(Math.round(${o}) - ${o}) > 1e-${i}`:(0,Zp._)`${o} !== parseInt(${o})`;t.fail$data((0,Zp._)`(${s} === 0 || (${o} = ${r}/${s}, ${a}))`)}};n1.default=Lge});var r3=m(i1=>{"use strict";Object.defineProperty(i1,"__esModule",{value:!0});function t3(t){let e=t.length,r=0,s=0,n;for(;s<e;)r++,n=t.charCodeAt(s++),n>=55296&&n<=56319&&s<e&&(n=t.charCodeAt(s),(n&64512)===56320&&s++);return r}i1.default=t3;t3.code='require("ajv/dist/runtime/ucs2length").default'});var s3=m(o1=>{"use strict";Object.defineProperty(o1,"__esModule",{value:!0});var Du=Te(),jge=ze(),Fge=r3(),Bge={message({keyword:t,schemaCode:e}){let r=t==="maxLength"?"more":"fewer";return(0,Du.str)`must NOT have ${r} than ${e} characters`},params:({schemaCode:t})=>(0,Du._)`{limit: ${t}}`},zge={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:Bge,code(t){let{keyword:e,data:r,schemaCode:s,it:n}=t,i=e==="maxLength"?Du.operators.GT:Du.operators.LT,o=n.opts.unicode===!1?(0,Du._)`${r}.length`:(0,Du._)`${(0,jge.useFunc)(t.gen,Fge.default)}(${r})`;t.fail$data((0,Du._)`${o} ${i} ${s}`)}};o1.default=zge});var n3=m(a1=>{"use strict";Object.defineProperty(a1,"__esModule",{value:!0});var Uge=Vr(),bv=Te(),Vge={message:({schemaCode:t})=>(0,bv.str)`must match pattern "${t}"`,params:({schemaCode:t})=>(0,bv._)`{pattern: ${t}}`},Hge={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:Vge,code(t){let{data:e,$data:r,schema:s,schemaCode:n,it:i}=t,o=i.opts.unicodeRegExp?"u":"",a=r?(0,bv._)`(new RegExp(${n}, ${o}))`:(0,Uge.usePattern)(t,s);t.fail$data((0,bv._)`!${a}.test(${e})`)}};a1.default=Hge});var i3=m(l1=>{"use strict";Object.defineProperty(l1,"__esModule",{value:!0});var Yp=Te(),Gge={message({keyword:t,schemaCode:e}){let r=t==="maxProperties"?"more":"fewer";return(0,Yp.str)`must NOT have ${r} than ${e} properties`},params:({schemaCode:t})=>(0,Yp._)`{limit: ${t}}`},Kge={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:Gge,code(t){let{keyword:e,data:r,schemaCode:s}=t,n=e==="maxProperties"?Yp.operators.GT:Yp.operators.LT;t.fail$data((0,Yp._)`Object.keys(${r}).length ${n} ${s}`)}};l1.default=Kge});var o3=m(u1=>{"use strict";Object.defineProperty(u1,"__esModule",{value:!0});var Jp=Vr(),Xp=Te(),Qge=ze(),Wge={message:({params:{missingProperty:t}})=>(0,Xp.str)`must have required property '${t}'`,params:({params:{missingProperty:t}})=>(0,Xp._)`{missingProperty: ${t}}`},Zge={keyword:"required",type:"object",schemaType:"array",$data:!0,error:Wge,code(t){let{gen:e,schema:r,schemaCode:s,data:n,$data:i,it:o}=t,{opts:a}=o;if(!i&&r.length===0)return;let l=r.length>=a.loopRequired;if(o.allErrors?u():c(),a.strictRequired){let h=t.parentSchema.properties,{definedProperties:p}=t.it;for(let g of r)if(h?.[g]===void 0&&!p.has(g)){let _=o.schemaEnv.baseId+o.errSchemaPath,S=`required property "${g}" is not defined at "${_}" (strictRequired)`;(0,Qge.checkStrictMode)(o,S,o.opts.strictRequired)}}function u(){if(l||i)t.block$data(Xp.nil,d);else for(let h of r)(0,Jp.checkReportMissingProp)(t,h)}function c(){let h=e.let("missing");if(l||i){let p=e.let("valid",!0);t.block$data(p,()=>f(h,p)),t.ok(p)}else e.if((0,Jp.checkMissingProp)(t,r,h)),(0,Jp.reportMissingProp)(t,h),e.else()}function d(){e.forOf("prop",s,h=>{t.setParams({missingProperty:h}),e.if((0,Jp.noPropertyInData)(e,n,h,a.ownProperties),()=>t.error())})}function f(h,p){t.setParams({missingProperty:h}),e.forOf(h,s,()=>{e.assign(p,(0,Jp.propertyInData)(e,n,h,a.ownProperties)),e.if((0,Xp.not)(p),()=>{t.error(),e.break()})},Xp.nil)}}};u1.default=Zge});var a3=m(c1=>{"use strict";Object.defineProperty(c1,"__esModule",{value:!0});var em=Te(),Yge={message({keyword:t,schemaCode:e}){let r=t==="maxItems"?"more":"fewer";return(0,em.str)`must NOT have ${r} than ${e} items`},params:({schemaCode:t})=>(0,em._)`{limit: ${t}}`},Jge={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:Yge,code(t){let{keyword:e,data:r,schemaCode:s}=t,n=e==="maxItems"?em.operators.GT:em.operators.LT;t.fail$data((0,em._)`${r}.length ${n} ${s}`)}};c1.default=Jge});var tm=m(d1=>{"use strict";Object.defineProperty(d1,"__esModule",{value:!0});var l3=Fa();l3.code='require("ajv/dist/runtime/equal").default';d1.default=l3});var u3=m(h1=>{"use strict";Object.defineProperty(h1,"__esModule",{value:!0});var f1=zp(),Gr=Te(),Xge=ze(),eye=tm(),tye={message:({params:{i:t,j:e}})=>(0,Gr.str)`must NOT have duplicate items (items ## ${e} and ${t} are identical)`,params:({params:{i:t,j:e}})=>(0,Gr._)`{i: ${t}, j: ${e}}`},rye={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:tye,code(t){let{gen:e,data:r,$data:s,schema:n,parentSchema:i,schemaCode:o,it:a}=t;if(!s&&!n)return;let l=e.let("valid"),u=i.items?(0,f1.getSchemaTypes)(i.items):[];t.block$data(l,c,(0,Gr._)`${o} === false`),t.ok(l);function c(){let p=e.let("i",(0,Gr._)`${r}.length`),g=e.let("j");t.setParams({i:p,j:g}),e.assign(l,!0),e.if((0,Gr._)`${p} > 1`,()=>(d()?f:h)(p,g))}function d(){return u.length>0&&!u.some(p=>p==="object"||p==="array")}function f(p,g){let _=e.name("item"),S=(0,f1.checkDataTypes)(u,_,a.opts.strictNumbers,f1.DataType.Wrong),b=e.const("indices",(0,Gr._)`{}`);e.for((0,Gr._)`;${p}--;`,()=>{e.let(_,(0,Gr._)`${r}[${p}]`),e.if(S,(0,Gr._)`continue`),u.length>1&&e.if((0,Gr._)`typeof ${_} == "string"`,(0,Gr._)`${_} += "_"`),e.if((0,Gr._)`typeof ${b}[${_}] == "number"`,()=>{e.assign(g,(0,Gr._)`${b}[${_}]`),t.error(),e.assign(l,!1).break()}).code((0,Gr._)`${b}[${_}] = ${p}`)})}function h(p,g){let _=(0,Xge.useFunc)(e,eye.default),S=e.name("outer");e.label(S).for((0,Gr._)`;${p}--;`,()=>e.for((0,Gr._)`${g} = ${p}; ${g}--;`,()=>e.if((0,Gr._)`${_}(${r}[${p}], ${r}[${g}])`,()=>{t.error(),e.assign(l,!1).break(S)})))}}};h1.default=rye});var c3=m(m1=>{"use strict";Object.defineProperty(m1,"__esModule",{value:!0});var p1=Te(),sye=ze(),nye=tm(),iye={message:"must be equal to constant",params:({schemaCode:t})=>(0,p1._)`{allowedValue: ${t}}`},oye={keyword:"const",$data:!0,error:iye,code(t){let{gen:e,data:r,$data:s,schemaCode:n,schema:i}=t;s||i&&typeof i=="object"?t.fail$data((0,p1._)`!${(0,sye.useFunc)(e,nye.default)}(${r}, ${n})`):t.fail((0,p1._)`${i} !== ${r}`)}};m1.default=oye});var d3=m(g1=>{"use strict";Object.defineProperty(g1,"__esModule",{value:!0});var rm=Te(),aye=ze(),lye=tm(),uye={message:"must be equal to one of the allowed values",params:({schemaCode:t})=>(0,rm._)`{allowedValues: ${t}}`},cye={keyword:"enum",schemaType:"array",$data:!0,error:uye,code(t){let{gen:e,data:r,$data:s,schema:n,schemaCode:i,it:o}=t;if(!s&&n.length===0)throw new Error("enum must have non-empty array");let a=n.length>=o.opts.loopEnum,l,u=()=>l??(l=(0,aye.useFunc)(e,lye.default)),c;if(a||s)c=e.let("valid"),t.block$data(c,d);else{if(!Array.isArray(n))throw new Error("ajv implementation error");let h=e.const("vSchema",i);c=(0,rm.or)(...n.map((p,g)=>f(h,g)))}t.pass(c);function d(){e.assign(c,!1),e.forOf("v",i,h=>e.if((0,rm._)`${u()}(${r}, ${h})`,()=>e.assign(c,!0).break()))}function f(h,p){let g=n[p];return typeof g=="object"&&g!==null?(0,rm._)`${u()}(${r}, ${h}[${p}])`:(0,rm._)`${r} === ${g}`}}};g1.default=cye});var f3=m(y1=>{"use strict";Object.defineProperty(y1,"__esModule",{value:!0});var dye=XU(),fye=e3(),hye=s3(),pye=n3(),mye=i3(),gye=o3(),yye=a3(),vye=u3(),_ye=c3(),Sye=d3(),bye=[dye.default,fye.default,hye.default,pye.default,mye.default,gye.default,yye.default,vye.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},_ye.default,Sye.default];y1.default=bye});var _1=m(sm=>{"use strict";Object.defineProperty(sm,"__esModule",{value:!0});sm.validateAdditionalItems=void 0;var Mu=Te(),v1=ze(),Eye={message:({params:{len:t}})=>(0,Mu.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,Mu._)`{limit: ${t}}`},wye={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:Eye,code(t){let{parentSchema:e,it:r}=t,{items:s}=e;if(!Array.isArray(s)){(0,v1.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas');return}h3(t,s)}};function h3(t,e){let{gen:r,schema:s,data:n,keyword:i,it:o}=t;o.items=!0;let a=r.const("len",(0,Mu._)`${n}.length`);if(s===!1)t.setParams({len:e.length}),t.pass((0,Mu._)`${a} <= ${e.length}`);else if(typeof s=="object"&&!(0,v1.alwaysValidSchema)(o,s)){let u=r.var("valid",(0,Mu._)`${a} <= ${e.length}`);r.if((0,Mu.not)(u),()=>l(u)),t.ok(u)}function l(u){r.forRange("i",e.length,a,c=>{t.subschema({keyword:i,dataProp:c,dataPropType:v1.Type.Num},u),o.allErrors||r.if((0,Mu.not)(u),()=>r.break())})}}sm.validateAdditionalItems=h3;sm.default=wye});var S1=m(nm=>{"use strict";Object.defineProperty(nm,"__esModule",{value:!0});nm.validateTuple=void 0;var p3=Te(),Ev=ze(),Tye=Vr(),Cye={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(t){let{schema:e,it:r}=t;if(Array.isArray(e))return m3(t,"additionalItems",e);r.items=!0,!(0,Ev.alwaysValidSchema)(r,e)&&t.ok((0,Tye.validateArray)(t))}};function m3(t,e,r=t.schema){let{gen:s,parentSchema:n,data:i,keyword:o,it:a}=t;c(n),a.opts.unevaluated&&r.length&&a.items!==!0&&(a.items=Ev.mergeEvaluated.items(s,r.length,a.items));let l=s.name("valid"),u=s.const("len",(0,p3._)`${i}.length`);r.forEach((d,f)=>{(0,Ev.alwaysValidSchema)(a,d)||(s.if((0,p3._)`${u} > ${f}`,()=>t.subschema({keyword:o,schemaProp:f,dataProp:f},l)),t.ok(l))});function c(d){let{opts:f,errSchemaPath:h}=a,p=r.length,g=p===d.minItems&&(p===d.maxItems||d[e]===!1);if(f.strictTuples&&!g){let _=`"${o}" is ${p}-tuple, but minItems or maxItems/${e} are not specified or different at path "${h}"`;(0,Ev.checkStrictMode)(a,_,f.strictTuples)}}}nm.validateTuple=m3;nm.default=Cye});var g3=m(b1=>{"use strict";Object.defineProperty(b1,"__esModule",{value:!0});var Rye=S1(),Oye={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:t=>(0,Rye.validateTuple)(t,"items")};b1.default=Oye});var v3=m(E1=>{"use strict";Object.defineProperty(E1,"__esModule",{value:!0});var y3=Te(),Pye=ze(),Aye=Vr(),kye=_1(),xye={message:({params:{len:t}})=>(0,y3.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,y3._)`{limit: ${t}}`},Iye={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:xye,code(t){let{schema:e,parentSchema:r,it:s}=t,{prefixItems:n}=r;s.items=!0,!(0,Pye.alwaysValidSchema)(s,e)&&(n?(0,kye.validateAdditionalItems)(t,n):t.ok((0,Aye.validateArray)(t)))}};E1.default=Iye});var _3=m(w1=>{"use strict";Object.defineProperty(w1,"__esModule",{value:!0});var An=Te(),wv=ze(),Nye={message:({params:{min:t,max:e}})=>e===void 0?(0,An.str)`must contain at least ${t} valid item(s)`:(0,An.str)`must contain at least ${t} and no more than ${e} valid item(s)`,params:({params:{min:t,max:e}})=>e===void 0?(0,An._)`{minContains: ${t}}`:(0,An._)`{minContains: ${t}, maxContains: ${e}}`},Dye={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:Nye,code(t){let{gen:e,schema:r,parentSchema:s,data:n,it:i}=t,o,a,{minContains:l,maxContains:u}=s;i.opts.next?(o=l===void 0?1:l,a=u):o=1;let c=e.const("len",(0,An._)`${n}.length`);if(t.setParams({min:o,max:a}),a===void 0&&o===0){(0,wv.checkStrictMode)(i,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(a!==void 0&&o>a){(0,wv.checkStrictMode)(i,'"minContains" > "maxContains" is always invalid'),t.fail();return}if((0,wv.alwaysValidSchema)(i,r)){let g=(0,An._)`${c} >= ${o}`;a!==void 0&&(g=(0,An._)`${g} && ${c} <= ${a}`),t.pass(g);return}i.items=!0;let d=e.name("valid");a===void 0&&o===1?h(d,()=>e.if(d,()=>e.break())):o===0?(e.let(d,!0),a!==void 0&&e.if((0,An._)`${n}.length > 0`,f)):(e.let(d,!1),f()),t.result(d,()=>t.reset());function f(){let g=e.name("_valid"),_=e.let("count",0);h(g,()=>e.if(g,()=>p(_)))}function h(g,_){e.forRange("i",0,c,S=>{t.subschema({keyword:"contains",dataProp:S,dataPropType:wv.Type.Num,compositeRule:!0},g),_()})}function p(g){e.code((0,An._)`${g}++`),a===void 0?e.if((0,An._)`${g} >= ${o}`,()=>e.assign(d,!0).break()):(e.if((0,An._)`${g} > ${a}`,()=>e.assign(d,!1).break()),o===1?e.assign(d,!0):e.if((0,An._)`${g} >= ${o}`,()=>e.assign(d,!0)))}}};w1.default=Dye});var E3=m(Gi=>{"use strict";Object.defineProperty(Gi,"__esModule",{value:!0});Gi.validateSchemaDeps=Gi.validatePropertyDeps=Gi.error=void 0;var T1=Te(),Mye=ze(),im=Vr();Gi.error={message:({params:{property:t,depsCount:e,deps:r}})=>{let s=e===1?"property":"properties";return(0,T1.str)`must have ${s} ${r} when property ${t} is present`},params:({params:{property:t,depsCount:e,deps:r,missingProperty:s}})=>(0,T1._)`{property: ${t},
    missingProperty: ${s},
    depsCount: ${e},
    deps: ${r}}`};var $ye={keyword:"dependencies",type:"object",schemaType:"object",error:Gi.error,code(t){let[e,r]=qye(t);S3(t,e),b3(t,r)}};function qye({schema:t}){let e={},r={};for(let s in t){if(s==="__proto__")continue;let n=Array.isArray(t[s])?e:r;n[s]=t[s]}return[e,r]}function S3(t,e=t.schema){let{gen:r,data:s,it:n}=t;if(Object.keys(e).length===0)return;let i=r.let("missing");for(let o in e){let a=e[o];if(a.length===0)continue;let l=(0,im.propertyInData)(r,s,o,n.opts.ownProperties);t.setParams({property:o,depsCount:a.length,deps:a.join(", ")}),n.allErrors?r.if(l,()=>{for(let u of a)(0,im.checkReportMissingProp)(t,u)}):(r.if((0,T1._)`${l} && (${(0,im.checkMissingProp)(t,a,i)})`),(0,im.reportMissingProp)(t,i),r.else())}}Gi.validatePropertyDeps=S3;function b3(t,e=t.schema){let{gen:r,data:s,keyword:n,it:i}=t,o=r.name("valid");for(let a in e)(0,Mye.alwaysValidSchema)(i,e[a])||(r.if((0,im.propertyInData)(r,s,a,i.opts.ownProperties),()=>{let l=t.subschema({keyword:n,schemaProp:a},o);t.mergeValidEvaluated(l,o)},()=>r.var(o,!0)),t.ok(o))}Gi.validateSchemaDeps=b3;Gi.default=$ye});var T3=m(C1=>{"use strict";Object.defineProperty(C1,"__esModule",{value:!0});var w3=Te(),Lye=ze(),jye={message:"property name must be valid",params:({params:t})=>(0,w3._)`{propertyName: ${t.propertyName}}`},Fye={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:jye,code(t){let{gen:e,schema:r,data:s,it:n}=t;if((0,Lye.alwaysValidSchema)(n,r))return;let i=e.name("valid");e.forIn("key",s,o=>{t.setParams({propertyName:o}),t.subschema({keyword:"propertyNames",data:o,dataTypes:["string"],propertyName:o,compositeRule:!0},i),e.if((0,w3.not)(i),()=>{t.error(!0),n.allErrors||e.break()})}),t.ok(i)}};C1.default=Fye});var O1=m(R1=>{"use strict";Object.defineProperty(R1,"__esModule",{value:!0});var Tv=Vr(),mi=Te(),Bye=On(),Cv=ze(),zye={message:"must NOT have additional properties",params:({params:t})=>(0,mi._)`{additionalProperty: ${t.additionalProperty}}`},Uye={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:zye,code(t){let{gen:e,schema:r,parentSchema:s,data:n,errsCount:i,it:o}=t;if(!i)throw new Error("ajv implementation error");let{allErrors:a,opts:l}=o;if(o.props=!0,l.removeAdditional!=="all"&&(0,Cv.alwaysValidSchema)(o,r))return;let u=(0,Tv.allSchemaProperties)(s.properties),c=(0,Tv.allSchemaProperties)(s.patternProperties);d(),t.ok((0,mi._)`${i} === ${Bye.default.errors}`);function d(){e.forIn("key",n,_=>{!u.length&&!c.length?p(_):e.if(f(_),()=>p(_))})}function f(_){let S;if(u.length>8){let b=(0,Cv.schemaRefOrVal)(o,s.properties,"properties");S=(0,Tv.isOwnProperty)(e,b,_)}else u.length?S=(0,mi.or)(...u.map(b=>(0,mi._)`${_} === ${b}`)):S=mi.nil;return c.length&&(S=(0,mi.or)(S,...c.map(b=>(0,mi._)`${(0,Tv.usePattern)(t,b)}.test(${_})`))),(0,mi.not)(S)}function h(_){e.code((0,mi._)`delete ${n}[${_}]`)}function p(_){if(l.removeAdditional==="all"||l.removeAdditional&&r===!1){h(_);return}if(r===!1){t.setParams({additionalProperty:_}),t.error(),a||e.break();return}if(typeof r=="object"&&!(0,Cv.alwaysValidSchema)(o,r)){let S=e.name("valid");l.removeAdditional==="failing"?(g(_,S,!1),e.if((0,mi.not)(S),()=>{t.reset(),h(_)})):(g(_,S),a||e.if((0,mi.not)(S),()=>e.break()))}}function g(_,S,b){let v={keyword:"additionalProperties",dataProp:_,dataPropType:Cv.Type.Str};b===!1&&Object.assign(v,{compositeRule:!0,createErrors:!1,allErrors:!1}),t.subschema(v,S)}}};R1.default=Uye});var O3=m(A1=>{"use strict";Object.defineProperty(A1,"__esModule",{value:!0});var Vye=Cd(),C3=Vr(),P1=ze(),R3=O1(),Hye={keyword:"properties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,parentSchema:s,data:n,it:i}=t;i.opts.removeAdditional==="all"&&s.additionalProperties===void 0&&R3.default.code(new Vye.KeywordCxt(i,R3.default,"additionalProperties"));let o=(0,C3.allSchemaProperties)(r);for(let d of o)i.definedProperties.add(d);i.opts.unevaluated&&o.length&&i.props!==!0&&(i.props=P1.mergeEvaluated.props(e,(0,P1.toHash)(o),i.props));let a=o.filter(d=>!(0,P1.alwaysValidSchema)(i,r[d]));if(a.length===0)return;let l=e.name("valid");for(let d of a)u(d)?c(d):(e.if((0,C3.propertyInData)(e,n,d,i.opts.ownProperties)),c(d),i.allErrors||e.else().var(l,!0),e.endIf()),t.it.definedProperties.add(d),t.ok(l);function u(d){return i.opts.useDefaults&&!i.compositeRule&&r[d].default!==void 0}function c(d){t.subschema({keyword:"properties",schemaProp:d,dataProp:d},l)}}};A1.default=Hye});var x3=m(k1=>{"use strict";Object.defineProperty(k1,"__esModule",{value:!0});var P3=Vr(),Rv=Te(),A3=ze(),k3=ze(),Gye={keyword:"patternProperties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,data:s,parentSchema:n,it:i}=t,{opts:o}=i,a=(0,P3.allSchemaProperties)(r),l=a.filter(g=>(0,A3.alwaysValidSchema)(i,r[g]));if(a.length===0||l.length===a.length&&(!i.opts.unevaluated||i.props===!0))return;let u=o.strictSchema&&!o.allowMatchingProperties&&n.properties,c=e.name("valid");i.props!==!0&&!(i.props instanceof Rv.Name)&&(i.props=(0,k3.evaluatedPropsToName)(e,i.props));let{props:d}=i;f();function f(){for(let g of a)u&&h(g),i.allErrors?p(g):(e.var(c,!0),p(g),e.if(c))}function h(g){for(let _ in u)new RegExp(g).test(_)&&(0,A3.checkStrictMode)(i,`property ${_} matches pattern ${g} (use allowMatchingProperties)`)}function p(g){e.forIn("key",s,_=>{e.if((0,Rv._)`${(0,P3.usePattern)(t,g)}.test(${_})`,()=>{let S=l.includes(g);S||t.subschema({keyword:"patternProperties",schemaProp:g,dataProp:_,dataPropType:k3.Type.Str},c),i.opts.unevaluated&&d!==!0?e.assign((0,Rv._)`${d}[${_}]`,!0):!S&&!i.allErrors&&e.if((0,Rv.not)(c),()=>e.break())})})}}};k1.default=Gye});var I3=m(x1=>{"use strict";Object.defineProperty(x1,"__esModule",{value:!0});var Kye=ze(),Qye={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(t){let{gen:e,schema:r,it:s}=t;if((0,Kye.alwaysValidSchema)(s,r)){t.fail();return}let n=e.name("valid");t.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},n),t.failResult(n,()=>t.reset(),()=>t.error())},error:{message:"must NOT be valid"}};x1.default=Qye});var N3=m(I1=>{"use strict";Object.defineProperty(I1,"__esModule",{value:!0});var Wye=Vr(),Zye={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:Wye.validateUnion,error:{message:"must match a schema in anyOf"}};I1.default=Zye});var D3=m(N1=>{"use strict";Object.defineProperty(N1,"__esModule",{value:!0});var Ov=Te(),Yye=ze(),Jye={message:"must match exactly one schema in oneOf",params:({params:t})=>(0,Ov._)`{passingSchemas: ${t.passing}}`},Xye={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:Jye,code(t){let{gen:e,schema:r,parentSchema:s,it:n}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(n.opts.discriminator&&s.discriminator)return;let i=r,o=e.let("valid",!1),a=e.let("passing",null),l=e.name("_valid");t.setParams({passing:a}),e.block(u),t.result(o,()=>t.reset(),()=>t.error(!0));function u(){i.forEach((c,d)=>{let f;(0,Yye.alwaysValidSchema)(n,c)?e.var(l,!0):f=t.subschema({keyword:"oneOf",schemaProp:d,compositeRule:!0},l),d>0&&e.if((0,Ov._)`${l} && ${o}`).assign(o,!1).assign(a,(0,Ov._)`[${a}, ${d}]`).else(),e.if(l,()=>{e.assign(o,!0),e.assign(a,d),f&&t.mergeEvaluated(f,Ov.Name)})})}}};N1.default=Xye});var M3=m(D1=>{"use strict";Object.defineProperty(D1,"__esModule",{value:!0});var e0e=ze(),t0e={keyword:"allOf",schemaType:"array",code(t){let{gen:e,schema:r,it:s}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");let n=e.name("valid");r.forEach((i,o)=>{if((0,e0e.alwaysValidSchema)(s,i))return;let a=t.subschema({keyword:"allOf",schemaProp:o},n);t.ok(n),t.mergeEvaluated(a)})}};D1.default=t0e});var L3=m(M1=>{"use strict";Object.defineProperty(M1,"__esModule",{value:!0});var Pv=Te(),q3=ze(),r0e={message:({params:t})=>(0,Pv.str)`must match "${t.ifClause}" schema`,params:({params:t})=>(0,Pv._)`{failingKeyword: ${t.ifClause}}`},s0e={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:r0e,code(t){let{gen:e,parentSchema:r,it:s}=t;r.then===void 0&&r.else===void 0&&(0,q3.checkStrictMode)(s,'"if" without "then" and "else" is ignored');let n=$3(s,"then"),i=$3(s,"else");if(!n&&!i)return;let o=e.let("valid",!0),a=e.name("_valid");if(l(),t.reset(),n&&i){let c=e.let("ifClause");t.setParams({ifClause:c}),e.if(a,u("then",c),u("else",c))}else n?e.if(a,u("then")):e.if((0,Pv.not)(a),u("else"));t.pass(o,()=>t.error(!0));function l(){let c=t.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},a);t.mergeEvaluated(c)}function u(c,d){return()=>{let f=t.subschema({keyword:c},a);e.assign(o,a),t.mergeValidEvaluated(f,o),d?e.assign(d,(0,Pv._)`${c}`):t.setParams({ifClause:c})}}}};function $3(t,e){let r=t.schema[e];return r!==void 0&&!(0,q3.alwaysValidSchema)(t,r)}M1.default=s0e});var j3=m($1=>{"use strict";Object.defineProperty($1,"__esModule",{value:!0});var n0e=ze(),i0e={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:t,parentSchema:e,it:r}){e.if===void 0&&(0,n0e.checkStrictMode)(r,`"${t}" without "if" is ignored`)}};$1.default=i0e});var F3=m(q1=>{"use strict";Object.defineProperty(q1,"__esModule",{value:!0});var o0e=_1(),a0e=g3(),l0e=S1(),u0e=v3(),c0e=_3(),d0e=E3(),f0e=T3(),h0e=O1(),p0e=O3(),m0e=x3(),g0e=I3(),y0e=N3(),v0e=D3(),_0e=M3(),S0e=L3(),b0e=j3();function E0e(t=!1){let e=[g0e.default,y0e.default,v0e.default,_0e.default,S0e.default,b0e.default,f0e.default,h0e.default,d0e.default,p0e.default,m0e.default];return t?e.push(a0e.default,u0e.default):e.push(o0e.default,l0e.default),e.push(c0e.default),e}q1.default=E0e});var B3=m(L1=>{"use strict";Object.defineProperty(L1,"__esModule",{value:!0});var ur=Te(),w0e={message:({schemaCode:t})=>(0,ur.str)`must match format "${t}"`,params:({schemaCode:t})=>(0,ur._)`{format: ${t}}`},T0e={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:w0e,code(t,e){let{gen:r,data:s,$data:n,schema:i,schemaCode:o,it:a}=t,{opts:l,errSchemaPath:u,schemaEnv:c,self:d}=a;if(!l.validateFormats)return;n?f():h();function f(){let p=r.scopeValue("formats",{ref:d.formats,code:l.code.formats}),g=r.const("fDef",(0,ur._)`${p}[${o}]`),_=r.let("fType"),S=r.let("format");r.if((0,ur._)`typeof ${g} == "object" && !(${g} instanceof RegExp)`,()=>r.assign(_,(0,ur._)`${g}.type || "string"`).assign(S,(0,ur._)`${g}.validate`),()=>r.assign(_,(0,ur._)`"string"`).assign(S,g)),t.fail$data((0,ur.or)(b(),v()));function b(){return l.strictSchema===!1?ur.nil:(0,ur._)`${o} && !${S}`}function v(){let y=c.$async?(0,ur._)`(${g}.async ? await ${S}(${s}) : ${S}(${s}))`:(0,ur._)`${S}(${s})`,R=(0,ur._)`(typeof ${S} == "function" ? ${y} : ${S}.test(${s}))`;return(0,ur._)`${S} && ${S} !== true && ${_} === ${e} && !${R}`}}function h(){let p=d.formats[i];if(!p){b();return}if(p===!0)return;let[g,_,S]=v(p);g===e&&t.pass(y());function b(){if(l.strictSchema===!1){d.logger.warn(R());return}throw new Error(R());function R(){return`unknown format "${i}" ignored in schema at path "${u}"`}}function v(R){let P=R instanceof RegExp?(0,ur.regexpCode)(R):l.code.formats?(0,ur._)`${l.code.formats}${(0,ur.getProperty)(i)}`:void 0,w=r.scopeValue("formats",{key:i,ref:R,code:P});return typeof R=="object"&&!(R instanceof RegExp)?[R.type||"string",R.validate,(0,ur._)`${w}.validate`]:["string",R,w]}function y(){if(typeof p=="object"&&!(p instanceof RegExp)&&p.async){if(!c.$async)throw new Error("async format in sync schema");return(0,ur._)`await ${S}(${s})`}return typeof _=="function"?(0,ur._)`${S}(${s})`:(0,ur._)`${S}.test(${s})`}}}};L1.default=T0e});var z3=m(j1=>{"use strict";Object.defineProperty(j1,"__esModule",{value:!0});var C0e=B3(),R0e=[C0e.default];j1.default=R0e});var U3=m(Ad=>{"use strict";Object.defineProperty(Ad,"__esModule",{value:!0});Ad.contentVocabulary=Ad.metadataVocabulary=void 0;Ad.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];Ad.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]});var H3=m(F1=>{"use strict";Object.defineProperty(F1,"__esModule",{value:!0});var O0e=JU(),P0e=f3(),A0e=F3(),k0e=z3(),V3=U3(),x0e=[O0e.default,P0e.default,(0,A0e.default)(),k0e.default,V3.metadataVocabulary,V3.contentVocabulary];F1.default=x0e});var B1=m(Av=>{"use strict";Object.defineProperty(Av,"__esModule",{value:!0});Av.DiscrError=void 0;var G3;(function(t){t.Tag="tag",t.Mapping="mapping"})(G3||(Av.DiscrError=G3={}))});var Q3=m(U1=>{"use strict";Object.defineProperty(U1,"__esModule",{value:!0});var kd=Te(),z1=B1(),K3=Iu(),I0e=Zo(),N0e=ze(),D0e={message:({params:{discrError:t,tagName:e}})=>t===z1.DiscrError.Tag?`tag "${e}" must be string`:`value of tag "${e}" must be in oneOf`,params:({params:{discrError:t,tag:e,tagName:r}})=>(0,kd._)`{error: ${t}, tag: ${r}, tagValue: ${e}}`},M0e={keyword:"discriminator",type:"object",schemaType:"object",error:D0e,code(t){let{gen:e,data:r,schema:s,parentSchema:n,it:i}=t,{oneOf:o}=n;if(!i.opts.discriminator)throw new Error("discriminator: requires discriminator option");let a=s.propertyName;if(typeof a!="string")throw new Error("discriminator: requires propertyName");if(s.mapping)throw new Error("discriminator: mapping is not supported");if(!o)throw new Error("discriminator: requires oneOf keyword");let l=e.let("valid",!1),u=e.const("tag",(0,kd._)`${r}${(0,kd.getProperty)(a)}`);e.if((0,kd._)`typeof ${u} == "string"`,()=>c(),()=>t.error(!1,{discrError:z1.DiscrError.Tag,tag:u,tagName:a})),t.ok(l);function c(){let h=f();e.if(!1);for(let p in h)e.elseIf((0,kd._)`${u} === ${p}`),e.assign(l,d(h[p]));e.else(),t.error(!1,{discrError:z1.DiscrError.Mapping,tag:u,tagName:a}),e.endIf()}function d(h){let p=e.name("valid"),g=t.subschema({keyword:"oneOf",schemaProp:h},p);return t.mergeEvaluated(g,kd.Name),p}function f(){var h;let p={},g=S(n),_=!0;for(let y=0;y<o.length;y++){let R=o[y];if(R?.$ref&&!(0,N0e.schemaHasRulesButRef)(R,i.self.RULES)){let w=R.$ref;if(R=K3.resolveRef.call(i.self,i.schemaEnv.root,i.baseId,w),R instanceof K3.SchemaEnv&&(R=R.schema),R===void 0)throw new I0e.default(i.opts.uriResolver,i.baseId,w)}let P=(h=R?.properties)===null||h===void 0?void 0:h[a];if(typeof P!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${a}"`);_=_&&(g||S(R)),b(P,y)}if(!_)throw new Error(`discriminator: "${a}" must be required`);return p;function S({required:y}){return Array.isArray(y)&&y.includes(a)}function b(y,R){if(y.const)v(y.const,R);else if(y.enum)for(let P of y.enum)v(P,R);else throw new Error(`discriminator: "properties/${a}" must have "const" or "enum"`)}function v(y,R){if(typeof y!="string"||y in p)throw new Error(`discriminator: "${a}" values must be unique strings`);p[y]=R}}}};U1.default=M0e});var W3=m((u5e,$0e)=>{$0e.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}});var Nd=m((Ft,V1)=>{"use strict";Object.defineProperty(Ft,"__esModule",{value:!0});Ft.MissingRefError=Ft.ValidationError=Ft.CodeGen=Ft.Name=Ft.nil=Ft.stringify=Ft.str=Ft._=Ft.KeywordCxt=Ft.Ajv=void 0;var q0e=XR(),L0e=H3(),j0e=Q3(),Z3=W3(),F0e=["/properties"],kv="http://json-schema.org/draft-07/schema",xd=class extends q0e.default{_addVocabularies(){super._addVocabularies(),L0e.default.forEach(e=>this.addVocabulary(e)),this.opts.discriminator&&this.addKeyword(j0e.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;let e=this.opts.$data?this.$dataMetaSchema(Z3,F0e):Z3;this.addMetaSchema(e,kv,!1),this.refs["http://json-schema.org/schema"]=kv}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(kv)?kv:void 0)}};Ft.Ajv=xd;V1.exports=Ft=xd;V1.exports.Ajv=xd;Object.defineProperty(Ft,"__esModule",{value:!0});Ft.default=xd;var B0e=Cd();Object.defineProperty(Ft,"KeywordCxt",{enumerable:!0,get:function(){return B0e.KeywordCxt}});var Id=Te();Object.defineProperty(Ft,"_",{enumerable:!0,get:function(){return Id._}});Object.defineProperty(Ft,"str",{enumerable:!0,get:function(){return Id.str}});Object.defineProperty(Ft,"stringify",{enumerable:!0,get:function(){return Id.stringify}});Object.defineProperty(Ft,"nil",{enumerable:!0,get:function(){return Id.nil}});Object.defineProperty(Ft,"Name",{enumerable:!0,get:function(){return Id.Name}});Object.defineProperty(Ft,"CodeGen",{enumerable:!0,get:function(){return Id.CodeGen}});var z0e=Gp();Object.defineProperty(Ft,"ValidationError",{enumerable:!0,get:function(){return z0e.default}});var U0e=Zo();Object.defineProperty(Ft,"MissingRefError",{enumerable:!0,get:function(){return U0e.default}})});var J3=m((c5e,Y3)=>{"use strict";var V0e={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};Y3.exports={HEX:V0e}});var o4=m((d5e,i4)=>{"use strict";var{HEX:H0e}=J3();function r4(t){if(n4(t,".")<3)return{host:t,isIPV4:!1};let e=t.match(/^(\b[01]?\d{1,2}|\b2[0-4]\d|\b25[0-5])(\.([01]?\d{1,2}|2[0-4]\d|25[0-5])){3}$/u)||[],[r]=e;return r?{host:K0e(r,"."),isIPV4:!0}:{host:t,isIPV4:!1}}function H1(t){let e="",r=!0;for(let s of t){if(s!=="0"&&r===!0&&(r=!1),H0e[s]===void 0)return;r||(e+=s)}return e}function G0e(t){let e=0,r={error:!1,address:"",zone:""},s=[],n=[],i=!1,o=!1,a=!1;function l(){if(n.length){if(i===!1){let u=H1(n.join(""));if(u!==void 0)s.push(u);else return r.error=!0,!1}n.length=0}return!0}for(let u=0;u<t.length;u++){let c=t[u];if(!(c==="["||c==="]"))if(c===":"){if(o===!0&&(a=!0),!l())break;if(e++,s.push(":"),e>7){r.error=!0;break}u-1>=0&&t[u-1]===":"&&(o=!0);continue}else if(c==="%"){if(!l())break;i=!0}else{n.push(c);continue}}return n.length&&(i?r.zone=n.join(""):a?s.push(n.join("")):s.push(H1(n.join("")))),r.address=s.join(""),r}function s4(t,e={}){if(n4(t,":")<2)return{host:t,isIPV6:!1};let r=G0e(t);if(r.error)return{host:t,isIPV6:!1};{let s=r.address,n=r.address;return r.zone&&(s+="%"+r.zone,n+="%25"+r.zone),{host:s,escapedHost:n,isIPV6:!0}}}function K0e(t,e){let r="",s=!0,n=t.length;for(let i=0;i<n;i++){let o=t[i];o==="0"&&s?(i+1<=n&&t[i+1]===e||i+1===n)&&(r+=o,s=!1):(o===e?s=!0:s=!1,r+=o)}return r}function n4(t,e){let r=0;for(let s=0;s<t.length;s++)t[s]===e&&r++;return r}var X3=/^\.\.?\//u,e4=/^\/\.(?:\/|$)/u,t4=/^\/\.\.(?:\/|$)/u,Q0e=/^\/?(?:.|\n)*?(?=\/|$)/u;function W0e(t){let e=[];for(;t.length;)if(t.match(X3))t=t.replace(X3,"");else if(t.match(e4))t=t.replace(e4,"/");else if(t.match(t4))t=t.replace(t4,"/"),e.pop();else if(t==="."||t==="..")t="";else{let r=t.match(Q0e);if(r){let s=r[0];t=t.slice(s.length),e.push(s)}else throw new Error("Unexpected dot segment condition")}return e.join("")}function Z0e(t,e){let r=e!==!0?escape:unescape;return t.scheme!==void 0&&(t.scheme=r(t.scheme)),t.userinfo!==void 0&&(t.userinfo=r(t.userinfo)),t.host!==void 0&&(t.host=r(t.host)),t.path!==void 0&&(t.path=r(t.path)),t.query!==void 0&&(t.query=r(t.query)),t.fragment!==void 0&&(t.fragment=r(t.fragment)),t}function Y0e(t,e){let r=[];if(t.userinfo!==void 0&&(r.push(t.userinfo),r.push("@")),t.host!==void 0){let s=unescape(t.host),n=r4(s);if(n.isIPV4)s=n.host;else{let i=s4(n.host,{isIPV4:!1});i.isIPV6===!0?s=`[${i.escapedHost}]`:s=t.host}r.push(s)}return(typeof t.port=="number"||typeof t.port=="string")&&(r.push(":"),r.push(String(t.port))),r.length?r.join(""):void 0}i4.exports={recomposeAuthority:Y0e,normalizeComponentEncoding:Z0e,removeDotSegments:W0e,normalizeIPv4:r4,normalizeIPv6:s4,stringToHexStripped:H1}});var f4=m((f5e,d4)=>{"use strict";var J0e=/^[\da-f]{8}\b-[\da-f]{4}\b-[\da-f]{4}\b-[\da-f]{4}\b-[\da-f]{12}$/iu,X0e=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu;function a4(t){return typeof t.secure=="boolean"?t.secure:String(t.scheme).toLowerCase()==="wss"}function l4(t){return t.host||(t.error=t.error||"HTTP URIs must have a host."),t}function u4(t){let e=String(t.scheme).toLowerCase()==="https";return(t.port===(e?443:80)||t.port==="")&&(t.port=void 0),t.path||(t.path="/"),t}function eve(t){return t.secure=a4(t),t.resourceName=(t.path||"/")+(t.query?"?"+t.query:""),t.path=void 0,t.query=void 0,t}function tve(t){if((t.port===(a4(t)?443:80)||t.port==="")&&(t.port=void 0),typeof t.secure=="boolean"&&(t.scheme=t.secure?"wss":"ws",t.secure=void 0),t.resourceName){let[e,r]=t.resourceName.split("?");t.path=e&&e!=="/"?e:void 0,t.query=r,t.resourceName=void 0}return t.fragment=void 0,t}function rve(t,e){if(!t.path)return t.error="URN can not be parsed",t;let r=t.path.match(X0e);if(r){let s=e.scheme||t.scheme||"urn";t.nid=r[1].toLowerCase(),t.nss=r[2];let n=`${s}:${e.nid||t.nid}`,i=G1[n];t.path=void 0,i&&(t=i.parse(t,e))}else t.error=t.error||"URN can not be parsed.";return t}function sve(t,e){let r=e.scheme||t.scheme||"urn",s=t.nid.toLowerCase(),n=`${r}:${e.nid||s}`,i=G1[n];i&&(t=i.serialize(t,e));let o=t,a=t.nss;return o.path=`${s||e.nid}:${a}`,e.skipEscape=!0,o}function nve(t,e){let r=t;return r.uuid=r.nss,r.nss=void 0,!e.tolerant&&(!r.uuid||!J0e.test(r.uuid))&&(r.error=r.error||"UUID is not valid."),r}function ive(t){let e=t;return e.nss=(t.uuid||"").toLowerCase(),e}var c4={scheme:"http",domainHost:!0,parse:l4,serialize:u4},ove={scheme:"https",domainHost:c4.domainHost,parse:l4,serialize:u4},xv={scheme:"ws",domainHost:!0,parse:eve,serialize:tve},ave={scheme:"wss",domainHost:xv.domainHost,parse:xv.parse,serialize:xv.serialize},lve={scheme:"urn",parse:rve,serialize:sve,skipNormalize:!0},uve={scheme:"urn:uuid",parse:nve,serialize:ive,skipNormalize:!0},G1={http:c4,https:ove,ws:xv,wss:ave,urn:lve,"urn:uuid":uve};d4.exports=G1});var Q1=m((h5e,Nv)=>{"use strict";var{normalizeIPv6:cve,normalizeIPv4:dve,removeDotSegments:om,recomposeAuthority:fve,normalizeComponentEncoding:Iv}=o4(),h4=f4();function hve(t,e){return typeof t=="string"?t=Ki(Yo(t,e),e):typeof t=="object"&&(t=Yo(Ki(t,e),e)),t}function pve(t,e,r){let s=Object.assign({scheme:"null"},r),n=p4(Yo(t,s),Yo(e,s),s,!0);return Ki(n,{...s,skipEscape:!0})}function p4(t,e,r,s){let n={};return s||(t=Yo(Ki(t,r),r),e=Yo(Ki(e,r),r)),r=r||{},!r.tolerant&&e.scheme?(n.scheme=e.scheme,n.userinfo=e.userinfo,n.host=e.host,n.port=e.port,n.path=om(e.path||""),n.query=e.query):(e.userinfo!==void 0||e.host!==void 0||e.port!==void 0?(n.userinfo=e.userinfo,n.host=e.host,n.port=e.port,n.path=om(e.path||""),n.query=e.query):(e.path?(e.path.charAt(0)==="/"?n.path=om(e.path):((t.userinfo!==void 0||t.host!==void 0||t.port!==void 0)&&!t.path?n.path="/"+e.path:t.path?n.path=t.path.slice(0,t.path.lastIndexOf("/")+1)+e.path:n.path=e.path,n.path=om(n.path)),n.query=e.query):(n.path=t.path,e.query!==void 0?n.query=e.query:n.query=t.query),n.userinfo=t.userinfo,n.host=t.host,n.port=t.port),n.scheme=t.scheme),n.fragment=e.fragment,n}function mve(t,e,r){return typeof t=="string"?(t=unescape(t),t=Ki(Iv(Yo(t,r),!0),{...r,skipEscape:!0})):typeof t=="object"&&(t=Ki(Iv(t,!0),{...r,skipEscape:!0})),typeof e=="string"?(e=unescape(e),e=Ki(Iv(Yo(e,r),!0),{...r,skipEscape:!0})):typeof e=="object"&&(e=Ki(Iv(e,!0),{...r,skipEscape:!0})),t.toLowerCase()===e.toLowerCase()}function Ki(t,e){let r={host:t.host,scheme:t.scheme,userinfo:t.userinfo,port:t.port,path:t.path,query:t.query,nid:t.nid,nss:t.nss,uuid:t.uuid,fragment:t.fragment,reference:t.reference,resourceName:t.resourceName,secure:t.secure,error:""},s=Object.assign({},e),n=[],i=h4[(s.scheme||r.scheme||"").toLowerCase()];i&&i.serialize&&i.serialize(r,s),r.path!==void 0&&(s.skipEscape?r.path=unescape(r.path):(r.path=escape(r.path),r.scheme!==void 0&&(r.path=r.path.split("%3A").join(":")))),s.reference!=="suffix"&&r.scheme&&(n.push(r.scheme),n.push(":"));let o=fve(r,s);if(o!==void 0&&(s.reference!=="suffix"&&n.push("//"),n.push(o),r.path&&r.path.charAt(0)!=="/"&&n.push("/")),r.path!==void 0){let a=r.path;!s.absolutePath&&(!i||!i.absolutePath)&&(a=om(a)),o===void 0&&(a=a.replace(/^\/\//u,"/%2F")),n.push(a)}return r.query!==void 0&&(n.push("?"),n.push(r.query)),r.fragment!==void 0&&(n.push("#"),n.push(r.fragment)),n.join("")}var gve=Array.from({length:127},(t,e)=>/[^!"$&'()*+,\-.;=_`a-z{}~]/u.test(String.fromCharCode(e)));function yve(t){let e=0;for(let r=0,s=t.length;r<s;++r)if(e=t.charCodeAt(r),e>126||gve[e])return!0;return!1}var vve=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function Yo(t,e){let r=Object.assign({},e),s={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0},n=t.indexOf("%")!==-1;r.reference==="suffix"&&(t=(r.scheme?r.scheme+":":"")+"//"+t);let i=t.match(vve);if(i){if(s.scheme=i[1],s.userinfo=i[3],s.host=i[4],s.port=parseInt(i[5],10),s.path=i[6]||"",s.query=i[7],s.fragment=i[8],isNaN(s.port)&&(s.port=i[5]),s.host){let a=dve(s.host);a.isIPV4===!1?s.host=cve(a.host,{isIPV4:!1}).host.toLowerCase():s.host=a.host}s.scheme===void 0&&s.userinfo===void 0&&s.host===void 0&&s.port===void 0&&!s.path&&s.query===void 0?s.reference="same-document":s.scheme===void 0?s.reference="relative":s.fragment===void 0?s.reference="absolute":s.reference="uri",r.reference&&r.reference!=="suffix"&&r.reference!==s.reference&&(s.error=s.error||"URI is not a "+r.reference+" reference.");let o=h4[(r.scheme||s.scheme||"").toLowerCase()];if(!r.unicodeSupport&&(!o||!o.unicodeSupport)&&s.host&&(r.domainHost||o&&o.domainHost)&&yve(s.host))try{s.host=URL.domainToASCII(s.host.toLowerCase())}catch(a){s.error=s.error||"Host's domain name can not be converted to ASCII: "+a}(!o||o&&!o.skipNormalize)&&(n&&s.scheme!==void 0&&(s.scheme=unescape(s.scheme)),n&&s.userinfo!==void 0&&(s.userinfo=unescape(s.userinfo)),n&&s.host!==void 0&&(s.host=unescape(s.host)),s.path!==void 0&&s.path.length&&(s.path=escape(unescape(s.path))),s.fragment!==void 0&&s.fragment.length&&(s.fragment=encodeURI(decodeURI(s.fragment)))),o&&o.parse&&o.parse(s,r)}else s.error=s.error||"URI can not be parsed.";return s}var K1={normalize:hve,resolve:pve,resolveComponents:p4,equal:mve,serialize:Ki,parse:Yo};Nv.exports=K1;Nv.exports.default=K1;Nv.exports.fastUri=K1});var Dv=m(Wi=>{"use strict";Object.defineProperty(Wi,"__esModule",{value:!0});Wi.formatNames=Wi.fastFormats=Wi.fullFormats=void 0;function Qi(t,e){return{validate:t,compare:e}}Wi.fullFormats={date:Qi(v4,J1),time:Qi(Z1(!0),X1),"date-time":Qi(m4(!0),S4),"iso-time":Qi(Z1(),_4),"iso-date-time":Qi(m4(),b4),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:Tve,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:xve,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:Cve,int32:{type:"number",validate:Pve},int64:{type:"number",validate:Ave},float:{type:"number",validate:y4},double:{type:"number",validate:y4},password:!0,binary:!0};Wi.fastFormats={...Wi.fullFormats,date:Qi(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,J1),time:Qi(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,X1),"date-time":Qi(/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,S4),"iso-time":Qi(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,_4),"iso-date-time":Qi(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,b4),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i};Wi.formatNames=Object.keys(Wi.fullFormats);function _ve(t){return t%4===0&&(t%100!==0||t%400===0)}var Sve=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,bve=[0,31,28,31,30,31,30,31,31,30,31,30,31];function v4(t){let e=Sve.exec(t);if(!e)return!1;let r=+e[1],s=+e[2],n=+e[3];return s>=1&&s<=12&&n>=1&&n<=(s===2&&_ve(r)?29:bve[s])}function J1(t,e){if(t&&e)return t>e?1:t<e?-1:0}var W1=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function Z1(t){return function(r){let s=W1.exec(r);if(!s)return!1;let n=+s[1],i=+s[2],o=+s[3],a=s[4],l=s[5]==="-"?-1:1,u=+(s[6]||0),c=+(s[7]||0);if(u>23||c>59||t&&!a)return!1;if(n<=23&&i<=59&&o<60)return!0;let d=i-c*l,f=n-u*l-(d<0?1:0);return(f===23||f===-1)&&(d===59||d===-1)&&o<61}}function X1(t,e){if(!(t&&e))return;let r=new Date("2020-01-01T"+t).valueOf(),s=new Date("2020-01-01T"+e).valueOf();if(r&&s)return r-s}function _4(t,e){if(!(t&&e))return;let r=W1.exec(t),s=W1.exec(e);if(r&&s)return t=r[1]+r[2]+r[3],e=s[1]+s[2]+s[3],t>e?1:t<e?-1:0}var Y1=/t|\s/i;function m4(t){let e=Z1(t);return function(s){let n=s.split(Y1);return n.length===2&&v4(n[0])&&e(n[1])}}function S4(t,e){if(!(t&&e))return;let r=new Date(t).valueOf(),s=new Date(e).valueOf();if(r&&s)return r-s}function b4(t,e){if(!(t&&e))return;let[r,s]=t.split(Y1),[n,i]=e.split(Y1),o=J1(r,n);if(o!==void 0)return o||X1(s,i)}var Eve=/\/|:/,wve=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function Tve(t){return Eve.test(t)&&wve.test(t)}var g4=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function Cve(t){return g4.lastIndex=0,g4.test(t)}var Rve=-(2**31),Ove=2**31-1;function Pve(t){return Number.isInteger(t)&&t<=Ove&&t>=Rve}function Ave(t){return Number.isInteger(t)}function y4(){return!0}var kve=/[^\\]\\Z/;function xve(t){if(kve.test(t))return!1;try{return new RegExp(t),!0}catch{return!1}}});var E4=m(Dd=>{"use strict";Object.defineProperty(Dd,"__esModule",{value:!0});Dd.formatLimitDefinition=void 0;var Ive=Nd(),gi=Te(),Qa=gi.operators,Mv={formatMaximum:{okStr:"<=",ok:Qa.LTE,fail:Qa.GT},formatMinimum:{okStr:">=",ok:Qa.GTE,fail:Qa.LT},formatExclusiveMaximum:{okStr:"<",ok:Qa.LT,fail:Qa.GTE},formatExclusiveMinimum:{okStr:">",ok:Qa.GT,fail:Qa.LTE}},Nve={message:({keyword:t,schemaCode:e})=>(0,gi.str)`should be ${Mv[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,gi._)`{comparison: ${Mv[t].okStr}, limit: ${e}}`};Dd.formatLimitDefinition={keyword:Object.keys(Mv),type:"string",schemaType:"string",$data:!0,error:Nve,code(t){let{gen:e,data:r,schemaCode:s,keyword:n,it:i}=t,{opts:o,self:a}=i;if(!o.validateFormats)return;let l=new Ive.KeywordCxt(i,a.RULES.all.format.definition,"format");l.$data?u():c();function u(){let f=e.scopeValue("formats",{ref:a.formats,code:o.code.formats}),h=e.const("fmt",(0,gi._)`${f}[${l.schemaCode}]`);t.fail$data((0,gi.or)((0,gi._)`typeof ${h} != "object"`,(0,gi._)`${h} instanceof RegExp`,(0,gi._)`typeof ${h}.compare != "function"`,d(h)))}function c(){let f=l.schema,h=a.formats[f];if(!h||h===!0)return;if(typeof h!="object"||h instanceof RegExp||typeof h.compare!="function")throw new Error(`"${n}": format "${f}" does not define "compare" function`);let p=e.scopeValue("formats",{key:f,ref:h,code:o.code.formats?(0,gi._)`${o.code.formats}${(0,gi.getProperty)(f)}`:void 0});t.fail$data(d(p))}function d(f){return(0,gi._)`${f}.compare(${r}, ${s}) ${Mv[n].fail} 0`}},dependencies:["format"]};var Dve=t=>(t.addKeyword(Dd.formatLimitDefinition),t);Dd.default=Dve});var R4=m((am,C4)=>{"use strict";Object.defineProperty(am,"__esModule",{value:!0});var Md=Dv(),Mve=E4(),eO=Te(),w4=new eO.Name("fullFormats"),$ve=new eO.Name("fastFormats"),tO=(t,e={keywords:!0})=>{if(Array.isArray(e))return T4(t,e,Md.fullFormats,w4),t;let[r,s]=e.mode==="fast"?[Md.fastFormats,$ve]:[Md.fullFormats,w4],n=e.formats||Md.formatNames;return T4(t,n,r,s),e.keywords&&(0,Mve.default)(t),t};tO.get=(t,e="full")=>{let s=(e==="fast"?Md.fastFormats:Md.fullFormats)[t];if(!s)throw new Error(`Unknown format "${t}"`);return s};function T4(t,e,r,s){var n,i;(n=(i=t.opts.code).formats)!==null&&n!==void 0||(i.formats=(0,eO._)`require("ajv-formats/dist/formats").${s}`);for(let o of e)t.addFormat(o,r[o])}C4.exports=am=tO;Object.defineProperty(am,"__esModule",{value:!0});am.default=tO});var rO=m((g5e,O4)=>{"use strict";var qve=Nd(),Lve=Q1(),jve=R4(),Fve=_0()({proto:!0}),lm=class{constructor(e){this.ajv=new qve({...e,strictSchema:!1,validateSchema:!1,allowUnionTypes:!0,uriResolver:Lve}),jve(this.ajv),this.ajv.addKeyword({keyword:"fjs_type",type:"object",errors:!1,validate:(r,s)=>s instanceof Date}),this._ajvSchemas={},this._ajvOptions=e||{}}addSchema(e,r){let s=e.$id||r;if(e.$id!==void 0&&e.$id[0]==="#"&&(s=r+e.$id),this.ajv.refs[s]===void 0&&this.ajv.schemas[s]===void 0){let n=Fve(e);this.convertSchemaToAjvFormat(n),this.ajv.addSchema(n,s),this._ajvSchemas[s]=e}}validate(e,r){return this.ajv.validate(e,r)}convertSchemaToAjvFormat(e){if(e!==null){e.type==="string"?(e.fjs_type="string",e.type=["string","object"]):Array.isArray(e.type)&&e.type.includes("string")&&!e.type.includes("object")&&(e.fjs_type="string",e.type.push("object"));for(let r in e)typeof e[r]=="object"&&this.convertSchemaToAjvFormat(e[r])}}getState(){return{ajvOptions:this._ajvOptions,ajvSchemas:this._ajvSchemas}}static restoreFromState(e){let r=new lm(e.ajvOptions);for(let[s,n]of Object.entries(e.ajvSchemas))r.ajv.addSchema(n,s);return r}};O4.exports=lm});var A4=m((y5e,P4)=>{"use strict";var um=class{constructor(e,r,s="#"){this.schema=e,this.schemaId=r,this.jsonPointer=s}getPropertyLocation(e){return new um(this.schema[e],this.schemaId,this.jsonPointer+"/"+e)}getSchemaRef(){return this.schemaId+this.jsonPointer}};P4.exports=um});var D4=m((v5e,nO)=>{"use strict";nO.exports=te;nO.exports.default=te;var Bve={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0},k4={enum:["array","boolean","integer","null","number","object","string"]},x4=/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,zve=Dv().fullFormats.uri,I4=Dv().fullFormats.regex;function kn(t,{instancePath:e="",parentData:r,parentDataProperty:s,rootData:n=t}={}){let i=null,o=0,a=o;return typeof t=="number"&&!(t%1)&&!isNaN(t)&&isFinite(t)?o===a&&typeof t=="number"&&isFinite(t)&&(t<0||isNaN(t))?(kn.errors=[{instancePath:e,schemaPath:"#/definitions/nonNegativeInteger/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0"}],!1):(kn.errors=i,o===0):(kn.errors=[{instancePath:e,schemaPath:"#/definitions/nonNegativeInteger/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1)}var sO={validate:te};function Es(t,{instancePath:e="",parentData:r,parentDataProperty:s,rootData:n=t}={}){let i=null,o=0;if(o===0)if(Array.isArray(t)){if(t.length<1)return Es.errors=[{instancePath:e,schemaPath:"#/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"}],!1;{var a=!0;let l=t.length;for(let u=0;u<l;u++){let c=o;sO.validate(t[u],{instancePath:e+"/"+u,parentData:t,parentDataProperty:u,rootData:n})||(i=i===null?sO.validate.errors:i.concat(sO.validate.errors),o=i.length);var a=c===o;if(!a)break}}}else return Es.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;return Es.errors=i,o===0}var N4=tm().default;function te(t,{instancePath:e="",parentData:r,parentDataProperty:s,rootData:n=t}={}){let i=null,o=0;if(!(t&&typeof t=="object"&&!Array.isArray(t))&&typeof t!="boolean")return te.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:Bve.type},message:"must be object,boolean"}],!1;if(o===0&&t&&typeof t=="object"&&!Array.isArray(t)){if(t.$id!==void 0){let v=t.$id,y=o;if(o===y&&o===y)if(typeof v=="string"){if(!x4.test(v))return te.errors=[{instancePath:e+"/$id",schemaPath:"#/properties/%24id/format",keyword:"format",params:{format:"uri-reference"},message:'must match format "uri-reference"'}],!1}else return te.errors=[{instancePath:e+"/$id",schemaPath:"#/properties/%24id/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=y===o}else var a=!0;if(a){if(t.$schema!==void 0){let v=t.$schema,y=o;if(o===y&&o===y)if(typeof v=="string"){if(!zve(v))return te.errors=[{instancePath:e+"/$schema",schemaPath:"#/properties/%24schema/format",keyword:"format",params:{format:"uri"},message:'must match format "uri"'}],!1}else return te.errors=[{instancePath:e+"/$schema",schemaPath:"#/properties/%24schema/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=y===o}else var a=!0;if(a){if(t.$ref!==void 0){let v=t.$ref,y=o;if(o===y&&o===y)if(typeof v=="string"){if(!x4.test(v))return te.errors=[{instancePath:e+"/$ref",schemaPath:"#/properties/%24ref/format",keyword:"format",params:{format:"uri-reference"},message:'must match format "uri-reference"'}],!1}else return te.errors=[{instancePath:e+"/$ref",schemaPath:"#/properties/%24ref/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=y===o}else var a=!0;if(a){if(t.$comment!==void 0){let v=o;if(typeof t.$comment!="string")return te.errors=[{instancePath:e+"/$comment",schemaPath:"#/properties/%24comment/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=v===o}else var a=!0;if(a){if(t.title!==void 0){let v=o;if(typeof t.title!="string")return te.errors=[{instancePath:e+"/title",schemaPath:"#/properties/title/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=v===o}else var a=!0;if(a){if(t.description!==void 0){let v=o;if(typeof t.description!="string")return te.errors=[{instancePath:e+"/description",schemaPath:"#/properties/description/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=v===o}else var a=!0;if(a){if(t.readOnly!==void 0){let v=o;if(typeof t.readOnly!="boolean")return te.errors=[{instancePath:e+"/readOnly",schemaPath:"#/properties/readOnly/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;var a=v===o}else var a=!0;if(a){if(t.examples!==void 0){let v=o;if(o===v&&!Array.isArray(t.examples))return te.errors=[{instancePath:e+"/examples",schemaPath:"#/properties/examples/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;var a=v===o}else var a=!0;if(a){if(t.multipleOf!==void 0){let v=t.multipleOf,y=o;if(o===y)if(typeof v=="number"&&isFinite(v)){if(v<=0||isNaN(v))return te.errors=[{instancePath:e+"/multipleOf",schemaPath:"#/properties/multipleOf/exclusiveMinimum",keyword:"exclusiveMinimum",params:{comparison:">",limit:0},message:"must be > 0"}],!1}else return te.errors=[{instancePath:e+"/multipleOf",schemaPath:"#/properties/multipleOf/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var a=y===o}else var a=!0;if(a){if(t.maximum!==void 0){let v=t.maximum,y=o;if(!(typeof v=="number"&&isFinite(v)))return te.errors=[{instancePath:e+"/maximum",schemaPath:"#/properties/maximum/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var a=y===o}else var a=!0;if(a){if(t.exclusiveMaximum!==void 0){let v=t.exclusiveMaximum,y=o;if(!(typeof v=="number"&&isFinite(v)))return te.errors=[{instancePath:e+"/exclusiveMaximum",schemaPath:"#/properties/exclusiveMaximum/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var a=y===o}else var a=!0;if(a){if(t.minimum!==void 0){let v=t.minimum,y=o;if(!(typeof v=="number"&&isFinite(v)))return te.errors=[{instancePath:e+"/minimum",schemaPath:"#/properties/minimum/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var a=y===o}else var a=!0;if(a){if(t.exclusiveMinimum!==void 0){let v=t.exclusiveMinimum,y=o;if(!(typeof v=="number"&&isFinite(v)))return te.errors=[{instancePath:e+"/exclusiveMinimum",schemaPath:"#/properties/exclusiveMinimum/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var a=y===o}else var a=!0;if(a){if(t.maxLength!==void 0){let v=t.maxLength,y=o,R=o;if(!(typeof v=="number"&&!(v%1)&&!isNaN(v)&&isFinite(v)))return te.errors=[{instancePath:e+"/maxLength",schemaPath:"#/definitions/nonNegativeInteger/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;if(o===R&&typeof v=="number"&&isFinite(v)&&(v<0||isNaN(v)))return te.errors=[{instancePath:e+"/maxLength",schemaPath:"#/definitions/nonNegativeInteger/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0"}],!1;var a=y===o}else var a=!0;if(a){if(t.minLength!==void 0){let v=o;kn(t.minLength,{instancePath:e+"/minLength",parentData:t,parentDataProperty:"minLength",rootData:n})||(i=i===null?kn.errors:i.concat(kn.errors),o=i.length);var a=v===o}else var a=!0;if(a){if(t.pattern!==void 0){let v=t.pattern,y=o;if(o===y&&o===y)if(typeof v=="string"){if(!I4(v))return te.errors=[{instancePath:e+"/pattern",schemaPath:"#/properties/pattern/format",keyword:"format",params:{format:"regex"},message:'must match format "regex"'}],!1}else return te.errors=[{instancePath:e+"/pattern",schemaPath:"#/properties/pattern/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=y===o}else var a=!0;if(a){if(t.additionalItems!==void 0){let v=o;te(t.additionalItems,{instancePath:e+"/additionalItems",parentData:t,parentDataProperty:"additionalItems",rootData:n})||(i=i===null?te.errors:i.concat(te.errors),o=i.length);var a=v===o}else var a=!0;if(a){if(t.items!==void 0){let v=t.items,y=o,R=o,P=!1,w=o;te(v,{instancePath:e+"/items",parentData:t,parentDataProperty:"items",rootData:n})||(i=i===null?te.errors:i.concat(te.errors),o=i.length);var l=w===o;if(P=P||l,!P){let $=o;Es(v,{instancePath:e+"/items",parentData:t,parentDataProperty:"items",rootData:n})||(i=i===null?Es.errors:i.concat(Es.errors),o=i.length);var l=$===o;P=P||l}if(P)o=R,i!==null&&(R?i.length=R:i=null);else{let $={instancePath:e+"/items",schemaPath:"#/properties/items/anyOf",keyword:"anyOf",params:{},message:"must match a schema in anyOf"};return i===null?i=[$]:i.push($),o++,te.errors=i,!1}var a=y===o}else var a=!0;if(a){if(t.maxItems!==void 0){let v=t.maxItems,y=o,R=o;if(!(typeof v=="number"&&!(v%1)&&!isNaN(v)&&isFinite(v)))return te.errors=[{instancePath:e+"/maxItems",schemaPath:"#/definitions/nonNegativeInteger/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;if(o===R&&typeof v=="number"&&isFinite(v)&&(v<0||isNaN(v)))return te.errors=[{instancePath:e+"/maxItems",schemaPath:"#/definitions/nonNegativeInteger/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0"}],!1;var a=y===o}else var a=!0;if(a){if(t.minItems!==void 0){let v=o;kn(t.minItems,{instancePath:e+"/minItems",parentData:t,parentDataProperty:"minItems",rootData:n})||(i=i===null?kn.errors:i.concat(kn.errors),o=i.length);var a=v===o}else var a=!0;if(a){if(t.uniqueItems!==void 0){let v=o;if(typeof t.uniqueItems!="boolean")return te.errors=[{instancePath:e+"/uniqueItems",schemaPath:"#/properties/uniqueItems/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;var a=v===o}else var a=!0;if(a){if(t.contains!==void 0){let v=o;te(t.contains,{instancePath:e+"/contains",parentData:t,parentDataProperty:"contains",rootData:n})||(i=i===null?te.errors:i.concat(te.errors),o=i.length);var a=v===o}else var a=!0;if(a){if(t.maxProperties!==void 0){let v=t.maxProperties,y=o,R=o;if(!(typeof v=="number"&&!(v%1)&&!isNaN(v)&&isFinite(v)))return te.errors=[{instancePath:e+"/maxProperties",schemaPath:"#/definitions/nonNegativeInteger/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;if(o===R&&typeof v=="number"&&isFinite(v)&&(v<0||isNaN(v)))return te.errors=[{instancePath:e+"/maxProperties",schemaPath:"#/definitions/nonNegativeInteger/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0"}],!1;var a=y===o}else var a=!0;if(a){if(t.minProperties!==void 0){let v=o;kn(t.minProperties,{instancePath:e+"/minProperties",parentData:t,parentDataProperty:"minProperties",rootData:n})||(i=i===null?kn.errors:i.concat(kn.errors),o=i.length);var a=v===o}else var a=!0;if(a){if(t.required!==void 0){let v=t.required,y=o;if(o===o)if(Array.isArray(v)){var u=!0;let w=v.length;for(let O=0;O<w;O++){let $=o;if(typeof v[O]!="string")return te.errors=[{instancePath:e+"/required/"+O,schemaPath:"#/definitions/stringArray/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=$===o;if(!u)break}if(u){let O=v.length,$;if(O>1){let C={};for(;O--;){let k=v[O];if(typeof k=="string"){if(typeof C[k]=="number"){return $=C[k],te.errors=[{instancePath:e+"/required",schemaPath:"#/definitions/stringArray/uniqueItems",keyword:"uniqueItems",params:{i:O,j:$},message:"must NOT have duplicate items (items ## "+$+" and "+O+" are identical)"}],!1;break}C[k]=O}}}}}else return te.errors=[{instancePath:e+"/required",schemaPath:"#/definitions/stringArray/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;var a=y===o}else var a=!0;if(a){if(t.additionalProperties!==void 0){let v=o;te(t.additionalProperties,{instancePath:e+"/additionalProperties",parentData:t,parentDataProperty:"additionalProperties",rootData:n})||(i=i===null?te.errors:i.concat(te.errors),o=i.length);var a=v===o}else var a=!0;if(a){if(t.definitions!==void 0){let v=t.definitions,y=o;if(o===y)if(v&&typeof v=="object"&&!Array.isArray(v))for(let P in v){let w=o;te(v[P],{instancePath:e+"/definitions/"+P.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:v,parentDataProperty:P,rootData:n})||(i=i===null?te.errors:i.concat(te.errors),o=i.length);var c=w===o;if(!c)break}else return te.errors=[{instancePath:e+"/definitions",schemaPath:"#/properties/definitions/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=y===o}else var a=!0;if(a){if(t.properties!==void 0){let v=t.properties,y=o;if(o===y)if(v&&typeof v=="object"&&!Array.isArray(v))for(let P in v){let w=o;te(v[P],{instancePath:e+"/properties/"+P.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:v,parentDataProperty:P,rootData:n})||(i=i===null?te.errors:i.concat(te.errors),o=i.length);var d=w===o;if(!d)break}else return te.errors=[{instancePath:e+"/properties",schemaPath:"#/properties/properties/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=y===o}else var a=!0;if(a){if(t.patternProperties!==void 0){let v=t.patternProperties,y=o;if(o===y)if(v&&typeof v=="object"&&!Array.isArray(v)){for(let P in v){let w=o;if(o===w&&typeof P=="string"&&!I4(P)){let O={instancePath:e+"/patternProperties",schemaPath:"#/properties/patternProperties/propertyNames/format",keyword:"format",params:{format:"regex"},message:'must match format "regex"',propertyName:P};i===null?i=[O]:i.push(O),o++}var f=w===o;if(!f){let O={instancePath:e+"/patternProperties",schemaPath:"#/properties/patternProperties/propertyNames",keyword:"propertyNames",params:{propertyName:P},message:"property name must be valid"};return i===null?i=[O]:i.push(O),o++,te.errors=i,!1;break}}if(f)for(let P in v){let w=o;te(v[P],{instancePath:e+"/patternProperties/"+P.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:v,parentDataProperty:P,rootData:n})||(i=i===null?te.errors:i.concat(te.errors),o=i.length);var h=w===o;if(!h)break}}else return te.errors=[{instancePath:e+"/patternProperties",schemaPath:"#/properties/patternProperties/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=y===o}else var a=!0;if(a){if(t.dependencies!==void 0){let v=t.dependencies,y=o;if(o===y)if(v&&typeof v=="object"&&!Array.isArray(v))for(let P in v){let w=v[P],O=o,$=o,C=!1,k=o;te(w,{instancePath:e+"/dependencies/"+P.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:v,parentDataProperty:P,rootData:n})||(i=i===null?te.errors:i.concat(te.errors),o=i.length);var p=k===o;if(C=C||p,!C){let z=o;if(o===o)if(Array.isArray(w)){var g=!0;let V=w.length;for(let G=0;G<V;G++){let X=o;if(typeof w[G]!="string"){let J={instancePath:e+"/dependencies/"+P.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+G,schemaPath:"#/definitions/stringArray/items/type",keyword:"type",params:{type:"string"},message:"must be string"};i===null?i=[J]:i.push(J),o++}var g=X===o;if(!g)break}if(g){let G=w.length,X;if(G>1){let pe={};for(;G--;){let J=w[G];if(typeof J=="string"){if(typeof pe[J]=="number"){X=pe[J];let ye={instancePath:e+"/dependencies/"+P.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/stringArray/uniqueItems",keyword:"uniqueItems",params:{i:G,j:X},message:"must NOT have duplicate items (items ## "+X+" and "+G+" are identical)"};i===null?i=[ye]:i.push(ye),o++;break}pe[J]=G}}}}}else{let V={instancePath:e+"/dependencies/"+P.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/stringArray/type",keyword:"type",params:{type:"array"},message:"must be array"};i===null?i=[V]:i.push(V),o++}var p=z===o;C=C||p}if(C)o=$,i!==null&&($?i.length=$:i=null);else{let z={instancePath:e+"/dependencies/"+P.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/dependencies/additionalProperties/anyOf",keyword:"anyOf",params:{},message:"must match a schema in anyOf"};return i===null?i=[z]:i.push(z),o++,te.errors=i,!1}var _=O===o;if(!_)break}else return te.errors=[{instancePath:e+"/dependencies",schemaPath:"#/properties/dependencies/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=y===o}else var a=!0;if(a){if(t.propertyNames!==void 0){let v=o;te(t.propertyNames,{instancePath:e+"/propertyNames",parentData:t,parentDataProperty:"propertyNames",rootData:n})||(i=i===null?te.errors:i.concat(te.errors),o=i.length);var a=v===o}else var a=!0;if(a){if(t.enum!==void 0){let v=t.enum,y=o;if(o===y)if(Array.isArray(v)){if(v.length<1)return te.errors=[{instancePath:e+"/enum",schemaPath:"#/properties/enum/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"}],!1;{let P=v.length,w;if(P>1){e:for(;P--;)for(w=P;w--;)if(N4(v[P],v[w])){return te.errors=[{instancePath:e+"/enum",schemaPath:"#/properties/enum/uniqueItems",keyword:"uniqueItems",params:{i:P,j:w},message:"must NOT have duplicate items (items ## "+w+" and "+P+" are identical)"}],!1;break e}}}}else return te.errors=[{instancePath:e+"/enum",schemaPath:"#/properties/enum/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;var a=y===o}else var a=!0;if(a){if(t.type!==void 0){let v=t.type,y=o,R=o,P=!1,w=o;if(!(v==="array"||v==="boolean"||v==="integer"||v==="null"||v==="number"||v==="object"||v==="string")){let $={instancePath:e+"/type",schemaPath:"#/definitions/simpleTypes/enum",keyword:"enum",params:{allowedValues:k4.enum},message:"must be equal to one of the allowed values"};i===null?i=[$]:i.push($),o++}var S=w===o;if(P=P||S,!P){let $=o;if(o===$)if(Array.isArray(v))if(v.length<1){let k={instancePath:e+"/type",schemaPath:"#/properties/type/anyOf/1/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"};i===null?i=[k]:i.push(k),o++}else{var b=!0;let k=v.length;for(let z=0;z<k;z++){let A=v[z],E=o;if(!(A==="array"||A==="boolean"||A==="integer"||A==="null"||A==="number"||A==="object"||A==="string")){let G={instancePath:e+"/type/"+z,schemaPath:"#/definitions/simpleTypes/enum",keyword:"enum",params:{allowedValues:k4.enum},message:"must be equal to one of the allowed values"};i===null?i=[G]:i.push(G),o++}var b=E===o;if(!b)break}if(b){let z=v.length,A;if(z>1){e:for(;z--;)for(A=z;A--;)if(N4(v[z],v[A])){let E={instancePath:e+"/type",schemaPath:"#/properties/type/anyOf/1/uniqueItems",keyword:"uniqueItems",params:{i:z,j:A},message:"must NOT have duplicate items (items ## "+A+" and "+z+" are identical)"};i===null?i=[E]:i.push(E),o++;break e}}}}else{let k={instancePath:e+"/type",schemaPath:"#/properties/type/anyOf/1/type",keyword:"type",params:{type:"array"},message:"must be array"};i===null?i=[k]:i.push(k),o++}var S=$===o;P=P||S}if(P)o=R,i!==null&&(R?i.length=R:i=null);else{let $={instancePath:e+"/type",schemaPath:"#/properties/type/anyOf",keyword:"anyOf",params:{},message:"must match a schema in anyOf"};return i===null?i=[$]:i.push($),o++,te.errors=i,!1}var a=y===o}else var a=!0;if(a){if(t.format!==void 0){let v=o;if(typeof t.format!="string")return te.errors=[{instancePath:e+"/format",schemaPath:"#/properties/format/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=v===o}else var a=!0;if(a){if(t.contentMediaType!==void 0){let v=o;if(typeof t.contentMediaType!="string")return te.errors=[{instancePath:e+"/contentMediaType",schemaPath:"#/properties/contentMediaType/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=v===o}else var a=!0;if(a){if(t.contentEncoding!==void 0){let v=o;if(typeof t.contentEncoding!="string")return te.errors=[{instancePath:e+"/contentEncoding",schemaPath:"#/properties/contentEncoding/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=v===o}else var a=!0;if(a){if(t.if!==void 0){let v=o;te(t.if,{instancePath:e+"/if",parentData:t,parentDataProperty:"if",rootData:n})||(i=i===null?te.errors:i.concat(te.errors),o=i.length);var a=v===o}else var a=!0;if(a){if(t.then!==void 0){let v=o;te(t.then,{instancePath:e+"/then",parentData:t,parentDataProperty:"then",rootData:n})||(i=i===null?te.errors:i.concat(te.errors),o=i.length);var a=v===o}else var a=!0;if(a){if(t.else!==void 0){let v=o;te(t.else,{instancePath:e+"/else",parentData:t,parentDataProperty:"else",rootData:n})||(i=i===null?te.errors:i.concat(te.errors),o=i.length);var a=v===o}else var a=!0;if(a){if(t.allOf!==void 0){let v=o;Es(t.allOf,{instancePath:e+"/allOf",parentData:t,parentDataProperty:"allOf",rootData:n})||(i=i===null?Es.errors:i.concat(Es.errors),o=i.length);var a=v===o}else var a=!0;if(a){if(t.anyOf!==void 0){let v=o;Es(t.anyOf,{instancePath:e+"/anyOf",parentData:t,parentDataProperty:"anyOf",rootData:n})||(i=i===null?Es.errors:i.concat(Es.errors),o=i.length);var a=v===o}else var a=!0;if(a){if(t.oneOf!==void 0){let v=o;Es(t.oneOf,{instancePath:e+"/oneOf",parentData:t,parentDataProperty:"oneOf",rootData:n})||(i=i===null?Es.errors:i.concat(Es.errors),o=i.length);var a=v===o}else var a=!0;if(a)if(t.not!==void 0){let v=o;te(t.not,{instancePath:e+"/not",parentData:t,parentDataProperty:"not",rootData:n})||(i=i===null?te.errors:i.concat(te.errors),o=i.length);var a=v===o}else var a=!0}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}return te.errors=i,o===0}});var lO=m((_5e,M4)=>{"use strict";var iO=class extends Error{constructor(e,r){super(),this.name="JsonSchemaMergeError",this.code="JSON_SCHEMA_MERGE_ERROR",this.message=`Failed to merge "${e}" keyword schemas.`,this.schemas=r}},oO=class extends Error{constructor(e,r){super(),this.name="JsonSchemaMergeError",this.code="JSON_SCHEMA_MERGE_ERROR",this.message=`Resolver for "${e}" keyword not found.`,this.schemas=r}},aO=class extends Error{constructor(e){super(),this.name="JsonSchemaMergeError",this.code="JSON_SCHEMA_MERGE_ERROR",this.message=`Invalid "onConflict" option: "${e}".`}};M4.exports={MergeError:iO,ResolverNotFoundError:oO,InvalidOnConflictOptionError:aO}});var L4=m((S5e,q4)=>{"use strict";var Uve=Fa(),{MergeError:uO}=lO();function $4(t){let e=t[0];for(let r=1;r<t.length;r++)e=e.filter(s=>t[r].includes(s));return e}function Vve(t,e,r){let s=$4(e);if(s.length===0)throw new uO(t,e);r[t]=s}function Hve(t,e,r){for(let n=0;n<e.length;n++)Array.isArray(e[n])||(e[n]=[e[n]]);let s=$4(e);if(s.length===0)throw new uO(t,e);s.length===1?r[t]=s[0]:r[t]=s}function Gve(t,e,r){let s=[];for(let n of e)for(let i of n)s.includes(i)||s.push(i);r[t]=s}function Kve(t,e,r){r[t]=Math.min(...e)}function Qve(t,e,r){r[t]=Math.max(...e)}function Wve(t,e,r){let s=(a,l)=>l?s(l,a%l):a,n=(a,l)=>a*l/s(a,l),i=1;for(let a of e)for(;a*i%1!==0;)i*=10;let o=e[0]*i;for(let a of e)o=n(o,a*i);r[t]=o/i}function Zve(t,e,r){let s=e[0];for(let n=1;n<e.length;n++)if(!Uve(e[n],s))throw new uO(t,e);r[t]=s}function Yve(){}function Jve(t,e,r){for(let s of e)if(s===!1){r[t]=!1;return}r[t]=!0}function Xve(t,e,r){for(let s of e)if(s===!0){r[t]=!0;return}r[t]=!1}q4.exports={arraysIntersection:Vve,hybridArraysIntersection:Hve,arraysUnion:Gve,minNumber:Kve,maxNumber:Qve,commonMultiple:Wve,allEqual:Zve,booleanAnd:Jve,booleanOr:Xve,skip:Yve}});var V4=m((b5e,U4)=>{"use strict";var e_e=Fa(),Qt=L4(),Lv=lO(),B4={$id:Qt.skip,type:Qt.hybridArraysIntersection,enum:Qt.arraysIntersection,minLength:Qt.maxNumber,maxLength:Qt.minNumber,minimum:Qt.maxNumber,maximum:Qt.minNumber,multipleOf:Qt.commonMultiple,exclusiveMinimum:Qt.maxNumber,exclusiveMaximum:Qt.minNumber,minItems:Qt.maxNumber,maxItems:Qt.minNumber,maxProperties:Qt.minNumber,minProperties:Qt.maxNumber,const:Qt.allEqual,default:Qt.allEqual,format:Qt.allEqual,required:Qt.arraysUnion,properties:o_e,patternProperties:qv,additionalProperties:$v,items:s_e,additionalItems:n_e,definitions:qv,$defs:qv,nullable:Qt.booleanAnd,oneOf:j4,anyOf:j4,allOf:Qt.arraysUnion,not:$v,if:a_e,then:Qt.skip,else:Qt.skip,dependencies:F4,dependentRequired:F4,dependentSchemas:qv,propertyNames:$v,uniqueItems:Qt.booleanOr,contains:$v};function $v(t,e,r,s,n){r[t]=yi(e,n)}function t_e(t){let e=[[]];for(let r of t){let s=[];for(let n of e)for(let i of r)s.push([...n,i]);e=s}return e}function j4(t,e,r,s,n){if(e.length===1){r[t]=e[0];return}let i=t_e(e),o=[];for(let a of i)try{let l=yi(a,n);l!==void 0&&o.push(l)}catch(l){if(l instanceof Lv.MergeError)continue;throw l}r[t]=o}function r_e(t,e){let{items:r,additionalItems:s}=t;return Array.isArray(r)?e<r.length?r[e]:s:r!==void 0?r:s}function s_e(t,e,r,s,n){let i=0;for(let a of e)Array.isArray(a)&&(i=Math.max(i,a.length));if(i===0){r[t]=yi(e,n);return}let o=[];for(let a=0;a<i;a++){let l=[];for(let u of s){let c=r_e(u,a);c!==void 0&&l.push(c)}o[a]=yi(l,n)}r[t]=o}function n_e(t,e,r,s,n){let i=!1;for(let a of s)if(Array.isArray(a.items)){i=!0;break}if(!i){r[t]=yi(e,n);return}let o=[];for(let a of s){let l=a.additionalItems;l===void 0&&!Array.isArray(a.items)&&(l=a.items),l!==void 0&&o.push(l)}r[t]=yi(o,n)}function i_e(t,e){let{properties:r,patternProperties:s,additionalProperties:n}=t;if(r?.[e]!==void 0)return r[e];for(let i of Object.keys(s??{}))if(new RegExp(i).test(e))return s[i];return n}function o_e(t,e,r,s,n){let i={};for(let a of s){let l=a.properties??{};for(let u of Object.keys(l)){if(i[u]!==void 0)continue;let c=l[u];i[u]=[c];for(let d of s){if(a===d)continue;let f=i_e(d,u);f!==void 0&&i[u].push(f)}}}let o={};for(let a of Object.keys(i)){let l=i[a];o[a]=yi(l,n)}r[t]=o}function qv(t,e,r,s,n){let i={};for(let a of e)for(let l of Object.keys(a))i[l]===void 0&&(i[l]=[]),i[l].push(a[l]);let o={};for(let a of Object.keys(i)){let l=i[a],u=yi(l,n);o[a]=u}r[t]=o}function a_e(t,e,r,s,n){for(let i=0;i<s.length;i++){let o={if:s[i].if,then:s[i].then,else:s[i].else};if(o.if!==void 0){if(r.if===void 0){r.if=o.if,o.then!==void 0&&(r.then=o.then),o.else!==void 0&&(r.else=o.else);continue}r.then!==void 0&&(r.then=yi([r.then,o],n)),r.else!==void 0&&(r.else=yi([r.else,o],n))}}}function F4(t,e,r){let s={};for(let n of e)for(let i of Object.keys(n)){s[i]===void 0&&(s[i]=[]);let o=s[i];for(let a of n[i])o.includes(a)||o.push(a)}r[t]=s}function yi(t,e){if(t.length===0)return{};if(t.length===1)return t[0];let r={},s={},n=!0;for(let i of t){if(i===!1)return!1;if(i!==!0){n=!1;for(let o of Object.keys(i))s[o]===void 0&&(s[o]=[]),s[o].push(i[o])}}if(n)return!0;for(let i of Object.keys(s)){let o=s[i];(e.resolvers[i]??e.defaultResolver)(i,o,r,t,e)}return r}function z4(t,e,r,s,n){let i=n.onConflict??"throw";if(e.length===1||i==="first"){r[t]=e[0];return}let o=!0;for(let a=1;a<e.length;a++)if(!e_e(e[a],e[0])){o=!1;break}if(o){r[t]=e[0];return}if(i==="throw")throw new Lv.ResolverNotFoundError(t,e);if(i!=="skip")throw new Lv.InvalidOnConflictOptionError(i)}function l_e(t,e={}){return e.defaultResolver===void 0&&(e.defaultResolver=z4),e.resolvers={...B4,...e.resolvers},yi(t,e)}U4.exports={mergeSchemas:l_e,keywordsResolvers:B4,defaultResolver:z4,...Lv}});var G4=m((E5e,H4)=>{"use strict";var{mergeSchemas:u_e}=V4();function c_e(t){return u_e(t,{onConflict:"skip"})}H4.exports=c_e});var K4=m((w5e,cO)=>{"use strict";function d_e(t,e,r,s){let n="";e.validatorSchemasIds.size>0?(n+=`const Validator = require('fast-json-stringify/lib/validator')
`,n+=`const validatorState = ${JSON.stringify(s.getState())}
`,n+=`const validator = Validator.restoreFromState(validatorState)
`):n+=`const validator = null
`;let{schema:i,...o}=r.getState();return`
  'use strict'

  const Serializer = require('fast-json-stringify/lib/serializer')
  const serializerState = ${JSON.stringify(o)}
  const serializer = Serializer.restoreFromState(serializerState)

  ${n}

  module.exports = ${t.toString()}(validator, serializer)`}cO.exports=d_e;cO.exports.dependencies={Serializer:b0(),Validator:rO()}});var rV=m((T5e,$d)=>{"use strict";var{RefResolver:f_e}=Lz(),h_e=b0(),p_e=rO(),$u=A4(),Q4=D4(),m_e=G4(),g_e=/'/g,jv=2e4,Z4="default",y_e=["floor","ceil","round","trunc"],Y4=["default","json-stringify"],cm=0;function dO(t,e){if(!Q4(t)){e?e=`"${e}" `:e="";let r=Q4.errors[0],s=new Error(`${e}schema is invalid: data${r.instancePath} ${r.message}`);throw s.errors=dO.errors,s}}function dm(t,e){let r=e.schema.$ref,s=r.indexOf("#");s===-1&&(s=r.length);let n=r.slice(0,s)||e.schemaId,i=r.slice(s)||"#",o=t.refResolver.getSchema(n,i);if(o===null)throw new Error(`Cannot find reference "${r}"`);let a=new $u(o,n,i);return o.$ref!==void 0?dm(t,a):a}function Fv(t,e){let r=t.refResolver.getSchema(e,"#");return new $u(r,e,"#")}function W4(t,e){return t.$id&&t.$id.charAt(0)!=="#"?t.$id:e}function fO(t,e){dO(t),e=e||{};let r={functions:[],functionsCounter:0,functionsNamesBySchema:new Map,options:e,refResolver:new f_e,rootSchemaId:t.$id||`__fjs_root_${cm++}`,validatorSchemasIds:new Set,mergedSchemasIds:new Map},s=W4(t,r.rootSchemaId);if(r.refResolver.hasSchema(s)||r.refResolver.addSchema(t,r.rootSchemaId),e.schema)for(let c in e.schema){let d=e.schema[c],f=W4(d,c);r.refResolver.hasSchema(f)||(dO(d,c),r.refResolver.addSchema(d,c))}if(e.rounding&&!y_e.includes(e.rounding))throw new Error(`Unsupported integer rounding method ${e.rounding}`);if(e.largeArrayMechanism)if(Y4.includes(e.largeArrayMechanism))Z4=e.largeArrayMechanism;else throw new Error(`Unsupported large array mechanism ${e.largeArrayMechanism}`);if(e.largeArraySize)if(typeof e.largeArraySize=="string"&&Number.isFinite(Number.parseInt(e.largeArraySize,10)))jv=Number.parseInt(e.largeArraySize,10);else if(typeof e.largeArraySize=="number"&&Number.isInteger(e.largeArraySize))jv=e.largeArraySize;else if(typeof e.largeArraySize=="bigint")jv=Number(e.largeArraySize);else throw new Error(`Unsupported large array size. Expected integer-like, got ${typeof e.largeArraySize} with value ${e.largeArraySize}`);let n=new $u(t,r.rootSchemaId),i=en(r,n,"input"),o=`
    const JSON_STR_BEGIN_OBJECT = '{'
    const JSON_STR_END_OBJECT = '}'
    const JSON_STR_BEGIN_ARRAY = '['
    const JSON_STR_END_ARRAY = ']'
    const JSON_STR_COMMA = ','
    const JSON_STR_COLONS = ':'
    const JSON_STR_QUOTE = '"'
    const JSON_STR_EMPTY_OBJECT = JSON_STR_BEGIN_OBJECT + JSON_STR_END_OBJECT
    const JSON_STR_EMPTY_ARRAY = JSON_STR_BEGIN_ARRAY + JSON_STR_END_ARRAY
    const JSON_STR_EMPTY_STRING = JSON_STR_QUOTE + JSON_STR_QUOTE
    const JSON_STR_NULL = 'null'
  `;i==="json += anonymous0(input)"?o+=`
    ${r.functions.join(`
`)}
    const main = anonymous0
    return main
    `:o+=`
    function main (input) {
      let json = ''
      ${i}
      return json
    }
    ${r.functions.join(`
`)}
    return main
    `;let a=new h_e(e),l=new p_e(e.ajv);for(let c of r.validatorSchemasIds){let d=r.refResolver.getSchema(c);l.addSchema(d,c);let f=r.refResolver.getSchemaDependencies(c);for(let[h,p]of Object.entries(f))l.addSchema(p,h)}if(e.debugMode&&(e.mode="debug"),e.mode==="debug")return{validator:l,serializer:a,code:`validator
serializer
${o}`,ajv:l.ajv};let u=new Function("validator","serializer",o);return e.mode==="standalone"?K4()(u,r,a,l):u(l,a)}var v_e=["properties","required","additionalProperties","patternProperties","maxProperties","minProperties","dependencies"],__e=["items","additionalItems","maxItems","minItems","uniqueItems","contains"],S_e=["maxLength","minLength","pattern"],b_e=["multipleOf","maximum","exclusiveMaximum","minimum","exclusiveMinimum"];function E_e(t){for(var e of v_e)if(e in t)return"object";for(var e of __e)if(e in t)return"array";for(var e of S_e)if(e in t)return"string";for(var e of b_e)if(e in t)return"number";return t.type}function w_e(t,e,r){let s=e.schema,n=Object.keys(s.properties||{}),i=`
    const propertiesKeys = ${JSON.stringify(n)}
    for (const [key, value] of Object.entries(obj)) {
      if (
        propertiesKeys.includes(key) ||
        value === undefined ||
        typeof value === 'function' ||
        typeof value === 'symbol'
      ) continue
  `,o=e.getPropertyLocation("patternProperties"),a=o.schema;if(a!==void 0)for(let c in a){let d=o.getPropertyLocation(c);i+=`
        if (/${c.replace(/\\*\//g,"\\/")}/.test(key)) {
          ${r}
          json += serializer.asString(key) + JSON_STR_COLONS
          ${en(t,d,"value")}
          continue
        }
      `}let u=e.getPropertyLocation("additionalProperties").schema;if(u!==void 0)if(u===!0)i+=`
        ${r}
        json += serializer.asString(key) + JSON_STR_COLONS + JSON.stringify(value)
      `;else{let c=e.getPropertyLocation("additionalProperties");i+=`
        ${r}
        json += serializer.asString(key) + JSON_STR_COLONS
        ${en(t,c,"value")}
      `}return i+=`
    }
  `,i}function T_e(t,e){let r=e.schema,s=e.getPropertyLocation("properties"),n=r.required||[],i=Object.keys(r.properties||{}).sort((u,c)=>{let d=n.includes(u),f=n.includes(c);return d===f?0:d?-1:1}),o=n.includes(i[0]),a=`let value
`;for(let u of n)if(!i.includes(u)){let c=JSON.stringify(u);a+=`if (obj[${c}] === undefined) throw new Error('${c.replace(/'/g,"\\'")} is required!')
`}a+=`let json = JSON_STR_BEGIN_OBJECT
`;let l="";o||(a+=`let addComma = false
`,l="!addComma && (addComma = true) || (json += JSON_STR_COMMA)");for(let u of i){let c=s.getPropertyLocation(u);c.schema.$ref&&(c=dm(t,c));let d=JSON.stringify(u),f=c.schema.default,h=n.includes(u);a+=`
      value = obj[${d}]
      if (value !== undefined) {
        ${l}
        json += ${JSON.stringify(d+":")}
        ${en(t,c,"value")}
      }`,f!==void 0?a+=` else {
        ${l}
        json += ${JSON.stringify(d+":"+JSON.stringify(f))}
      }
      `:h?a+=` else {
        throw new Error('${d.replace(/'/g,"\\'")} is required!')
      }
      `:a+=`
`,o&&(l="json += ','")}return(r.patternProperties||r.additionalProperties)&&(a+=w_e(t,e,l)),a+=`
    return json + JSON_STR_END_OBJECT
  `,a}function Bv(t,e,r){for(let o=0;o<r.length;o++){let a=r[o];a.schema.$ref&&(r[o]=dm(t,a))}let s=[];for(let o of r){let a=J4(t,o.schema,o.schemaId);delete a.$id,s.push(a)}let n=m_e(s),i=new $u(n,e);return t.refResolver.addSchema(n,e),i}function J4(t,e,r){let s=Array.isArray(e)?[]:{};e.$id!==void 0&&e.$id.charAt(0)!=="#"&&(r=e.$id);let n=t.mergedSchemasIds.get(e);n&&t.mergedSchemasIds.set(s,n);for(let i in e){let o=e[i];i==="$ref"&&typeof o=="string"&&o.charAt(0)==="#"&&(o=r+o),typeof o=="object"&&o!==null&&(o=J4(t,o,r)),s[i]=o}return s}function C_e(t){return`(${t} && typeof ${t}.toJSON === 'function')
    ? ${t}.toJSON()
    : ${t}
  `}function R_e(t,e){let r=e.schema;if(t.functionsNamesBySchema.has(r))return t.functionsNamesBySchema.get(r);let s=eV(t);t.functionsNamesBySchema.set(r,s);let n=e.getSchemaRef();n.startsWith(t.rootSchemaId)&&(n=n.replace(t.rootSchemaId,""));let i=`
  `,o=r.nullable===!0;return i+=`
    // ${n}
    function ${s} (input) {
      const obj = ${C_e("input")}
      ${o?"":"if (obj === null) return JSON_STR_EMPTY_OBJECT"}

      ${T_e(t,e)}
    }
  `,t.functions.push(i),s}function O_e(t,e){let r=e.schema,s=e.getPropertyLocation("items");s.schema=s.schema||{},s.schema.$ref&&(s=dm(t,s));let n=s.schema;if(t.functionsNamesBySchema.has(r))return t.functionsNamesBySchema.get(r);let i=eV(t);t.functionsNamesBySchema.set(r,i);let o=e.getSchemaRef();o.startsWith(t.rootSchemaId)&&(o=o.replace(t.rootSchemaId,""));let a=`
    function ${i} (obj) {
      // ${o}
  `,l=r.nullable===!0;if(a+=`
    ${l?"":"if (obj === null) return JSON_STR_EMPTY_ARRAY"}
    if (!Array.isArray(obj)) {
      throw new TypeError(\`The value of '${o}' does not match schema definition.\`)
    }
    const arrayLength = obj.length
  `,!r.additionalItems&&Array.isArray(n)&&(a+=`
      if (arrayLength > ${n.length}) {
        throw new Error(\`Item at ${n.length} does not match schema definition.\`)
      }
    `),Z4==="json-stringify"&&(a+=`if (arrayLength >= ${jv}) return JSON.stringify(obj)
`),a+=`
    const arrayEnd = arrayLength - 1
    let value
    let json = ''
  `,Array.isArray(n)){for(let u=0;u<n.length;u++){let c=n[u];a+=`value = obj[${u}]`;let d=en(t,s.getPropertyLocation(u),"value");a+=`
        if (${u} < arrayLength) {
          if (${X4(c.type,`[${u}]`)}) {
            ${d}
            if (${u} < arrayEnd) {
              json += JSON_STR_COMMA
            }
          } else {
            throw new Error(\`Item at ${u} does not match schema definition.\`)
          }
        }
        `}r.additionalItems&&(a+=`
        for (let i = ${n.length}; i < arrayLength; i++) {
          json += JSON.stringify(obj[i])
          if (i < arrayEnd) {
            json += JSON_STR_COMMA
          }
        }`)}else{let u=en(t,s,"obj[i]");a+=`
      for (let i = 0; i < arrayLength; i++) {
        ${u}
        if (i < arrayEnd) {
          json += JSON_STR_COMMA
        }
      }`}return a+=`
    return JSON_STR_BEGIN_ARRAY + json + JSON_STR_END_ARRAY
  }`,t.functions.push(a),i}function X4(t,e){let r;switch(t){case"null":r="value === null";break;case"string":r=`typeof value === 'string' ||
      value === null ||
      value instanceof Date ||
      value instanceof RegExp ||
      (
        typeof value === "object" &&
        typeof value.toString === "function" &&
        value.toString !== Object.prototype.toString
      )`;break;case"integer":r="Number.isInteger(value)";break;case"number":r="Number.isFinite(value)";break;case"boolean":r="typeof value === 'boolean'";break;case"object":r="value && typeof value === 'object' && value.constructor === Object";break;case"array":r="Array.isArray(value)";break;default:Array.isArray(t)&&(r=`(${t.map(n=>X4(n,e)).join(" || ")})`)}return r}function eV(t){return"anonymous"+t.functionsCounter++}function P_e(t,e,r){let n=e.schema.type.sort(a=>a==="null"?-1:1),i="";n.forEach((a,l)=>{e.schema={...e.schema,type:a};let u=tV(t,e,r),c=l===0?"if":"else if";switch(a){case"null":i+=`
          ${c} (${r} === null)
            ${u}
          `;break;case"string":{i+=`
          ${c}(
            typeof ${r} === "string" ||
            ${r} === null ||
            ${r} instanceof Date ||
            ${r} instanceof RegExp ||
            (
              typeof ${r} === "object" &&
              typeof ${r}.toString === "function" &&
              ${r}.toString !== Object.prototype.toString
            )
          )
            ${u}
        `;break}case"array":{i+=`
          ${c}(Array.isArray(${r}))
            ${u}
        `;break}case"integer":{i+=`
          ${c}(Number.isInteger(${r}) || ${r} === null)
            ${u}
        `;break}default:{i+=`
          ${c}(typeof ${r} === "${a}" || ${r} === null)
            ${u}
        `;break}}});let o=e.getSchemaRef();return o.startsWith(t.rootSchemaId)&&(o=o.replace(t.rootSchemaId,"")),i+=`
    else throw new TypeError(\`The value of '${o}' does not match schema definition.\`)
  `,i}function tV(t,e,r){let s=e.schema;switch(s.type){case"null":return"json += JSON_STR_NULL";case"string":return s.format==="date-time"?`json += serializer.asDateTime(${r})`:s.format==="date"?`json += serializer.asDate(${r})`:s.format==="time"?`json += serializer.asTime(${r})`:s.format==="unsafe"?`json += serializer.asUnsafeString(${r})`:`
        if (typeof ${r} !== 'string') {
          if (${r} === null) {
            json += JSON_STR_EMPTY_STRING
          } else if (${r} instanceof Date) {
            json += JSON_STR_QUOTE + ${r}.toISOString() + JSON_STR_QUOTE
          } else if (${r} instanceof RegExp) {
            json += serializer.asString(${r}.source)
          } else {
            json += serializer.asString(${r}.toString())
          }
        } else {
          json += serializer.asString(${r})
        }
        `;case"integer":return`json += serializer.asInteger(${r})`;case"number":return`json += serializer.asNumber(${r})`;case"boolean":return`json += serializer.asBoolean(${r})`;case"object":return`json += ${R_e(t,e)}(${r})`;case"array":return`json += ${O_e(t,e)}(${r})`;case void 0:return`json += JSON.stringify(${r})`;default:throw new Error(`${s.type} unsupported`)}}function A_e(t,e){let r=t.schema,s=r.type,n=Array.isArray(s)&&s.includes("null"),i="";return n&&(i+=`
      if (${e} === null) {
        json += JSON_STR_NULL
      } else {
    `),i+=`json += '${JSON.stringify(r.const).replace(g_e,"\\'")}'`,n&&(i+=`
      }
    `),i}function k_e(t,e,r){let s=e.schema,n=t.mergedSchemasIds.get(s);if(n){let c=Fv(t,n);return en(t,c,r)}n=`__fjs_merged_${cm++}`,t.mergedSchemasIds.set(s,n);let{allOf:i,...o}=e.schema,a=[new $u(o,e.schemaId,e.jsonPointer)],l=e.getPropertyLocation("allOf");for(let c=0;c<i.length;c++)a.push(l.getPropertyLocation(c));let u=Bv(t,n,a);return en(t,u,r)}function x_e(t,e,r){t.validatorSchemasIds.add(e.schemaId);let n=e.schema.anyOf?"anyOf":"oneOf",{[n]:i,...o}=e.schema,a=new $u(o,e.schemaId,e.jsonPointer),l=e.getPropertyLocation(n),u="";for(let d=0;d<i.length;d++){let f=l.getPropertyLocation(d),h=f.schema,p=t.mergedSchemasIds.get(h),g=null;p?g=Fv(t,p):(p=`__fjs_merged_${cm++}`,t.mergedSchemasIds.set(h,p),g=Bv(t,p,[a,f]));let _=en(t,g,r),S=f.getSchemaRef();u+=`
      ${d===0?"if":"else if"}(validator.validate("${S}", ${r}))
        ${_}
    `}let c=e.getSchemaRef();return c.startsWith(t.rootSchemaId)&&(c=c.replace(t.rootSchemaId,"")),u+=`
    else throw new TypeError(\`The value of '${c}' does not match schema definition.\`)
  `,u}function I_e(t,e,r){t.validatorSchemasIds.add(e.schemaId);let{if:s,then:n,else:i,...o}=e.schema,a=new $u(o,e.schemaId,e.jsonPointer),u=e.getPropertyLocation("if").getSchemaRef(),c=e.getPropertyLocation("then"),d=t.mergedSchemasIds.get(n),f=null;if(d?f=Fv(t,d):(d=`__fjs_merged_${cm++}`,t.mergedSchemasIds.set(n,d),f=Bv(t,d,[a,c])),!i)return`
      if (validator.validate("${u}", ${r})) {
        ${en(t,f,r)}
      } else {
        ${en(t,a,r)}
      }
    `;let h=e.getPropertyLocation("else"),p=t.mergedSchemasIds.get(i),g=null;return p?g=Fv(t,p):(p=`__fjs_merged_${cm++}`,t.mergedSchemasIds.set(i,p),g=Bv(t,p,[a,h])),`
    if (validator.validate("${u}", ${r})) {
      ${en(t,f,r)}
    } else {
      ${en(t,g,r)}
    }
  `}function en(t,e,r){let s=e.schema;if(typeof s=="boolean")return`json += JSON.stringify(${r})`;if(s.$ref&&(e=dm(t,e),s=e.schema),s.allOf)return k_e(t,e,r);if(s.anyOf||s.oneOf)return x_e(t,e,r);if(s.if&&s.then)return I_e(t,e,r);if(s.type===void 0){let a=E_e(s);a&&(s.type=a)}let n="",i=s.type,o=s.nullable===!0;return o&&(n+=`
      if (${r} === null) {
        json += JSON_STR_NULL
      } else {
    `),s.const!==void 0?n+=A_e(e,r):Array.isArray(i)?n+=P_e(t,e,r):n+=tV(t,e,r),o&&(n+=`
      }
    `),n}$d.exports=fO;$d.exports.default=fO;$d.exports.build=fO;$d.exports.validLargeArrayMechanisms=Y4;$d.exports.restore=function({code:t,validator:e,serializer:r}){return Function.apply(null,["validator","serializer",t]).apply(null,[e,r])}});var nV=m((C5e,hO)=>{"use strict";var N_e=pO();function sV(t={readMode:!0}){if(t.readMode===!0&&typeof t.restoreFunction!="function")throw new Error("You must provide a function for the restoreFunction-option when readMode ON");if(t.readMode!==!0&&typeof t.storeFunction!="function")throw new Error("You must provide a function for the storeFunction-option when readMode OFF");if(t.readMode===!0)return function(){return function(s){return t.restoreFunction(s)}};let e=N_e();return function(s,n={}){n.mode="standalone";let i=e(s,n);return function(o){let a=i(o);return t.storeFunction(o,a),new Function(a)}}}hO.exports=sV;hO.exports.default=sV});var pO=m((R5e,fm)=>{"use strict";var D_e=rV();function mO(){return function(e,r){let s=Object.assign({},r,{schema:e});return M_e.bind(null,s)}}function M_e(t,{schema:e}){return t.schema&&e.$id&&t.schema[e.$id]&&(t.schema={...t.schema},delete t.schema[e.$id]),D_e(e,t)}fm.exports=mO;fm.exports.default=mO;fm.exports.SerializerSelector=mO;fm.exports.StandaloneSerializer=nV()});var Jo=m(hm=>{"use strict";Object.defineProperty(hm,"__esModule",{value:!0});hm.checkMetadata=void 0;var $_e=ze(),q_e={keyword:"metadata",schemaType:"object",code(t){iV(t);let{gen:e,schema:r,it:s}=t;if((0,$_e.alwaysValidSchema)(s,r))return;let n=e.name("valid");t.subschema({keyword:"metadata",jtdMetadata:!0},n),t.ok(n)}};function iV({it:t,keyword:e},r){if(t.jtdMetadata!==r)throw new Error(`JTD: "${e}" cannot be used in this schema location`)}hm.checkMetadata=iV;hm.default=q_e});var zv=m(mm=>{"use strict";Object.defineProperty(mm,"__esModule",{value:!0});mm.hasRef=void 0;var oV=Iu(),pm=Te(),L_e=Zo(),aV=On(),lV=t1(),j_e=Jo(),F_e={keyword:"ref",schemaType:"string",code(t){(0,j_e.checkMetadata)(t);let{gen:e,data:r,schema:s,parentSchema:n,it:i}=t,{schemaEnv:{root:o}}=i,a=e.name("valid");n.nullable?(e.var(a,(0,pm._)`${r} === null`),e.if((0,pm.not)(a),l)):(e.var(a,!1),l()),t.ok(a);function l(){var d;let f=(d=o.schema.definitions)===null||d===void 0?void 0:d[s];if(!f)throw new L_e.default(i.opts.uriResolver,"",s,`No definition ${s}`);gO(f)||!i.opts.inlineRefs?u(f):c(f)}function u(d){let f=oV.compileSchema.call(i.self,new oV.SchemaEnv({schema:d,root:o,schemaPath:`/definitions/${s}`})),h=(0,lV.getValidate)(t,f),p=e.const("_errs",aV.default.errors);(0,lV.callRef)(t,h,f,f.$async),e.assign(a,(0,pm._)`${p} === ${aV.default.errors}`)}function c(d){let f=e.scopeValue("schema",i.opts.code.source===!0?{ref:d,code:(0,pm.stringify)(d)}:{ref:d});t.subschema({schema:d,dataTypes:[],schemaPath:pm.nil,topSchemaRef:f,errSchemaPath:`/definitions/${s}`},a)}}};function gO(t){for(let e in t){let r;if(e==="ref"||typeof(r=t[e])=="object"&&gO(r))return!0}return!1}mm.hasRef=gO;mm.default=F_e});var vO=m(yO=>{"use strict";Object.defineProperty(yO,"__esModule",{value:!0});var B_e=/t|\s/i,z_e=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,U_e=/^(\d\d):(\d\d):(\d\d)(?:\.\d+)?(?:z|([+-]\d\d)(?::?(\d\d))?)$/i,V_e=[0,31,28,31,30,31,30,31,31,30,31,30,31];function cV(t,e){let r=t.split(B_e);return r.length===2&&uV(r[0])&&H_e(r[1])||e&&r.length===1&&uV(r[0])}yO.default=cV;function uV(t){let e=z_e.exec(t);if(!e)return!1;let r=+e[1],s=+e[2],n=+e[3];return s>=1&&s<=12&&n>=1&&(n<=V_e[s]||s===2&&n===29&&(r%100===0?r%400===0:r%4===0))}function H_e(t){let e=U_e.exec(t);if(!e)return!1;let r=+e[1],s=+e[2],n=+e[3],i=+(e[4]||0),o=+(e[5]||0);return r<=23&&s<=59&&n<=59||r-i===23&&s-o===59&&n===60}cV.code='require("ajv/dist/runtime/timestamp").default'});var qd=m(Wa=>{"use strict";Object.defineProperty(Wa,"__esModule",{value:!0});Wa.typeErrorParams=Wa.typeErrorMessage=Wa.typeError=void 0;var G_e=Te();function K_e(t){return{message:e=>dV(e,t),params:e=>fV(e,t)}}Wa.typeError=K_e;function dV({parentSchema:t},e){return t?.nullable?`must be ${e} or null`:`must be ${e}`}Wa.typeErrorMessage=dV;function fV({parentSchema:t},e){return(0,G_e._)`{type: ${e}, nullable: ${!!t?.nullable}}`}Wa.typeErrorParams=fV});var _O=m(Ld=>{"use strict";Object.defineProperty(Ld,"__esModule",{value:!0});Ld.intRange=void 0;var tn=Te(),Q_e=vO(),W_e=ze(),Z_e=Jo(),hV=qd();Ld.intRange={int8:[-128,127,3],uint8:[0,255,3],int16:[-32768,32767,5],uint16:[0,65535,5],int32:[-2147483648,2147483647,10],uint32:[0,4294967295,10]};var Y_e={message:t=>(0,hV.typeErrorMessage)(t,t.schema),params:t=>(0,hV.typeErrorParams)(t,t.schema)};function J_e(t){let{gen:e,data:r,it:s}=t,{timestamp:n,allowDate:i}=s.opts;if(n==="date")return(0,tn._)`${r} instanceof Date `;let o=(0,W_e.useFunc)(e,Q_e.default),a=i?(0,tn._)`, true`:tn.nil,l=(0,tn._)`typeof ${r} == "string" && ${o}(${r}${a})`;return n==="string"?l:(0,tn.or)((0,tn._)`${r} instanceof Date`,l)}var X_e={keyword:"type",schemaType:"string",error:Y_e,code(t){(0,Z_e.checkMetadata)(t);let{data:e,schema:r,parentSchema:s,it:n}=t,i;switch(r){case"boolean":case"string":i=(0,tn._)`typeof ${e} == ${r}`;break;case"timestamp":{i=J_e(t);break}case"float32":case"float64":i=(0,tn._)`typeof ${e} == "number"`;break;default:{let o=r;if(i=(0,tn._)`typeof ${e} == "number" && isFinite(${e}) && !(${e} % 1)`,!n.opts.int32range&&(o==="int32"||o==="uint32"))o==="uint32"&&(i=(0,tn._)`${i} && ${e} >= 0`);else{let[a,l]=Ld.intRange[o];i=(0,tn._)`${i} && ${e} >= ${a} && ${e} <= ${l}`}}}t.pass(s.nullable?(0,tn.or)((0,tn._)`${e} === null`,i):i)}};Ld.default=X_e});var Fd=m(jd=>{"use strict";Object.defineProperty(jd,"__esModule",{value:!0});jd.checkNullableObject=jd.checkNullable=void 0;var Uv=Te();function pV({gen:t,data:e,parentSchema:r},s=Uv.nil){let n=t.name("valid");return r.nullable?(t.let(n,(0,Uv._)`${e} === null`),s=(0,Uv.not)(n)):t.let(n,!1),[n,s]}jd.checkNullable=pV;function eSe(t,e){let[r,s]=pV(t,e);return[r,(0,Uv._)`${s} && typeof ${t.data} == "object" && !Array.isArray(${t.data})`]}jd.checkNullableObject=eSe});var mV=m(SO=>{"use strict";Object.defineProperty(SO,"__esModule",{value:!0});var Za=Te(),tSe=Jo(),rSe=Fd(),sSe={message:"must be equal to one of the allowed values",params:({schemaCode:t})=>(0,Za._)`{allowedValues: ${t}}`},nSe={keyword:"enum",schemaType:"array",error:sSe,code(t){(0,tSe.checkMetadata)(t);let{gen:e,data:r,schema:s,schemaValue:n,parentSchema:i,it:o}=t;if(s.length===0)throw new Error("enum must have non-empty array");if(s.length!==new Set(s).size)throw new Error("enum items must be unique");let a,l=(0,Za._)`typeof ${r} == "string"`;if(s.length>=o.opts.loopEnum){let c;[a,c]=(0,rSe.checkNullable)(t,l),e.if(c,u)}else{if(!Array.isArray(s))throw new Error("ajv implementation error");a=(0,Za.and)(l,(0,Za.or)(...s.map(c=>(0,Za._)`${r} === ${c}`))),i.nullable&&(a=(0,Za.or)((0,Za._)`${r} === null`,a))}t.pass(a);function u(){e.forOf("v",n,c=>e.if((0,Za._)`${a} = ${r} === ${c}`,()=>e.break()))}}};SO.default=nSe});var yV=m(bO=>{"use strict";Object.defineProperty(bO,"__esModule",{value:!0});var iSe=ze(),oSe=Vr(),gV=Te(),aSe=Jo(),lSe=Fd(),uSe=qd(),cSe={keyword:"elements",schemaType:"object",error:(0,uSe.typeError)("array"),code(t){(0,aSe.checkMetadata)(t);let{gen:e,data:r,schema:s,it:n}=t;if((0,iSe.alwaysValidSchema)(n,s))return;let[i]=(0,lSe.checkNullable)(t);e.if((0,gV.not)(i),()=>e.if((0,gV._)`Array.isArray(${r})`,()=>e.assign(i,(0,oSe.validateArray)(t)),()=>t.error())),t.ok(i)}};bO.default=cSe});var wO=m(Ya=>{"use strict";Object.defineProperty(Ya,"__esModule",{value:!0});Ya.validateProperties=Ya.error=void 0;var EO=Vr(),vV=ze(),Xo=Te(),dSe=Jo(),fSe=Fd(),_V=qd(),Bd;(function(t){t.Additional="additional",t.Missing="missing"})(Bd||(Bd={}));Ya.error={message:t=>{let{params:e}=t;return e.propError?e.propError===Bd.Additional?"must NOT have additional properties":`must have property '${e.missingProperty}'`:(0,_V.typeErrorMessage)(t,"object")},params:t=>{let{params:e}=t;return e.propError?e.propError===Bd.Additional?(0,Xo._)`{error: ${e.propError}, additionalProperty: ${e.additionalProperty}}`:(0,Xo._)`{error: ${e.propError}, missingProperty: ${e.missingProperty}}`:(0,_V.typeErrorParams)(t,"object")}};var hSe={keyword:"properties",schemaType:"object",error:Ya.error,code:SV};function SV(t){(0,dSe.checkMetadata)(t);let{gen:e,data:r,parentSchema:s,it:n}=t,{additionalProperties:i,nullable:o}=s;if(n.jtdDiscriminator&&o)throw new Error("JTD: nullable inside discriminator mapping");if(h())throw new Error("JTD: properties and optionalProperties have common members");let[a,l]=p("properties"),[u,c]=p("optionalProperties");if(l.length===0&&c.length===0&&i)return;let[d,f]=n.jtdDiscriminator===void 0?(0,fSe.checkNullableObject)(t,r):[e.let("valid",!1),!0];e.if(f,()=>e.assign(d,!0).block(()=>{g(l,"properties",!0),g(c,"optionalProperties"),i||S()})),t.pass(d);function h(){let v=s.properties,y=s.optionalProperties;if(!(v&&y))return!1;for(let R in v)if(Object.prototype.hasOwnProperty.call(y,R))return!0;return!1}function p(v){let y=s[v],R=y?(0,EO.allSchemaProperties)(y):[];if(n.jtdDiscriminator&&R.some(w=>w===n.jtdDiscriminator))throw new Error(`JTD: discriminator tag used in ${v}`);let P=R.filter(w=>!(0,vV.alwaysValidSchema)(n,y[w]));return[R,P]}function g(v,y,R){let P=e.var("valid");for(let O of v)e.if((0,EO.propertyInData)(e,r,O,n.opts.ownProperties),()=>_(O,y,P),()=>w(O)),t.ok(P);function w(O){R?(e.assign(P,!1),t.error(!1,{propError:Bd.Missing,missingProperty:O},{schemaPath:O})):e.assign(P,!0)}}function _(v,y,R){t.subschema({keyword:y,schemaProp:v,dataProp:v},R)}function S(){e.forIn("key",r,v=>{let y=b(v,a,"properties",n.jtdDiscriminator),R=b(v,u,"optionalProperties"),P=y===!0?R:R===!0?y:(0,Xo.and)(y,R);e.if(P,()=>{n.opts.removeAdditional?e.code((0,Xo._)`delete ${r}[${v}]`):(t.error(!1,{propError:Bd.Additional,additionalProperty:v},{instancePath:v,parentSchema:!0}),n.opts.allErrors||e.break())})})}function b(v,y,R,P){let w;if(y.length>8){let O=(0,vV.schemaRefOrVal)(n,s[R],R);w=(0,Xo.not)((0,EO.isOwnProperty)(e,O,v)),P!==void 0&&(w=(0,Xo.and)(w,(0,Xo._)`${v} !== ${P}`))}else if(y.length||P!==void 0){let O=P===void 0?y:[P].concat(y);w=(0,Xo.and)(...O.map($=>(0,Xo._)`${v} !== ${$}`))}else w=!0;return w}}Ya.validateProperties=SV;Ya.default=hSe});var EV=m(TO=>{"use strict";Object.defineProperty(TO,"__esModule",{value:!0});var bV=wO(),pSe={keyword:"optionalProperties",schemaType:"object",error:bV.error,code(t){t.parentSchema.properties||(0,bV.validateProperties)(t)}};TO.default=pSe});var TV=m(CO=>{"use strict";Object.defineProperty(CO,"__esModule",{value:!0});var qu=Te(),mSe=Jo(),gSe=Fd(),wV=qd(),Vv=B1(),ySe={message:t=>{let{schema:e,params:r}=t;return r.discrError?r.discrError===Vv.DiscrError.Tag?`tag "${e}" must be string`:`value of tag "${e}" must be in mapping`:(0,wV.typeErrorMessage)(t,"object")},params:t=>{let{schema:e,params:r}=t;return r.discrError?(0,qu._)`{error: ${r.discrError}, tag: ${e}, tagValue: ${r.tag}}`:(0,wV.typeErrorParams)(t,"object")}},vSe={keyword:"discriminator",schemaType:"string",implements:["mapping"],error:ySe,code(t){(0,mSe.checkMetadata)(t);let{gen:e,data:r,schema:s,parentSchema:n}=t,[i,o]=(0,gSe.checkNullableObject)(t,r);e.if(o),a(),e.elseIf((0,qu.not)(i)),t.error(),e.endIf(),t.ok(i);function a(){let c=e.const("tag",(0,qu._)`${r}${(0,qu.getProperty)(s)}`);e.if((0,qu._)`${c} === undefined`),t.error(!1,{discrError:Vv.DiscrError.Tag,tag:c}),e.elseIf((0,qu._)`typeof ${c} == "string"`),l(c),e.else(),t.error(!1,{discrError:Vv.DiscrError.Tag,tag:c},{instancePath:s}),e.endIf()}function l(c){e.if(!1);for(let d in n.mapping)e.elseIf((0,qu._)`${c} === ${d}`),e.assign(i,u(d));e.else(),t.error(!1,{discrError:Vv.DiscrError.Mapping,tag:c},{instancePath:s,schemaPath:"mapping",parentSchema:!0}),e.endIf()}function u(c){let d=e.name("valid");return t.subschema({keyword:"mapping",schemaProp:c,jtdDiscriminator:s},d),d}}};CO.default=vSe});var RV=m(RO=>{"use strict";Object.defineProperty(RO,"__esModule",{value:!0});var CV=ze(),Hv=Te(),_Se=Jo(),SSe=Fd(),bSe=qd(),ESe={keyword:"values",schemaType:"object",error:(0,bSe.typeError)("object"),code(t){(0,_Se.checkMetadata)(t);let{gen:e,data:r,schema:s,it:n}=t,[i,o]=(0,SSe.checkNullableObject)(t,r);(0,CV.alwaysValidSchema)(n,s)?e.if((0,Hv.not)((0,Hv.or)(o,i)),()=>t.error()):(e.if(o),e.assign(i,a()),e.elseIf((0,Hv.not)(i)),t.error(),e.endIf()),t.ok(i);function a(){let l=e.name("valid");if(n.allErrors){let c=e.let("valid",!0);return u(()=>e.assign(c,!1)),c}return e.var(l,!0),u(()=>e.break()),l;function u(c){e.forIn("key",r,d=>{t.subschema({keyword:"values",dataProp:d,dataPropType:CV.Type.Str},l),e.if((0,Hv.not)(l),c)})}}}};RO.default=ESe});var OV=m(OO=>{"use strict";Object.defineProperty(OO,"__esModule",{value:!0});var wSe=Vr(),TSe={keyword:"union",schemaType:"array",trackErrors:!0,code:wSe.validateUnion,error:{message:"must match a schema in union"}};OO.default=TSe});var PV=m(PO=>{"use strict";Object.defineProperty(PO,"__esModule",{value:!0});var CSe=zv(),RSe=_O(),OSe=mV(),PSe=yV(),ASe=wO(),kSe=EV(),xSe=TV(),ISe=RV(),NSe=OV(),DSe=Jo(),MSe=["definitions",CSe.default,RSe.default,OSe.default,PSe.default,ASe.default,kSe.default,xSe.default,ISe.default,NSe.default,DSe.default,{keyword:"additionalProperties",schemaType:"boolean"},{keyword:"nullable",schemaType:"boolean"}];PO.default=MSe});var IV=m(AO=>{"use strict";Object.defineProperty(AO,"__esModule",{value:!0});var ea=t=>{let e={nullable:{type:"boolean"},metadata:{optionalProperties:{union:{elements:{ref:"schema"}}},additionalProperties:!0}};return t&&(e.definitions={values:{ref:"schema"}}),e},$Se=t=>({optionalProperties:ea(t)}),qSe=t=>({properties:{ref:{type:"string"}},optionalProperties:ea(t)}),LSe=t=>({properties:{type:{enum:["boolean","timestamp","string","float32","float64","int8","uint8","int16","uint16","int32","uint32"]}},optionalProperties:ea(t)}),jSe=t=>({properties:{enum:{elements:{type:"string"}}},optionalProperties:ea(t)}),FSe=t=>({properties:{elements:{ref:"schema"}},optionalProperties:ea(t)}),kV=t=>({properties:{properties:{values:{ref:"schema"}}},optionalProperties:{optionalProperties:{values:{ref:"schema"}},additionalProperties:{type:"boolean"},...ea(t)}}),xV=t=>({properties:{optionalProperties:{values:{ref:"schema"}}},optionalProperties:{additionalProperties:{type:"boolean"},...ea(t)}}),BSe=t=>({properties:{discriminator:{type:"string"},mapping:{values:{metadata:{union:[kV(!1),xV(!1)]}}}},optionalProperties:ea(t)}),zSe=t=>({properties:{values:{ref:"schema"}},optionalProperties:ea(t)}),AV=t=>({metadata:{union:[$Se,qSe,LSe,jSe,FSe,kV,xV,BSe,zSe].map(e=>e(t))}}),USe={definitions:{schema:AV(!1)},...AV(!0)};AO.default=USe});var kO=m(Gv=>{"use strict";Object.defineProperty(Gv,"__esModule",{value:!0});Gv.jtdForms=void 0;Gv.jtdForms=["elements","values","discriminator","properties","optionalProperties","enum","type","ref"]});var DV=m(IO=>{"use strict";Object.defineProperty(IO,"__esModule",{value:!0});var xO=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,VSe={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function NV(t){return xO.lastIndex=0,'"'+(xO.test(t)?t.replace(xO,e=>{let r=VSe[e];return typeof r=="string"?r:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}):t)+'"'}IO.default=NV;NV.code='require("ajv/dist/runtime/quote").default'});var FV=m(DO=>{"use strict";Object.defineProperty(DO,"__esModule",{value:!0});var HSe=kO(),$V=Iu(),Je=Te(),GSe=Zo(),Nt=On(),KSe=Vr(),QSe=zv(),WSe=ze(),ZSe=DV(),YSe={elements:XSe,values:ebe,discriminator:tbe,properties:MV,optionalProperties:MV,enum:gm,type:rbe,ref:nbe};function qV(t,e){let r=$V.getCompilingSchema.call(this,t);if(r)return r;let{es5:s,lines:n}=this.opts.code,{ownProperties:i}=this.opts,o=new Je.CodeGen(this.scope,{es5:s,lines:n,ownProperties:i}),a=o.scopeName("serialize"),l={self:this,gen:o,schema:t.schema,schemaEnv:t,definitions:e,data:Nt.default.data},u;try{this._compilations.add(t),t.serializeName=a,o.func(a,Nt.default.data,!1,()=>{o.let(Nt.default.json,(0,Je.str)``),ym(l),o.return(Nt.default.json)}),o.optimize(this.opts.code.optimize);let c=o.toString();u=`${o.scopeRefs(Nt.default.scope)}return ${c}`;let f=new Function(`${Nt.default.scope}`,u)(this.scope.get());this.scope.value(a,{ref:f}),t.serialize=f}catch(c){throw u&&this.logger.error("Error compiling serializer, function code:",u),delete t.serialize,delete t.serializeName,c}finally{this._compilations.delete(t)}return t}DO.default=qV;function ym(t){let e;for(let r of HSe.jtdForms)if(r in t.schema){e=r;break}JSe(t,e?YSe[e]:obe)}function JSe(t,e){let{gen:r,schema:s,data:n}=t;if(!s.nullable)return e(t);r.if((0,Je._)`${n} === undefined || ${n} === null`,()=>r.add(Nt.default.json,(0,Je._)`"null"`),()=>e(t))}function XSe(t){let{gen:e,schema:r,data:s}=t;e.add(Nt.default.json,(0,Je.str)`[`);let n=e.let("first",!0);e.forOf("el",s,i=>{NO(t,n),ym({...t,schema:r.elements,data:i})}),e.add(Nt.default.json,(0,Je.str)`]`)}function ebe(t){let{gen:e,schema:r,data:s}=t;e.add(Nt.default.json,(0,Je.str)`{`);let n=e.let("first",!0);e.forIn("key",s,i=>LV(t,i,r.values,n)),e.add(Nt.default.json,(0,Je.str)`}`)}function LV(t,e,r,s){let{gen:n,data:i}=t;NO(t,s),gm({...t,data:e}),n.add(Nt.default.json,(0,Je.str)`:`);let o=n.const("value",(0,Je._)`${i}${(0,Je.getProperty)(e)}`);ym({...t,schema:r,data:o})}function tbe(t){let{gen:e,schema:r,data:s}=t,{discriminator:n}=r;e.add(Nt.default.json,(0,Je.str)`{${JSON.stringify(n)}:`);let i=e.const("tag",(0,Je._)`${s}${(0,Je.getProperty)(n)}`);gm({...t,data:i}),e.if(!1);for(let o in r.mapping){e.elseIf((0,Je._)`${i} === ${o}`);let a=r.mapping[o];jV({...t,schema:a},n)}e.endIf(),e.add(Nt.default.json,(0,Je.str)`}`)}function MV(t){let{gen:e}=t;e.add(Nt.default.json,(0,Je.str)`{`),jV(t),e.add(Nt.default.json,(0,Je.str)`}`)}function jV(t,e){let{gen:r,schema:s,data:n}=t,{properties:i,optionalProperties:o}=s,a=f(i),l=f(o),u=h(a.concat(l)),c=!e,d;for(let S of a)c?c=!1:r.add(Nt.default.json,(0,Je.str)`,`),g(S,i[S],p(S));c&&(d=r.let("first",!0));for(let S of l){let b=p(S);r.if((0,Je.and)((0,Je._)`${b} !== undefined`,(0,KSe.isOwnProperty)(r,n,S)),()=>{NO(t,d),g(S,o[S],b)})}s.additionalProperties&&r.forIn("key",n,S=>r.if(_(S,u),()=>LV(t,S,{},d)));function f(S){return S?Object.keys(S):[]}function h(S){if(e&&S.push(e),new Set(S).size!==S.length)throw new Error("JTD: properties/optionalProperties/disciminator overlap");return S}function p(S){return r.const("value",(0,Je._)`${n}${(0,Je.getProperty)(S)}`)}function g(S,b,v){r.add(Nt.default.json,(0,Je.str)`${JSON.stringify(S)}:`),ym({...t,schema:b,data:v})}function _(S,b){return b.length?(0,Je.and)(...b.map(v=>(0,Je._)`${S} !== ${v}`)):!0}}function rbe(t){let{gen:e,schema:r,data:s}=t;switch(r.type){case"boolean":e.add(Nt.default.json,(0,Je._)`${s} ? "true" : "false"`);break;case"string":gm(t);break;case"timestamp":e.if((0,Je._)`${s} instanceof Date`,()=>e.add(Nt.default.json,(0,Je._)`'"' + ${s}.toISOString() + '"'`),()=>gm(t));break;default:sbe(t)}}function gm({gen:t,data:e}){t.add(Nt.default.json,(0,Je._)`${(0,WSe.useFunc)(t,ZSe.default)}(${e})`)}function sbe({gen:t,data:e}){t.add(Nt.default.json,(0,Je._)`"" + ${e}`)}function nbe(t){let{gen:e,self:r,data:s,definitions:n,schema:i,schemaEnv:o}=t,{ref:a}=i,l=n[a];if(!l)throw new GSe.default(r.opts.uriResolver,"",a,`No definition ${a}`);if(!(0,QSe.hasRef)(l))return ym({...t,schema:l});let{root:u}=o,c=qV.call(r,new $V.SchemaEnv({schema:l,root:u}),n);e.add(Nt.default.json,(0,Je._)`${ibe(e,c)}(${s})`)}function ibe(t,e){return e.serialize?t.scopeValue("serialize",{ref:e.serialize}):(0,Je._)`${t.scopeValue("wrapper",{ref:e})}.serialize`}function obe({gen:t,data:e}){t.add(Nt.default.json,(0,Je._)`JSON.stringify(${e})`)}function NO({gen:t},e){e?t.if(e,()=>t.assign(e,!1),()=>t.add(Nt.default.json,(0,Je.str)`,`)):t.add(Nt.default.json,(0,Je.str)`,`)}});var zV=m(Xa=>{"use strict";Object.defineProperty(Xa,"__esModule",{value:!0});Xa.parseJsonString=Xa.parseJsonNumber=Xa.parseJson=void 0;var abe=/position\s(\d+)(?: \(line \d+ column \d+\))?$/;function ta(t,e){let r;ta.message=void 0;let s;e&&(t=t.slice(e));try{return ta.position=e+t.length,JSON.parse(t)}catch(n){if(s=abe.exec(n.message),!s){ta.message="unexpected end";return}r=+s[1];let i=t[r];t=t.slice(0,r),ta.position=e+r;try{return JSON.parse(t)}catch{ta.message=`unexpected token ${i}`;return}}}Xa.parseJson=ta;ta.message=void 0;ta.position=0;ta.code='require("ajv/dist/runtime/parseJson").parseJson';function ra(t,e,r){let s="",n;if(ra.message=void 0,t[e]==="-"&&(s+="-",e++),t[e]==="0")s+="0",e++;else if(!i(r)){o();return}if(r)return ra.position=e,+s;if(t[e]==="."&&(s+=".",e++,!i())){o();return}if(n=t[e],(n==="e"||n==="E")&&(s+="e",e++,n=t[e],(n==="+"||n==="-")&&(s+=n,e++),!i())){o();return}return ra.position=e,+s;function i(a){let l=!1;for(;n=t[e],n>="0"&&n<="9"&&(a===void 0||a-- >0);)l=!0,s+=n,e++;return l}function o(){ra.position=e,ra.message=e<t.length?`unexpected token ${t[e]}`:"unexpected end"}}Xa.parseJsonNumber=ra;ra.message=void 0;ra.position=0;ra.code='require("ajv/dist/runtime/parseJson").parseJsonNumber';var BV={b:"\b",f:"\f",n:`
`,r:"\r",t:"	",'"':'"',"/":"/","\\":"\\"},lbe="a".charCodeAt(0),ube="0".charCodeAt(0);function Ja(t,e){let r="",s;for(Ja.message=void 0;s=t[e++],s!=='"';)if(s==="\\")if(s=t[e],s in BV)r+=BV[s],e++;else if(s==="u"){e++;let i=4,o=0;for(;i--;){if(o<<=4,s=t[e],s===void 0){n("unexpected end");return}if(s=s.toLowerCase(),s>="a"&&s<="f")o+=s.charCodeAt(0)-lbe+10;else if(s>="0"&&s<="9")o+=s.charCodeAt(0)-ube;else{n(`unexpected token ${s}`);return}e++}r+=String.fromCharCode(o)}else{n(`unexpected token ${s}`);return}else if(s===void 0){n("unexpected end");return}else if(s.charCodeAt(0)>=32)r+=s;else{n(`unexpected token ${s}`);return}return Ja.position=e,r;function n(i){Ja.position=e,Ja.message=i}}Xa.parseJsonString=Ja;Ja.message=void 0;Ja.position=0;Ja.code='require("ajv/dist/runtime/parseJson").parseJsonString'});var XV=m(zO=>{"use strict";Object.defineProperty(zO,"__esModule",{value:!0});var cbe=kO(),GV=Iu(),Se=Te(),dbe=Zo(),We=On(),fbe=Vr(),hbe=zv(),pbe=_O(),qO=zV(),KV=ze(),mbe=vO(),gbe={elements:Sbe,values:bbe,discriminator:wbe,properties:UV,optionalProperties:UV,enum:Cbe,type:Tbe,ref:Rbe};function QV(t,e){let r=GV.getCompilingSchema.call(this,t);if(r)return r;let{es5:s,lines:n}=this.opts.code,{ownProperties:i}=this.opts,o=new Se.CodeGen(this.scope,{es5:s,lines:n,ownProperties:i}),a=o.scopeName("parse"),l={self:this,gen:o,schema:t.schema,schemaEnv:t,definitions:e,data:We.default.data,parseName:a,char:o.name("c")},u;try{this._compilations.add(t),t.parseName=a,ybe(l),o.optimize(this.opts.code.optimize);let c=o.toString();u=`${o.scopeRefs(We.default.scope)}return ${c}`;let f=new Function(`${We.default.scope}`,u)(this.scope.get());this.scope.value(a,{ref:f}),t.parse=f}catch(c){throw u&&this.logger.error("Error compiling parser, function code:",u),delete t.parse,delete t.parseName,c}finally{this._compilations.delete(t)}return t}zO.default=QV;var $O=(0,Se._)`undefined`;function ybe(t){let{gen:e,parseName:r,char:s}=t;e.func(r,(0,Se._)`${We.default.json}, ${We.default.jsonPos}, ${We.default.jsonPart}`,!1,()=>{e.let(We.default.data),e.let(s),e.assign((0,Se._)`${r}.message`,$O),e.assign((0,Se._)`${r}.position`,$O),e.assign(We.default.jsonPos,(0,Se._)`${We.default.jsonPos} || 0`),e.const(We.default.jsonLen,(0,Se._)`${We.default.json}.length`),Kv(t),BO(t),e.if(We.default.jsonPart,()=>{e.assign((0,Se._)`${r}.position`,We.default.jsonPos),e.return(We.default.data)}),e.if((0,Se._)`${We.default.jsonPos} === ${We.default.jsonLen}`,()=>e.return(We.default.data)),zd(t)})}function Kv(t){let e;for(let r of cbe.jtdForms)if(r in t.schema){e=r;break}e?_be(t,gbe[e]):jO(t)}var vbe=HV(!0,HV(!1,zd));function _be(t,e){let{gen:r,schema:s,data:n}=t;if(!s.nullable)return e(t);vm(t,"null",e,()=>r.assign(n,null))}function Sbe(t){let{gen:e,schema:r,data:s}=t;Zi(t,"[");let n=e.let("i",0);e.assign(s,(0,Se._)`[]`),LO(t,"]",()=>{let i=e.let("el");Kv({...t,schema:r.elements,data:i}),e.assign((0,Se._)`${s}[${n}++]`,i)})}function bbe(t){let{gen:e,schema:r,data:s}=t;Zi(t,"{"),e.assign(s,(0,Se._)`{}`),LO(t,"}",()=>Ebe(t,r.values))}function LO(t,e,r){WV(t,e,r),Zi(t,e)}function WV(t,e,r){let{gen:s}=t;s.for((0,Se._)`;${We.default.jsonPos}<${We.default.jsonLen} && ${Qv(1)}!==${e};`,()=>{r(),vm(t,",",()=>s.break(),n)});function n(){vm(t,e,()=>{},zd)}}function Ebe(t,e){let{gen:r}=t,s=r.let("key");Lu({...t,data:s}),Zi(t,":"),YV(t,s,e)}function wbe(t){let{gen:e,data:r,schema:s}=t,{discriminator:n,mapping:i}=s;Zi(t,"{"),e.assign(r,(0,Se._)`{}`);let o=e.const("pos",We.default.jsonPos),a=e.let("value"),l=e.let("tag");WV(t,"}",()=>{let u=e.let("key");Lu({...t,data:u}),Zi(t,":"),e.if((0,Se._)`${u} === ${n}`,()=>{Lu({...t,data:l}),e.assign((0,Se._)`${r}[${u}]`,l),e.break()},()=>jO({...t,data:a}))}),e.assign(We.default.jsonPos,o),e.if((0,Se._)`${l} === undefined`),sa(t,(0,Se.str)`discriminator tag not found`);for(let u in i)e.elseIf((0,Se._)`${l} === ${u}`),ZV({...t,schema:i[u]},n);e.else(),sa(t,(0,Se.str)`discriminator value not in schema`),e.endIf()}function UV(t){let{gen:e,data:r}=t;Zi(t,"{"),e.assign(r,(0,Se._)`{}`),ZV(t)}function ZV(t,e){let{gen:r,schema:s,data:n}=t,{properties:i,optionalProperties:o,additionalProperties:a}=s;if(LO(t,"}",()=>{let l=r.let("key");if(Lu({...t,data:l}),Zi(t,":"),r.if(!1),VV(t,l,i),VV(t,l,o),e){r.elseIf((0,Se._)`${l} === ${e}`);let u=r.let("tag");Lu({...t,data:u})}r.else(),a?jO({...t,data:(0,Se._)`${n}[${l}]`}):sa(t,(0,Se.str)`property ${l} not allowed`),r.endIf()}),i){let l=(0,fbe.hasPropFunc)(r),u=(0,Se.and)(...Object.keys(i).map(c=>(0,Se._)`${l}.call(${n}, ${c})`));r.if((0,Se.not)(u),()=>sa(t,(0,Se.str)`missing required properties`))}}function VV(t,e,r={}){let{gen:s}=t;for(let n in r)s.elseIf((0,Se._)`${e} === ${n}`),YV(t,e,r[n])}function YV(t,e,r){Kv({...t,schema:r,data:(0,Se._)`${t.data}[${e}]`})}function Tbe(t){let{gen:e,schema:r,data:s,self:n}=t;switch(r.type){case"boolean":vbe(t);break;case"string":Lu(t);break;case"timestamp":{Lu(t);let i=(0,KV.useFunc)(e,mbe.default),{allowDate:o,parseDate:a}=n.opts,l=o?(0,Se._)`!${i}(${s}, true)`:(0,Se._)`!${i}(${s})`,u=a?(0,Se.or)(l,(0,Se._)`(${s} = new Date(${s}), false)`,(0,Se._)`isNaN(${s}.valueOf())`):l;e.if(u,()=>sa(t,(0,Se.str)`invalid timestamp`));break}case"float32":case"float64":MO(t);break;default:{let i=r.type;if(!n.opts.int32range&&(i==="int32"||i==="uint32"))MO(t,16),i==="uint32"&&e.if((0,Se._)`${s} < 0`,()=>sa(t,(0,Se.str)`integer out of range`));else{let[o,a,l]=pbe.intRange[i];MO(t,l),e.if((0,Se._)`${s} < ${o} || ${s} > ${a}`,()=>sa(t,(0,Se.str)`integer out of range`))}}}}function Lu(t){Zi(t,'"'),FO(t,qO.parseJsonString)}function Cbe(t){let{gen:e,data:r,schema:s}=t,n=s.enum;Zi(t,'"'),e.if(!1);for(let i of n){let o=JSON.stringify(i).slice(1);e.elseIf((0,Se._)`${Qv(o.length)} === ${o}`),e.assign(r,(0,Se.str)`${i}`),e.add(We.default.jsonPos,o.length)}e.else(),zd(t),e.endIf()}function MO(t,e){let{gen:r}=t;BO(t),r.if((0,Se._)`"-0123456789".indexOf(${Qv(1)}) < 0`,()=>zd(t),()=>FO(t,qO.parseJsonNumber,e))}function HV(t,e){return r=>{let{gen:s,data:n}=r;vm(r,`${t}`,()=>e(r),()=>s.assign(n,t))}}function Rbe(t){let{gen:e,self:r,definitions:s,schema:n,schemaEnv:i}=t,{ref:o}=n,a=s[o];if(!a)throw new dbe.default(r.opts.uriResolver,"",o,`No definition ${o}`);if(!(0,hbe.hasRef)(a))return Kv({...t,schema:a});let{root:l}=i,u=QV.call(r,new GV.SchemaEnv({schema:a,root:l}),s);JV(t,Obe(e,u),!0)}function Obe(t,e){return e.parse?t.scopeValue("parse",{ref:e.parse}):(0,Se._)`${t.scopeValue("wrapper",{ref:e})}.parse`}function jO(t){FO(t,qO.parseJson)}function FO(t,e,r){JV(t,(0,KV.useFunc)(t.gen,e),r)}function JV(t,e,r){let{gen:s,data:n}=t;s.assign(n,(0,Se._)`${e}(${We.default.json}, ${We.default.jsonPos}${r?(0,Se._)`, ${r}`:Se.nil})`),s.assign(We.default.jsonPos,(0,Se._)`${e}.position`),s.if((0,Se._)`${n} === undefined`,()=>sa(t,(0,Se._)`${e}.message`))}function Zi(t,e){vm(t,e,zd)}function vm(t,e,r,s){let{gen:n}=t,i=e.length;BO(t),n.if((0,Se._)`${Qv(i)} === ${e}`,()=>{n.add(We.default.jsonPos,i),s?.(t)},()=>r(t))}function BO({gen:t,char:e}){t.code((0,Se._)`while((${e}=${We.default.json}[${We.default.jsonPos}],${e}===" "||${e}==="\\n"||${e}==="\\r"||${e}==="\\t"))${We.default.jsonPos}++;`)}function Qv(t){return t===1?(0,Se._)`${We.default.json}[${We.default.jsonPos}]`:(0,Se._)`${We.default.json}.slice(${We.default.jsonPos}, ${We.default.jsonPos}+${t})`}function zd(t){sa(t,(0,Se._)`"unexpected token " + ${We.default.json}[${We.default.jsonPos}]`)}function sa({gen:t,parseName:e},r){t.assign((0,Se._)`${e}.message`,r),t.assign((0,Se._)`${e}.position`,We.default.jsonPos),t.return($O)}});var HO=m((Bt,VO)=>{"use strict";Object.defineProperty(Bt,"__esModule",{value:!0});Bt.MissingRefError=Bt.ValidationError=Bt.CodeGen=Bt.Name=Bt.nil=Bt.stringify=Bt.str=Bt._=Bt.KeywordCxt=Bt.Ajv=void 0;var Pbe=XR(),Abe=PV(),kbe=IV(),xbe=FV(),Ibe=XV(),UO="JTD-meta-schema",Ud=class extends Pbe.default{constructor(e={}){super({...e,jtd:!0})}_addVocabularies(){super._addVocabularies(),this.addVocabulary(Abe.default)}_addDefaultMetaSchema(){super._addDefaultMetaSchema(),this.opts.meta&&this.addMetaSchema(kbe.default,UO,!1)}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(UO)?UO:void 0)}compileSerializer(e){let r=this._addSchema(e);return r.serialize||this._compileSerializer(r)}compileParser(e){let r=this._addSchema(e);return r.parse||this._compileParser(r)}_compileSerializer(e){if(xbe.default.call(this,e,e.schema.definitions||{}),!e.serialize)throw new Error("ajv implementation error");return e.serialize}_compileParser(e){if(Ibe.default.call(this,e,e.schema.definitions||{}),!e.parse)throw new Error("ajv implementation error");return e.parse}};Bt.Ajv=Ud;VO.exports=Bt=Ud;VO.exports.Ajv=Ud;Object.defineProperty(Bt,"__esModule",{value:!0});Bt.default=Ud;var Nbe=Cd();Object.defineProperty(Bt,"KeywordCxt",{enumerable:!0,get:function(){return Nbe.KeywordCxt}});var Vd=Te();Object.defineProperty(Bt,"_",{enumerable:!0,get:function(){return Vd._}});Object.defineProperty(Bt,"str",{enumerable:!0,get:function(){return Vd.str}});Object.defineProperty(Bt,"stringify",{enumerable:!0,get:function(){return Vd.stringify}});Object.defineProperty(Bt,"nil",{enumerable:!0,get:function(){return Vd.nil}});Object.defineProperty(Bt,"Name",{enumerable:!0,get:function(){return Vd.Name}});Object.defineProperty(Bt,"CodeGen",{enumerable:!0,get:function(){return Vd.CodeGen}});var Dbe=Gp();Object.defineProperty(Bt,"ValidationError",{enumerable:!0,get:function(){return Dbe.default}});var Mbe=Zo();Object.defineProperty(Bt,"MissingRefError",{enumerable:!0,get:function(){return Mbe.default}})});var GO=m((K5e,eH)=>{"use strict";var $be=Q1();eH.exports=Object.freeze({coerceTypes:"array",useDefaults:!0,removeAdditional:!0,uriResolver:$be,addUsedSchema:!1,allErrors:!1})});var oH=m(Yi=>{"use strict";Object.defineProperty(Yi,"__esModule",{value:!0});Yi.formatNames=Yi.fastFormats=Yi.fullFormats=void 0;function Hd(t,e){return{validate:t,compare:e}}Yi.fullFormats={date:Hd(sH,WO),time:Hd(nH,ZO),"date-time":Hd(Fbe,iH),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:Ube,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:Zbe,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:Vbe,int32:{type:"number",validate:Kbe},int64:{type:"number",validate:Qbe},float:{type:"number",validate:rH},double:{type:"number",validate:rH},password:!0,binary:!0};Yi.fastFormats={...Yi.fullFormats,date:Hd(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,WO),time:Hd(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,ZO),"date-time":Hd(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,iH),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i};Yi.formatNames=Object.keys(Yi.fullFormats);function qbe(t){return t%4===0&&(t%100!==0||t%400===0)}var Lbe=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,jbe=[0,31,28,31,30,31,30,31,31,30,31,30,31];function sH(t){let e=Lbe.exec(t);if(!e)return!1;let r=+e[1],s=+e[2],n=+e[3];return s>=1&&s<=12&&n>=1&&n<=(s===2&&qbe(r)?29:jbe[s])}function WO(t,e){if(t&&e)return t>e?1:t<e?-1:0}var KO=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i;function nH(t,e){let r=KO.exec(t);if(!r)return!1;let s=+r[1],n=+r[2],i=+r[3],o=r[5];return(s<=23&&n<=59&&i<=59||s===23&&n===59&&i===60)&&(!e||o!=="")}function ZO(t,e){if(!(t&&e))return;let r=KO.exec(t),s=KO.exec(e);if(r&&s)return t=r[1]+r[2]+r[3]+(r[4]||""),e=s[1]+s[2]+s[3]+(s[4]||""),t>e?1:t<e?-1:0}var QO=/t|\s/i;function Fbe(t){let e=t.split(QO);return e.length===2&&sH(e[0])&&nH(e[1],!0)}function iH(t,e){if(!(t&&e))return;let[r,s]=t.split(QO),[n,i]=e.split(QO),o=WO(r,n);if(o!==void 0)return o||ZO(s,i)}var Bbe=/\/|:/,zbe=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function Ube(t){return Bbe.test(t)&&zbe.test(t)}var tH=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function Vbe(t){return tH.lastIndex=0,tH.test(t)}var Hbe=-(2**31),Gbe=2**31-1;function Kbe(t){return Number.isInteger(t)&&t<=Gbe&&t>=Hbe}function Qbe(t){return Number.isInteger(t)}function rH(){return!0}var Wbe=/[^\\]\\Z/;function Zbe(t){if(Wbe.test(t))return!1;try{return new RegExp(t),!0}catch{return!1}}});var aH=m(Gd=>{"use strict";Object.defineProperty(Gd,"__esModule",{value:!0});Gd.formatLimitDefinition=void 0;var Ybe=Nd(),vi=Te(),el=vi.operators,Wv={formatMaximum:{okStr:"<=",ok:el.LTE,fail:el.GT},formatMinimum:{okStr:">=",ok:el.GTE,fail:el.LT},formatExclusiveMaximum:{okStr:"<",ok:el.LT,fail:el.GTE},formatExclusiveMinimum:{okStr:">",ok:el.GT,fail:el.LTE}},Jbe={message:({keyword:t,schemaCode:e})=>vi.str`should be ${Wv[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>vi._`{comparison: ${Wv[t].okStr}, limit: ${e}}`};Gd.formatLimitDefinition={keyword:Object.keys(Wv),type:"string",schemaType:"string",$data:!0,error:Jbe,code(t){let{gen:e,data:r,schemaCode:s,keyword:n,it:i}=t,{opts:o,self:a}=i;if(!o.validateFormats)return;let l=new Ybe.KeywordCxt(i,a.RULES.all.format.definition,"format");l.$data?u():c();function u(){let f=e.scopeValue("formats",{ref:a.formats,code:o.code.formats}),h=e.const("fmt",vi._`${f}[${l.schemaCode}]`);t.fail$data(vi.or(vi._`typeof ${h} != "object"`,vi._`${h} instanceof RegExp`,vi._`typeof ${h}.compare != "function"`,d(h)))}function c(){let f=l.schema,h=a.formats[f];if(!h||h===!0)return;if(typeof h!="object"||h instanceof RegExp||typeof h.compare!="function")throw new Error(`"${n}": format "${f}" does not define "compare" function`);let p=e.scopeValue("formats",{key:f,ref:h,code:o.code.formats?vi._`${o.code.formats}${vi.getProperty(f)}`:void 0});t.fail$data(d(p))}function d(f){return vi._`${f}.compare(${r}, ${s}) ${Wv[n].fail} 0`}},dependencies:["format"]};var Xbe=t=>(t.addKeyword(Gd.formatLimitDefinition),t);Gd.default=Xbe});var dH=m((_m,cH)=>{"use strict";Object.defineProperty(_m,"__esModule",{value:!0});var Kd=oH(),eEe=aH(),YO=Te(),lH=new YO.Name("fullFormats"),tEe=new YO.Name("fastFormats"),JO=(t,e={keywords:!0})=>{if(Array.isArray(e))return uH(t,e,Kd.fullFormats,lH),t;let[r,s]=e.mode==="fast"?[Kd.fastFormats,tEe]:[Kd.fullFormats,lH],n=e.formats||Kd.formatNames;return uH(t,n,r,s),e.keywords&&eEe.default(t),t};JO.get=(t,e="full")=>{let s=(e==="fast"?Kd.fastFormats:Kd.fullFormats)[t];if(!s)throw new Error(`Unknown format "${t}"`);return s};function uH(t,e,r,s){var n,i;(n=(i=t.opts.code).formats)!==null&&n!==void 0||(i.formats=YO._`require("ajv-formats/dist/formats").${s}`);for(let o of e)t.addFormat(o,r[o])}cH.exports=_m=JO;Object.defineProperty(_m,"__esModule",{value:!0});_m.default=JO});var pH=m((Z5e,hH)=>{"use strict";var rEe=Nd().default,sEe=HO(),fH=GO(),XO=class{constructor(e,r){r.mode==="JTD"?this.ajv=new sEe(Object.assign({},fH,r.customOptions)):this.ajv=new rEe(Object.assign({},fH,r.customOptions));let s=!0;if(r.plugins&&r.plugins.length>0)for(let i of r.plugins)Array.isArray(i)?(s=s&&i[0].name!=="formatsPlugin",i[0](this.ajv,i[1])):(s=s&&i.name!=="formatsPlugin",i(this.ajv));s&&dH()(this.ajv),r.onCreate?.(this.ajv);let n=Object.values(e);for(let i of n)this.ajv.addSchema(i)}buildValidatorFunction({schema:e}){if(e.$id){let r=this.ajv.getSchema(e.$id);if(r)return r}return this.ajv.compile(e)}};hH.exports=XO});var gH=m((Y5e,mH)=>{"use strict";var nEe=HO(),iEe=GO(),eP=class{constructor(e,r){this.ajv=new nEe(Object.assign({},iEe,r))}buildSerializerFunction({schema:e}){return this.ajv.compileSerializer(e)}};mH.exports=eP});var _H=m((bm,vH)=>{"use strict";Object.defineProperty(bm,"__esModule",{value:!0});var Sm=nv(),_i=yd();function yH(t,e){if(!t.opts.code.source)throw new Error("moduleCode: ajv instance must have code.source option");let{_n:r}=t.scope.opts;return typeof e=="function"?n(e.source):e!==void 0?i(e,s):i(t.schemas,a=>a.meta?void 0:t.compile(a.schema));function s(a){let l=t.getSchema(a);if(!l)throw new Error(`moduleCode: no schema with id ${a}`);return l}function n(a){let l={},u=a?.validateName,c=o(l,a);return t.opts.code.esm?`"use strict";${r}export const validate = ${u};${r}export default ${u};${r}${c}`:`"use strict";${r}module.exports = ${u};${r}module.exports.default = ${u};${r}${c}`}function i(a,l){var u;let c={},d=(0,_i._)`"use strict";`;for(let f in a){let h=l(a[f]);if(h){let p=o(c,h.source),g=t.opts.code.esm?(0,_i._)`export const ${(0,_i.getEsmExportName)(f)}`:(0,_i._)`exports${(0,_i.getProperty)(f)}`;d=(0,_i._)`${d}${r}${g} = ${(u=h.source)===null||u===void 0?void 0:u.validateName};${r}${p}`}}return`${d}`}function o(a,l){if(!l)throw new Error('moduleCode: function does not have "source" property');if(f(l.validateName)===Sm.UsedValueState.Completed)return _i.nil;h(l.validateName,Sm.UsedValueState.Started);let u=t.scope.scopeCode(l.scopeValues,a,d),c=new _i._Code(`${u}${r}${l.validateCode}`);return l.evaluated?(0,_i._)`${c}${l.validateName}.evaluated = ${l.evaluated};${r}`:c;function d(p){var g;let _=(g=p.value)===null||g===void 0?void 0:g.ref;if(p.prefix==="validate"&&typeof _=="function")return o(a,_.source);if((p.prefix==="root"||p.prefix==="wrapper")&&typeof _=="object"){let{validate:S,validateName:b}=_;if(!b)throw new Error("ajv internal error");let v=t.opts.code.es5?Sm.varKinds.var:Sm.varKinds.const,y=(0,_i._)`${v} ${p} = {validate: ${b}};`;if(f(b)===Sm.UsedValueState.Started)return y;let R=o(a,S?.source);return(0,_i._)`${y}${r}${R}`}}function f(p){var g;return(g=a[p.prefix])===null||g===void 0?void 0:g.get(p)}function h(p,g){let{prefix:_}=p;(a[_]=a[_]||new Map).set(p,g)}}}vH.exports=bm=yH;Object.defineProperty(bm,"__esModule",{value:!0});bm.default=yH});var EH=m((J5e,bH)=>{"use strict";var SH=tP(),oEe=_H().default;function aEe(t={readMode:!0}){if(t.readMode===!0&&!t.restoreFunction)throw new Error("You must provide a restoreFunction options when readMode ON");if(t.readMode!==!0&&!t.storeFunction)throw new Error("You must provide a storeFunction options when readMode OFF");if(t.readMode===!0)return function(){return function(s){return t.restoreFunction(s)}};let e=SH();return function(s,n={}){(!n.customOptions||!n.customOptions.code)&&(n.customOptions=Object.assign({},n.customOptions,{code:{source:!0}}));let i=e(s,n);return function(o){let a=i(o),l=oEe(i[SH.AjvReference].ajv,a);return t.storeFunction(o,l),a}}}bH.exports=aEe});var tP=m((X5e,Qd)=>{"use strict";var TH=Symbol.for("fastify.ajv-compiler.reference"),lEe=pH(),uEe=gH();function rP(t){let e=new Map,r=new Map;return t&&t.jtdSerializer===!0?function(n,i){let o=wH({},i);if(r.has(o))return r.get(o);let a=new uEe(n,i),l=a.buildSerializerFunction.bind(a);return r.set(o,l),l}:function(n,i){let o=wH(n,i.customOptions);if(e.has(o))return e.get(o);let a=new lEe(n,i),l=a.buildValidatorFunction.bind(a);return e.set(o,l),i.customOptions.code!==void 0&&(l[TH]=a),l}}function wH(t,e){let r=JSON.stringify(t),s=JSON.stringify(e);return`${r}${s}`}Qd.exports=rP;Qd.exports.default=rP;Qd.exports.AjvCompiler=rP;Qd.exports.AjvReference=TH;Qd.exports.StandaloneValidator=EH()});var sP=m((eGe,CH)=>{"use strict";var{buildSchemas:cEe}=yp(),dEe=pO(),fEe=tP();function hEe(t,e){if(t)return new Wd(t,e);let r=Object.assign({buildValidator:null,buildSerializer:null},e?.compilersFactory);r.buildValidator||(r.buildValidator=fEe()),r.buildSerializer||(r.buildSerializer=dEe());let s={bucket:e&&e.bucket||cEe,compilersFactory:r,isCustomValidatorCompiler:typeof e?.compilersFactory?.buildValidator=="function",isCustomSerializerCompiler:typeof e?.compilersFactory?.buildValidator=="function"};return new Wd(void 0,s)}var Wd=class{constructor(e,r){this.opts=r||e?.opts,this.addedSchemas=!1,this.compilersFactory=this.opts.compilersFactory,e?(this.schemaBucket=this.opts.bucket(e.getSchemas()),this.validatorCompiler=e.getValidatorCompiler(),this.serializerCompiler=e.getSerializerCompiler(),this.isCustomValidatorCompiler=e.isCustomValidatorCompiler,this.isCustomSerializerCompiler=e.isCustomSerializerCompiler,this.parent=e):(this.schemaBucket=this.opts.bucket(),this.isCustomValidatorCompiler=this.opts.isCustomValidatorCompiler||!1,this.isCustomSerializerCompiler=this.opts.isCustomSerializerCompiler||!1)}add(e){return this.addedSchemas=!0,this.schemaBucket.add(e)}getSchema(e){return this.schemaBucket.getSchema(e)}getSchemas(){return this.schemaBucket.getSchemas()}setValidatorCompiler(e){this.compilersFactory=Object.assign({},this.compilersFactory,{buildValidator:()=>e}),this.validatorCompiler=e,this.isCustomValidatorCompiler=!0}setSerializerCompiler(e){this.compilersFactory=Object.assign({},this.compilersFactory,{buildSerializer:()=>e}),this.serializerCompiler=e,this.isCustomSerializerCompiler=!0}getValidatorCompiler(){return this.validatorCompiler||this.parent&&this.parent.getValidatorCompiler()}getSerializerCompiler(){return this.serializerCompiler||this.parent&&this.parent.getSerializerCompiler()}getSerializerBuilder(){return this.compilersFactory.buildSerializer||this.parent&&this.parent.getSerializerBuilder()}getValidatorBuilder(){return this.compilersFactory.buildValidator||this.parent&&this.parent.getValidatorBuilder()}setupValidator(e){this.validatorCompiler!==void 0&&!this.addedSchemas||(this.validatorCompiler=this.getValidatorBuilder()(this.schemaBucket.getSchemas(),e.ajv))}setupSerializer(e){this.serializerCompiler!==void 0&&!this.addedSchemas||(this.serializerCompiler=this.getSerializerBuilder()(this.schemaBucket.getSchemas(),e.serializerOpts))}};Wd.buildSchemaController=hEe;CH.exports=Wd});var uP=m((tGe,lP)=>{"use strict";var nP=VC(),oP=require("node:assert"),aP=Symbol.for("registered-plugin"),{kTestInternals:pEe}=xr(),{exist:mEe,existReply:gEe,existRequest:yEe}=eR(),{FST_ERR_PLUGIN_VERSION_MISMATCH:vEe,FST_ERR_PLUGIN_NOT_PRESENT_IN_INSTANCE:_Ee}=rs(),{FSTWRN002:SEe}=zo();function Em(t){return t[Symbol.for("plugin-meta")]}function RH(t){let e=OH(t);if(e)return e;let r=require.cache;if(r){let s=Object.keys(r);for(let n=0;n<s.length;n++){let i=s[n];if(r[i].exports===t)return i}}return t.name?t.name:null}function bEe(t){return t.toString().split(`
`).slice(0,2).map(e=>e.trim()).join(" -- ")}function OH(t){return t[Symbol.for("fastify.display-name")]}function PH(t){return!!t[Symbol.for("skip-override")]}function AH(t){let e=Em(t);if(!e)return;let r=e.dependencies;r&&(oP(Array.isArray(r),"The dependencies should be an array of strings"),r.forEach(s=>{oP(this[aP].indexOf(s)>-1,`The dependency '${s}' of plugin '${e.name}' is not registered`)}))}function kH(t){let e=Em(t);if(!e)return;let{decorators:r,name:s}=e;r&&(r.fastify&&iP(this,"Fastify",r.fastify,s),r.reply&&iP(this,"Reply",r.reply,s),r.request&&iP(this,"Request",r.request,s))}var EEe={Fastify:mEe,Request:yEe,Reply:gEe};function iP(t,e,r,s){oP(Array.isArray(r),"The decorators should be an array of strings"),r.forEach(n=>{let i=typeof s=="string"?` required by '${s}'`:"";if(!EEe[e].call(t,n))throw new _Ee(n,i,e)})}function wEe(t){let e=Em(t);if(!e)return;let r=e.fastify,s=/-rc.+$/.test(this.version);if(!(s===!0&&nP.gt(this.version,nP.coerce(r))===!0)&&r&&nP.satisfies(this.version,r,{includePrerelease:s})===!1)throw new vEe(e.name,r,this.version)}function TEe(t){let e=Em(t);if(!e)return;let r=e.name;if(r)return this[aP].push(r),r}function CEe(t,e){t.constructor.name==="AsyncFunction"&&t.length===3&&SEe(e||"anonymous")}function REe(t){let e=TEe.call(this,t)||RH(t);return CEe.call(this,t,e),wEe.call(this,t),kH.call(this,t),AH.call(this,t),PH(t)}lP.exports={getPluginName:RH,getFuncPreview:bEe,kRegisteredPlugins:aP,getDisplayName:OH,registerPlugin:REe};lP.exports[pEe]={shouldSkipOverride:PH,getMeta:Em,checkDecorators:kH,checkDependencies:AH}});var Zv=m((rGe,xH)=>{"use strict";function OEe(t,e){let r=e||AEe();return t?kEe(t,r):r}function PEe(t,e){return t.genReqId(e)}function AEe(){let e=0;return function(){return e=e+1&2147483647,`req-${e.toString(36)}`}}function kEe(t,e){return function(r){return r.headers[t]||e(r)}}xH.exports={getGenReqId:PEe,reqIdGenFactory:OEe}});var MH=m((sGe,DH)=>{"use strict";var IH=12,xEe=0,cP=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,7,7,7,7,7,7,7,7,7,7,7,7,8,7,7,10,9,9,9,11,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,24,36,48,60,72,84,96,0,12,12,12,0,0,0,0,0,0,0,0,0,0,0,24,0,0,0,0,0,0,0,0,0,24,24,24,0,0,0,0,0,0,0,0,0,24,24,0,0,0,0,0,0,0,0,0,0,48,48,48,0,0,0,0,0,0,0,0,0,0,48,48,0,0,0,0,0,0,0,0,0,48,0,0,0,0,0,0,0,0,0,0,127,63,63,63,0,31,15,15,15,7,7,7];function IEe(t){var e=t.indexOf("%");if(e===-1)return t;for(var r=t.length,s="",n=0,i=0,o=e,a=IH;e>-1&&e<r;){var l=NH(t[e+1],4),u=NH(t[e+2],0),c=l|u,d=cP[c];if(a=cP[256+a+d],i=i<<6|c&cP[364+d],a===IH)s+=t.slice(n,o),s+=i<=65535?String.fromCharCode(i):String.fromCharCode(55232+(i>>10),56320+(i&1023)),i=0,n=e+3,e=o=t.indexOf("%",n);else{if(a===xEe)return null;if(e+=3,e<r&&t.charCodeAt(e)===37)continue;return null}}return s+t.slice(n)}var NEe={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};function NH(t,e){var r=NEe[t];return r===void 0?255:r<<e}DH.exports=IEe});var FH=m((nGe,jH)=>{"use strict";var $H=MH(),qH=/\+/g,LH=function(){};LH.prototype=Object.create(null);function DEe(t){let e=new LH;if(typeof t!="string")return e;let r=t.length,s="",n="",i=-1,o=-1,a=!1,l=!1,u=!1,c=!1,d=!1,f=0;for(let h=0;h<r+1;h++)if(f=h!==r?t.charCodeAt(h):38,f===38){if(d=o>i,d||(o=h),s=t.slice(i+1,o),d||s.length>0){u&&(s=s.replace(qH," ")),a&&(s=$H(s)||s),d&&(n=t.slice(o+1,h),c&&(n=n.replace(qH," ")),l&&(n=$H(n)||n));let p=e[s];p===void 0?e[s]=n:p.pop?p.push(n):e[s]=[p,n]}n="",i=h,o=h,a=!1,l=!1,u=!1,c=!1}else f===61?o<=i?o=h:l=!0:f===43?o>i?c=!0:u=!0:f===37&&(o>i?l=!0:a=!0);return e}jH.exports=DEe});var zH=m((iGe,BH)=>{var Ji=Array.from({length:256},(t,e)=>"%"+((e<16?"0":"")+e.toString(16)).toUpperCase()),MEe=new Int8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1,1,1,0,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,0]);function $Ee(t){let e=t.length;if(e===0)return"";let r="",s=0,n=0;e:for(;n<e;n++){let i=t.charCodeAt(n);for(;i<128;){if(MEe[i]!==1&&(s<n&&(r+=t.slice(s,n)),s=n+1,r+=Ji[i]),++n===e)break e;i=t.charCodeAt(n)}if(s<n&&(r+=t.slice(s,n)),i<2048){s=n+1,r+=Ji[192|i>>6]+Ji[128|i&63];continue}if(i<55296||i>=57344){s=n+1,r+=Ji[224|i>>12]+Ji[128|i>>6&63]+Ji[128|i&63];continue}if(++n,n>=e)throw new Error("URI malformed");let o=t.charCodeAt(n)&1023;s=n+1,i=65536+((i&1023)<<10|o),r+=Ji[240|i>>18]+Ji[128|i>>12&63]+Ji[128|i>>6&63]+Ji[128|i&63]}return s===0?t:s<e?r+t.slice(s):r}BH.exports={encodeString:$Ee}});var HH=m((oGe,VH)=>{"use strict";var{encodeString:dP}=zH();function UH(t){let e=typeof t;return e==="string"?dP(t):e==="bigint"?t.toString():e==="boolean"?t?"true":"false":e==="number"&&Number.isFinite(t)?t<1e21?""+t:dP(""+t):""}function qEe(t){let e="";if(t===null||typeof t!="object")return e;let r="&",s=Object.keys(t),n=s.length,i=0;for(let o=0;o<n;o++){let a=s[o],l=t[a],u=dP(a)+"=";if(o&&(e+=r),Array.isArray(l)){i=l.length;for(let c=0;c<i;c++)c&&(e+=r),e+=u,e+=UH(l[c])}else e+=u,e+=UH(l)}return e}VH.exports=qEe});var WH=m((aGe,wm)=>{"use strict";var GH=FH(),KH=HH(),QH={parse:GH,stringify:KH};wm.exports=QH;wm.exports.default=QH;wm.exports.parse=GH;wm.exports.stringify=KH});var YH=m(ZH=>{"use strict";Object.defineProperty(ZH,"__esModule",{value:!0})});var JH=m(Tm=>{"use strict";Object.defineProperty(Tm,"__esModule",{value:!0});Tm.types=void 0;var LEe;(function(t){t[t.ROOT=0]="ROOT",t[t.GROUP=1]="GROUP",t[t.POSITION=2]="POSITION",t[t.SET=3]="SET",t[t.RANGE=4]="RANGE",t[t.REPETITION=5]="REPETITION",t[t.REFERENCE=6]="REFERENCE",t[t.CHAR=7]="CHAR"})(LEe=Tm.types||(Tm.types={}))});var e6=m(XH=>{"use strict";Object.defineProperty(XH,"__esModule",{value:!0})});var ia=m(na=>{"use strict";var jEe=na&&na.__createBinding||(Object.create?function(t,e,r,s){s===void 0&&(s=r),Object.defineProperty(t,s,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,s){s===void 0&&(s=r),t[s]=e[r]}),fP=na&&na.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&jEe(e,t,r)};Object.defineProperty(na,"__esModule",{value:!0});fP(YH(),na);fP(JH(),na);fP(e6(),na)});var Yv=m(ls=>{"use strict";Object.defineProperty(ls,"__esModule",{value:!0});ls.anyChar=ls.notWhitespace=ls.whitespace=ls.notInts=ls.ints=ls.notWords=ls.words=void 0;var vt=ia(),t6=()=>[{type:vt.types.RANGE,from:48,to:57}],r6=()=>[{type:vt.types.CHAR,value:95},{type:vt.types.RANGE,from:97,to:122},{type:vt.types.RANGE,from:65,to:90},{type:vt.types.RANGE,from:48,to:57}],s6=()=>[{type:vt.types.CHAR,value:9},{type:vt.types.CHAR,value:10},{type:vt.types.CHAR,value:11},{type:vt.types.CHAR,value:12},{type:vt.types.CHAR,value:13},{type:vt.types.CHAR,value:32},{type:vt.types.CHAR,value:160},{type:vt.types.CHAR,value:5760},{type:vt.types.RANGE,from:8192,to:8202},{type:vt.types.CHAR,value:8232},{type:vt.types.CHAR,value:8233},{type:vt.types.CHAR,value:8239},{type:vt.types.CHAR,value:8287},{type:vt.types.CHAR,value:12288},{type:vt.types.CHAR,value:65279}],FEe=()=>[{type:vt.types.CHAR,value:10},{type:vt.types.CHAR,value:13},{type:vt.types.CHAR,value:8232},{type:vt.types.CHAR,value:8233}];ls.words=()=>({type:vt.types.SET,set:r6(),not:!1});ls.notWords=()=>({type:vt.types.SET,set:r6(),not:!0});ls.ints=()=>({type:vt.types.SET,set:t6(),not:!1});ls.notInts=()=>({type:vt.types.SET,set:t6(),not:!0});ls.whitespace=()=>({type:vt.types.SET,set:s6(),not:!1});ls.notWhitespace=()=>({type:vt.types.SET,set:s6(),not:!0});ls.anyChar=()=>({type:vt.types.SET,set:FEe(),not:!0})});var i6=m(xn=>{"use strict";var BEe=xn&&xn.__createBinding||(Object.create?function(t,e,r,s){s===void 0&&(s=r),Object.defineProperty(t,s,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,s){s===void 0&&(s=r),t[s]=e[r]}),zEe=xn&&xn.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),UEe=xn&&xn.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&BEe(e,t,r);return zEe(e,t),e};Object.defineProperty(xn,"__esModule",{value:!0});xn.tokenizeClass=xn.strToChars=void 0;var n6=ia(),Zd=UEe(Yv()),VEe="@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^ ?";xn.strToChars=t=>{let e=/(\[\\b\])|(\\)?\\(?:u([A-F0-9]{4})|x([A-F0-9]{2})|c([@A-Z[\\\]^?])|([0tnvfr]))/g;return t.replace(e,(r,s,n,i,o,a,l)=>{if(n)return r;let u=s?8:i?parseInt(i,16):o?parseInt(o,16):a?VEe.indexOf(a):{0:0,t:9,n:10,v:11,f:12,r:13}[l],c=String.fromCharCode(u);return/[[\]{}^$.|?*+()]/.test(c)?`\\${c}`:c})};xn.tokenizeClass=(t,e)=>{var r,s,n,i,o,a,l;let u=[],c,d,f=/\\(?:(w)|(d)|(s)|(W)|(D)|(S))|((?:(?:\\)(.)|([^\]\\]))-(((?:\\)])|(((?:\\)?([^\]])))))|(\])|(?:\\)?([^])/g;for(;(c=f.exec(t))!==null;){let h=(l=(a=(o=(i=(n=(s=(r=c[1]&&Zd.words())!==null&&r!==void 0?r:c[2]&&Zd.ints())!==null&&s!==void 0?s:c[3]&&Zd.whitespace())!==null&&n!==void 0?n:c[4]&&Zd.notWords())!==null&&i!==void 0?i:c[5]&&Zd.notInts())!==null&&o!==void 0?o:c[6]&&Zd.notWhitespace())!==null&&a!==void 0?a:c[7]&&{type:n6.types.RANGE,from:(c[8]||c[9]).charCodeAt(0),to:(d=c[10]).charCodeAt(d.length-1)})!==null&&l!==void 0?l:(d=c[16])&&{type:n6.types.CHAR,value:d.charCodeAt(0)};if(h)u.push(h);else return[u,f.lastIndex]}throw new SyntaxError(`Invalid regular expression: /${e}/: Unterminated character class`)}});var hP=m(Xi=>{"use strict";var HEe=Xi&&Xi.__createBinding||(Object.create?function(t,e,r,s){s===void 0&&(s=r),Object.defineProperty(t,s,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,s){s===void 0&&(s=r),t[s]=e[r]}),GEe=Xi&&Xi.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a6=Xi&&Xi.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&HEe(e,t,r);return GEe(e,t),e};Object.defineProperty(Xi,"__esModule",{value:!0});Xi.tokenizer=void 0;var o6=a6(i6()),Kr=ia(),ju=a6(Yv());Xi.tokenizer=t=>{let e=0,r,s={type:Kr.types.ROOT,stack:[]},n=s,i=s.stack,o=[],a=[],l=0,u=d=>{throw new SyntaxError(`Invalid regular expression: /${t}/: Nothing to repeat at column ${d-1}`)},c=o6.strToChars(t);for(;e<c.length;)switch(r=c[e++]){case"\\":if(e===c.length)throw new SyntaxError(`Invalid regular expression: /${t}/: \\ at end of pattern`);switch(r=c[e++]){case"b":i.push({type:Kr.types.POSITION,value:"b"});break;case"B":i.push({type:Kr.types.POSITION,value:"B"});break;case"w":i.push(ju.words());break;case"W":i.push(ju.notWords());break;case"d":i.push(ju.ints());break;case"D":i.push(ju.notInts());break;case"s":i.push(ju.whitespace());break;case"S":i.push(ju.notWhitespace());break;default:if(/\d/.test(r)){let d=r;for(;e<c.length&&/\d/.test(c[e]);)d+=c[e++];let f=parseInt(d,10),h={type:Kr.types.REFERENCE,value:f};i.push(h),a.push({reference:h,stack:i,index:i.length-1})}else i.push({type:Kr.types.CHAR,value:r.charCodeAt(0)})}break;case"^":i.push({type:Kr.types.POSITION,value:"^"});break;case"$":i.push({type:Kr.types.POSITION,value:"$"});break;case"[":{let d;c[e]==="^"?(d=!0,e++):d=!1;let f=o6.tokenizeClass(c.slice(e),t);e+=f[1],i.push({type:Kr.types.SET,set:f[0],not:d});break}case".":i.push(ju.anyChar());break;case"(":{let d={type:Kr.types.GROUP,stack:[],remember:!0};if(c[e]==="?"){if(r=c[e+1],e+=2,r==="=")d.followedBy=!0;else if(r==="!")d.notFollowedBy=!0;else if(r!==":")throw new SyntaxError(`Invalid regular expression: /${t}/: Invalid group, character '${r}' after '?' at column ${e-1}`);d.remember=!1}else l+=1;i.push(d),o.push(n),n=d,i=d.stack;break}case")":if(o.length===0)throw new SyntaxError(`Invalid regular expression: /${t}/: Unmatched ) at column ${e-1}`);n=o.pop(),i=n.options?n.options[n.options.length-1]:n.stack;break;case"|":{n.options||(n.options=[n.stack],delete n.stack);let d=[];n.options.push(d),i=d;break}case"{":{let d=/^(\d+)(,(\d+)?)?\}/.exec(c.slice(e)),f,h;d!==null?(i.length===0&&u(e),f=parseInt(d[1],10),h=d[2]?d[3]?parseInt(d[3],10):1/0:f,e+=d[0].length,i.push({type:Kr.types.REPETITION,min:f,max:h,value:i.pop()})):i.push({type:Kr.types.CHAR,value:123});break}case"?":i.length===0&&u(e),i.push({type:Kr.types.REPETITION,min:0,max:1,value:i.pop()});break;case"+":i.length===0&&u(e),i.push({type:Kr.types.REPETITION,min:1,max:1/0,value:i.pop()});break;case"*":i.length===0&&u(e),i.push({type:Kr.types.REPETITION,min:0,max:1/0,value:i.pop()});break;default:i.push({type:Kr.types.CHAR,value:r.charCodeAt(0)})}if(o.length!==0)throw new SyntaxError(`Invalid regular expression: /${t}/: Unterminated group`);return KEe(a,l),s};function KEe(t,e){for(let r of t.reverse())if(e<r.reference.value){r.reference.type=Kr.types.CHAR;let s=r.reference.value.toString();if(r.reference.value=parseInt(s,8),!/^[0-7]+$/.test(s)){let n=0;for(;s[n]!=="8"&&s[n]!=="9";)n+=1;if(n===0?(r.reference.value=s.charCodeAt(0),n+=1):r.reference.value=parseInt(s.slice(0,n),8),s.length>n){let i=r.stack.splice(r.index+1);for(let o of s.slice(n))r.stack.push({type:Kr.types.CHAR,value:o.charCodeAt(0)});r.stack.push(...i)}}}}});var u6=m(us=>{"use strict";var QEe=us&&us.__createBinding||(Object.create?function(t,e,r,s){s===void 0&&(s=r),Object.defineProperty(t,s,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,s){s===void 0&&(s=r),t[s]=e[r]}),WEe=us&&us.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),ZEe=us&&us.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&QEe(e,t,r);return WEe(e,t),e};Object.defineProperty(us,"__esModule",{value:!0});us.NOTANYCHAR=us.WHITESPACE=us.WORDS=us.INTS=void 0;var Jv=ZEe(Yv()),l6=ia();function Xv(t){let e={},r=0;for(let s of t)s.type===l6.types.CHAR&&(e[s.value]=!0),s.type===l6.types.RANGE&&(e[`${s.from}-${s.to}`]=!0),r+=1;return{lookup:()=>Object.assign({},e),len:r}}us.INTS=Xv(Jv.ints().set);us.WORDS=Xv(Jv.words().set);us.WHITESPACE=Xv(Jv.whitespace().set);us.NOTANYCHAR=Xv(Jv.anyChar().set)});var d6=m(In=>{"use strict";var YEe=In&&In.__createBinding||(Object.create?function(t,e,r,s){s===void 0&&(s=r),Object.defineProperty(t,s,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,s){s===void 0&&(s=r),t[s]=e[r]}),JEe=In&&In.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),XEe=In&&In.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&YEe(e,t,r);return JEe(e,t),e};Object.defineProperty(In,"__esModule",{value:!0});In.writeSetTokens=In.setChar=void 0;var s_=ia(),e_=XEe(u6());function r_(t){return t===94?"\\^":t===92?"\\\\":t===93?"\\]":t===45?"\\-":String.fromCharCode(t)}In.setChar=r_;function t_(t,{lookup:e,len:r}){if(r!==t.length)return!1;let s=e();for(let n of t){if(n.type===s_.types.SET)return!1;let i=n.type===s_.types.CHAR?n.value:`${n.from}-${n.to}`;if(s[i])s[i]=!1;else return!1}return!0}function c6(t,e=!1){if(t_(t.set,e_.INTS))return t.not?"\\D":"\\d";if(t_(t.set,e_.WORDS))return t.not?"\\W":"\\w";if(t.not&&t_(t.set,e_.NOTANYCHAR))return".";if(t_(t.set,e_.WHITESPACE))return t.not?"\\S":"\\s";let r="";for(let n=0;n<t.set.length;n++){let i=t.set[n];r+=ewe(i)}let s=`${t.not?"^":""}${r}`;return e?s:`[${s}]`}In.writeSetTokens=c6;function ewe(t){return t.type===s_.types.CHAR?r_(t.value):t.type===s_.types.RANGE?`${r_(t.from)}-${r_(t.to)}`:c6(t,!0)}});var mP=m(Yd=>{"use strict";Object.defineProperty(Yd,"__esModule",{value:!0});Yd.reconstruct=void 0;var tl=ia(),pP=d6(),f6=t=>t.map(Yd.reconstruct).join(""),h6=t=>{if("options"in t)return t.options.map(f6).join("|");if("stack"in t)return f6(t.stack);throw new Error("options or stack must be Root or Group token")};Yd.reconstruct=t=>{switch(t.type){case tl.types.ROOT:return h6(t);case tl.types.CHAR:{let e=String.fromCharCode(t.value);return(/[[\\{}$^.|?*+()]/.test(e)?"\\":"")+e}case tl.types.POSITION:return t.value==="^"||t.value==="$"?t.value:`\\${t.value}`;case tl.types.REFERENCE:return`\\${t.value}`;case tl.types.SET:return pP.writeSetTokens(t);case tl.types.GROUP:return`(${t.remember?"":t.followedBy?"?=":t.notFollowedBy?"?!":"?:"}${h6(t)})`;case tl.types.REPETITION:{let{min:e,max:r}=t,s;return e===0&&r===1?s="?":e===1&&r===1/0?s="+":e===0&&r===1/0?s="*":r===1/0?s=`{${e},}`:e===r?s=`{${e}}`:s=`{${e},${r}}`,`${Yd.reconstruct(t.value)}${s}`}case tl.types.RANGE:return`${pP.setChar(t.from)}-${pP.setChar(t.to)}`;default:throw new Error(`Invalid token type ${t}`)}}});var g6=m((Nn,n_)=>{"use strict";var twe=Nn&&Nn.__createBinding||(Object.create?function(t,e,r,s){s===void 0&&(s=r),Object.defineProperty(t,s,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,s){s===void 0&&(s=r),t[s]=e[r]}),gP=Nn&&Nn.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&twe(e,t,r)};Object.defineProperty(Nn,"__esModule",{value:!0});Nn.types=void 0;var p6=ia();Object.defineProperty(Nn,"types",{enumerable:!0,get:function(){return p6.types}});gP(hP(),Nn);gP(mP(),Nn);var m6=hP(),rwe=mP();gP(ia(),Nn);Nn.default=m6.tokenizer;n_.exports=m6.tokenizer;n_.exports.types=p6.types;n_.exports.reconstruct=rwe.reconstruct});var v6=m((vGe,i_)=>{"use strict";var y6=g6(),swe=y6.types;function yP(t,e){e||(e={});let r=e.limit===void 0?25:e.limit;nwe(t)?t=t.source:typeof t!="string"&&(t=String(t));try{t=y6(t)}catch{return!1}let s=0;return function n(i,o){let a,l,u;if(i.type===swe.REPETITION&&(o++,s++,o>1||s>r))return!1;if(i.options){for(a=0,u=i.options.length;a<u;a++)if(l=n({stack:i.options[a]},o),!l)return!1}let c=i.stack||i.value&&i.value.stack;if(!c)return!0;for(a=0;a<c.length;a++)if(l=n(c[a],o),!l)return!1;return!0}(t,0)}function nwe(t){return{}.toString.call(t)==="[object RegExp]"}i_.exports=yP;i_.exports.default=yP;i_.exports.safeRegex=yP});var o_=m((_Ge,_6)=>{"use strict";_6.exports={name:"__fmw_internal_strategy_merged_tree_http_method__",storage:function(){let t={};return{get:e=>t[e]||null,set:(e,r)=>{t[e]=r}}},deriveConstraint:t=>t.method,mustMatchWhenDerived:!0}});var R6=m((SGe,C6)=>{"use strict";var S6=Fa(),b6=o_(),E6=Symbol("treeData");function w6(t,e=""){let r="",s=Object.keys(t);for(let n=0;n<s.length;n++){let i=s[n],o=t[i],a=n===s.length-1,l=a?"\u2514\u2500\u2500 ":"\u251C\u2500\u2500 ",u=a?"    ":"\u2502   ",d=(o[E6]||"").split(`
`).join(`
`+e+u);r+=e+l+i+d+`
`,r+=w6(o,e+u)}return r}function iwe(t){let e=t.name||"";return e=e.replace("bound","").trim(),e=(e||"anonymous")+"()",e}function T6(t){return Array.isArray(t)?t.map(e=>T6(e)):typeof t=="symbol"?t.toString():typeof t=="function"?iwe(t):t}function owe(t,e){if(!e.includeMeta)return{};let r=e.buildPrettyMeta(t),s={},n=e.includeMeta;Array.isArray(n)||(n=Reflect.ownKeys(r));for(let i of n){if(!Object.prototype.hasOwnProperty.call(r,i))continue;let o=i.toString(),a=r[i];if(a!=null){let l=JSON.stringify(T6(a));s[o]=l}}return s}function awe(t){let e="";for(let[r,s]of Object.entries(t))e+=`
\u2022 (${r}) ${s}`;return e}function lwe(t){let e={...t.opts.constraints},r=e[b6.name];return delete e[b6.name],{...t,method:r,opts:{constraints:e}}}function uwe(t){let e=` (${t.method})`,r=t.opts.constraints||{};return Object.keys(r).length!==0&&(e+=" "+JSON.stringify(r)),e+=awe(t.metaData),e}function cwe(t){return t.reduce((e,r)=>{for(let s of e)if(S6(r.opts.constraints,s.opts.constraints)&&S6(r.metaData,s.metaData))return s.method+=", "+r.method,e;return e.push(r),e},[])}function dwe(t,e,r){let s=t.routes;return r.method===void 0&&(s=s.map(lwe)),s=s.map(n=>(n.metaData=owe(n,r),n)),r.method===void 0&&(s=cwe(s)),s.map(uwe).join(`
${e}`)}function a_(t,e,r,s){if((t.isLeafNode||s.commonPrefix!==!1)&&(r=r||"(empty root node)",e=e[r]={},t.isLeafNode&&(e[E6]=dwe(t,r,s)),r=""),t.staticChildren)for(let n of Object.values(t.staticChildren))a_(n,e,r+n.prefix,s);if(t.parametricChildren)for(let n of Object.values(t.parametricChildren)){let i=Array.from(n.nodePaths).join("|");a_(n,e,r+i,s)}t.wildcardChild&&a_(t.wildcardChild,e,"*",s)}function fwe(t,e){let r={};return a_(t,r,t.prefix,e),w6(r)}C6.exports={prettyPrintTree:fwe}});var P6=m((bGe,O6)=>{"use strict";var hwe=o_(),vP=class{constructor(){this.unconstrainedHandler=null,this.constraints=[],this.handlers=[],this.constrainedHandlerStores=null}getMatchingHandler(e){return e===void 0?this.unconstrainedHandler:this._getHandlerMatchingConstraints(e)}addHandler(e,r){let s=r.params,n=r.opts.constraints||{},i={params:s,constraints:n,handler:r.handler,store:r.store||null,_createParamsObject:this._compileCreateParamsObject(s)},o=Object.keys(n);o.length===0&&(this.unconstrainedHandler=i);for(let l of o)this.constraints.includes(l)||(l==="version"?this.constraints.unshift(l):this.constraints.push(l));let a=o.includes(hwe.name);if(!a&&this.handlers.length>=31)throw new Error("find-my-way supports a maximum of 31 route handlers per node when there are constraints, limit reached");this.handlers.push(i),this.handlers.sort((l,u)=>Object.keys(l.constraints).length-Object.keys(u.constraints).length),a||this._compileGetHandlerMatchingConstraints(e,n)}_compileCreateParamsObject(e){let r=[];for(let s=0;s<e.length;s++)r.push(`'${e[s]}': paramsArray[${s}]`);return new Function("paramsArray",`return {${r.join(",")}}`)}_getHandlerMatchingConstraints(){return null}_buildConstraintStore(e,r){for(let s=0;s<this.handlers.length;s++){let i=this.handlers[s].constraints[r];if(i!==void 0){let o=e.get(i)||0;o|=1<<s,e.set(i,o)}}}_constrainedIndexBitmask(e){let r=0;for(let s=0;s<this.handlers.length;s++)this.handlers[s].constraints[e]!==void 0&&(r|=1<<s);return~r}_compileGetHandlerMatchingConstraints(e){this.constrainedHandlerStores={};for(let s of this.constraints){let n=e.newStoreForConstraint(s);this.constrainedHandlerStores[s]=n,this._buildConstraintStore(n,s)}let r=[];r.push(`
    let candidates = ${(1<<this.handlers.length)-1}
    let mask, matches
    `);for(let s of this.constraints){r.push(`
      mask = ${this._constrainedIndexBitmask(s)}
      value = derivedConstraints.${s}
      `);let i=e.strategies[s].mustMatchWhenDerived?"matches":"(matches | mask)";r.push(`
      if (value === undefined) {
        candidates &= mask
      } else {
        matches = this.constrainedHandlerStores.${s}.get(value) || 0
        candidates &= ${i}
      }
      if (candidates === 0) return null;
      `)}for(let s in e.strategies)e.strategies[s].mustMatchWhenDerived&&!this.constraints.includes(s)&&r.push(`if (derivedConstraints.${s} !== undefined) return null`);r.push("return this.handlers[Math.floor(Math.log2(candidates))]"),this._getHandlerMatchingConstraints=new Function("derivedConstraints",r.join(`
`))}};O6.exports=vP});var k6=m((EGe,A6)=>{"use strict";var pwe=P6(),f_={STATIC:0,PARAMETRIC:1,WILDCARD:2},l_=class{constructor(){this.isLeafNode=!1,this.routes=null,this.handlerStorage=null}addRoute(e,r){this.routes===null&&(this.routes=[]),this.handlerStorage===null&&(this.handlerStorage=new pwe),this.isLeafNode=!0,this.routes.push(e),this.handlerStorage.addHandler(r,e)}},u_=class extends l_{constructor(){super(),this.staticChildren={}}findStaticMatchingChild(e,r){let s=this.staticChildren[e.charAt(r)];return s===void 0||!s.matchPrefix(e,r)?null:s}getStaticChild(e,r=0){if(e.length===r)return this;let s=this.findStaticMatchingChild(e,r);return s?s.getStaticChild(e,r+s.prefix.length):null}createStaticChild(e){if(e.length===0)return this;let r=this.staticChildren[e.charAt(0)];if(r){let n=1;for(;n<r.prefix.length;n++)if(e.charCodeAt(n)!==r.prefix.charCodeAt(n)){r=r.split(this,n);break}return r.createStaticChild(e.slice(n))}let s=e.charAt(0);return this.staticChildren[s]=new Jd(e),this.staticChildren[s]}},Jd=class extends u_{constructor(e){super(),this.prefix=e,this.wildcardChild=null,this.parametricChildren=[],this.kind=f_.STATIC,this._compilePrefixMatch()}getParametricChild(e){let r=e&&e.source,s=this.parametricChildren.find(n=>(n.regex&&n.regex.source)===r);return s||null}createParametricChild(e,r,s){let n=this.getParametricChild(e);return n?(n.nodePaths.add(s),n):(n=new c_(e,r,s),this.parametricChildren.push(n),this.parametricChildren.sort((i,o)=>i.isRegex?o.isRegex?i.staticSuffix===null?1:o.staticSuffix===null?-1:o.staticSuffix.endsWith(i.staticSuffix)?1:i.staticSuffix.endsWith(o.staticSuffix)?-1:0:-1:1),n)}getWildcardChild(){return this.wildcardChild}createWildcardChild(){return this.wildcardChild=this.getWildcardChild()||new d_,this.wildcardChild}split(e,r){let s=this.prefix.slice(0,r),n=this.prefix.slice(r);this.prefix=n,this._compilePrefixMatch();let i=new Jd(s);return i.staticChildren[n.charAt(0)]=this,e.staticChildren[s.charAt(0)]=i,i}getNextNode(e,r,s,n){let i=this.findStaticMatchingChild(e,r),o=0;if(i===null){if(this.parametricChildren.length===0)return this.wildcardChild;i=this.parametricChildren[0],o=1}this.wildcardChild!==null&&s.push({paramsCount:n,brotherPathIndex:r,brotherNode:this.wildcardChild});for(let a=this.parametricChildren.length-1;a>=o;a--)s.push({paramsCount:n,brotherPathIndex:r,brotherNode:this.parametricChildren[a]});return i}_compilePrefixMatch(){if(this.prefix.length===1){this.matchPrefix=()=>!0;return}let e=[];for(let r=1;r<this.prefix.length;r++){let s=this.prefix.charCodeAt(r);e.push(`path.charCodeAt(i + ${r}) === ${s}`)}this.matchPrefix=new Function("path","i",`return ${e.join(" && ")}`)}},c_=class extends u_{constructor(e,r,s){super(),this.isRegex=!!e,this.regex=e||null,this.staticSuffix=r||null,this.kind=f_.PARAMETRIC,this.nodePaths=new Set([s])}getNextNode(e,r){return this.findStaticMatchingChild(e,r)}},d_=class extends l_{constructor(){super(),this.kind=f_.WILDCARD}getNextNode(){return null}};A6.exports={StaticNode:Jd,ParametricNode:c_,WildcardNode:d_,NODE_TYPES:f_}});var I6=m((wGe,x6)=>{"use strict";var mwe=require("node:assert");function Cm(){if(!(this instanceof Cm))return new Cm;this.store={},this.maxMajor=0,this.maxMinors={},this.maxPatches={}}Cm.prototype.set=function(t,e){if(typeof t!="string")throw new TypeError("Version should be a string");let[r,s,n]=t.split(".");if(isNaN(r))throw new TypeError("Major version must be a numeric value");return r=Number(r),s=Number(s)||0,n=Number(n)||0,r>=this.maxMajor&&(this.maxMajor=r,this.store.x=e,this.store["*"]=e,this.store["x.x"]=e,this.store["x.x.x"]=e),s>=(this.maxMinors[r]||0)&&(this.maxMinors[r]=s,this.store[`${r}.x`]=e,this.store[`${r}.x.x`]=e),n>=(this.maxPatches[`${r}.${s}`]||0)&&(this.maxPatches[`${r}.${s}`]=n,this.store[`${r}.${s}.x`]=e),this.store[`${r}.${s}.${n}`]=e,this};Cm.prototype.get=function(t){return this.store[t]};x6.exports={name:"version",mustMatchWhenDerived:!0,storage:Cm,validate(t){mwe(typeof t=="string","Version should be a string")}}});var D6=m((TGe,N6)=>{"use strict";var gwe=require("node:assert");function ywe(){let t={},e=[];return{get:r=>{let s=t[r];if(s)return s;for(let n of e)if(n.host.test(r))return n.value},set:(r,s)=>{r instanceof RegExp?e.push({host:r,value:s}):t[r]=s}}}N6.exports={name:"host",mustMatchWhenDerived:!1,storage:ywe,validate(t){gwe(typeof t=="string"||Object.prototype.toString.call(t)==="[object RegExp]","Host should be a string or a RegExp")}}});var $6=m((CGe,M6)=>{"use strict";var vwe=I6(),_we=D6(),_P=require("node:assert"),SP=class{constructor(e){if(this.strategies={version:vwe,host:_we},this.strategiesInUse=new Set,this.asyncStrategiesInUse=new Set,e)for(let r of Object.values(e))this.addConstraintStrategy(r)}isStrategyUsed(e){return this.strategiesInUse.has(e)||this.asyncStrategiesInUse.has(e)}hasConstraintStrategy(e){let r=this.strategies[e];return r!==void 0?r.isCustom||this.isStrategyUsed(e):!1}addConstraintStrategy(e){if(_P(typeof e.name=="string"&&e.name!=="","strategy.name is required."),_P(e.storage&&typeof e.storage=="function","strategy.storage function is required."),_P(e.deriveConstraint&&typeof e.deriveConstraint=="function","strategy.deriveConstraint function is required."),this.strategies[e.name]&&this.strategies[e.name].isCustom)throw new Error(`There already exists a custom constraint with the name ${e.name}.`);if(this.isStrategyUsed(e.name))throw new Error(`There already exists a route with ${e.name} constraint.`);e.isCustom=!0,e.isAsync=e.deriveConstraint.length===3,this.strategies[e.name]=e,e.mustMatchWhenDerived&&this.noteUsage({[e.name]:e})}deriveConstraints(e,r,s){let n=this.deriveSyncConstraints(e,r);if(s===void 0)return n;this.deriveAsyncConstraints(n,e,r,s)}deriveSyncConstraints(e,r){}noteUsage(e){if(e){let r=this.strategiesInUse.size;for(let s in e)this.strategies[s].isAsync?this.asyncStrategiesInUse.add(s):this.strategiesInUse.add(s);r!==this.strategiesInUse.size&&this._buildDeriveConstraints()}}newStoreForConstraint(e){if(!this.strategies[e])throw new Error(`No strategy registered for constraint key ${e}`);return this.strategies[e].storage()}validateConstraints(e){for(let r in e){let s=e[r];if(typeof s>"u")throw new Error("Can't pass an undefined constraint value, must pass null or no key at all");let n=this.strategies[r];if(!n)throw new Error(`No strategy registered for constraint key ${r}`);n.validate&&n.validate(s)}}deriveAsyncConstraints(e,r,s,n){let i=this.asyncStrategiesInUse.size;if(i===0){n(null,e);return}e=e||{};for(let o of this.asyncStrategiesInUse)this.strategies[o].deriveConstraint(r,s,(l,u)=>{if(l!==null){n(l);return}e[o]=u,--i===0&&n(null,e)})}_buildDeriveConstraints(){if(this.strategiesInUse.size===0)return;let e=["return {"];for(let r of this.strategiesInUse){let s=this.strategies[r];s.isCustom?e.push(`  ${s.name}: this.strategies.${r}.deriveConstraint(req, ctx),`):r==="version"?e.push("   version: req.headers['accept-version'],"):e.push("   host: req.headers.host || req.headers[':authority'],")}e.push("}"),this.deriveSyncConstraints=new Function("req","ctx",e.join(`
`)).bind(this)}};M6.exports=SP});var L6=m((RGe,q6)=>{"use strict";var Swe=["ACL","BIND","CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LINK","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCALENDAR","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REBIND","REPORT","SEARCH","SOURCE","SUBSCRIBE","TRACE","UNBIND","UNLINK","UNLOCK","UNSUBSCRIBE"];q6.exports=Swe});var B6=m((OGe,F6)=>{"use strict";function j6(t,e){return t===50?e===53?"%":e===51?"#":e===52?"$":e===54?"&":e===66||e===98?"+":e===67||e===99?",":e===70||e===102?"/":null:t===51?e===65||e===97?":":e===66||e===98?";":e===68||e===100?"=":e===70||e===102?"?":null:t===52&&e===48?"@":null}function bwe(t,e){let r=!1,s=!1,n="";for(let o=1;o<t.length;o++){let a=t.charCodeAt(o);if(a===37){let l=t.charCodeAt(o+1),u=t.charCodeAt(o+2);j6(l,u)===null?r=!0:(s=!0,l===50&&u===53&&(r=!0,t=t.slice(0,o+1)+"25"+t.slice(o+1),o+=2),o+=2)}else if(a===63||a===35||a===59&&e){n=t.slice(o+1),t=t.slice(0,o);break}}return{path:r?decodeURI(t):t,querystring:n,shouldDecodeParam:s}}function Ewe(t){let e=t.indexOf("%");if(e===-1)return t;let r="",s=e;for(let n=e;n<t.length;n++)if(t.charCodeAt(n)===37){let i=t.charCodeAt(n+1),o=t.charCodeAt(n+2),a=j6(i,o);r+=t.slice(s,n)+a,s=n+3}return t.slice(0,e)+r+t.slice(s)}F6.exports={safeDecodeURI:bwe,safeDecodeURIComponent:Ewe}});var CP=m((PGe,W6)=>{"use strict";var cr=require("node:assert"),wwe=WH(),h_=v6(),EP=Fa(),{prettyPrintTree:Twe}=R6(),{StaticNode:z6,NODE_TYPES:U6}=k6(),Cwe=$6(),Xd=L6(),bP=o_(),{safeDecodeURI:Rwe,safeDecodeURIComponent:V6}=B6(),H6=/^https?:\/\/.*?\//,Fu=/(\/:[^/()]*?)\?(\/?)/;if(!h_(H6))throw new Error("the FULL_PATH_REGEXP is not safe, update this module");if(!h_(Fu))throw new Error("the OPTIONAL_PARAM_REGEXP is not safe, update this module");function tr(t){if(!(this instanceof tr))return new tr(t);t=t||{},this._opts=t,t.defaultRoute?(cr(typeof t.defaultRoute=="function","The default route must be a function"),this.defaultRoute=t.defaultRoute):this.defaultRoute=null,t.onBadUrl?(cr(typeof t.onBadUrl=="function","The bad url handler must be a function"),this.onBadUrl=t.onBadUrl):this.onBadUrl=null,t.buildPrettyMeta?(cr(typeof t.buildPrettyMeta=="function","buildPrettyMeta must be a function"),this.buildPrettyMeta=t.buildPrettyMeta):this.buildPrettyMeta=Owe,t.querystringParser?(cr(typeof t.querystringParser=="function","querystringParser must be a function"),this.querystringParser=t.querystringParser):this.querystringParser=e=>e===""?{}:wwe.parse(e),this.caseSensitive=t.caseSensitive===void 0?!0:t.caseSensitive,this.ignoreTrailingSlash=t.ignoreTrailingSlash||!1,this.ignoreDuplicateSlashes=t.ignoreDuplicateSlashes||!1,this.maxParamLength=t.maxParamLength||100,this.allowUnsafeRegex=t.allowUnsafeRegex||!1,this.constrainer=new Cwe(t.constraints),this.useSemicolonDelimiter=t.useSemicolonDelimiter||!1,this.routes=[],this.trees={}}tr.prototype.on=function(e,r,s,n,i){typeof s=="function"&&(n!==void 0&&(i=n),n=s,s={}),cr(typeof r=="string","Path should be a string"),cr(r.length>0,"The path could not be empty"),cr(r[0]==="/"||r[0]==="*","The first character of a path should be `/` or `*`"),cr(typeof n=="function","Handler should be a function");let o=r.match(Fu);if(o){cr(r.length===o.index+o[0].length,"Optional Parameter needs to be the last parameter of the path");let u=r.replace(Fu,"$1$2"),c=r.replace(Fu,"$2")||"/";this.on(e,u,s,n,i),this.on(e,c,s,n,i);return}let a=r;this.ignoreDuplicateSlashes&&(r=wP(r)),this.ignoreTrailingSlash&&(r=TP(r));let l=Array.isArray(e)?e:[e];for(let u of l)cr(typeof u=="string","Method should be a string"),cr(Xd.includes(u),`Method '${u}' is not an http method.`),this._on(u,r,s,n,i,a)};tr.prototype._on=function(e,r,s,n,i){let o={};s.constraints!==void 0&&(cr(typeof s.constraints=="object"&&s.constraints!==null,"Constraints should be an object"),Object.keys(s.constraints).length!==0&&(o=s.constraints)),this.constrainer.validateConstraints(o),this.constrainer.noteUsage(o),this.trees[e]===void 0&&(this.trees[e]=new z6("/"));let a=r;if(a==="*"&&this.trees[e].prefix.length!==0){let f=this.trees[e];this.trees[e]=new z6(""),this.trees[e].staticChildren["/"]=f}let l=this.trees[e],u=l.prefix.length,c=[];for(let f=0;f<=a.length;f++){if(a.charCodeAt(f)===58&&a.charCodeAt(f+1)===58){f++;continue}let h=a.charCodeAt(f)===58&&a.charCodeAt(f+1)!==58,p=a.charCodeAt(f)===42;if(h||p||f===a.length&&f!==u){let g=a.slice(u,f);this.caseSensitive||(g=g.toLowerCase()),g=g.split("::").join(":"),g=g.split("%").join("%25"),l=l.createStaticChild(g)}if(h){let g=!1,_=[],S=f+1;for(let b=S;;b++){let v=a.charCodeAt(b),y=v===40,R=v===45||v===46,P=v===47||b===a.length;if(y||R||P){let w=a.slice(S,b);if(c.push(w),g=g||y||R,y){let C=Q6(a,b),k=a.slice(b,C+1);this.allowUnsafeRegex||cr(h_(new RegExp(k)),`The regex '${k}' is not safe!`),_.push(K6(k)),b=C+1}else _.push("(.*?)");let O=b;for(;b<a.length;b++){let C=a.charCodeAt(b);if(C===47)break;if(C===58)if(a.charCodeAt(b+1)===58)b++;else break}let $=a.slice(O,b);if($&&($=$.split("::").join(":"),$=$.split("%").join("%25"),_.push(G6($))),S=b+1,P||a.charCodeAt(b)===47||b===a.length){let C=g?"()"+$:$,k=a.slice(f,b);a=a.slice(0,f+1)+C+a.slice(b),f+=C.length;let z=g?new RegExp("^"+_.join("")+"$"):null;l=l.createParametricChild(z,$||null,k),u=f+1;break}}}}else if(p&&(c.push("*"),l=l.createWildcardChild(),u=f+1,f!==a.length-1))throw new Error("Wildcard must be the last character in the route")}this.caseSensitive||(a=a.toLowerCase()),a==="*"&&(a="/*");for(let f of this.routes){let h=f.opts.constraints||{};if(f.method===e&&f.pattern===a&&EP(h,o))throw new Error(`Method '${e}' already declared for route '${a}' with constraints '${JSON.stringify(o)}'`)}let d={method:e,path:r,pattern:a,params:c,opts:s,handler:n,store:i};this.routes.push(d),l.addRoute(d,this.constrainer)};tr.prototype.hasRoute=function(e,r,s){return this.findRoute(e,r,s)!==null};tr.prototype.findRoute=function(e,r,s={}){if(this.trees[e]===void 0)return null;let n=r,i=this.trees[e],o=i.prefix.length,a=[];for(let l=0;l<=n.length;l++){if(n.charCodeAt(l)===58&&n.charCodeAt(l+1)===58){l++;continue}let u=n.charCodeAt(l)===58&&n.charCodeAt(l+1)!==58,c=n.charCodeAt(l)===42;if(u||c||l===n.length&&l!==o){let d=n.slice(o,l);if(this.caseSensitive||(d=d.toLowerCase()),d=d.split("::").join(":"),d=d.split("%").join("%25"),i=i.getStaticChild(d),i===null)return null}if(u){let d=!1,f=[],h=l+1;for(let p=h;;p++){let g=n.charCodeAt(p),_=g===40,S=g===45||g===46,b=g===47||p===n.length;if(_||S||b){let v=n.slice(h,p);if(a.push(v),d=d||_||S,_){let P=Q6(n,p),w=n.slice(p,P+1);this.allowUnsafeRegex||cr(h_(new RegExp(w)),`The regex '${w}' is not safe!`),f.push(K6(w)),p=P+1}else f.push("(.*?)");let y=p;for(;p<n.length;p++){let P=n.charCodeAt(p);if(P===47)break;if(P===58)if(n.charCodeAt(p+1)===58)p++;else break}let R=n.slice(y,p);if(R&&(R=R.split("::").join(":"),R=R.split("%").join("%25"),f.push(G6(R))),h=p+1,b||n.charCodeAt(p)===47||p===n.length){let P=d?"()"+R:R,w=n.slice(l,p);n=n.slice(0,l+1)+P+n.slice(p),l+=P.length;let O=d?new RegExp("^"+f.join("")+"$"):null;if(i=i.getParametricChild(O,R||null,w),i===null)return null;o=l+1;break}}}}else if(c&&(a.push("*"),i=i.getWildcardChild(),o=l+1,l!==n.length-1))throw new Error("Wildcard must be the last character in the route")}this.caseSensitive||(n=n.toLowerCase());for(let l of this.routes){let u=l.opts.constraints||{};if(l.method===e&&l.pattern===n&&EP(u,s))return{handler:l.handler,store:l.store,params:l.params}}return null};tr.prototype.hasConstraintStrategy=function(t){return this.constrainer.hasConstraintStrategy(t)};tr.prototype.addConstraintStrategy=function(t){this.constrainer.addConstraintStrategy(t),this._rebuild(this.routes)};tr.prototype.reset=function(){this.trees={},this.routes=[]};tr.prototype.off=function(e,r,s){cr(typeof r=="string","Path should be a string"),cr(r.length>0,"The path could not be empty"),cr(r[0]==="/"||r[0]==="*","The first character of a path should be `/` or `*`"),cr(typeof s>"u"||typeof s=="object"&&!Array.isArray(s)&&s!==null,"Constraints should be an object or undefined.");let n=r.match(Fu);if(n){cr(r.length===n.index+n[0].length,"Optional Parameter needs to be the last parameter of the path");let o=r.replace(Fu,"$1$2"),a=r.replace(Fu,"$2");this.off(e,o,s),this.off(e,a,s);return}this.ignoreDuplicateSlashes&&(r=wP(r)),this.ignoreTrailingSlash&&(r=TP(r));let i=Array.isArray(e)?e:[e];for(let o of i)this._off(o,r,s)};tr.prototype._off=function(e,r,s){cr(typeof e=="string","Method should be a string"),cr(Xd.includes(e),`Method '${e}' is not an http method.`);function n(l){return e!==l.method||r!==l.path}function i(l){return n(l)||!EP(s,l.opts.constraints||{})}let o=s?i:n,a=this.routes.filter(o);this._rebuild(a)};tr.prototype.lookup=function(e,r,s,n){if(typeof s=="function"&&(n=s,s=void 0),n===void 0){let i=this.constrainer.deriveConstraints(e,s),o=this.find(e.method,e.url,i);return this.callHandler(o,e,r,s)}this.constrainer.deriveConstraints(e,s,(i,o)=>{if(i!==null){n(i);return}try{let a=this.find(e.method,e.url,o),l=this.callHandler(a,e,r,s);n(null,l)}catch(a){n(a)}})};tr.prototype.callHandler=function(e,r,s,n){return e===null?this._defaultRoute(r,s,n):n===void 0?e.handler(r,s,e.params,e.store,e.searchParams):e.handler.call(n,r,s,e.params,e.store,e.searchParams)};tr.prototype.find=function(e,r,s){let n=this.trees[e];if(n===void 0)return null;r.charCodeAt(0)!==47&&(r=r.replace(H6,"/")),this.ignoreDuplicateSlashes&&(r=wP(r));let i,o,a;try{i=Rwe(r,this.useSemicolonDelimiter),r=i.path,o=i.querystring,a=i.shouldDecodeParam}catch{return this._onBadUrl(r)}this.ignoreTrailingSlash&&(r=TP(r));let l=r;this.caseSensitive===!1&&(r=r.toLowerCase());let u=this.maxParamLength,c=n.prefix.length,d=[],f=r.length,h=[];for(;;){if(c===f&&n.isLeafNode){let S=n.handlerStorage.getMatchingHandler(s);if(S!==null)return{handler:S.handler,store:S.store,params:S._createParamsObject(d),searchParams:this.querystringParser(o)}}let p=n.getNextNode(r,c,h,d.length);if(p===null){if(h.length===0)return null;let S=h.pop();c=S.brotherPathIndex,d.splice(S.paramsCount),p=S.brotherNode}if(n=p,n.kind===U6.STATIC){c+=n.prefix.length;continue}if(n.kind===U6.WILDCARD){let S=l.slice(c);a&&(S=V6(S)),d.push(S),c=f;continue}let g=l.indexOf("/",c);g===-1&&(g=f);let _=l.slice(c,g);if(a&&(_=V6(_)),n.isRegex){let S=n.regex.exec(_);if(S===null)continue;for(let b=1;b<S.length;b++){let v=S[b];if(v.length>u)return null;d.push(v)}}else{if(_.length>u)return null;d.push(_)}c=g}};tr.prototype._rebuild=function(t){this.reset();for(let e of t){let{method:r,path:s,opts:n,handler:i,store:o}=e;this._on(r,s,n,i,o)}};tr.prototype._defaultRoute=function(t,e,r){if(this.defaultRoute!==null)return r===void 0?this.defaultRoute(t,e):this.defaultRoute.call(r,t,e);e.statusCode=404,e.end()};tr.prototype._onBadUrl=function(t){if(this.onBadUrl===null)return null;let e=this.onBadUrl;return{handler:(r,s,n)=>e(t,r,s),params:{},store:null}};tr.prototype.prettyPrint=function(t={}){let e=t.method;t.buildPrettyMeta=this.buildPrettyMeta.bind(this);let r=null;if(e===void 0){let{version:s,host:n,...i}=this.constrainer.strategies;i[bP.name]=bP;let o=new tr({...this._opts,constraints:i}),a=this.routes.map(l=>{let u={...l.opts.constraints,[bP.name]:l.method};return{...l,method:"MERGED",opts:{constraints:u}}});o._rebuild(a),r=o.trees.MERGED}else r=this.trees[e];return r==null?"(empty tree)":Twe(r,t)};for(let t in Xd){if(!Xd.hasOwnProperty(t))continue;let e=Xd[t],r=e.toLowerCase();tr.prototype[r]=function(s,n,i){return this.on(e,s,n,i)}}tr.prototype.all=function(t,e,r){this.on(Xd,t,e,r)};W6.exports=tr;function G6(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function wP(t){return t.replace(/\/\/+/g,"/")}function TP(t){return t.length>1&&t.charCodeAt(t.length-1)===47?t.slice(0,-1):t}function K6(t){return t.charCodeAt(1)===94&&(t=t.slice(0,1)+t.slice(2)),t.charCodeAt(t.length-2)===36&&(t=t.slice(0,t.length-2)+t.slice(t.length-1)),t}function Q6(t,e){let r=1;for(;e<t.length;){if(e++,t[e]==="\\"){e++;continue}if(t[e]===")"?r--:t[e]==="("&&r++,!r)return e}throw new TypeError('Invalid regexp expression in "'+t+'"')}function Owe(t){return t?t.store?Object.assign({},t.store):{}:{}}});var Y6=m((AGe,Z6)=>{"use strict";function RP(t,e,r,s){if(r===void 0)return e.header("content-length","0"),s(null,null);if(typeof r.resume=="function")return r.on("error",i=>{e.log.error({err:i},"Error on Stream found for HEAD route")}),r.resume(),s(null,null);let n=""+Buffer.byteLength(r);e.header("content-length",n),s(null,null)}function Pwe(t){return t==null?RP:Array.isArray(t)?[...t,RP]:[t,RP]}Z6.exports={parseHeadOnSendHandlers:Pwe}});var p9=m((kGe,h9)=>{"use strict";var Awe=CP(),kwe=H0(),J6=ST(),{onRequestAbortHookRunner:xwe,lifecycleHooks:X6,preParsingHookRunner:Iwe,onTimeoutHookRunner:Nwe,onRequestHookRunner:Dwe}=Na(),{supportedMethods:Mwe}=WC(),{normalizeSchema:$we}=yp(),{parseHeadOnSendHandlers:qwe}=Y6(),{FSTDEP007:Lwe,FSTDEP008:jwe,FSTDEP014:e9}=zo(),{compileSchemasForValidation:Fwe,compileSchemasForSerialization:Bwe}=mT(),{FST_ERR_SCH_VALIDATION_BUILD:zwe,FST_ERR_SCH_SERIALIZATION_BUILD:Uwe,FST_ERR_DEFAULT_ROUTE_INVALID_TYPE:Vwe,FST_ERR_DUPLICATED_ROUTE:Hwe,FST_ERR_INVALID_URL:Gwe,FST_ERR_HOOK_INVALID_HANDLER:t9,FST_ERR_ROUTE_OPTIONS_NOT_OBJ:Kwe,FST_ERR_ROUTE_DUPLICATED_HANDLER:Qwe,FST_ERR_ROUTE_HANDLER_NOT_FN:r9,FST_ERR_ROUTE_MISSING_HANDLER:Wwe,FST_ERR_ROUTE_METHOD_NOT_SUPPORTED:Zwe,FST_ERR_ROUTE_METHOD_INVALID:Ywe,FST_ERR_ROUTE_BODY_VALIDATION_SCHEMA_NOT_SUPPORTED:Jwe,FST_ERR_ROUTE_BODY_LIMIT_OPTION_NOT_INT:Xwe,FST_ERR_HOOK_INVALID_ASYNC_HANDLER:OP}=rs(),{kRoutePrefix:eTe,kLogLevel:tTe,kLogSerializers:s9,kHooks:n9,kSchemaController:rTe,kOptions:i9,kReplySerializerDefault:PP,kReplyIsError:sTe,kRequestPayloadStream:nTe,kDisableRequestLogging:iTe,kSchemaErrorFormatter:oTe,kErrorHandler:o9,kHasBeenDecorated:a9,kRequestAcceptVersion:AP,kRouteByFastify:kP,kRouteContext:l9}=xr(),{buildErrorHandler:aTe}=vp(),{createChildLogger:lTe}=gp(),{getGenReqId:uTe}=Zv();function cTe(t){let e=Awe(t.config),r,s,n,i,o,a,l,u,c,d,f,h,p,g=!1;return{setup(O,$){r=$.avvio,s=$.fourOhFour,n=$.logger,i=$.hasLogger,o=$.setupResponseListeners,a=$.throwIfAlreadyStarted,h=$.validateHTTPVersion,f=O.exposeHeadRoutes,l=O.disableRequestLogging,u=O.ignoreTrailingSlash,c=O.ignoreDuplicateSlashes,d=Object.prototype.hasOwnProperty.call(O,"return503OnClosing")?O.return503OnClosing:!0,p=$.keepAliveConnections},routing:e.lookup.bind(e),route:P,hasRoute:y,prepareRoute:v,getDefaultRoute:function(){return e9(),e.defaultRoute},setDefaultRoute:function(O){if(e9(),typeof O!="function")throw new Vwe;e.defaultRoute=O},routeHandler:w,closeRoutes:()=>{g=!0},printRoutes:e.prettyPrint.bind(e),addConstraintStrategy:_,hasConstraintStrategy:S,isAsyncConstraint:b,findRoute:R};function _(O){return a("Cannot add constraint strategy!"),e.addConstraintStrategy(O)}function S(O){return e.hasConstraintStrategy(O)}function b(){return e.constrainer.asyncStrategiesInUse.size>0}function v({method:O,url:$,options:C,handler:k,isFastify:z}){if(typeof $!="string")throw new Gwe(typeof $);if(!k&&typeof C=="function")k=C,C={};else if(k&&typeof k=="function"){if(Object.prototype.toString.call(C)!=="[object Object]")throw new Kwe(O,$);if(C.handler)throw typeof C.handler=="function"?new Qwe(O,$):new r9(O,$)}return C=Object.assign({},C,{method:O,url:$,path:$,handler:k||C&&C.handler}),P.call(this,{options:C,isFastify:z})}function y({options:O}){let $=O.method?.toUpperCase()??"";return R({...O,method:$})!==null}function R(O){let $=e.find(O.method,O.url||"",O.constraints);return $?{handler:$.handler,params:$.params,searchParams:$.searchParams}:null}function P({options:O,isFastify:$}){let C={...O},{exposeHeadRoute:k}=C,A=k!=null?k:f,E=C.method==="GET"||Array.isArray(C.method)&&C.method.includes("GET"),V=C.method==="HEAD"||Array.isArray(C.method)&&C.method.includes("HEAD"),G=A&&E?{...O}:null;a("Cannot add route!");let X=C.url||C.path||"";if(Array.isArray(C.method))for(var pe=0;pe<C.method.length;++pe)C.method[pe]=u9(C.method[pe]),c9(C.method[pe],X,C.schema);else C.method=u9(C.method),c9(C.method,X,C.schema);if(!C.handler)throw new Wwe(C.method,X);if(C.errorHandler!==void 0&&typeof C.errorHandler!="function")throw new r9(C.method,X);f9(C.bodyLimit);let J=this[eTe];if(X==="/"&&J.length>0&&C.method!=="HEAD")switch(C.prefixTrailingSlash){case"slash":ye.call(this,{path:X,isFastify:$});break;case"no-slash":ye.call(this,{path:"",isFastify:$});break;case"both":default:ye.call(this,{path:"",isFastify:$}),u!==!0&&(c!==!0||!J.endsWith("/"))&&ye.call(this,{path:X,prefixing:!0,isFastify:$})}else X[0]==="/"&&J.endsWith("/")?ye.call(this,{path:X.slice(1),isFastify:$}):ye.call(this,{path:X,isFastify:$});return this;function ye({path:st,prefixing:ve=!1,isFastify:pt=!1}){let Ze=J+st;if(C.url=Ze,C.path=Ze,C.routePath=st,C.prefix=J,C.logLevel=C.logLevel||this[tTe],(this[s9]||C.logSerializers)&&(C.logSerializers=Object.assign(Object.create(this[s9]),C.logSerializers)),C.attachValidation==null&&(C.attachValidation=!1),ve===!1)for(let H of this[n9].onRoute)H.call(this,C);for(let H of X6)if(C&&H in C){if(Array.isArray(C[H]))for(let Q of C[H]){if(typeof Q!="function")throw new t9(H,Object.prototype.toString.call(Q));if(H==="onSend"||H==="preSerialization"||H==="onError"||H==="preParsing"){if(Q.constructor.name==="AsyncFunction"&&Q.length===4)throw new OP}else if(H==="onRequestAbort"){if(Q.constructor.name==="AsyncFunction"&&Q.length!==1)throw new OP}else if(Q.constructor.name==="AsyncFunction"&&Q.length===3)throw new OP}else if(C[H]!==void 0&&typeof C[H]!="function")throw new t9(H,Object.prototype.toString.call(C[H]))}let _e=C.constraints||{},Ye={...C.config,url:Ze,method:C.method},Re=new kwe({schema:C.schema,handler:C.handler.bind(this),config:Ye,errorHandler:C.errorHandler,childLoggerFactory:C.childLoggerFactory,bodyLimit:C.bodyLimit,logLevel:C.logLevel,logSerializers:C.logSerializers,attachValidation:C.attachValidation,schemaErrorFormatter:C.schemaErrorFormatter,replySerializer:this[PP],validatorCompiler:C.validatorCompiler,serializerCompiler:C.serializerCompiler,exposeHeadRoute:A,prefixTrailingSlash:C.prefixTrailingSlash||"both",server:this,isFastify:pt});C.version&&(jwe(),_e.version=C.version);let Pe=e.findRoute("HEAD",C.url,_e),W=Pe!==null;V&&W&&!Re[kP]&&Pe.store[kP]&&e.off("HEAD",C.url,_e);try{e.on(C.method,C.url,{constraints:_e},w,Re)}catch(H){if(!Re[kP])throw H.message.includes(`Method '${C.method}' already declared for route '${C.url}'`)?new Hwe(C.method,C.url):H}if(this.after((H,Q)=>{Re.errorHandler=C.errorHandler?aTe(this[o9],C.errorHandler):this[o9],Re._parserOptions.limit=C.bodyLimit||null,Re.logLevel=C.logLevel,Re.logSerializers=C.logSerializers,Re.attachValidation=C.attachValidation,Re[PP]=this[PP],Re.schemaErrorFormatter=C.schemaErrorFormatter||this[oTe]||Re.schemaErrorFormatter,r.once("preReady",()=>{for(let N of X6){let q=this[n9][N].concat(C[N]||[]).map(K=>K.bind(this));Re[N]=q.length?q:null}for(;!Re.Request[a9]&&Re.Request.parent;)Re.Request=Re.Request.parent;for(;!Re.Reply[a9]&&Re.Reply.parent;)Re.Reply=Re.Reply.parent;if(s.setContext(this,Re),C.schema){Re.schema=$we(Re.schema,this.initialConfig);let N=this[rTe];!C.validatorCompiler&&(C.schema.body||C.schema.headers||C.schema.querystring||C.schema.params)&&N.setupValidator(this[i9]);try{let q=typeof C?.validatorCompiler=="function"||N.isCustomValidatorCompiler;Fwe(Re,C.validatorCompiler||N.validatorCompiler,q)}catch(q){throw new zwe(C.method,Ze,q.message)}C.schema.response&&!C.serializerCompiler&&N.setupSerializer(this[i9]);try{Bwe(Re,C.serializerCompiler||N.serializerCompiler)}catch(q){throw new Uwe(C.method,Ze,q.message)}}}),Q(H)}),A&&E&&!V&&!W){let H=qwe(G.onSend);v.call(this,{method:"HEAD",url:st,options:{...G,onSend:H},isFastify:!0})}else W&&k&&Lwe()}}function w(O,$,C,k,z){let A=uTe(k.server,O),E={level:k.logLevel};k.logSerializers&&(E.serializers=k.logSerializers);let V=lTe(k,n,O,A,E);if(V[iTe]=l,!h(O.httpVersion)){V.info({res:{statusCode:505}},"request aborted - invalid HTTP version");let J='{"error":"HTTP Version Not Supported","message":"HTTP Version Not Supported","statusCode":505}',ye={"Content-Type":"application/json","Content-Length":J.length};$.writeHead(505,ye),$.end(J);return}if(g===!0&&(O.httpVersionMajor!==2&&$.setHeader("Connection","close"),d)){let J={"Content-Type":"application/json","Content-Length":"80"};$.writeHead(503,J),$.end('{"error":"Service Unavailable","message":"Service Unavailable","statusCode":503}'),V.info({res:{statusCode:503}},"request aborted - refusing to accept new requests as server is closing");return}String.prototype.toLowerCase.call(O.headers.connection||"")==="keep-alive"&&p.has(O.socket)===!1&&(p.add(O.socket),O.socket.on("close",hTe.bind({keepAliveConnections:p,socket:O.socket}))),O.headers[AP]!==void 0&&(O.headers["accept-version"]=O.headers[AP],O.headers[AP]=void 0);let X=new k.Request(A,C,O,z,V,k),pe=new k.Reply($,X,V);l===!1&&V.info({req:X},"incoming request"),(i===!0||k.onResponse!==null)&&o(pe),k.onRequest!==null?Dwe(k.onRequest,X,pe,d9):d9(null,X,pe),k.onRequestAbort!==null&&O.on("close",()=>{O.aborted&&xwe(k.onRequestAbort,X,dTe.bind(null,pe))}),k.onTimeout!==null&&(X.raw.socket._meta||X.raw.socket.on("timeout",fTe),X.raw.socket._meta={context:k,request:X,reply:pe})}}function dTe(t,e){e&&t.log.error({err:e},"onRequestAborted hook failed")}function fTe(){let{context:t,request:e,reply:r}=this._meta;Nwe(t.onTimeout,e,r,pTe)}function u9(t){if(typeof t!="string")throw new Ywe;if(t=t.toUpperCase(),Mwe.indexOf(t)===-1)throw new Zwe(t);return t}function c9(t,e,r){if((t==="GET"||t==="HEAD")&&r&&r.body)throw new Jwe(t,e)}function f9(t){if(t!==void 0&&(!Number.isInteger(t)||t<=0))throw new Xwe(t)}function d9(t,e,r){if(r.sent!==!0){if(t!=null){r[sTe]=!0,r.send(t);return}e[nTe]=e.raw,e[l9].preParsing!==null?Iwe(e[l9].preParsing,e,r,J6):J6(null,e,r)}}function hTe(){this.keepAliveConnections.delete(this.socket)}function pTe(){}h9.exports={buildRouting:cTe,validateBodyLimitOption:f9}});var b9=m((xGe,S9)=>{"use strict";var mTe=CP(),m9=A0(),g9=V0(),gTe=H0(),{kRoutePrefix:yTe,kCanSetNotFoundHandler:Rm,kFourOhFourLevelInstance:Om,kFourOhFourContext:eo,kHooks:vTe,kErrorHandler:y9}=xr(),{lifecycleHooks:_Te}=Na(),{buildErrorHandler:STe}=vp(),{FST_ERR_NOT_FOUND:bTe}=rs(),{createChildLogger:v9}=gp(),{getGenReqId:_9}=Zv();function ETe(t){let{logger:e,disableRequestLogging:r}=t,s=mTe({onBadUrl:a(),defaultRoute:d}),n=null;return{router:s,setNotFoundHandler:u,setContext:l,arrange404:i};function i(f){f[Om]=f,f[Rm]=!0,s.onBadUrl=s.onBadUrl.bind(f),s.defaultRoute=s.defaultRoute.bind(f)}function o(f,h){let{url:p,method:g}=f.raw,_=`Route ${g}:${p} not found`;r||f.log.info(_),h.code(404).send({message:_,error:"Not Found",statusCode:404})}function a(){return function(h,p,g){let _=this[Om][eo],S=_9(_.server,p),b=v9(_,e,p,S),v=new g9(S,null,p,null,b,_),y=new m9(g,v,b);n(v,y)}}function l(f,h){let p=Object.assign({},f[eo]);p.onSend=h.onSend,h[eo]=p}function u(f,h,p,g){this[Rm]===void 0&&(this[Rm]=!0),this[eo]===void 0&&(this[eo]=null);let _=this,S=this[yTe]||"/";if(this[Rm]===!1)throw new Error(`Not found handler already set for Fastify instance with prefix: '${S}'`);typeof f=="object"&&(f.preHandler&&(Array.isArray(f.preHandler)?f.preHandler=f.preHandler.map(b=>b.bind(_)):f.preHandler=f.preHandler.bind(_)),f.preValidation&&(Array.isArray(f.preValidation)?f.preValidation=f.preValidation.map(b=>b.bind(_)):f.preValidation=f.preValidation.bind(_))),typeof f=="function"&&(h=f,f=void 0),f=f||{},h?(this[Om][Rm]=!1,h=h.bind(this),n=h):(h=o,n=o),this.after((b,v)=>{c.call(this,S,f,h,p,g),v(b)})}function c(f,h,p,g,_){let S=new gTe({schema:h.schema,handler:p,config:h.config||{},server:this});if(g.once("preReady",()=>{let b=this[eo];for(let v of _Te){let y=this[vTe][v].concat(h[v]||[]).map(R=>R.bind(this));b[v]=y.length?y:null}b.errorHandler=h.errorHandler?STe(this[y9],h.errorHandler):this[y9]}),this[eo]!==null&&f==="/"){Object.assign(this[eo],S);return}this[Om][eo]=S,s.all(f+(f.endsWith("/")?"*":"/*"),_,S),s.all(f,_,S)}function d(f,h){let p=this[Om][eo],g=_9(p.server,f),_=v9(p,e,f,g);_.info({req:f},"incoming request");let S=new g9(g,null,f,null,_,p),b=new m9(h,S,_);S.log.warn("the default handler for 404 did not catch this, this is likely a fastify bug, please report it"),S.log.warn(s.prettyPrint()),b.code(404).send(new bTe)}}S9.exports=ETe});var w9=m((IGe,p_)=>{"use strict";p_.exports=dt;p_.exports.default=dt;var E9={type:"object",additionalProperties:!1,properties:{connectionTimeout:{type:"integer",default:0},keepAliveTimeout:{type:"integer",default:72e3},forceCloseConnections:{oneOf:[{type:"string",pattern:"idle"},{type:"boolean"}]},maxRequestsPerSocket:{type:"integer",default:0,nullable:!0},requestTimeout:{type:"integer",default:0},bodyLimit:{type:"integer",default:1048576},caseSensitive:{type:"boolean",default:!0},allowUnsafeRegex:{type:"boolean",default:!1},http2:{type:"boolean"},https:{if:{not:{oneOf:[{type:"boolean"},{type:"null"},{type:"object",additionalProperties:!1,required:["allowHTTP1"],properties:{allowHTTP1:{type:"boolean"}}}]}},then:{setDefaultValue:!0}},ignoreTrailingSlash:{type:"boolean",default:!1},ignoreDuplicateSlashes:{type:"boolean",default:!1},disableRequestLogging:{type:"boolean",default:!1},jsonShorthand:{type:"boolean",default:!0},maxParamLength:{type:"integer",default:100},onProtoPoisoning:{type:"string",default:"error"},onConstructorPoisoning:{type:"string",default:"error"},pluginTimeout:{type:"integer",default:1e4},requestIdHeader:{anyOf:[{enum:[!1]},{type:"string"}],default:"request-id"},requestIdLogLabel:{type:"string",default:"reqId"},http2SessionTimeout:{type:"integer",default:72e3},exposeHeadRoutes:{type:"boolean",default:!0},useSemicolonDelimiter:{type:"boolean",default:!0},versioning:{type:"object",additionalProperties:!0,required:["storage","deriveVersion"],properties:{storage:{},deriveVersion:{}}},constraints:{type:"object",additionalProperties:{type:"object",required:["name","storage","validate","deriveConstraint"],additionalProperties:!0,properties:{name:{type:"string"},storage:{},validate:{},deriveConstraint:{}}}}}},wTe=Object.prototype.hasOwnProperty,TTe=new RegExp("idle","u");function dt(t,{instancePath:e="",parentData:r,parentDataProperty:s,rootData:n=t}={}){let i=null,o=0;if(o===0)if(t&&typeof t=="object"&&!Array.isArray(t)){t.connectionTimeout===void 0&&(t.connectionTimeout=0),t.keepAliveTimeout===void 0&&(t.keepAliveTimeout=72e3),t.maxRequestsPerSocket===void 0&&(t.maxRequestsPerSocket=0),t.requestTimeout===void 0&&(t.requestTimeout=0),t.bodyLimit===void 0&&(t.bodyLimit=1048576),t.caseSensitive===void 0&&(t.caseSensitive=!0),t.allowUnsafeRegex===void 0&&(t.allowUnsafeRegex=!1),t.ignoreTrailingSlash===void 0&&(t.ignoreTrailingSlash=!1),t.ignoreDuplicateSlashes===void 0&&(t.ignoreDuplicateSlashes=!1),t.disableRequestLogging===void 0&&(t.disableRequestLogging=!1),t.jsonShorthand===void 0&&(t.jsonShorthand=!0),t.maxParamLength===void 0&&(t.maxParamLength=100),t.onProtoPoisoning===void 0&&(t.onProtoPoisoning="error"),t.onConstructorPoisoning===void 0&&(t.onConstructorPoisoning="error"),t.pluginTimeout===void 0&&(t.pluginTimeout=1e4),t.requestIdHeader===void 0&&(t.requestIdHeader="request-id"),t.requestIdLogLabel===void 0&&(t.requestIdLogLabel="reqId"),t.http2SessionTimeout===void 0&&(t.http2SessionTimeout=72e3),t.exposeHeadRoutes===void 0&&(t.exposeHeadRoutes=!0),t.useSemicolonDelimiter===void 0&&(t.useSemicolonDelimiter=!0);let p=o;for(let g in t)wTe.call(E9.properties,g)||delete t[g];if(p===o){let g=t.connectionTimeout,_=o;if(!(typeof g=="number"&&!(g%1)&&!isNaN(g)&&isFinite(g))){let S=typeof g,b;if(b===void 0)if(S==="boolean"||g===null||S==="string"&&g&&g==+g&&!(g%1))b=+g;else return dt.errors=[{instancePath:e+"/connectionTimeout",schemaPath:"#/properties/connectionTimeout/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;b!==void 0&&(g=b,t!==void 0&&(t.connectionTimeout=b))}var a=_===o;if(a){let S=t.keepAliveTimeout,b=o;if(!(typeof S=="number"&&!(S%1)&&!isNaN(S)&&isFinite(S))){let y=typeof S,R;if(R===void 0)if(y==="boolean"||S===null||y==="string"&&S&&S==+S&&!(S%1))R=+S;else return dt.errors=[{instancePath:e+"/keepAliveTimeout",schemaPath:"#/properties/keepAliveTimeout/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;R!==void 0&&(S=R,t!==void 0&&(t.keepAliveTimeout=R))}var a=b===o;if(a){if(t.forceCloseConnections!==void 0){let y=t.forceCloseConnections,R=o,P=o,w=!1,O=null,$=o;if(typeof y!="string"){let z=typeof y,A;if(A===void 0)if(z=="number"||z=="boolean")A=""+y;else if(y===null)A="";else{let E={instancePath:e+"/forceCloseConnections",schemaPath:"#/properties/forceCloseConnections/oneOf/0/type",keyword:"type",params:{type:"string"},message:"must be string"};i===null?i=[E]:i.push(E),o++}A!==void 0&&(y=A,t!==void 0&&(t.forceCloseConnections=A))}if(o===$&&typeof y=="string"&&!TTe.test(y)){let z={instancePath:e+"/forceCloseConnections",schemaPath:"#/properties/forceCloseConnections/oneOf/0/pattern",keyword:"pattern",params:{pattern:"idle"},message:'must match pattern "idle"'};i===null?i=[z]:i.push(z),o++}var l=$===o;l&&(w=!0,O=0);let C=o;if(typeof y!="boolean"){let z;if(z===void 0)if(y==="false"||y===0||y===null)z=!1;else if(y==="true"||y===1)z=!0;else{let A={instancePath:e+"/forceCloseConnections",schemaPath:"#/properties/forceCloseConnections/oneOf/1/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"};i===null?i=[A]:i.push(A),o++}z!==void 0&&(y=z,t!==void 0&&(t.forceCloseConnections=z))}var l=C===o;if(l&&w?(w=!1,O=[O,1]):l&&(w=!0,O=1),w)o=P,i!==null&&(P?i.length=P:i=null);else{let z={instancePath:e+"/forceCloseConnections",schemaPath:"#/properties/forceCloseConnections/oneOf",keyword:"oneOf",params:{passingSchemas:O},message:"must match exactly one schema in oneOf"};return i===null?i=[z]:i.push(z),o++,dt.errors=i,!1}var a=R===o}else var a=!0;if(a){let y=t.maxRequestsPerSocket,R=o;if(!(typeof y=="number"&&!(y%1)&&!isNaN(y)&&isFinite(y))&&y!==null){let w=typeof y,O;if(O===void 0)if(w==="boolean"||y===null||w==="string"&&y&&y==+y&&!(y%1))O=+y;else if(y===""||y===0||y===!1)O=null;else return dt.errors=[{instancePath:e+"/maxRequestsPerSocket",schemaPath:"#/properties/maxRequestsPerSocket/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;O!==void 0&&(y=O,t!==void 0&&(t.maxRequestsPerSocket=O))}var a=R===o;if(a){let w=t.requestTimeout,O=o;if(!(typeof w=="number"&&!(w%1)&&!isNaN(w)&&isFinite(w))){let C=typeof w,k;if(k===void 0)if(C==="boolean"||w===null||C==="string"&&w&&w==+w&&!(w%1))k=+w;else return dt.errors=[{instancePath:e+"/requestTimeout",schemaPath:"#/properties/requestTimeout/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;k!==void 0&&(w=k,t!==void 0&&(t.requestTimeout=k))}var a=O===o;if(a){let C=t.bodyLimit,k=o;if(!(typeof C=="number"&&!(C%1)&&!isNaN(C)&&isFinite(C))){let A=typeof C,E;if(E===void 0)if(A==="boolean"||C===null||A==="string"&&C&&C==+C&&!(C%1))E=+C;else return dt.errors=[{instancePath:e+"/bodyLimit",schemaPath:"#/properties/bodyLimit/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;E!==void 0&&(C=E,t!==void 0&&(t.bodyLimit=E))}var a=k===o;if(a){let A=t.caseSensitive,E=o;if(typeof A!="boolean"){let G;if(G===void 0)if(A==="false"||A===0||A===null)G=!1;else if(A==="true"||A===1)G=!0;else return dt.errors=[{instancePath:e+"/caseSensitive",schemaPath:"#/properties/caseSensitive/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;G!==void 0&&(A=G,t!==void 0&&(t.caseSensitive=G))}var a=E===o;if(a){let G=t.allowUnsafeRegex,X=o;if(typeof G!="boolean"){let J;if(J===void 0)if(G==="false"||G===0||G===null)J=!1;else if(G==="true"||G===1)J=!0;else return dt.errors=[{instancePath:e+"/allowUnsafeRegex",schemaPath:"#/properties/allowUnsafeRegex/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;J!==void 0&&(G=J,t!==void 0&&(t.allowUnsafeRegex=J))}var a=X===o;if(a){if(t.http2!==void 0){let J=t.http2,ye=o;if(typeof J!="boolean"){let ve;if(ve===void 0)if(J==="false"||J===0||J===null)ve=!1;else if(J==="true"||J===1)ve=!0;else return dt.errors=[{instancePath:e+"/http2",schemaPath:"#/properties/http2/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;ve!==void 0&&(J=ve,t!==void 0&&(t.http2=ve))}var a=ye===o}else var a=!0;if(a){if(t.https!==void 0){let J=t.https,ye=o,st=o,ve=!0,pt=o,Ze=o,_e=o,Ye=o,Re=!1,Pe=null,W=o;if(typeof J!="boolean"){let N;if(N===void 0)if(J==="false"||J===0||J===null)N=!1;else if(J==="true"||J===1)N=!0;else{let q={};i===null?i=[q]:i.push(q),o++}N!==void 0&&(J=N,t!==void 0&&(t.https=N))}var u=W===o;u&&(Re=!0,Pe=0);let H=o;if(J!==null){let N;if(N===void 0)if(J===""||J===0||J===!1)N=null;else{let q={};i===null?i=[q]:i.push(q),o++}N!==void 0&&(J=N,t!==void 0&&(t.https=N))}var u=H===o;if(u&&Re)Re=!1,Pe=[Pe,1];else{u&&(Re=!0,Pe=1);let N=o;if(o===N)if(J&&typeof J=="object"&&!Array.isArray(J)){let K;if(J.allowHTTP1===void 0&&(K="allowHTTP1")){let se={};i===null?i=[se]:i.push(se),o++}else{let se=o;for(let ke in J)ke!=="allowHTTP1"&&delete J[ke];if(se===o&&J.allowHTTP1!==void 0){let ke=J.allowHTTP1;if(typeof ke!="boolean"){let le;if(le===void 0)if(ke==="false"||ke===0||ke===null)le=!1;else if(ke==="true"||ke===1)le=!0;else{let lt={};i===null?i=[lt]:i.push(lt),o++}le!==void 0&&(ke=le,J!==void 0&&(J.allowHTTP1=le))}}}}else{let K={};i===null?i=[K]:i.push(K),o++}var u=N===o;u&&Re?(Re=!1,Pe=[Pe,2]):u&&(Re=!0,Pe=2)}if(Re)o=Ye,i!==null&&(Ye?i.length=Ye:i=null);else{let N={};i===null?i=[N]:i.push(N),o++}var c=_e===o;if(c){let N={};i===null?i=[N]:i.push(N),o++}else o=Ze,i!==null&&(Ze?i.length=Ze:i=null);var d=pt===o;if(o=st,i!==null&&(st?i.length=st:i=null),d){let N=o;t.https=!0;var d=N===o;ve=d}if(!ve){let N={instancePath:e+"/https",schemaPath:"#/properties/https/if",keyword:"if",params:{failingKeyword:"then"},message:'must match "then" schema'};return i===null?i=[N]:i.push(N),o++,dt.errors=i,!1}var a=ye===o}else var a=!0;if(a){let J=t.ignoreTrailingSlash,ye=o;if(typeof J!="boolean"){let ve;if(ve===void 0)if(J==="false"||J===0||J===null)ve=!1;else if(J==="true"||J===1)ve=!0;else return dt.errors=[{instancePath:e+"/ignoreTrailingSlash",schemaPath:"#/properties/ignoreTrailingSlash/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;ve!==void 0&&(J=ve,t!==void 0&&(t.ignoreTrailingSlash=ve))}var a=ye===o;if(a){let ve=t.ignoreDuplicateSlashes,pt=o;if(typeof ve!="boolean"){let _e;if(_e===void 0)if(ve==="false"||ve===0||ve===null)_e=!1;else if(ve==="true"||ve===1)_e=!0;else return dt.errors=[{instancePath:e+"/ignoreDuplicateSlashes",schemaPath:"#/properties/ignoreDuplicateSlashes/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;_e!==void 0&&(ve=_e,t!==void 0&&(t.ignoreDuplicateSlashes=_e))}var a=pt===o;if(a){let _e=t.disableRequestLogging,Ye=o;if(typeof _e!="boolean"){let Pe;if(Pe===void 0)if(_e==="false"||_e===0||_e===null)Pe=!1;else if(_e==="true"||_e===1)Pe=!0;else return dt.errors=[{instancePath:e+"/disableRequestLogging",schemaPath:"#/properties/disableRequestLogging/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;Pe!==void 0&&(_e=Pe,t!==void 0&&(t.disableRequestLogging=Pe))}var a=Ye===o;if(a){let Pe=t.jsonShorthand,W=o;if(typeof Pe!="boolean"){let Q;if(Q===void 0)if(Pe==="false"||Pe===0||Pe===null)Q=!1;else if(Pe==="true"||Pe===1)Q=!0;else return dt.errors=[{instancePath:e+"/jsonShorthand",schemaPath:"#/properties/jsonShorthand/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;Q!==void 0&&(Pe=Q,t!==void 0&&(t.jsonShorthand=Q))}var a=W===o;if(a){let Q=t.maxParamLength,N=o;if(!(typeof Q=="number"&&!(Q%1)&&!isNaN(Q)&&isFinite(Q))){let K=typeof Q,se;if(se===void 0)if(K==="boolean"||Q===null||K==="string"&&Q&&Q==+Q&&!(Q%1))se=+Q;else return dt.errors=[{instancePath:e+"/maxParamLength",schemaPath:"#/properties/maxParamLength/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;se!==void 0&&(Q=se,t!==void 0&&(t.maxParamLength=se))}var a=N===o;if(a){let K=t.onProtoPoisoning,se=o;if(typeof K!="string"){let le=typeof K,lt;if(lt===void 0)if(le=="number"||le=="boolean")lt=""+K;else if(K===null)lt="";else return dt.errors=[{instancePath:e+"/onProtoPoisoning",schemaPath:"#/properties/onProtoPoisoning/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;lt!==void 0&&(K=lt,t!==void 0&&(t.onProtoPoisoning=lt))}var a=se===o;if(a){let le=t.onConstructorPoisoning,lt=o;if(typeof le!="string"){let mt=typeof le,ir;if(ir===void 0)if(mt=="number"||mt=="boolean")ir=""+le;else if(le===null)ir="";else return dt.errors=[{instancePath:e+"/onConstructorPoisoning",schemaPath:"#/properties/onConstructorPoisoning/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;ir!==void 0&&(le=ir,t!==void 0&&(t.onConstructorPoisoning=ir))}var a=lt===o;if(a){let mt=t.pluginTimeout,ir=o;if(!(typeof mt=="number"&&!(mt%1)&&!isNaN(mt)&&isFinite(mt))){let oi=typeof mt,qo;if(qo===void 0)if(oi==="boolean"||mt===null||oi==="string"&&mt&&mt==+mt&&!(mt%1))qo=+mt;else return dt.errors=[{instancePath:e+"/pluginTimeout",schemaPath:"#/properties/pluginTimeout/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;qo!==void 0&&(mt=qo,t!==void 0&&(t.pluginTimeout=qo))}var a=ir===o;if(a){let oi=t.requestIdHeader,qo=o,tp=o,Aa=!1,ai=o;if(oi!==!1){let es={instancePath:e+"/requestIdHeader",schemaPath:"#/properties/requestIdHeader/anyOf/0/enum",keyword:"enum",params:{allowedValues:E9.properties.requestIdHeader.anyOf[0].enum},message:"must be equal to one of the allowed values"};i===null?i=[es]:i.push(es),o++}var f=ai===o;if(Aa=Aa||f,!Aa){let es=o;if(typeof oi!="string"){let ka=typeof oi,qt;if(qt===void 0)if(ka=="number"||ka=="boolean")qt=""+oi;else if(oi===null)qt="";else{let Ws={instancePath:e+"/requestIdHeader",schemaPath:"#/properties/requestIdHeader/anyOf/1/type",keyword:"type",params:{type:"string"},message:"must be string"};i===null?i=[Ws]:i.push(Ws),o++}qt!==void 0&&(oi=qt,t!==void 0&&(t.requestIdHeader=qt))}var f=es===o;Aa=Aa||f}if(Aa)o=tp,i!==null&&(tp?i.length=tp:i=null);else{let es={instancePath:e+"/requestIdHeader",schemaPath:"#/properties/requestIdHeader/anyOf",keyword:"anyOf",params:{},message:"must match a schema in anyOf"};return i===null?i=[es]:i.push(es),o++,dt.errors=i,!1}var a=qo===o;if(a){let es=t.requestIdLogLabel,Ny=o;if(typeof es!="string"){let qt=typeof es,Ws;if(Ws===void 0)if(qt=="number"||qt=="boolean")Ws=""+es;else if(es===null)Ws="";else return dt.errors=[{instancePath:e+"/requestIdLogLabel",schemaPath:"#/properties/requestIdLogLabel/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;Ws!==void 0&&(es=Ws,t!==void 0&&(t.requestIdLogLabel=Ws))}var a=Ny===o;if(a){let qt=t.http2SessionTimeout,Ws=o;if(!(typeof qt=="number"&&!(qt%1)&&!isNaN(qt)&&isFinite(qt))){let Zs=typeof qt,Ar;if(Ar===void 0)if(Zs==="boolean"||qt===null||Zs==="string"&&qt&&qt==+qt&&!(qt%1))Ar=+qt;else return dt.errors=[{instancePath:e+"/http2SessionTimeout",schemaPath:"#/properties/http2SessionTimeout/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;Ar!==void 0&&(qt=Ar,t!==void 0&&(t.http2SessionTimeout=Ar))}var a=Ws===o;if(a){let Zs=t.exposeHeadRoutes,Ar=o;if(typeof Zs!="boolean"){let ts;if(ts===void 0)if(Zs==="false"||Zs===0||Zs===null)ts=!1;else if(Zs==="true"||Zs===1)ts=!0;else return dt.errors=[{instancePath:e+"/exposeHeadRoutes",schemaPath:"#/properties/exposeHeadRoutes/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;ts!==void 0&&(Zs=ts,t!==void 0&&(t.exposeHeadRoutes=ts))}var a=Ar===o;if(a){let ts=t.useSemicolonDelimiter,Qw=o;if(typeof ts!="boolean"){let mr;if(mr===void 0)if(ts==="false"||ts===0||ts===null)mr=!1;else if(ts==="true"||ts===1)mr=!0;else return dt.errors=[{instancePath:e+"/useSemicolonDelimiter",schemaPath:"#/properties/useSemicolonDelimiter/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;mr!==void 0&&(ts=mr,t!==void 0&&(t.useSemicolonDelimiter=mr))}var a=Qw===o;if(a){if(t.versioning!==void 0){let mr=t.versioning,fu=o;if(o===fu)if(mr&&typeof mr=="object"&&!Array.isArray(mr)){let li;if(mr.storage===void 0&&(li="storage")||mr.deriveVersion===void 0&&(li="deriveVersion"))return dt.errors=[{instancePath:e+"/versioning",schemaPath:"#/properties/versioning/required",keyword:"required",params:{missingProperty:li},message:"must have required property '"+li+"'"}],!1}else return dt.errors=[{instancePath:e+"/versioning",schemaPath:"#/properties/versioning/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=fu===o}else var a=!0;if(a)if(t.constraints!==void 0){let mr=t.constraints,fu=o;if(o===fu)if(mr&&typeof mr=="object"&&!Array.isArray(mr))for(let li in mr){let xs=mr[li],Dy=o;if(o===Dy)if(xs&&typeof xs=="object"&&!Array.isArray(xs)){let Li;if(xs.name===void 0&&(Li="name")||xs.storage===void 0&&(Li="storage")||xs.validate===void 0&&(Li="validate")||xs.deriveConstraint===void 0&&(Li="deriveConstraint"))return dt.errors=[{instancePath:e+"/constraints/"+li.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/constraints/additionalProperties/required",keyword:"required",params:{missingProperty:Li},message:"must have required property '"+Li+"'"}],!1;if(xs.name!==void 0){let xa=xs.name;if(typeof xa!="string"){let My=typeof xa,Lo;if(Lo===void 0)if(My=="number"||My=="boolean")Lo=""+xa;else if(xa===null)Lo="";else return dt.errors=[{instancePath:e+"/constraints/"+li.replace(/~/g,"~0").replace(/\//g,"~1")+"/name",schemaPath:"#/properties/constraints/additionalProperties/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;Lo!==void 0&&(xa=Lo,xs!==void 0&&(xs.name=Lo))}}}else return dt.errors=[{instancePath:e+"/constraints/"+li.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/constraints/additionalProperties/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var h=Dy===o;if(!h)break}else return dt.errors=[{instancePath:e+"/constraints",schemaPath:"#/properties/constraints/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=fu===o}else var a=!0}}}}}}}}}}}}}}}}}}}}}}}}}else return dt.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return dt.errors=i,o===0}p_.exports.defaultInitOptions={connectionTimeout:0,keepAliveTimeout:72e3,maxRequestsPerSocket:0,requestTimeout:0,bodyLimit:1048576,caseSensitive:!0,allowUnsafeRegex:!1,disableRequestLogging:!1,jsonShorthand:!0,ignoreTrailingSlash:!1,ignoreDuplicateSlashes:!1,maxParamLength:100,onProtoPoisoning:"error",onConstructorPoisoning:"error",pluginTimeout:1e4,requestIdHeader:"request-id",requestIdLogLabel:"reqId",http2SessionTimeout:72e3,exposeHeadRoutes:!0,useSemicolonDelimiter:!0}});var T9=m((NGe,g_)=>{"use strict";var m_=w9(),CTe=_0()({circles:!0,proto:!1}),{FST_ERR_INIT_OPTS_INVALID:RTe}=rs();function OTe(t){let e=CTe(t);if(!m_(e)){let r=new RTe(JSON.stringify(m_.errors.map(s=>s.message)));throw r.errors=m_.errors,r}return xP(e)}function xP(t){let e=Object.getOwnPropertyNames(t);for(let r of e){let s=t[r];ArrayBuffer.isView(s)&&!(s instanceof DataView)||(t[r]=s&&typeof s=="object"?xP(s):s)}return Object.freeze(t)}g_.exports=OTe;g_.exports.defaultInitOptions=m_.defaultInitOptions;g_.exports.utils={deepFreezeObject:xP}});var N9=m((DGe,I9)=>{"use strict";var{kAvvioBoot:PTe,kChildren:C9,kRoutePrefix:R9,kLogLevel:O9,kLogSerializers:IP,kHooks:NP,kSchemaController:ef,kContentTypeParser:P9,kReply:A9,kRequest:k9,kFourOhFour:ATe,kPluginNameChain:x9}=xr(),kTe=A0(),xTe=V0(),ITe=sP(),NTe=uR(),{buildHooks:DTe}=Na(),Pm=uP();I9.exports=function(e,r,s){let n=Pm.registerPlugin.call(e,r),i=Pm.getPluginName(r)||Pm.getFuncPreview(r);if(n)return e[x9].push(i),e;let o=Object.create(e);e[C9].push(o),o.ready=e[PTe].bind(o),o[C9]=[],o[A9]=kTe.buildReply(o[A9]),o[k9]=xTe.buildRequest(o[k9]),o[P9]=NTe.helpers.buildContentTypeParser(o[P9]),o[NP]=DTe(o[NP]),o[R9]=MTe(o[R9],s.prefix),o[O9]=s.logLevel||o[O9],o[ef]=ITe.buildSchemaController(e[ef]),o.getSchema=o[ef].getSchema.bind(o[ef]),o.getSchemas=o[ef].getSchemas.bind(o[ef]),o[Pm.kRegisteredPlugins]=Object.create(o[Pm.kRegisteredPlugins]),o[x9]=[i],(o[IP]||s.logSerializers)&&(o[IP]=Object.assign(Object.create(o[IP]),s.logSerializers)),s.prefix&&o[ATe].arrange404(o);for(let a of o[NP].onRegister)a.call(this,o,s);return o};function MTe(t,e){return e?(t.endsWith("/")&&e[0]==="/"?e=e.slice(1):e[0]!=="/"&&(e="/"+e),t+e):t}});var M9=m((MGe,D9)=>{"use strict";D9.exports=function(){return{[Symbol.iterator]:function*(){},add(){},delete(){},has(){return!0}}}});var $9=m(DP=>{"use strict";DP.parse=qTe;DP.serialize=LTe;var $Te=Object.prototype.toString,y_=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function qTe(t,e){if(typeof t!="string")throw new TypeError("argument str must be a string");for(var r={},s=e||{},n=s.decode||jTe,i=0;i<t.length;){var o=t.indexOf("=",i);if(o===-1)break;var a=t.indexOf(";",i);if(a===-1)a=t.length;else if(a<o){i=t.lastIndexOf(";",o-1)+1;continue}var l=t.slice(i,o).trim();if(r[l]===void 0){var u=t.slice(o+1,a).trim();u.charCodeAt(0)===34&&(u=u.slice(1,-1)),r[l]=zTe(u,n)}i=a+1}return r}function LTe(t,e,r){var s=r||{},n=s.encode||FTe;if(typeof n!="function")throw new TypeError("option encode is invalid");if(!y_.test(t))throw new TypeError("argument name is invalid");var i=n(e);if(i&&!y_.test(i))throw new TypeError("argument val is invalid");var o=t+"="+i;if(s.maxAge!=null){var a=s.maxAge-0;if(isNaN(a)||!isFinite(a))throw new TypeError("option maxAge is invalid");o+="; Max-Age="+Math.floor(a)}if(s.domain){if(!y_.test(s.domain))throw new TypeError("option domain is invalid");o+="; Domain="+s.domain}if(s.path){if(!y_.test(s.path))throw new TypeError("option path is invalid");o+="; Path="+s.path}if(s.expires){var l=s.expires;if(!BTe(l)||isNaN(l.valueOf()))throw new TypeError("option expires is invalid");o+="; Expires="+l.toUTCString()}if(s.httpOnly&&(o+="; HttpOnly"),s.secure&&(o+="; Secure"),s.partitioned&&(o+="; Partitioned"),s.priority){var u=typeof s.priority=="string"?s.priority.toLowerCase():s.priority;switch(u){case"low":o+="; Priority=Low";break;case"medium":o+="; Priority=Medium";break;case"high":o+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}}if(s.sameSite){var c=typeof s.sameSite=="string"?s.sameSite.toLowerCase():s.sameSite;switch(c){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;case"none":o+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return o}function jTe(t){return t.indexOf("%")!==-1?decodeURIComponent(t):t}function FTe(t){return encodeURIComponent(t)}function BTe(t){return $Te.call(t)==="[object Date]"||t instanceof Date}function zTe(t,e){try{return e(t)}catch{return t}}});var j9=m((qGe,L9)=>{"use strict";var{URL:q9}=require("node:url"),MP="http://localhost";L9.exports=function(e,r){(typeof e=="string"||Object.prototype.toString.call(e)==="[object String]")&&e.startsWith("//")&&(e=MP+e);let s=typeof e=="object"?Object.assign(new q9(MP),e):new q9(e,MP);if(typeof r=="string"){r=new URLSearchParams(r);for(let n of r.keys()){s.searchParams.delete(n);for(let i of r.getAll(n))s.searchParams.append(n,i)}}else{let n=Object.assign({},e.query,r);for(let i in n){let o=n[i];if(Array.isArray(o)){s.searchParams.delete(i);for(let a of o)s.searchParams.append(i,a)}else s.searchParams.set(i,o)}}return s}});var F9=m((LGe,$P)=>{"use strict";var{randomUUID:UTe}=require("node:crypto"),{Readable:VTe}=require("node:stream"),tf;function HTe(t){return t&&typeof t=="object"&&typeof t.append=="function"&&typeof t.delete=="function"&&typeof t.get=="function"&&typeof t.getAll=="function"&&typeof t.has=="function"&&typeof t.set=="function"&&t[Symbol.toStringTag]==="FormData"}function GTe(t){tf=tf??new TextEncoder;let e=`----formdata-${UTe()}`,r=`--${e}\r
Content-Disposition: form-data`;let s=l=>l.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22"),n=l=>l.replace(/\r?\n|\r/g,`\r
`),i=new Uint8Array([13,10]);async function*o(){for(let[l,u]of t)if(typeof u=="string")yield tf.encode(`${r}; name="${s(n(l))}"\r
\r
`),yield tf.encode(`${n(u)}\r
`);else{let c=`${r}; name="${s(n(l))}"`;u.name&&(c+=`; filename="${s(u.name)}"`),c+=`\r
Content-Type: ${u.type||"application/octet-stream"}\r
\r
`,yield tf.encode(c),u.stream?yield*u.stream():yield u,yield i}yield tf.encode(`--${e}--`)}return{stream:VTe.from(o()),contentType:`multipart/form-data; boundary=${e}`}}$P.exports.isFormDataLike=HTe;$P.exports.formDataToStream=GTe});var U9=m((jGe,v_)=>{"use strict";var{Readable:B9,addAbortSignal:KTe}=require("node:stream"),LP=require("node:util"),QTe=$9(),WTe=require("node:assert"),{createDeprecation:ZTe}=uT(),YTe=j9(),{isFormDataLike:JTe,formDataToStream:XTe}=F9(),{EventEmitter:eCe}=require("node:events"),tCe=ZTe({name:"FastifyDeprecationLightMyRequest",code:"FST_LIGHTMYREQUEST_DEP01",message:'You are accessing "request.connection", use "request.socket" instead.'});function rCe(t){return t.port?t.host:t.hostname+(t.protocol==="https:"?":443":":80")}var qP=class extends eCe{constructor(e){super(),this.remoteAddress=e}};function z9(t){return new e(this);function e(r){to.call(r,{...t,Request:void 0}),Object.assign(this,r);for(let s of Object.keys(to.prototype))this.constructor.prototype[s]=to.prototype[s];return LP.inherits(this.constructor,t.Request),this}}function to(t){B9.call(this,{autoDestroy:!1});let e=YTe(t.url||t.path,t.query);this.url=e.pathname+e.search,this.aborted=!1,this.httpVersionMajor=1,this.httpVersionMinor=1,this.httpVersion="1.1",this.method=t.method?t.method.toUpperCase():"GET",this.headers={},this.rawHeaders=[];let r=t.headers||{};for(let o in r){let a=o.toLowerCase();if((a==="user-agent"||a==="content-type")&&r[o]===void 0){this.headers[a]=void 0;continue}let l=r[o];WTe(l!==void 0,'invalid value "undefined" for header '+o),this.headers[a]=""+l}if("user-agent"in this.headers||(this.headers["user-agent"]="lightMyRequest"),this.headers.host=this.headers.host||t.authority||rCe(e),t.cookies){let{cookies:o}=t,a=Object.keys(o).map(l=>QTe.serialize(l,o[l]));this.headers.cookie&&a.unshift(this.headers.cookie),this.headers.cookie=a.join("; ")}this.socket=new qP(t.remoteAddress||"127.0.0.1"),Object.defineProperty(this,"connection",{get(){return tCe(),this.socket},configurable:!0});let s=t.payload||t.body||null,n=s&&typeof s.resume=="function";if(JTe(s)){let o=XTe(s);s=o.stream,n=!0,this.headers["content-type"]=o.contentType}s&&typeof s!="string"&&!n&&!Buffer.isBuffer(s)&&(s=JSON.stringify(s),"content-type"in this.headers||(this.headers["content-type"]="application/json")),s&&!n&&!Object.prototype.hasOwnProperty.call(this.headers,"content-length")&&(this.headers["content-length"]=(Buffer.isBuffer(s)?s.length:Buffer.byteLength(s)).toString());for(let o of Object.keys(this.headers))this.rawHeaders.push(o,this.headers[o]);this._lightMyRequest={payload:s,isDone:!1,simulate:t.simulate||{}};let i=t.signal;return i&&KTe(i,this),this}LP.inherits(to,B9);LP.inherits(z9,to);to.prototype.prepare=function(t){let e=this._lightMyRequest.payload;if(!e||typeof e.resume!="function")return t();let r=[];e.on("data",s=>r.push(Buffer.from(s))),e.on("end",()=>{let s=Buffer.concat(r);return this.headers["content-length"]=this.headers["content-length"]||""+s.length,this._lightMyRequest.payload=s,t()}),e.resume()};to.prototype._read=function(t){setImmediate(()=>{if(this._lightMyRequest.isDone){this._lightMyRequest.simulate.end!==!1&&this.push(null);return}this._lightMyRequest.isDone=!0,this._lightMyRequest.payload&&(this._lightMyRequest.simulate.split?(this.push(this._lightMyRequest.payload.slice(0,1)),this.push(this._lightMyRequest.payload.slice(1))):this.push(this._lightMyRequest.payload)),this._lightMyRequest.simulate.error&&this.emit("error",new Error("Simulated")),this._lightMyRequest.simulate.close&&this.emit("close"),this._lightMyRequest.simulate.end!==!1&&this.push(null)})};to.prototype.destroy=function(t){this.destroyed||this._lightMyRequest.isDone||(this.destroyed=!0,t&&(this._error=!0,process.nextTick(()=>this.emit("error",t))),process.nextTick(()=>this.emit("close")))};v_.exports=to;v_.exports.Request=to;v_.exports.CustomRequest=z9});var H9=m((FGe,Am)=>{"use strict";var rf={decodeValues:!0,map:!1,silent:!1};function jP(t){return typeof t=="string"&&!!t.trim()}function FP(t,e){var r=t.split(";").filter(jP),s=r.shift(),n=sCe(s),i=n.name,o=n.value;e=e?Object.assign({},rf,e):rf;try{o=e.decodeValues?decodeURIComponent(o):o}catch(l){console.error("set-cookie-parser encountered an error while decoding a cookie with value '"+o+"'. Set options.decodeValues to false to disable this feature.",l)}var a={name:i,value:o};return r.forEach(function(l){var u=l.split("="),c=u.shift().trimLeft().toLowerCase(),d=u.join("=");c==="expires"?a.expires=new Date(d):c==="max-age"?a.maxAge=parseInt(d,10):c==="secure"?a.secure=!0:c==="httponly"?a.httpOnly=!0:c==="samesite"?a.sameSite=d:a[c]=d}),a}function sCe(t){var e="",r="",s=t.split("=");return s.length>1?(e=s.shift(),r=s.join("=")):r=t,{name:e,value:r}}function V9(t,e){if(e=e?Object.assign({},rf,e):rf,!t)return e.map?{}:[];if(t.headers)if(typeof t.headers.getSetCookie=="function")t=t.headers.getSetCookie();else if(t.headers["set-cookie"])t=t.headers["set-cookie"];else{var r=t.headers[Object.keys(t.headers).find(function(n){return n.toLowerCase()==="set-cookie"})];!r&&t.headers.cookie&&!e.silent&&console.warn("Warning: set-cookie-parser appears to have been called on a request object. It is designed to parse Set-Cookie headers from responses, not Cookie headers from requests. Set the option {silent: true} to suppress this warning."),t=r}if(Array.isArray(t)||(t=[t]),e=e?Object.assign({},rf,e):rf,e.map){var s={};return t.filter(jP).reduce(function(n,i){var o=FP(i,e);return n[o.name]=o,n},s)}else return t.filter(jP).map(function(n){return FP(n,e)})}function nCe(t){if(Array.isArray(t))return t;if(typeof t!="string")return[];var e=[],r=0,s,n,i,o,a;function l(){for(;r<t.length&&/\s/.test(t.charAt(r));)r+=1;return r<t.length}function u(){return n=t.charAt(r),n!=="="&&n!==";"&&n!==","}for(;r<t.length;){for(s=r,a=!1;l();)if(n=t.charAt(r),n===","){for(i=r,r+=1,l(),o=r;r<t.length&&u();)r+=1;r<t.length&&t.charAt(r)==="="?(a=!0,r=o,e.push(t.substring(s,i)),s=r):r=i+1}else r+=1;(!a||r>=t.length)&&e.push(t.substring(s,t.length))}return e}Am.exports=V9;Am.exports.parse=V9;Am.exports.parseString=FP;Am.exports.splitCookiesString=nCe});var Q9=m((BGe,K9)=>{"use strict";var km=require("node:http"),{Writable:iCe,Readable:oCe}=require("node:stream"),aCe=require("node:util"),lCe=H9();function rl(t,e,r){km.ServerResponse.call(this,t),this._lightMyRequest={headers:null,trailers:{},payloadChunks:[]},this.setHeader("foo","bar"),this.removeHeader("foo"),this.assignSocket(cCe()),this._promiseCallback=typeof r=="function";let s=!1,n=o=>{if(s=!0,this._promiseCallback)return process.nextTick(()=>e(o));process.nextTick(()=>e(null,o))},i=o=>{if(!s){if(s=!0,this._promiseCallback)return process.nextTick(()=>r(o));process.nextTick(()=>e(o,null))}};this.once("finish",()=>{let o=uCe(this);o.raw.req=t,n(o)}),this.connection.once("error",i),this.once("error",i),this.once("close",i)}aCe.inherits(rl,km.ServerResponse);rl.prototype.setTimeout=function(t,e){return this.timeoutHandle=setTimeout(()=>{this.emit("timeout")},t),this.on("timeout",e),this};rl.prototype.writeHead=function(){let t=km.ServerResponse.prototype.writeHead.apply(this,arguments);return G9(this),t};rl.prototype.write=function(t,e,r){return this.timeoutHandle&&clearTimeout(this.timeoutHandle),km.ServerResponse.prototype.write.call(this,t,e,r),this._lightMyRequest.payloadChunks.push(Buffer.from(t,e)),!0};rl.prototype.end=function(t,e,r){t&&this.write(t,e),km.ServerResponse.prototype.end.call(this,r),this.emit("finish"),this.destroy()};rl.prototype.destroy=function(t){this.destroyed||(this.destroyed=!0,t&&process.nextTick(()=>this.emit("error",t)),process.nextTick(()=>this.emit("close")))};rl.prototype.addTrailers=function(t){for(let e in t)this._lightMyRequest.trailers[e.toLowerCase().trim()]=t[e].toString().trim()};function uCe(t){t._lightMyRequest.headers===null&&G9(t),dCe(t);let e={raw:{res:t},headers:t._lightMyRequest.headers,statusCode:t.statusCode,statusMessage:t.statusMessage,trailers:{},get cookies(){return lCe.parse(this)}},r=Buffer.concat(t._lightMyRequest.payloadChunks);return e.rawPayload=r,e.payload=r.toString(),e.body=e.payload,e.trailers=t._lightMyRequest.trailers,e.json=function(){return JSON.parse(e.payload)},e.stream=function(){return oCe.from(t._lightMyRequest.payloadChunks)},e}function cCe(){return new iCe({write(t,e,r){setImmediate(r)}})}function dCe(t){let e=t._lightMyRequest.headers;for(let r of Object.keys(e)){let s=e[r];Array.isArray(s)?e[r]=s.map(n=>""+n):e[r]=""+s}}function G9(t){t._lightMyRequest.headers=Object.assign({},t.getHeaders()),["Date","Connection","Transfer-Encoding"].forEach(e=>{let r=new RegExp("\\r\\n"+e+": ([^\\r]*)\\r\\n"),s=t._header.match(r);s&&(t._lightMyRequest.headers[e.toLowerCase()]=s[1])})}K9.exports=rl});var W9=m((zGe,BP)=>{"use strict";BP.exports=vr;BP.exports.default=vr;var fCe={type:"object",properties:{url:{oneOf:[{type:"string"},{type:"object",properties:{protocol:{type:"string"},hostname:{type:"string"},pathname:{type:"string"}},additionalProperties:!0,required:["pathname"]}]},path:{oneOf:[{type:"string"},{type:"object",properties:{protocol:{type:"string"},hostname:{type:"string"},pathname:{type:"string"}},additionalProperties:!0,required:["pathname"]}]},cookies:{type:"object",additionalProperties:!0},headers:{type:"object",additionalProperties:!0},query:{anyOf:[{type:"object",additionalProperties:!0},{type:"string"}]},simulate:{type:"object",properties:{end:{type:"boolean"},split:{type:"boolean"},error:{type:"boolean"},close:{type:"boolean"}}},authority:{type:"string"},remoteAddress:{type:"string"},method:{type:"string",enum:["ACL","BIND","CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LINK","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCALENDAR","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REBIND","REPORT","SEARCH","SOURCE","SUBSCRIBE","TRACE","UNBIND","UNLINK","UNLOCK","UNSUBSCRIBE","acl","bind","checkout","connect","copy","delete","get","head","link","lock","m-search","merge","mkactivity","mkcalendar","mkcol","move","notify","options","patch","post","propfind","proppatch","purge","put","rebind","report","search","source","subscribe","trace","unbind","unlink","unlock","unsubscribe"]},validate:{type:"boolean"}},additionalProperties:!0,oneOf:[{required:["url"]},{required:["path"]}]};function vr(t,{instancePath:e="",parentData:r,parentDataProperty:s,rootData:n=t}={}){let i=null,o=0,a=o,l=!1,u=null,c=o;if(t&&typeof t=="object"&&!Array.isArray(t)){let y;if(t.url===void 0&&(y="url")){let R={instancePath:e,schemaPath:"#/oneOf/0/required",keyword:"required",params:{missingProperty:y},message:"must have required property '"+y+"'"};i===null?i=[R]:i.push(R),o++}}var f=c===o;f&&(l=!0,u=0);let d=o;if(t&&typeof t=="object"&&!Array.isArray(t)){let y;if(t.path===void 0&&(y="path")){let R={instancePath:e,schemaPath:"#/oneOf/1/required",keyword:"required",params:{missingProperty:y},message:"must have required property '"+y+"'"};i===null?i=[R]:i.push(R),o++}}var f=d===o;if(f&&l?(l=!1,u=[u,1]):f&&(l=!0,u=1),l)o=a,i!==null&&(a?i.length=a:i=null);else{let y={instancePath:e,schemaPath:"#/oneOf",keyword:"oneOf",params:{passingSchemas:u},message:"must match exactly one schema in oneOf"};return i===null?i=[y]:i.push(y),o++,vr.errors=i,!1}if(o===0)if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.url!==void 0){let y=t.url,R=o,P=o,w=!1,O=null,$=o;if(typeof y!="string"){let k=typeof y,z;if(z===void 0)if(k=="number"||k=="boolean")z=""+y;else if(y===null)z="";else{let A={instancePath:e+"/url",schemaPath:"#/properties/url/oneOf/0/type",keyword:"type",params:{type:"string"},message:"must be string"};i===null?i=[A]:i.push(A),o++}z!==void 0&&(y=z,t!==void 0&&(t.url=z))}var p=$===o;p&&(w=!0,O=0);let C=o;if(o===C)if(y&&typeof y=="object"&&!Array.isArray(y)){let k;if(y.pathname===void 0&&(k="pathname")){let z={instancePath:e+"/url",schemaPath:"#/properties/url/oneOf/1/required",keyword:"required",params:{missingProperty:k},message:"must have required property '"+k+"'"};i===null?i=[z]:i.push(z),o++}else{if(y.protocol!==void 0){let z=y.protocol,A=o;if(typeof z!="string"){let E=typeof z,V;if(V===void 0)if(E=="number"||E=="boolean")V=""+z;else if(z===null)V="";else{let G={instancePath:e+"/url/protocol",schemaPath:"#/properties/url/oneOf/1/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};i===null?i=[G]:i.push(G),o++}V!==void 0&&(z=V,y!==void 0&&(y.protocol=V))}var h=A===o}else var h=!0;if(h){if(y.hostname!==void 0){let z=y.hostname,A=o;if(typeof z!="string"){let V=typeof z,G;if(G===void 0)if(V=="number"||V=="boolean")G=""+z;else if(z===null)G="";else{let X={instancePath:e+"/url/hostname",schemaPath:"#/properties/url/oneOf/1/properties/hostname/type",keyword:"type",params:{type:"string"},message:"must be string"};i===null?i=[X]:i.push(X),o++}G!==void 0&&(z=G,y!==void 0&&(y.hostname=G))}var h=A===o}else var h=!0;if(h)if(y.pathname!==void 0){let z=y.pathname,A=o;if(typeof z!="string"){let V=typeof z,G;if(G===void 0)if(V=="number"||V=="boolean")G=""+z;else if(z===null)G="";else{let X={instancePath:e+"/url/pathname",schemaPath:"#/properties/url/oneOf/1/properties/pathname/type",keyword:"type",params:{type:"string"},message:"must be string"};i===null?i=[X]:i.push(X),o++}G!==void 0&&(z=G,y!==void 0&&(y.pathname=G))}var h=A===o}else var h=!0}}}else{let k={instancePath:e+"/url",schemaPath:"#/properties/url/oneOf/1/type",keyword:"type",params:{type:"object"},message:"must be object"};i===null?i=[k]:i.push(k),o++}var p=C===o;if(p&&w?(w=!1,O=[O,1]):p&&(w=!0,O=1),w)o=P,i!==null&&(P?i.length=P:i=null);else{let k={instancePath:e+"/url",schemaPath:"#/properties/url/oneOf",keyword:"oneOf",params:{passingSchemas:O},message:"must match exactly one schema in oneOf"};return i===null?i=[k]:i.push(k),o++,vr.errors=i,!1}var g=R===o}else var g=!0;if(g){if(t.path!==void 0){let y=t.path,R=o,P=o,w=!1,O=null,$=o;if(typeof y!="string"){let z=typeof y,A;if(A===void 0)if(z=="number"||z=="boolean")A=""+y;else if(y===null)A="";else{let E={instancePath:e+"/path",schemaPath:"#/properties/path/oneOf/0/type",keyword:"type",params:{type:"string"},message:"must be string"};i===null?i=[E]:i.push(E),o++}A!==void 0&&(y=A,t!==void 0&&(t.path=A))}var S=$===o;S&&(w=!0,O=0);let C=o;if(o===C)if(y&&typeof y=="object"&&!Array.isArray(y)){let z;if(y.pathname===void 0&&(z="pathname")){let A={instancePath:e+"/path",schemaPath:"#/properties/path/oneOf/1/required",keyword:"required",params:{missingProperty:z},message:"must have required property '"+z+"'"};i===null?i=[A]:i.push(A),o++}else{if(y.protocol!==void 0){let A=y.protocol,E=o;if(typeof A!="string"){let V=typeof A,G;if(G===void 0)if(V=="number"||V=="boolean")G=""+A;else if(A===null)G="";else{let X={instancePath:e+"/path/protocol",schemaPath:"#/properties/path/oneOf/1/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};i===null?i=[X]:i.push(X),o++}G!==void 0&&(A=G,y!==void 0&&(y.protocol=G))}var _=E===o}else var _=!0;if(_){if(y.hostname!==void 0){let A=y.hostname,E=o;if(typeof A!="string"){let G=typeof A,X;if(X===void 0)if(G=="number"||G=="boolean")X=""+A;else if(A===null)X="";else{let pe={instancePath:e+"/path/hostname",schemaPath:"#/properties/path/oneOf/1/properties/hostname/type",keyword:"type",params:{type:"string"},message:"must be string"};i===null?i=[pe]:i.push(pe),o++}X!==void 0&&(A=X,y!==void 0&&(y.hostname=X))}var _=E===o}else var _=!0;if(_)if(y.pathname!==void 0){let A=y.pathname,E=o;if(typeof A!="string"){let G=typeof A,X;if(X===void 0)if(G=="number"||G=="boolean")X=""+A;else if(A===null)X="";else{let pe={instancePath:e+"/path/pathname",schemaPath:"#/properties/path/oneOf/1/properties/pathname/type",keyword:"type",params:{type:"string"},message:"must be string"};i===null?i=[pe]:i.push(pe),o++}X!==void 0&&(A=X,y!==void 0&&(y.pathname=X))}var _=E===o}else var _=!0}}}else{let z={instancePath:e+"/path",schemaPath:"#/properties/path/oneOf/1/type",keyword:"type",params:{type:"object"},message:"must be object"};i===null?i=[z]:i.push(z),o++}var S=C===o;if(S&&w?(w=!1,O=[O,1]):S&&(w=!0,O=1),w)o=P,i!==null&&(P?i.length=P:i=null);else{let z={instancePath:e+"/path",schemaPath:"#/properties/path/oneOf",keyword:"oneOf",params:{passingSchemas:O},message:"must match exactly one schema in oneOf"};return i===null?i=[z]:i.push(z),o++,vr.errors=i,!1}var g=R===o}else var g=!0;if(g){if(t.cookies!==void 0){let y=t.cookies,R=o;if(o===R&&!(y&&typeof y=="object"&&!Array.isArray(y)))return vr.errors=[{instancePath:e+"/cookies",schemaPath:"#/properties/cookies/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var g=R===o}else var g=!0;if(g){if(t.headers!==void 0){let y=t.headers,R=o;if(o===R&&!(y&&typeof y=="object"&&!Array.isArray(y)))return vr.errors=[{instancePath:e+"/headers",schemaPath:"#/properties/headers/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var g=R===o}else var g=!0;if(g){if(t.query!==void 0){let y=t.query,R=o,P=o,w=!1,O=o;if(o===O&&!(y&&typeof y=="object"&&!Array.isArray(y))){let C={instancePath:e+"/query",schemaPath:"#/properties/query/anyOf/0/type",keyword:"type",params:{type:"object"},message:"must be object"};i===null?i=[C]:i.push(C),o++}var b=O===o;if(w=w||b,!w){let C=o;if(typeof y!="string"){let z=typeof y,A;if(A===void 0)if(z=="number"||z=="boolean")A=""+y;else if(y===null)A="";else{let E={instancePath:e+"/query",schemaPath:"#/properties/query/anyOf/1/type",keyword:"type",params:{type:"string"},message:"must be string"};i===null?i=[E]:i.push(E),o++}A!==void 0&&(y=A,t!==void 0&&(t.query=A))}var b=C===o;w=w||b}if(w)o=P,i!==null&&(P?i.length=P:i=null);else{let C={instancePath:e+"/query",schemaPath:"#/properties/query/anyOf",keyword:"anyOf",params:{},message:"must match a schema in anyOf"};return i===null?i=[C]:i.push(C),o++,vr.errors=i,!1}var g=R===o}else var g=!0;if(g){if(t.simulate!==void 0){let y=t.simulate,R=o;if(o===R)if(y&&typeof y=="object"&&!Array.isArray(y)){if(y.end!==void 0){let w=y.end,O=o;if(typeof w!="boolean"){let $;if($===void 0)if(w==="false"||w===0||w===null)$=!1;else if(w==="true"||w===1)$=!0;else return vr.errors=[{instancePath:e+"/simulate/end",schemaPath:"#/properties/simulate/properties/end/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;$!==void 0&&(w=$,y!==void 0&&(y.end=$))}var v=O===o}else var v=!0;if(v){if(y.split!==void 0){let w=y.split,O=o;if(typeof w!="boolean"){let C;if(C===void 0)if(w==="false"||w===0||w===null)C=!1;else if(w==="true"||w===1)C=!0;else return vr.errors=[{instancePath:e+"/simulate/split",schemaPath:"#/properties/simulate/properties/split/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;C!==void 0&&(w=C,y!==void 0&&(y.split=C))}var v=O===o}else var v=!0;if(v){if(y.error!==void 0){let w=y.error,O=o;if(typeof w!="boolean"){let C;if(C===void 0)if(w==="false"||w===0||w===null)C=!1;else if(w==="true"||w===1)C=!0;else return vr.errors=[{instancePath:e+"/simulate/error",schemaPath:"#/properties/simulate/properties/error/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;C!==void 0&&(w=C,y!==void 0&&(y.error=C))}var v=O===o}else var v=!0;if(v)if(y.close!==void 0){let w=y.close,O=o;if(typeof w!="boolean"){let C;if(C===void 0)if(w==="false"||w===0||w===null)C=!1;else if(w==="true"||w===1)C=!0;else return vr.errors=[{instancePath:e+"/simulate/close",schemaPath:"#/properties/simulate/properties/close/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;C!==void 0&&(w=C,y!==void 0&&(y.close=C))}var v=O===o}else var v=!0}}}else return vr.errors=[{instancePath:e+"/simulate",schemaPath:"#/properties/simulate/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var g=R===o}else var g=!0;if(g){if(t.authority!==void 0){let y=t.authority,R=o;if(typeof y!="string"){let w=typeof y,O;if(O===void 0)if(w=="number"||w=="boolean")O=""+y;else if(y===null)O="";else return vr.errors=[{instancePath:e+"/authority",schemaPath:"#/properties/authority/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;O!==void 0&&(y=O,t!==void 0&&(t.authority=O))}var g=R===o}else var g=!0;if(g){if(t.remoteAddress!==void 0){let y=t.remoteAddress,R=o;if(typeof y!="string"){let w=typeof y,O;if(O===void 0)if(w=="number"||w=="boolean")O=""+y;else if(y===null)O="";else return vr.errors=[{instancePath:e+"/remoteAddress",schemaPath:"#/properties/remoteAddress/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;O!==void 0&&(y=O,t!==void 0&&(t.remoteAddress=O))}var g=R===o}else var g=!0;if(g){if(t.method!==void 0){let y=t.method,R=o;if(typeof y!="string"){let w=typeof y,O;if(O===void 0)if(w=="number"||w=="boolean")O=""+y;else if(y===null)O="";else return vr.errors=[{instancePath:e+"/method",schemaPath:"#/properties/method/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;O!==void 0&&(y=O,t!==void 0&&(t.method=O))}if(!(y==="ACL"||y==="BIND"||y==="CHECKOUT"||y==="CONNECT"||y==="COPY"||y==="DELETE"||y==="GET"||y==="HEAD"||y==="LINK"||y==="LOCK"||y==="M-SEARCH"||y==="MERGE"||y==="MKACTIVITY"||y==="MKCALENDAR"||y==="MKCOL"||y==="MOVE"||y==="NOTIFY"||y==="OPTIONS"||y==="PATCH"||y==="POST"||y==="PROPFIND"||y==="PROPPATCH"||y==="PURGE"||y==="PUT"||y==="REBIND"||y==="REPORT"||y==="SEARCH"||y==="SOURCE"||y==="SUBSCRIBE"||y==="TRACE"||y==="UNBIND"||y==="UNLINK"||y==="UNLOCK"||y==="UNSUBSCRIBE"||y==="acl"||y==="bind"||y==="checkout"||y==="connect"||y==="copy"||y==="delete"||y==="get"||y==="head"||y==="link"||y==="lock"||y==="m-search"||y==="merge"||y==="mkactivity"||y==="mkcalendar"||y==="mkcol"||y==="move"||y==="notify"||y==="options"||y==="patch"||y==="post"||y==="propfind"||y==="proppatch"||y==="purge"||y==="put"||y==="rebind"||y==="report"||y==="search"||y==="source"||y==="subscribe"||y==="trace"||y==="unbind"||y==="unlink"||y==="unlock"||y==="unsubscribe"))return vr.errors=[{instancePath:e+"/method",schemaPath:"#/properties/method/enum",keyword:"enum",params:{allowedValues:fCe.properties.method.enum},message:"must be equal to one of the allowed values"}],!1;var g=R===o}else var g=!0;if(g)if(t.validate!==void 0){let y=t.validate,R=o;if(typeof y!="boolean"){let w;if(w===void 0)if(y==="false"||y===0||y===null)w=!1;else if(y==="true"||y===1)w=!0;else return vr.errors=[{instancePath:e+"/validate",schemaPath:"#/properties/validate/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;w!==void 0&&(y=w,t!==void 0&&(t.validate=w))}var g=R===o}else var g=!0}}}}}}}}}else return vr.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return vr.errors=i,o===0}});var J9=m((UGe,Im)=>{"use strict";var hCe=require("node:assert"),zP=U9(),__=Q9(),b_="The dispatch function has already been invoked",Z9=W9();function UP(t,e,r){return r===void 0?new xm(t,e):S_(t,e,r)}function Y9(t,e,r,s){return r.once("error",function(n){this.destroyed&&s.destroy(n)}),r.once("close",function(){this.destroyed&&!this._error&&s.destroy()}),r.prepare(()=>t.call(e,r,s))}function S_(t,e,r){if(e=typeof e=="string"?{url:e}:e,e.validate!==!1&&(hCe(typeof t=="function","dispatchFunc should be a function"),!Z9(e)))throw new Error(Z9.errors.map(o=>o.message));let s=e.server||{},n=e.Request?zP.CustomRequest:zP;if(t.request&&t.request.app===t&&(Object.setPrototypeOf(Object.getPrototypeOf(t.request),n.prototype),Object.setPrototypeOf(Object.getPrototypeOf(t.response),__.prototype)),typeof r=="function"){let i=new n(e),o=new __(i,r);return Y9(t,s,i,o)}else return new Promise((i,o)=>{let a=new n(e),l=new __(a,i,o);Y9(t,s,a,l)})}function xm(t,e){typeof e=="string"?this.option={url:e}:this.option=Object.assign({},e),this.dispatch=t,this._hasInvoked=!1,this._promise=null,this.option.autoStart!==!1&&process.nextTick(()=>{this._hasInvoked||this.end()})}var pCe=["delete","get","head","options","patch","post","put","trace"];pCe.forEach(t=>{xm.prototype[t]=function(e){if(this._hasInvoked===!0||this._promise)throw new Error(b_);return this.option.url=e,this.option.method=t.toUpperCase(),this}});var mCe=["body","cookies","headers","payload","query"];mCe.forEach(t=>{xm.prototype[t]=function(e){if(this._hasInvoked===!0||this._promise)throw new Error(b_);return this.option[t]=e,this}});xm.prototype.end=function(t){if(this._hasInvoked===!0||this._promise)throw new Error(b_);if(this._hasInvoked=!0,typeof t=="function")S_(this.dispatch,this.option,t);else return this._promise=S_(this.dispatch,this.option),this._promise};Object.getOwnPropertyNames(Promise.prototype).forEach(t=>{t!=="constructor"&&(xm.prototype[t]=function(...e){if(!this._promise){if(this._hasInvoked===!0)throw new Error(b_);this._hasInvoked=!0,this._promise=S_(this.dispatch,this.option)}return this._promise[t](...e)})});function gCe(t){return t instanceof zP||t instanceof __||t&&t.constructor&&t.constructor.name==="_CustomLMRRequest"}Im.exports=UP;Im.exports.default=UP;Im.exports.inject=UP;Im.exports.isInjection=gCe});var h5=m((VGe,qm)=>{"use strict";var yCe="4.28.0",vCe=$q(),VP=require("node:http"),Nm,{kAvvioBoot:Dm,kChildren:HP,kServerBindings:X9,kBodyLimit:_Ce,kRoutePrefix:e5,kLogLevel:SCe,kLogSerializers:bCe,kHooks:GP,kSchemaController:sl,kRequestAcceptVersion:ECe,kReplySerializerDefault:t5,kContentTypeParser:wCe,kReply:TCe,kRequest:CCe,kFourOhFour:RCe,kState:dr,kOptions:KP,kPluginNameChain:Mm,kSchemaErrorFormatter:QP,kErrorHandler:E_,kKeepAliveConnections:WP,kChildLoggerFactory:ZP,kGenReqId:YP}=xr(),{createServer:OCe,compileValidateHTTPVersion:PCe}=iL(),$m=A0(),w_=V0(),ACe=H0(),{supportedMethods:kCe}=WC(),sf=eR(),Bu=uR(),r5=sP(),{Hooks:xCe,hookRunnerApplication:s5,supportedHooks:JP}=Na(),{createLogger:ICe,createChildLogger:n5,defaultChildLoggerFactory:NCe}=gp(),i5=uP(),{getGenReqId:o5,reqIdGenFactory:a5}=Zv(),{buildRouting:DCe,validateBodyLimitOption:MCe}=p9(),$Ce=b9(),f5=T9(),qCe=N9(),{FSTDEP009:LCe}=zo(),jCe=M9(),{appendStackTrace:FCe,AVVIO_ERRORS_MAP:l5,...zu}=rs(),{defaultInitOptions:Ls}=f5,{FST_ERR_ASYNC_CONSTRAINT:BCe,FST_ERR_BAD_URL:zCe,FST_ERR_FORCE_CLOSE_CONNECTIONS_IDLE_NOT_AVAILABLE:UCe,FST_ERR_OPTIONS_NOT_OBJ:VCe,FST_ERR_QSP_NOT_FN:HCe,FST_ERR_SCHEMA_CONTROLLER_BUCKET_OPT_NOT_FN:GCe,FST_ERR_AJV_CUSTOM_OPTIONS_OPT_NOT_OBJ:KCe,FST_ERR_AJV_CUSTOM_OPTIONS_OPT_NOT_ARR:QCe,FST_ERR_VERSION_CONSTRAINT_NOT_STR:WCe,FST_ERR_INSTANCE_ALREADY_LISTENING:ZCe,FST_ERR_REOPENED_CLOSE_SERVER:YCe,FST_ERR_ROUTE_REWRITE_NOT_STR:JCe,FST_ERR_SCHEMA_ERROR_FORMATTER_NOT_FN:u5,FST_ERR_ERROR_HANDLER_NOT_FN:XCe}=zu,{buildErrorHandler:c5}=vp();function eRe(t){let e={};return["errorHandler","logLevel","logSerializers"].concat(JP).forEach(s=>{e[s]=t.store[s]}),Object.assign({},e)}function XP(t){if(t=t||{},typeof t!="object")throw new VCe;if(t.querystringParser&&typeof t.querystringParser!="function")throw new HCe(typeof t.querystringParser);if(t.schemaController&&t.schemaController.bucket&&typeof t.schemaController.bucket!="function")throw new GCe(typeof t.schemaController.bucket);MCe(t.bodyLimit);let e=t.requestIdHeader===!1?!1:(t.requestIdHeader||Ls.requestIdHeader).toLowerCase(),r=a5(e,t.genReqId),s=t.requestIdLogLabel||"reqId",n=t.bodyLimit||Ls.bodyLimit,i=t.disableRequestLogging||!1,o=Object.assign({customOptions:{},plugins:[]},t.ajv),a=t.frameworkErrors;if(!o.customOptions||Object.prototype.toString.call(o.customOptions)!=="[object Object]")throw new KCe(typeof o.customOptions);if(!o.plugins||!Array.isArray(o.plugins))throw new QCe(typeof o.plugins);let{logger:l,hasLogger:u}=ICe(t);t.connectionTimeout=t.connectionTimeout||Ls.connectionTimeout,t.keepAliveTimeout=t.keepAliveTimeout||Ls.keepAliveTimeout,t.maxRequestsPerSocket=t.maxRequestsPerSocket||Ls.maxRequestsPerSocket,t.requestTimeout=t.requestTimeout||Ls.requestTimeout,t.logger=l,t.requestIdHeader=e,t.requestIdLogLabel=s,t.disableRequestLogging=i,t.ajv=o,t.clientErrorHandler=t.clientErrorHandler||X;let c=f5(t);t.exposeHeadRoutes=c.exposeHeadRoutes;let d=t.constraints;t.versioning&&(LCe(),d={...d,version:{name:"version",mustMatchWhenDerived:!0,storage:t.versioning.storage,deriveConstraint:t.versioning.deriveVersion,validate(N){if(typeof N!="string")throw new WCe}}});let f=DCe({config:{defaultRoute:pe,onBadUrl:J,constraints:d,ignoreTrailingSlash:t.ignoreTrailingSlash||Ls.ignoreTrailingSlash,ignoreDuplicateSlashes:t.ignoreDuplicateSlashes||Ls.ignoreDuplicateSlashes,maxParamLength:t.maxParamLength||Ls.maxParamLength,caseSensitive:t.caseSensitive,allowUnsafeRegex:t.allowUnsafeRegex||Ls.allowUnsafeRegex,buildPrettyMeta:eRe,querystringParser:t.querystringParser,useSemicolonDelimiter:t.useSemicolonDelimiter??Ls.useSemicolonDelimiter}}),h=$Ce(t),p=H(f,t);t.http2SessionTimeout=c.http2SessionTimeout;let{server:g,listen:_}=OCe(t,p),S=typeof g.closeAllConnections=="function",b=typeof g.closeIdleConnections=="function",v=t.forceCloseConnections;if(v==="idle"&&!b)throw new UCe;typeof v!="boolean"&&(v=b?"idle":!1);let y=!S&&v===!0?new Set:jCe(),R=$m.setupResponseListeners,P=r5.buildSchemaController(null,t.schemaController),w={[dr]:{listening:!1,closing:!1,started:!1,ready:!1,booting:!1,readyPromise:null},[WP]:y,[KP]:t,[HP]:[],[X9]:[],[_Ce]:n,[e5]:"",[SCe]:"",[bCe]:null,[GP]:new xCe,[sl]:P,[QP]:null,[E_]:c5(),[ZP]:NCe,[t5]:null,[wCe]:new Bu(n,t.onProtoPoisoning||Ls.onProtoPoisoning,t.onConstructorPoisoning||Ls.onConstructorPoisoning),[TCe]:$m.buildReply($m),[CCe]:w_.buildRequest(w_,t.trustProxy),[RCe]:h,[i5.kRegisteredPlugins]:[],[Mm]:["fastify"],[Dm]:null,[YP]:r,routing:p,getDefaultRoute:f.getDefaultRoute.bind(f),setDefaultRoute:f.setDefaultRoute.bind(f),delete:function(q,K,se){return f.prepareRoute.call(this,{method:"DELETE",url:q,options:K,handler:se})},get:function(q,K,se){return f.prepareRoute.call(this,{method:"GET",url:q,options:K,handler:se})},head:function(q,K,se){return f.prepareRoute.call(this,{method:"HEAD",url:q,options:K,handler:se})},patch:function(q,K,se){return f.prepareRoute.call(this,{method:"PATCH",url:q,options:K,handler:se})},post:function(q,K,se){return f.prepareRoute.call(this,{method:"POST",url:q,options:K,handler:se})},put:function(q,K,se){return f.prepareRoute.call(this,{method:"PUT",url:q,options:K,handler:se})},options:function(q,K,se){return f.prepareRoute.call(this,{method:"OPTIONS",url:q,options:K,handler:se})},all:function(q,K,se){return f.prepareRoute.call(this,{method:kCe,url:q,options:K,handler:se})},route:function(q){return f.route.call(this,{options:q})},hasRoute:function(q){return f.hasRoute.call(this,{options:q})},findRoute:function(q){return f.findRoute(q)},log:l,withTypeProvider:E,addHook:V,addSchema:G,getSchema:P.getSchema.bind(P),getSchemas:P.getSchemas.bind(P),setValidatorCompiler:ve,setSerializerCompiler:Ze,setSchemaController:_e,setReplySerializer:Ye,setSchemaErrorFormatter:pt,setGenReqId:Q,addContentTypeParser:Bu.helpers.addContentTypeParser,hasContentTypeParser:Bu.helpers.hasContentTypeParser,getDefaultJsonParser:Bu.defaultParsers.getDefaultJsonParser,defaultTextParser:Bu.defaultParsers.defaultTextParser,removeContentTypeParser:Bu.helpers.removeContentTypeParser,removeAllContentTypeParsers:Bu.helpers.removeAllContentTypeParsers,register:null,after:null,ready:null,onClose:null,close:null,printPlugins:null,hasPlugin:function(N){return this[i5.kRegisteredPlugins].includes(N)||this[Mm].includes(N)},listen:_,server:g,addresses:function(){let N=this[X9].map(q=>q.address());return N.push(this.server.address()),N.filter(q=>q)},decorate:sf.add,hasDecorator:sf.exist,decorateReply:sf.decorateReply,decorateRequest:sf.decorateRequest,hasRequestDecorator:sf.existRequest,hasReplyDecorator:sf.existReply,inject:z,printRoutes:W,setNotFoundHandler:st,setErrorHandler:Re,setChildLoggerFactory:Pe,initialConfig:c,addConstraintStrategy:f.addConstraintStrategy.bind(f),hasConstraintStrategy:f.hasConstraintStrategy.bind(f)};Object.defineProperties(w,{listeningOrigin:{get(){let N=this.addresses().slice(-1).pop();if(typeof N=="string")return N;let q=N.family==="IPv6"?`[${N.address}]`:N.address;return`${this[KP].https?"https":"http"}://${q}:${N.port}`}},pluginName:{configurable:!0,get(){return this[Mm].length>1?this[Mm].join(" -> "):this[Mm][0]}},prefix:{configurable:!0,get(){return this[e5]}},validatorCompiler:{configurable:!0,get(){return this[sl].getValidatorCompiler()}},serializerCompiler:{configurable:!0,get(){return this[sl].getSerializerCompiler()}},childLoggerFactory:{configurable:!0,get(){return this[ZP]}},version:{configurable:!0,get(){return yCe}},errorHandler:{configurable:!0,get(){return this[E_].func}},genReqId:{configurable:!0,get(){return this[YP]}}}),t.schemaErrorFormatter&&(d5(t.schemaErrorFormatter),w[QP]=t.schemaErrorFormatter.bind(w));let O=Number(t.pluginTimeout),$=vCe(w,{autostart:!1,timeout:isNaN(O)===!1?O:Ls.pluginTimeout,expose:{use:"register"}});$.override=qCe,$.on("start",()=>w[dr].started=!0),w[Dm]=w.ready,w.ready=A,w.printPlugins=$.prettyPrint.bind($),$.once("preReady",()=>{w.onClose((N,q)=>{w[dr].closing=!0,f.closeRoutes(),s5("preClose",w[Dm],w,function(){if(w[dr].listening){if(v==="idle")N.server.closeIdleConnections();else if(S&&v)N.server.closeAllConnections();else if(v===!0)for(let K of w[WP])K.destroy(),w[WP].delete(K)}!t.serverFactory||w[dr].listening?N.server.close(function(K){K&&K.code!=="ERR_SERVER_NOT_RUNNING"?q(null):q()}):process.nextTick(q,null)})})});let C=new ACe({server:w,config:{}});w.setNotFoundHandler(),h.arrange404(w),f.setup(t,{avvio:$,fourOhFour:h,logger:l,hasLogger:u,setupResponseListeners:R,throwIfAlreadyStarted:k,validateHTTPVersion:PCe(t),keepAliveConnections:y}),g.on("clientError",t.clientErrorHandler.bind(w));try{let q=require("node:diagnostics_channel").channel("fastify.initialization");q.hasSubscribers&&q.publish({fastify:w})}catch{}return"asyncDispose"in Symbol&&(w[Symbol.asyncDispose]=function(){return w.close()}),w;function k(N){if(w[dr].started)throw new ZCe(N)}function z(N,q){if(Nm===void 0&&(Nm=J9()),w[dr].started){if(w[dr].closing){let K=new YCe;if(q){q(K);return}else return Promise.reject(K)}return Nm(p,N,q)}if(q)this.ready(K=>{K?q(K,null):Nm(p,N,q)});else return Nm((K,se)=>{this.ready(function(ke){if(ke){se.emit("error",ke);return}p(K,se)})},N)}function A(N){if(this[dr].readyPromise!==null){if(N!=null){this[dr].readyPromise.then(()=>N(null,w),N);return}return this[dr].readyPromise}let q,K;if(process.nextTick(se),this[dr].readyPromise=new Promise(function(le,lt){q=le,K=lt}),N)this[dr].readyPromise.then(()=>N(null,w),N);else return this[dr].readyPromise;function se(){w[Dm]((le,lt)=>{le||w[dr].started||w[dr].ready||w[dr].booting?ke(le):(w[dr].booting=!0,s5("onReady",w[Dm],w,ke)),lt()})}function ke(le){if(le=le!=null&&l5[le.code]!=null?FCe(le,new l5[le.code](le.message)):le,le)return K(le);q(w),w[dr].booting=!1,w[dr].ready=!0,w[dr].promise=null}}function E(){return this}function V(N,q){if(k('Cannot call "addHook"!'),q==null)throw new zu.FST_ERR_HOOK_INVALID_HANDLER(N,q);if(N==="onSend"||N==="preSerialization"||N==="onError"||N==="preParsing"){if(q.constructor.name==="AsyncFunction"&&q.length===4)throw new zu.FST_ERR_HOOK_INVALID_ASYNC_HANDLER}else if(N==="onReady"||N==="onListen"){if(q.constructor.name==="AsyncFunction"&&q.length!==0)throw new zu.FST_ERR_HOOK_INVALID_ASYNC_HANDLER}else if(N==="onRequestAbort"){if(q.constructor.name==="AsyncFunction"&&q.length!==1)throw new zu.FST_ERR_HOOK_INVALID_ASYNC_HANDLER}else if(q.constructor.name==="AsyncFunction"&&q.length===3)throw new zu.FST_ERR_HOOK_INVALID_ASYNC_HANDLER;return N==="onClose"?this.onClose(q):N==="onReady"||N==="onListen"||N==="onRoute"?this[GP].add(N,q):this.after((se,ke)=>{K.call(this,N,q),ke(se)}),this;function K(se,ke){this[GP].add(se,ke),this[HP].forEach(le=>K.call(le,se,ke))}}function G(N){return k('Cannot call "addSchema"!'),this[sl].add(N),this[HP].forEach(q=>q.addSchema(N)),this}function X(N,q){if(N.code==="ECONNRESET"||q.destroyed)return;let K,se,ke,le;N.code==="ERR_HTTP_REQUEST_TIMEOUT"?(se="408",ke=VP.STATUS_CODES[se],K=`{"error":"${ke}","message":"Client Timeout","statusCode":408}`,le="timeout"):N.code==="HPE_HEADER_OVERFLOW"?(se="431",ke=VP.STATUS_CODES[se],K=`{"error":"${ke}","message":"Exceeded maximum allowed HTTP header size","statusCode":431}`,le="header_overflow"):(se="400",ke=VP.STATUS_CODES[se],K=`{"error":"${ke}","message":"Client Error","statusCode":400}`,le="error"),this.log.trace({err:N},`client ${le}`),q.writable&&q.write(`HTTP/1.1 ${se} ${ke}\r
Content-Length: ${K.length}\r
Content-Type: application/json\r
\r
${K}`),q.destroy(N)}function pe(N,q){N.headers["accept-version"]!==void 0&&(N.headers[ECe]=N.headers["accept-version"],N.headers["accept-version"]=void 0),h.router.lookup(N,q)}function J(N,q,K){if(a){let ke=o5(C.server,q),le=n5(C,l,q,ke),lt=new w_(ke,null,q,null,le,C),_n=new $m(K,lt,le);return i===!1&&le.info({req:lt},"incoming request"),a(new zCe(N),lt,_n)}let se=`{"error":"Bad Request","code":"FST_ERR_BAD_URL","message":"'${N}' is not a valid url component","statusCode":400}`;K.writeHead(400,{"Content-Type":"application/json","Content-Length":se.length}),K.end(se)}function ye(N,q,K){if(N!==!1)return function(ke){if(ke){if(a){let lt=o5(C.server,q),_n=n5(C,l,q,lt),mt=new w_(lt,null,q,null,_n,C),ir=new $m(K,mt,_n);return i===!1&&_n.info({req:mt},"incoming request"),a(new BCe,mt,ir)}let le='{"error":"Internal Server Error","message":"Unexpected error from async constraint","statusCode":500}';K.writeHead(500,{"Content-Type":"application/json","Content-Length":le.length}),K.end(le)}}}function st(N,q){return k('Cannot call "setNotFoundHandler"!'),h.setNotFoundHandler.call(this,N,q,$,f.routeHandler),this}function ve(N){return k('Cannot call "setValidatorCompiler"!'),this[sl].setValidatorCompiler(N),this}function pt(N){return k('Cannot call "setSchemaErrorFormatter"!'),d5(N),this[QP]=N.bind(this),this}function Ze(N){return k('Cannot call "setSerializerCompiler"!'),this[sl].setSerializerCompiler(N),this}function _e(N){k('Cannot call "setSchemaController"!');let q=this[sl],K=r5.buildSchemaController(q,Object.assign({},q.opts,N));return this[sl]=K,this.getSchema=K.getSchema.bind(K),this.getSchemas=K.getSchemas.bind(K),this}function Ye(N){return k('Cannot call "setReplySerializer"!'),this[t5]=N,this}function Re(N){if(k('Cannot call "setErrorHandler"!'),typeof N!="function")throw new XCe;return this[E_]=c5(this[E_],N.bind(this)),this}function Pe(N){return k('Cannot call "setChildLoggerFactory"!'),this[ZP]=N,this}function W(N={}){return N.includeMeta=N.includeHooks?N.includeMeta?JP.concat(N.includeMeta):JP:N.includeMeta,f.printRoutes(N)}function H(N,{rewriteUrl:q,logger:K}){let se;return function(le,lt){if(se===void 0&&(se=N.isAsyncConstraint()),q){le.originalUrl=le.url;let _n=q.call(w,le);if(typeof _n=="string")le.url=_n;else{let mt=new JCe(le.url,typeof _n);le.destroy(mt)}}N.routing(le,lt,ye(se,le,lt))}}function Q(N){return k('Cannot call "setGenReqId"!'),this[YP]=a5(this[KP].requestIdHeader,N),this}}function d5(t){if(typeof t!="function")throw new u5(typeof t);if(t.constructor.name==="AsyncFunction")throw new u5("AsyncFunction")}qm.exports=XP;qm.exports.errorCodes=zu;qm.exports.fastify=XP;qm.exports.default=XP});var p5=m((HGe,tRe)=>{tRe.exports={name:"dotenv",version:"16.4.5",description:"Loads environment variables from .env file",main:"lib/main.js",types:"lib/main.d.ts",exports:{".":{types:"./lib/main.d.ts",require:"./lib/main.js",default:"./lib/main.js"},"./config":"./config.js","./config.js":"./config.js","./lib/env-options":"./lib/env-options.js","./lib/env-options.js":"./lib/env-options.js","./lib/cli-options":"./lib/cli-options.js","./lib/cli-options.js":"./lib/cli-options.js","./package.json":"./package.json"},scripts:{"dts-check":"tsc --project tests/types/tsconfig.json",lint:"standard","lint-readme":"standard-markdown",pretest:"npm run lint && npm run dts-check",test:"tap tests/*.js --100 -Rspec","test:coverage":"tap --coverage-report=lcov",prerelease:"npm test",release:"standard-version"},repository:{type:"git",url:"git://github.com/motdotla/dotenv.git"},funding:"https://dotenvx.com",keywords:["dotenv","env",".env","environment","variables","config","settings"],readmeFilename:"README.md",license:"BSD-2-Clause",devDependencies:{"@definitelytyped/dtslint":"^0.0.133","@types/node":"^18.11.3",decache:"^4.6.1",sinon:"^14.0.1",standard:"^17.0.0","standard-markdown":"^7.1.0","standard-version":"^9.5.0",tap:"^16.3.0",tar:"^6.1.11",typescript:"^4.8.4"},engines:{node:">=12"},browser:{fs:!1}}});var sA=m((GGe,oa)=>{var eA=require("fs"),tA=require("path"),rRe=require("os"),sRe=require("crypto"),nRe=p5(),rA=nRe.version,iRe=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/mg;function oRe(t){let e={},r=t.toString();r=r.replace(/\r\n?/mg,`
`);let s;for(;(s=iRe.exec(r))!=null;){let n=s[1],i=s[2]||"";i=i.trim();let o=i[0];i=i.replace(/^(['"`])([\s\S]*)\1$/mg,"$2"),o==='"'&&(i=i.replace(/\\n/g,`
`),i=i.replace(/\\r/g,"\r")),e[n]=i}return e}function aRe(t){let e=y5(t),r=Er.configDotenv({path:e});if(!r.parsed){let o=new Error(`MISSING_DATA: Cannot parse ${e} for an unknown reason`);throw o.code="MISSING_DATA",o}let s=g5(t).split(","),n=s.length,i;for(let o=0;o<n;o++)try{let a=s[o].trim(),l=cRe(r,a);i=Er.decrypt(l.ciphertext,l.key);break}catch(a){if(o+1>=n)throw a}return Er.parse(i)}function lRe(t){console.log(`[dotenv@${rA}][INFO] ${t}`)}function uRe(t){console.log(`[dotenv@${rA}][WARN] ${t}`)}function T_(t){console.log(`[dotenv@${rA}][DEBUG] ${t}`)}function g5(t){return t&&t.DOTENV_KEY&&t.DOTENV_KEY.length>0?t.DOTENV_KEY:process.env.DOTENV_KEY&&process.env.DOTENV_KEY.length>0?process.env.DOTENV_KEY:""}function cRe(t,e){let r;try{r=new URL(e)}catch(a){if(a.code==="ERR_INVALID_URL"){let l=new Error("INVALID_DOTENV_KEY: Wrong format. Must be in valid uri format like dotenv://:key_1234@dotenvx.com/vault/.env.vault?environment=development");throw l.code="INVALID_DOTENV_KEY",l}throw a}let s=r.password;if(!s){let a=new Error("INVALID_DOTENV_KEY: Missing key part");throw a.code="INVALID_DOTENV_KEY",a}let n=r.searchParams.get("environment");if(!n){let a=new Error("INVALID_DOTENV_KEY: Missing environment part");throw a.code="INVALID_DOTENV_KEY",a}let i=`DOTENV_VAULT_${n.toUpperCase()}`,o=t.parsed[i];if(!o){let a=new Error(`NOT_FOUND_DOTENV_ENVIRONMENT: Cannot locate environment ${i} in your .env.vault file.`);throw a.code="NOT_FOUND_DOTENV_ENVIRONMENT",a}return{ciphertext:o,key:s}}function y5(t){let e=null;if(t&&t.path&&t.path.length>0)if(Array.isArray(t.path))for(let r of t.path)eA.existsSync(r)&&(e=r.endsWith(".vault")?r:`${r}.vault`);else e=t.path.endsWith(".vault")?t.path:`${t.path}.vault`;else e=tA.resolve(process.cwd(),".env.vault");return eA.existsSync(e)?e:null}function m5(t){return t[0]==="~"?tA.join(rRe.homedir(),t.slice(1)):t}function dRe(t){lRe("Loading env from encrypted .env.vault");let e=Er._parseVault(t),r=process.env;return t&&t.processEnv!=null&&(r=t.processEnv),Er.populate(r,e,t),{parsed:e}}function fRe(t){let e=tA.resolve(process.cwd(),".env"),r="utf8",s=!!(t&&t.debug);t&&t.encoding?r=t.encoding:s&&T_("No encoding is specified. UTF-8 is used by default");let n=[e];if(t&&t.path)if(!Array.isArray(t.path))n=[m5(t.path)];else{n=[];for(let l of t.path)n.push(m5(l))}let i,o={};for(let l of n)try{let u=Er.parse(eA.readFileSync(l,{encoding:r}));Er.populate(o,u,t)}catch(u){s&&T_(`Failed to load ${l} ${u.message}`),i=u}let a=process.env;return t&&t.processEnv!=null&&(a=t.processEnv),Er.populate(a,o,t),i?{parsed:o,error:i}:{parsed:o}}function hRe(t){if(g5(t).length===0)return Er.configDotenv(t);let e=y5(t);return e?Er._configVault(t):(uRe(`You set DOTENV_KEY but you are missing a .env.vault file at ${e}. Did you forget to build it?`),Er.configDotenv(t))}function pRe(t,e){let r=Buffer.from(e.slice(-64),"hex"),s=Buffer.from(t,"base64"),n=s.subarray(0,12),i=s.subarray(-16);s=s.subarray(12,-16);try{let o=sRe.createDecipheriv("aes-256-gcm",r,n);return o.setAuthTag(i),`${o.update(s)}${o.final()}`}catch(o){let a=o instanceof RangeError,l=o.message==="Invalid key length",u=o.message==="Unsupported state or unable to authenticate data";if(a||l){let c=new Error("INVALID_DOTENV_KEY: It must be 64 characters long (or more)");throw c.code="INVALID_DOTENV_KEY",c}else if(u){let c=new Error("DECRYPTION_FAILED: Please check your DOTENV_KEY");throw c.code="DECRYPTION_FAILED",c}else throw o}}function mRe(t,e,r={}){let s=!!(r&&r.debug),n=!!(r&&r.override);if(typeof e!="object"){let i=new Error("OBJECT_REQUIRED: Please check the processEnv argument being passed to populate");throw i.code="OBJECT_REQUIRED",i}for(let i of Object.keys(e))Object.prototype.hasOwnProperty.call(t,i)?(n===!0&&(t[i]=e[i]),s&&T_(n===!0?`"${i}" is already defined and WAS overwritten`:`"${i}" is already defined and was NOT overwritten`)):t[i]=e[i]}var Er={configDotenv:fRe,_configVault:dRe,_parseVault:aRe,config:hRe,decrypt:pRe,parse:oRe,populate:mRe};oa.exports.configDotenv=Er.configDotenv;oa.exports._configVault=Er._configVault;oa.exports._parseVault=Er._parseVault;oa.exports.config=Er.config;oa.exports.decrypt=Er.decrypt;oa.exports.parse=Er.parse;oa.exports.populate=Er.populate;oa.exports=Er});var _5=m((KGe,nA)=>{"use strict";var gRe=/at\s{1}(?:.*\.)?plugin\s{1}.*\n\s*(.*)/,yRe=/(\w*(\.\w*)*)\..*/;nA.exports=function(e){if(e.name.length>0)return e.name;let r=Error.stackTraceLimit;Error.stackTraceLimit=10;try{throw new Error("anonymous function")}catch(s){return Error.stackTraceLimit=r,v5(s.stack)}};function v5(t){let e=t.match(gRe);return e?e[1].split(/[/\\]/).slice(-1)[0].match(yRe)[1]:"anonymous"}nA.exports.extractPluginName=v5});var b5=m((QGe,S5)=>{"use strict";S5.exports=function(e){return e[0]==="@"&&(e=e.slice(1).replace("/","-")),e.replace(/-(.)/g,function(s,n){return n.toUpperCase()})}});var Uu=m((WGe,C_)=>{"use strict";var vRe=_5(),_Re=b5(),SRe=0;function iA(t,e={}){let r=!1;if(typeof t.default<"u"&&(t=t.default),typeof t!="function")throw new TypeError(`fastify-plugin expects a function, instead got a '${typeof t}'`);if(typeof e=="string"&&(e={fastify:e}),typeof e!="object"||Array.isArray(e)||e===null)throw new TypeError("The options object should be an object");if(e.fastify!==void 0&&typeof e.fastify!="string")throw new TypeError(`fastify-plugin expects a version string, instead got '${typeof e.fastify}'`);e.name||(r=!0,e.name=vRe(t)+"-auto-"+SRe++),t[Symbol.for("skip-override")]=e.encapsulate!==!0,t[Symbol.for("fastify.display-name")]=e.name,t[Symbol.for("plugin-meta")]=e,t.default||(t.default=t);let s=_Re(e.name);return!r&&!t[s]&&(t[s]=t),t}C_.exports=iA;C_.exports.default=iA;C_.exports.fastifyPlugin=iA});var T5=m((ZGe,w5)=>{"use strict";function bRe(t,e){let r=Array.from(t.matchAll(e));return r.length>0?r.slice(-1)[0].index:-1}function E5(t,e,r){let s=bRe(t,/(?!(?<=\\))\$/g);if(s===-1)return t;let n=t.slice(s),i=/((?!(?<=\\))\${?([\w]+)(?::-([^}\\]*))?}?)/,o=n.match(i);if(o!=null){let[,a,l,u]=o;return E5(t.replace(a,e[l]||u||r.parsed[l]||""),e,r)}return t}function ERe(t){return t.replace(/\\\$/g,"$")}function wRe(t){let e=t.ignoreProcessEnv?{}:process.env;for(let r in t.parsed){let s=Object.prototype.hasOwnProperty.call(e,r)?e[r]:t.parsed[r];t.parsed[r]=ERe(E5(s,e,t))}for(let r in t.parsed)e[r]=t.parsed[r];return t}w5.exports.expand=wRe});var P5=m((YGe,O_)=>{"use strict";var C5=Nd(),R5={keyword:"separator",type:"string",metaSchema:{type:"string",description:"value separator"},modifying:!0,valid:!0,errors:!1,compile:t=>(e,{parentData:r,parentDataProperty:s})=>{r[s]=e===""?[]:e.split(t)}},TRe={type:"object",required:["schema"],properties:{schema:{type:"object",additionalProperties:!0},data:{oneOf:[{type:"array",items:{type:"object"},minItems:1},{type:"object"}],default:{}},env:{type:"boolean",default:!0},dotenv:{type:["boolean","object"],default:!1},expandEnv:{type:["boolean"],default:!1},ajv:{type:"object",additionalProperties:!0}}},aA=O5(),oA=aA.compile(TRe);function R_(t){let e=Object.assign({},t);if(e.schema&&e.schema[Symbol.for("fluent-schema-object")]&&(e.schema=e.schema.valueOf()),!oA(e)){let d=new Error(aA.errorsText(oA.errors,{dataVar:"opts"}));throw d.errors=oA.errors,d}let{schema:s}=e;s.additionalProperties=!1;let{data:n,dotenv:i,env:o,expandEnv:a}=e;Array.isArray(n)||(n=[n]),i&&sA().config(Object.assign({},i)),o&&n.unshift(process.env);let l={};n.forEach(d=>Object.assign(l,d)),a&&T5().expand({ignoreProcessEnv:!0,parsed:l});let u=CRe(aA,e.ajv);if(!u.validate(s,l)){let d=new Error(u.errorsText(u.errors,{dataVar:"env"}));throw d.errors=u.errors,d}return l}function CRe(t,e){if(e){if(typeof e=="object"&&typeof e.customOptions=="function"){let r=e.customOptions(O5());if(!(r instanceof C5))throw new TypeError("customOptions function must return an instance of Ajv");return r}}else return t;return e}function O5(){return new C5({allErrors:!0,removeAdditional:!0,useDefaults:!0,coerceTypes:!0,allowUnionTypes:!0,addUsedSchema:!1,keywords:[R5]})}R_.keywords={separator:R5};O_.exports=R_;O_.exports.default=R_;O_.exports.envSchema=R_});var A5=m((JGe,P_)=>{"use strict";var RRe=Uu(),ORe=P5();function lA(t,e,r){try{let s=ORe(e),n=e.confKey||"config";t.decorate(n,s),t.hasDecorator("getEnvs")||t.decorate("getEnvs",()=>s),t.hasRequestDecorator("getEnvs")||t.decorateRequest("getEnvs",()=>s),r()}catch(s){r(s)}}P_.exports=RRe(lA,{fastify:"4.x",name:"@fastify/env"});P_.exports.default=lA;P_.exports.fastifyEnv=lA});var x5=m((XGe,k5)=>{function ro(t){if(typeof t!="function")throw new Error("obliterator/iterator: expecting a function!");this.next=t}typeof Symbol<"u"&&(ro.prototype[Symbol.iterator]=function(){return this});ro.of=function(){var t=arguments,e=t.length,r=0;return new ro(function(){return r>=e?{done:!0}:{done:!1,value:t[r++]}})};ro.empty=function(){var t=new ro(function(){return{done:!0}});return t};ro.fromSequence=function(t){var e=0,r=t.length;return new ro(function(){return e>=r?{done:!0}:{done:!1,value:t[e++]}})};ro.is=function(t){return t instanceof ro?!0:typeof t=="object"&&t!==null&&typeof t.next=="function"};k5.exports=ro});var I5=m(uA=>{uA.ARRAY_BUFFER_SUPPORT=typeof ArrayBuffer<"u";uA.SYMBOL_SUPPORT=typeof Symbol<"u"});var cA=m((t8e,D5)=>{var N5=I5(),PRe=N5.ARRAY_BUFFER_SUPPORT,ARe=N5.SYMBOL_SUPPORT;D5.exports=function(e,r){var s,n,i,o,a;if(!e)throw new Error("obliterator/forEach: invalid iterable.");if(typeof r!="function")throw new Error("obliterator/forEach: expecting a callback.");if(Array.isArray(e)||PRe&&ArrayBuffer.isView(e)||typeof e=="string"||e.toString()==="[object Arguments]"){for(i=0,o=e.length;i<o;i++)r(e[i],i);return}if(typeof e.forEach=="function"){e.forEach(r);return}if(ARe&&Symbol.iterator in e&&typeof e.next!="function"&&(e=e[Symbol.iterator]()),typeof e.next=="function"){for(s=e,i=0;a=s.next(),a.done!==!0;)r(a.value,i),i++;return}for(n in e)e.hasOwnProperty(n)&&r(e[n],n)}});var dA=m(so=>{var kRe=Math.pow(2,8)-1,xRe=Math.pow(2,16)-1,IRe=Math.pow(2,32)-1,NRe=Math.pow(2,7)-1,DRe=Math.pow(2,15)-1,MRe=Math.pow(2,31)-1;so.getPointerArray=function(t){var e=t-1;if(e<=kRe)return Uint8Array;if(e<=xRe)return Uint16Array;if(e<=IRe)return Uint32Array;throw new Error("mnemonist: Pointer Array of size > 4294967295 is not supported.")};so.getSignedPointerArray=function(t){var e=t-1;return e<=NRe?Int8Array:e<=DRe?Int16Array:e<=MRe?Int32Array:Float64Array};so.getNumberType=function(t){return t===(t|0)?Math.sign(t)===-1?t<=127&&t>=-128?Int8Array:t<=32767&&t>=-32768?Int16Array:Int32Array:t<=255?Uint8Array:t<=65535?Uint16Array:Uint32Array:Float64Array};var $Re={Uint8Array:1,Int8Array:2,Uint16Array:3,Int16Array:4,Uint32Array:5,Int32Array:6,Float32Array:7,Float64Array:8};so.getMinimalRepresentation=function(t,e){var r=null,s=0,n,i,o,a,l;for(a=0,l=t.length;a<l;a++)o=e?e(t[a]):t[a],i=so.getNumberType(o),n=$Re[i.name],n>s&&(s=n,r=i);return r};so.isTypedArray=function(t){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView(t)};so.concat=function(){var t=0,e,r,s;for(e=0,s=arguments.length;e<s;e++)t+=arguments[e].length;var n=new arguments[0].constructor(t);for(e=0,r=0;e<s;e++)n.set(arguments[e],r),r+=arguments[e].length;return n};so.indices=function(t){for(var e=so.getPointerArray(t),r=new e(t),s=0;s<t;s++)r[s]=s;return r}});var q5=m(Lm=>{var M5=cA(),$5=dA();function qRe(t){return Array.isArray(t)||$5.isTypedArray(t)}function fA(t){if(typeof t.length=="number")return t.length;if(typeof t.size=="number")return t.size}function LRe(t){var e=fA(t),r=typeof e=="number"?new Array(e):[],s=0;return M5(t,function(n){r[s++]=n}),r}function jRe(t){var e=fA(t),r=typeof e=="number"?$5.getPointerArray(e):Array,s=typeof e=="number"?new Array(e):[],n=typeof e=="number"?new r(e):[],i=0;return M5(t,function(o){s[i]=o,n[i]=i++}),[s,n]}Lm.isArrayLike=qRe;Lm.guessLength=fA;Lm.toArray=LRe;Lm.toArrayWithIndices=jRe});var j5=m((n8e,L5)=>{var hA=x5(),FRe=cA(),BRe=dA(),zRe=q5();function _r(t,e,r){if(arguments.length<2&&(r=t,t=null,e=null),this.capacity=r,typeof this.capacity!="number"||this.capacity<=0)throw new Error("mnemonist/lru-cache: capacity should be positive number.");if(!isFinite(this.capacity)||Math.floor(this.capacity)!==this.capacity)throw new Error("mnemonist/lru-cache: capacity should be a finite positive integer.");var s=BRe.getPointerArray(r);this.forward=new s(r),this.backward=new s(r),this.K=typeof t=="function"?new t(r):new Array(r),this.V=typeof e=="function"?new e(r):new Array(r),this.size=0,this.head=0,this.tail=0,this.items={}}_r.prototype.clear=function(){this.size=0,this.head=0,this.tail=0,this.items={}};_r.prototype.splayOnTop=function(t){var e=this.head;if(this.head===t)return this;var r=this.backward[t],s=this.forward[t];return this.tail===t?this.tail=r:this.backward[s]=r,this.forward[r]=s,this.backward[e]=t,this.head=t,this.forward[t]=e,this};_r.prototype.set=function(t,e){var r=this.items[t];if(typeof r<"u"){this.splayOnTop(r),this.V[r]=e;return}this.size<this.capacity?r=this.size++:(r=this.tail,this.tail=this.backward[r],delete this.items[this.K[r]]),this.items[t]=r,this.K[r]=t,this.V[r]=e,this.forward[r]=this.head,this.backward[this.head]=r,this.head=r};_r.prototype.setpop=function(t,e){var r=null,s=null,n=this.items[t];return typeof n<"u"?(this.splayOnTop(n),r=this.V[n],this.V[n]=e,{evicted:!1,key:t,value:r}):(this.size<this.capacity?n=this.size++:(n=this.tail,this.tail=this.backward[n],r=this.V[n],s=this.K[n],delete this.items[this.K[n]]),this.items[t]=n,this.K[n]=t,this.V[n]=e,this.forward[n]=this.head,this.backward[this.head]=n,this.head=n,s?{evicted:!0,key:s,value:r}:null)};_r.prototype.has=function(t){return t in this.items};_r.prototype.get=function(t){var e=this.items[t];if(!(typeof e>"u"))return this.splayOnTop(e),this.V[e]};_r.prototype.peek=function(t){var e=this.items[t];if(!(typeof e>"u"))return this.V[e]};_r.prototype.forEach=function(t,e){e=arguments.length>1?e:this;for(var r=0,s=this.size,n=this.head,i=this.K,o=this.V,a=this.forward;r<s;)t.call(e,o[n],i[n],this),n=a[n],r++};_r.prototype.keys=function(){var t=0,e=this.size,r=this.head,s=this.K,n=this.forward;return new hA(function(){if(t>=e)return{done:!0};var i=s[r];return t++,t<e&&(r=n[r]),{done:!1,value:i}})};_r.prototype.values=function(){var t=0,e=this.size,r=this.head,s=this.V,n=this.forward;return new hA(function(){if(t>=e)return{done:!0};var i=s[r];return t++,t<e&&(r=n[r]),{done:!1,value:i}})};_r.prototype.entries=function(){var t=0,e=this.size,r=this.head,s=this.K,n=this.V,i=this.forward;return new hA(function(){if(t>=e)return{done:!0};var o=s[r],a=n[r];return t++,t<e&&(r=i[r]),{done:!1,value:[o,a]}})};typeof Symbol<"u"&&(_r.prototype[Symbol.iterator]=_r.prototype.entries);_r.prototype.inspect=function(){for(var t=new Map,e=this.entries(),r;r=e.next(),!r.done;)t.set(r.value[0],r.value[1]);return Object.defineProperty(t,"constructor",{value:_r,enumerable:!1}),t};typeof Symbol<"u"&&(_r.prototype[Symbol.for("nodejs.util.inspect.custom")]=_r.prototype.inspect);_r.from=function(t,e,r,s){if(arguments.length<2){if(s=zRe.guessLength(t),typeof s!="number")throw new Error("mnemonist/lru-cache.from: could not guess iterable length. Please provide desired capacity as last argument.")}else arguments.length===2&&(s=e,e=null,r=null);var n=new _r(e,r,s);return FRe(t,function(i,o){n.set(o,i)}),n};L5.exports=_r});var B5=m((i8e,jm)=>{"use strict";var URe=j5(),VRe=/^[!#$%&'*+\-.^\w`|~]+$/u;function HRe(t){if(VRe.test(t)===!1)throw new TypeError("Fieldname contains invalid characters.")}function F5(t){t=t.trim().toLowerCase();let e=[];if(t.length!==0)if(t.indexOf(",")===-1)e.push(t);else{let r=t.length,s=0,n=0,i;for(s=0;s<r;++s)i=t[s],i===" "?n=s+1:i===","&&(n!==s&&e.push(t.slice(n,s)),n=s+1);n!==s&&e.push(t.slice(n,s))}return e}function pA(t){let e=new URe(1e3);return HRe(t),function(r){let s=r.getHeader("Vary");if(!s){r.header("Vary",t);return}if(s==="*")return;if(t==="*"){r.header("Vary","*");return}if(Array.isArray(s)&&(s=s.join(", ")),!e.has(s)){let i=F5(s);i.indexOf("*")!==-1?e.set(s,"*"):i.indexOf(t.toLowerCase())===-1?e.set(s,s+", "+t):e.set(s,null)}let n=e.get(s);n!==null&&r.header("Vary",n)}}jm.exports.createAddFieldnameToVary=pA;jm.exports.addOriginToVaryHeader=pA("Origin");jm.exports.addAccessControlRequestHeadersToVaryHeader=pA("Access-Control-Request-Headers");jm.exports.parse=F5});var G5=m((o8e,k_)=>{"use strict";var GRe=Uu(),{addAccessControlRequestHeadersToVaryHeader:KRe,addOriginToVaryHeader:QRe}=B5(),gA={origin:"*",methods:"GET,HEAD,PUT,PATCH,POST,DELETE",hook:"onRequest",preflightContinue:!1,optionsSuccessStatus:204,credentials:!1,exposedHeaders:null,allowedHeaders:null,maxAge:null,preflight:!0,strictPreflight:!0},WRe=["onRequest","preParsing","preValidation","preHandler","preSerialization","onSend"],mA=["preSerialization","preParsing","onSend"];function V5(t,e){WRe.indexOf(t)===-1&&e(new TypeError("@fastify/cors: Invalid hook option provided."))}function ZRe(t,e,r){t.decorateRequest("corsPreflightEnabled",!1);let s=!0;if(typeof e=="function")z5(e,t,{hook:gA.hook},r);else if(e.delegator){let{delegator:n,...i}=e;z5(n,t,i,r)}else{e.hideOptionsRoute!==void 0&&(s=e.hideOptionsRoute);let n=A_(e);V5(n.hook,r),mA.indexOf(n.hook)!==-1?t.addHook(n.hook,function(o,a,l,u){Fm(t,n,o,a,u)}):t.addHook(n.hook,function(o,a,l){Fm(t,n,o,a,l)})}t.options("*",{schema:{hide:s}},(n,i)=>{if(!n.corsPreflightEnabled){i.callNotFound();return}i.send()}),r()}function z5(t,e,r,s){let n=r&&r.hook||gA.hook;V5(n,s),t.length===2?mA.indexOf(n)!==-1?e.addHook(n,function(o,a,l,u){U5(t,e,o,a,u)}):e.addHook(n,function(o,a,l){U5(t,e,o,a,l)}):mA.indexOf(n)!==-1?e.addHook(n,function(o,a,l,u){let c=t(o);if(c&&typeof c.then=="function"){c.then(d=>Fm(e,A_(d,!0),o,a,u)).catch(u);return}u(new Error("Invalid CORS origin option"))}):e.addHook(n,function(o,a,l){let u=t(o);if(u&&typeof u.then=="function"){u.then(c=>Fm(e,A_(c,!0),o,a,l)).catch(l);return}l(new Error("Invalid CORS origin option"))})}function U5(t,e,r,s,n){t(r,(i,o)=>{i?n(i):Fm(e,A_(o,!0),r,s,n)})}function A_(t,e){let r={...gA,...t};return Array.isArray(t.origin)&&t.origin.indexOf("*")!==-1&&(r.origin="*"),Number.isInteger(r.cacheControl)?r.cacheControl=`max-age=${r.cacheControl}`:typeof r.cacheControl!="string"&&(r.cacheControl=null),r.dynamic=e||!1,r}function Fm(t,e,r,s,n){(typeof e.origin!="string"&&e.origin!==!1||e.dynamic)&&QRe(s),(typeof e.origin=="function"?XRe(t,e.origin):(o,a)=>a(null,e.origin))(r,(o,a)=>{if(o!==null)return n(o);if(a===!1)return n();if(!a)return n(new Error("Invalid CORS origin option"));if(YRe(r,s,a,e),r.raw.method==="OPTIONS"&&e.preflight===!0){if(e.strictPreflight===!0&&(!r.headers.origin||!r.headers["access-control-request-method"])){s.status(400).type("text/plain").send("Invalid Preflight Request");return}if(r.corsPreflightEnabled=!0,JRe(r,s,e),!e.preflightContinue){s.code(e.optionsSuccessStatus).header("Content-Length","0").send();return}}return n()})}function YRe(t,e,r,s){let n=e1e(t.headers.origin,r);n&&e.header("Access-Control-Allow-Origin",n),s.credentials&&e.header("Access-Control-Allow-Credentials","true"),s.exposedHeaders!==null&&e.header("Access-Control-Expose-Headers",Array.isArray(s.exposedHeaders)?s.exposedHeaders.join(", "):s.exposedHeaders)}function JRe(t,e,r){if(e.header("Access-Control-Allow-Methods",Array.isArray(r.methods)?r.methods.join(", "):r.methods),r.allowedHeaders===null){KRe(e);let s=t.headers["access-control-request-headers"];s!==void 0&&e.header("Access-Control-Allow-Headers",s)}else e.header("Access-Control-Allow-Headers",Array.isArray(r.allowedHeaders)?r.allowedHeaders.join(", "):r.allowedHeaders);r.maxAge!==null&&e.header("Access-Control-Max-Age",String(r.maxAge)),r.cacheControl&&e.header("Cache-Control",r.cacheControl)}function XRe(t,e){return function(r,s){let n=e.call(t,r.headers.origin,s);n&&typeof n.then=="function"&&n.then(i=>s(null,i),s)}}function e1e(t,e){return typeof e=="string"?e:H5(t,e)?t:!1}function H5(t,e){if(Array.isArray(e)){for(let r=0;r<e.length;++r)if(H5(t,e[r]))return!0;return!1}else return typeof e=="string"?t===e:e instanceof RegExp?(e.lastIndex=0,e.test(t)):!!e}var yA=GRe(ZRe,{fastify:"4.x",name:"@fastify/cors"});k_.exports=yA;k_.exports.fastifyCors=yA;k_.exports.default=yA});var Q5=m((a8e,K5)=>{"use strict";var x_=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function t1e(t,e){if(typeof t!="string")throw new TypeError("argument str must be a string");let r=e?.decode||decodeURIComponent,s={},n=t.length,i=0,o=0;for(;o!==n;){o=t.indexOf(";",i),o===-1&&(o=n);let a=t.indexOf("=",i);if(a===-1)break;if(a>o){i=o+1;continue}let l=t.substring(i,a++).trim();if(s[l]===void 0){let u=t.charCodeAt(a)===34?t.substring(a+1,o-1).trim():t.substring(a,o).trim();s[l]=r===decodeURIComponent&&u.indexOf("%")===-1?u:s1e(u,r)}i=o+1}return s}function r1e(t,e,r){let s=r?.encode||encodeURIComponent;if(typeof s!="function")throw new TypeError("option encode is invalid");if(t&&!x_.test(t))throw new TypeError("argument name is invalid");let n=s(e);if(n&&!x_.test(n))throw new TypeError("argument val is invalid");let i=t+"="+n;if(r==null)return i;if(r.maxAge!=null){let o=+r.maxAge;if(!isFinite(o))throw new TypeError("option maxAge is invalid");i+="; Max-Age="+Math.trunc(o)}if(r.domain){if(!x_.test(r.domain))throw new TypeError("option domain is invalid");i+="; Domain="+r.domain}if(r.path){if(!x_.test(r.path))throw new TypeError("option path is invalid");i+="; Path="+r.path}if(r.priority)switch(typeof r.priority=="string"?r.priority.toLowerCase():r.priority){case"low":i+="; Priority=Low";break;case"medium":i+="; Priority=Medium";break;case"high":i+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(r.expires){if(typeof r.expires.toUTCString!="function")throw new TypeError("option expires is invalid");i+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(i+="; HttpOnly"),r.secure&&(i+="; Secure"),r.partitioned&&(i+="; Partitioned"),r.sameSite)switch(typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite){case!0:i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"strict":i+="; SameSite=Strict";break;case"none":i+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return i}function s1e(t,e){try{return e(t)}catch{return t}}K5.exports={parse:t1e,serialize:r1e}});var J5=m((l8e,nf)=>{"use strict";var Bm=require("node:crypto"),W5=/=/gu;function Vu(t,e="sha256"){if(!(this instanceof Vu))return new Vu(t,e);this.secrets=Array.isArray(t)?t:[t],this.signingKey=this.secrets[0],this.algorithm=e,vA(this.secrets),n1e(this.algorithm)}function vA(t){for(let e=0;e<t.length;++e){let r=t[e];if(typeof r!="string"&&Buffer.isBuffer(r)===!1)throw new TypeError("Secret key must be a string or Buffer.")}}function n1e(t){try{Bm.createHmac(t,Bm.randomBytes(16))}catch{throw new TypeError(`Algorithm ${t} not supported.`)}}function Z5(t,e,r){if(typeof t!="string")throw new TypeError("Cookie value must be provided as a string.");return t+"."+Bm.createHmac(r,e).update(t).digest("base64").replace(W5,"")}function Y5(t,e,r){if(typeof t!="string")throw new TypeError("Signed cookie string must be provided.");let s=t.slice(0,t.lastIndexOf(".")),n=Buffer.from(t.slice(t.lastIndexOf(".")+1));for(let i=0;i<e.length;++i){let o=e[i],a=Buffer.from(Bm.createHmac(r,o).update(s).digest("base64").replace(W5,""));if(a.length===n.length&&Bm.timingSafeEqual(a,n))return{valid:!0,renew:o!==e[0],value:s}}return{valid:!1,renew:!1,value:null}}Vu.prototype.sign=function(t){return Z5(t,this.signingKey,this.algorithm)};Vu.prototype.unsign=function(t){return Y5(t,this.secrets,this.algorithm)};function i1e(t,e,r="sha256"){let s=Array.isArray(e)?e:[e];return vA(s),Z5(t,s[0],r)}function o1e(t,e,r="sha256"){let s=Array.isArray(e)?e:[e];return vA(s),Y5(t,s,r)}nf.exports=Vu;nf.exports.signerFactory=Vu;nf.exports.Signer=Vu;nf.exports.sign=i1e;nf.exports.unsign=o1e});var tG=m((u8e,no)=>{"use strict";var a1e=Uu(),of=Q5(),{Signer:SA,sign:l1e,unsign:u1e}=J5(),Si=Symbol("fastify.reply.setCookies"),bA=Symbol("fastify.reply.setCookiesHookRan");function X5(t,e,r,s){_A(t.server,t.request,t);let n=Object.assign({},s);return n.expires&&Number.isInteger(n.expires)&&(n.expires=new Date(n.expires)),n.signed&&(r=t.signCookie(r)),n.secure==="auto"&&(m1e(t.request)?n.secure=!0:(n.sameSite="lax",n.secure=!1)),t[Si].set(`${e};${n.domain};${n.path||"/"}`,{name:e,value:r,opts:n}),t[bA]&&eG(t),t}function c1e(t,e,r){let s=Object.assign({path:"/"},r,{expires:new Date(1),signed:void 0,maxAge:void 0});return X5(t,e,"",s)}function _A(t,e,r){if(r[Si])return;let s=e.raw.headers.cookie;e.cookies=s?t.parseCookie(s):{},r[Si]=new Map}function d1e(t,e){return e==="preParsing"?function(s,n,i,o){_A(t,s,n),o()}:function(s,n,i){_A(t,s,n),i()}}function eG(t){let e=t.getHeader("Set-Cookie"),r;if(e===void 0){if(t[Si].size===1){let s=t[Si].values().next().value;t.header("Set-Cookie",of.serialize(s.name,s.value,s.opts)),t[Si].clear();return}r=[]}else typeof e=="string"?r=[e]:r=e;for(let s of t[Si].values())r.push(of.serialize(s.name,s.value,s.opts));t.removeHeader("Set-Cookie"),t.header("Set-Cookie",r),t[Si].clear()}function f1e(t,e,r,s){if(!e[Si]){s();return}e[Si].size&&eG(e),e[bA]=!0,s()}function h1e(t,e,r){let s=e.secret,n=p1e(e.hook);if(n===void 0)return r(new Error("@fastify/cookie: Invalid value provided for the hook-option. You can set the hook-option only to false, 'onRequest' , 'preParsing' , 'preValidation' or 'preHandler'"));let o=!s||typeof s.sign=="function"&&typeof s.unsign=="function"?s:new SA(s,e.algorithm||"sha256");t.decorate("serializeCookie",of.serialize),t.decorate("parseCookie",a),s!==void 0&&(t.decorate("signCookie",l),t.decorate("unsignCookie",u),t.decorateRequest("signCookie",l),t.decorateRequest("unsignCookie",u),t.decorateReply("signCookie",l),t.decorateReply("unsignCookie",u)),t.decorateRequest("cookies",null),t.decorateReply(Si,null),t.decorateReply(bA,!1),t.decorateReply("cookie",c),t.decorateReply("setCookie",c),t.decorateReply("clearCookie",d),n&&(t.addHook(n,d1e(t,n)),t.addHook("onSend",f1e)),r();function a(f){return of.parse(f,e.parseOptions)}function l(f){return o.sign(f)}function u(f){return o.unsign(f)}function c(f,h,p){let g=Object.assign({},e.parseOptions,p);return X5(this,f,h,g)}function d(f,h){let p=Object.assign({},e.parseOptions,h);return c1e(this,f,p)}}function p1e(t="onRequest"){return{onRequest:"onRequest",preParsing:"preParsing",preValidation:"preValidation",preHandler:"preHandler",[!1]:!1}[t]}function m1e(t){return t.raw.socket?.encrypted===!0||t.headers["x-forwarded-proto"]==="https"}var EA=a1e(h1e,{fastify:"4.x",name:"@fastify/cookie"});no.exports=EA;no.exports.default=EA;no.exports.fastifyCookie=EA;no.exports.serialize=of.serialize;no.exports.parse=of.parse;no.exports.signerFactory=SA;no.exports.Signer=SA;no.exports.sign=l1e;no.exports.unsign=u1e});var sG=m((c8e,rG)=>{"use strict";rG.exports=t=>encodeURIComponent(t).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`)});var lG=m((d8e,aG)=>{"use strict";var oG="%[a-f0-9]{2}",nG=new RegExp("("+oG+")|([^%]+?)","gi"),iG=new RegExp("("+oG+")+","gi");function wA(t,e){try{return[decodeURIComponent(t.join(""))]}catch{}if(t.length===1)return t;e=e||1;var r=t.slice(0,e),s=t.slice(e);return Array.prototype.concat.call([],wA(r),wA(s))}function g1e(t){try{return decodeURIComponent(t)}catch{for(var e=t.match(nG)||[],r=1;r<e.length;r++)t=wA(e,r).join(""),e=t.match(nG)||[];return t}}function y1e(t){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=iG.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{var s=g1e(r[0]);s!==r[0]&&(e[r[0]]=s)}r=iG.exec(t)}e["%C2"]="\uFFFD";for(var n=Object.keys(e),i=0;i<n.length;i++){var o=n[i];t=t.replace(new RegExp(o,"g"),e[o])}return t}aG.exports=function(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch{return y1e(t)}}});var cG=m((f8e,uG)=>{"use strict";uG.exports=(t,e)=>{if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[t];let r=t.indexOf(e);return r===-1?[t]:[t.slice(0,r),t.slice(r+e.length)]}});var vG=m(aa=>{"use strict";var v1e=sG(),_1e=lG(),fG=cG(),S1e=t=>t==null;function b1e(t){switch(t.arrayFormat){case"index":return e=>(r,s)=>{let n=r.length;return s===void 0||t.skipNull&&s===null||t.skipEmptyString&&s===""?r:s===null?[...r,[Qr(e,t),"[",n,"]"].join("")]:[...r,[Qr(e,t),"[",Qr(n,t),"]=",Qr(s,t)].join("")]};case"bracket":return e=>(r,s)=>s===void 0||t.skipNull&&s===null||t.skipEmptyString&&s===""?r:s===null?[...r,[Qr(e,t),"[]"].join("")]:[...r,[Qr(e,t),"[]=",Qr(s,t)].join("")];case"comma":case"separator":return e=>(r,s)=>s==null||s.length===0?r:r.length===0?[[Qr(e,t),"=",Qr(s,t)].join("")]:[[r,Qr(s,t)].join(t.arrayFormatSeparator)];default:return e=>(r,s)=>s===void 0||t.skipNull&&s===null||t.skipEmptyString&&s===""?r:s===null?[...r,Qr(e,t)]:[...r,[Qr(e,t),"=",Qr(s,t)].join("")]}}function E1e(t){let e;switch(t.arrayFormat){case"index":return(r,s,n)=>{if(e=/\[(\d*)\]$/.exec(r),r=r.replace(/\[\d*\]$/,""),!e){n[r]=s;return}n[r]===void 0&&(n[r]={}),n[r][e[1]]=s};case"bracket":return(r,s,n)=>{if(e=/(\[\])$/.exec(r),r=r.replace(/\[\]$/,""),!e){n[r]=s;return}if(n[r]===void 0){n[r]=[s];return}n[r]=[].concat(n[r],s)};case"comma":case"separator":return(r,s,n)=>{let o=typeof s=="string"&&s.split("").indexOf(t.arrayFormatSeparator)>-1?s.split(t.arrayFormatSeparator).map(a=>zm(a,t)):s===null?s:zm(s,t);n[r]=o};default:return(r,s,n)=>{if(n[r]===void 0){n[r]=s;return}n[r]=[].concat(n[r],s)}}}function hG(t){if(typeof t!="string"||t.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function Qr(t,e){return e.encode?e.strict?v1e(t):encodeURIComponent(t):t}function zm(t,e){return e.decode?_1e(t):t}function pG(t){return Array.isArray(t)?t.sort():typeof t=="object"?pG(Object.keys(t)).sort((e,r)=>Number(e)-Number(r)).map(e=>t[e]):t}function mG(t){let e=t.indexOf("#");return e!==-1&&(t=t.slice(0,e)),t}function w1e(t){let e="",r=t.indexOf("#");return r!==-1&&(e=t.slice(r)),e}function gG(t){t=mG(t);let e=t.indexOf("?");return e===-1?"":t.slice(e+1)}function dG(t,e){return e.parseNumbers&&!Number.isNaN(Number(t))&&typeof t=="string"&&t.trim()!==""?t=Number(t):e.parseBooleans&&t!==null&&(t.toLowerCase()==="true"||t.toLowerCase()==="false")&&(t=t.toLowerCase()==="true"),t}function yG(t,e){e=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},e),hG(e.arrayFormatSeparator);let r=E1e(e),s=Object.create(null);if(typeof t!="string"||(t=t.trim().replace(/^[?#&]/,""),!t))return s;for(let n of t.split("&")){let[i,o]=fG(e.decode?n.replace(/\+/g," "):n,"=");o=o===void 0?null:["comma","separator"].includes(e.arrayFormat)?o:zm(o,e),r(zm(i,e),o,s)}for(let n of Object.keys(s)){let i=s[n];if(typeof i=="object"&&i!==null)for(let o of Object.keys(i))i[o]=dG(i[o],e);else s[n]=dG(i,e)}return e.sort===!1?s:(e.sort===!0?Object.keys(s).sort():Object.keys(s).sort(e.sort)).reduce((n,i)=>{let o=s[i];return o&&typeof o=="object"&&!Array.isArray(o)?n[i]=pG(o):n[i]=o,n},Object.create(null))}aa.extract=gG;aa.parse=yG;aa.stringify=(t,e)=>{if(!t)return"";e=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},e),hG(e.arrayFormatSeparator);let r=o=>e.skipNull&&S1e(t[o])||e.skipEmptyString&&t[o]==="",s=b1e(e),n={};for(let o of Object.keys(t))r(o)||(n[o]=t[o]);let i=Object.keys(n);return e.sort!==!1&&i.sort(e.sort),i.map(o=>{let a=t[o];return a===void 0?"":a===null?Qr(o,e):Array.isArray(a)?a.reduce(s(o),[]).join("&"):Qr(o,e)+"="+Qr(a,e)}).filter(o=>o.length>0).join("&")};aa.parseUrl=(t,e)=>{e=Object.assign({decode:!0},e);let[r,s]=fG(t,"#");return Object.assign({url:r.split("?")[0]||"",query:yG(gG(t),e)},e&&e.parseFragmentIdentifier&&s?{fragmentIdentifier:zm(s,e)}:{})};aa.stringifyUrl=(t,e)=>{e=Object.assign({encode:!0,strict:!0},e);let r=mG(t.url).split("?")[0]||"",s=aa.extract(t.url),n=aa.parse(s,{sort:!1}),i=Object.assign(n,t.query),o=aa.stringify(i,e);o&&(o=`?${o}`);let a=w1e(t.url);return t.fragmentIdentifier&&(a=`#${Qr(t.fragmentIdentifier,e)}`),`${r}${o}${a}`}});var I_=m(io=>{"use strict";Object.defineProperty(io,"__esModule",{value:!0});io.getDefaultOptions=io.defaultOptions=io.ignoreOverride=void 0;io.ignoreOverride=Symbol("Let zodToJsonSchema decide on which parser to use");io.defaultOptions={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"};var T1e=t=>typeof t=="string"?{...io.defaultOptions,name:t}:{...io.defaultOptions,...t};io.getDefaultOptions=T1e});var TA=m(N_=>{"use strict";Object.defineProperty(N_,"__esModule",{value:!0});N_.getRefs=void 0;var C1e=I_(),R1e=t=>{let e=(0,C1e.getDefaultOptions)(t),r=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([s,n])=>[n._def,{def:n._def,path:[...e.basePath,e.definitionPath,s],jsonSchema:void 0}]))}};N_.getRefs=R1e});var ll=m(lf=>{"use strict";Object.defineProperty(lf,"__esModule",{value:!0});lf.setResponseValueAndErrors=lf.addErrorMessage=void 0;function bG(t,e,r,s){s?.errorMessages&&r&&(t.errorMessage={...t.errorMessage,[e]:r})}lf.addErrorMessage=bG;function O1e(t,e,r,s,n){t[e]=r,bG(t,e,s,n)}lf.setResponseValueAndErrors=O1e});var Um=m(Tt=>{"use strict";Object.defineProperty(Tt,"__esModule",{value:!0});Tt.getParsedType=Tt.ZodParsedType=Tt.objectUtil=Tt.util=void 0;var EG;(function(t){t.assertEqual=n=>n;function e(n){}t.assertIs=e;function r(n){throw new Error}t.assertNever=r,t.arrayToEnum=n=>{let i={};for(let o of n)i[o]=o;return i},t.getValidEnumValues=n=>{let i=t.objectKeys(n).filter(a=>typeof n[n[a]]!="number"),o={};for(let a of i)o[a]=n[a];return t.objectValues(o)},t.objectValues=n=>t.objectKeys(n).map(function(i){return n[i]}),t.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{let i=[];for(let o in n)Object.prototype.hasOwnProperty.call(n,o)&&i.push(o);return i},t.find=(n,i)=>{for(let o of n)if(i(o))return o},t.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&isFinite(n)&&Math.floor(n)===n;function s(n,i=" | "){return n.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}t.joinValues=s,t.jsonStringifyReplacer=(n,i)=>typeof i=="bigint"?i.toString():i})(EG=Tt.util||(Tt.util={}));var P1e;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(P1e=Tt.objectUtil||(Tt.objectUtil={}));Tt.ZodParsedType=EG.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]);var A1e=t=>{switch(typeof t){case"undefined":return Tt.ZodParsedType.undefined;case"string":return Tt.ZodParsedType.string;case"number":return isNaN(t)?Tt.ZodParsedType.nan:Tt.ZodParsedType.number;case"boolean":return Tt.ZodParsedType.boolean;case"function":return Tt.ZodParsedType.function;case"bigint":return Tt.ZodParsedType.bigint;case"symbol":return Tt.ZodParsedType.symbol;case"object":return Array.isArray(t)?Tt.ZodParsedType.array:t===null?Tt.ZodParsedType.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?Tt.ZodParsedType.promise:typeof Map<"u"&&t instanceof Map?Tt.ZodParsedType.map:typeof Set<"u"&&t instanceof Set?Tt.ZodParsedType.set:typeof Date<"u"&&t instanceof Date?Tt.ZodParsedType.date:Tt.ZodParsedType.object;default:return Tt.ZodParsedType.unknown}};Tt.getParsedType=A1e});var D_=m(ul=>{"use strict";Object.defineProperty(ul,"__esModule",{value:!0});ul.ZodError=ul.quotelessJson=ul.ZodIssueCode=void 0;var wG=Um();ul.ZodIssueCode=wG.util.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);var k1e=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");ul.quotelessJson=k1e;var Hu=class extends Error{constructor(e){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){let r=e||function(i){return i.message},s={_errors:[]},n=i=>{for(let o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(n);else if(o.code==="invalid_return_type")n(o.returnTypeError);else if(o.code==="invalid_arguments")n(o.argumentsError);else if(o.path.length===0)s._errors.push(r(o));else{let a=s,l=0;for(;l<o.path.length;){let u=o.path[l];l===o.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(r(o))):a[u]=a[u]||{_errors:[]},a=a[u],l++}}};return n(this),s}static assert(e){if(!(e instanceof Hu))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,wG.util.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},s=[];for(let n of this.issues)n.path.length>0?(r[n.path[0]]=r[n.path[0]]||[],r[n.path[0]].push(e(n))):s.push(e(n));return{formErrors:s,fieldErrors:r}}get formErrors(){return this.flatten()}};ul.ZodError=Hu;Hu.create=t=>new Hu(t)});var RA=m(CA=>{"use strict";Object.defineProperty(CA,"__esModule",{value:!0});var Gu=Um(),cs=D_(),x1e=(t,e)=>{let r;switch(t.code){case cs.ZodIssueCode.invalid_type:t.received===Gu.ZodParsedType.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case cs.ZodIssueCode.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,Gu.util.jsonStringifyReplacer)}`;break;case cs.ZodIssueCode.unrecognized_keys:r=`Unrecognized key(s) in object: ${Gu.util.joinValues(t.keys,", ")}`;break;case cs.ZodIssueCode.invalid_union:r="Invalid input";break;case cs.ZodIssueCode.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Gu.util.joinValues(t.options)}`;break;case cs.ZodIssueCode.invalid_enum_value:r=`Invalid enum value. Expected ${Gu.util.joinValues(t.options)}, received '${t.received}'`;break;case cs.ZodIssueCode.invalid_arguments:r="Invalid function arguments";break;case cs.ZodIssueCode.invalid_return_type:r="Invalid function return type";break;case cs.ZodIssueCode.invalid_date:r="Invalid date";break;case cs.ZodIssueCode.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:Gu.util.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case cs.ZodIssueCode.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case cs.ZodIssueCode.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case cs.ZodIssueCode.custom:r="Invalid input";break;case cs.ZodIssueCode.invalid_intersection_types:r="Intersection results could not be merged";break;case cs.ZodIssueCode.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case cs.ZodIssueCode.not_finite:r="Number must be finite";break;default:r=e.defaultError,Gu.util.assertNever(t)}return{message:r}};CA.default=x1e});var M_=m(oo=>{"use strict";var I1e=oo&&oo.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(oo,"__esModule",{value:!0});oo.getErrorMap=oo.setErrorMap=oo.defaultErrorMap=void 0;var TG=I1e(RA());oo.defaultErrorMap=TG.default;var CG=TG.default;function N1e(t){CG=t}oo.setErrorMap=N1e;function D1e(){return CG}oo.getErrorMap=D1e});var OA=m(St=>{"use strict";var M1e=St&&St.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(St,"__esModule",{value:!0});St.isAsync=St.isValid=St.isDirty=St.isAborted=St.OK=St.DIRTY=St.INVALID=St.ParseStatus=St.addIssueToContext=St.EMPTY_PATH=St.makeIssue=void 0;var $1e=M_(),RG=M1e(RA()),q1e=t=>{let{data:e,path:r,errorMaps:s,issueData:n}=t,i=[...r,...n.path||[]],o={...n,path:i};if(n.message!==void 0)return{...n,path:i,message:n.message};let a="",l=s.filter(u=>!!u).slice().reverse();for(let u of l)a=u(o,{data:e,defaultError:a}).message;return{...n,path:i,message:a}};St.makeIssue=q1e;St.EMPTY_PATH=[];function L1e(t,e){let r=(0,$1e.getErrorMap)(),s=(0,St.makeIssue)({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===RG.default?void 0:RG.default].filter(n=>!!n)});t.common.issues.push(s)}St.addIssueToContext=L1e;var Vm=class{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){let s=[];for(let n of r){if(n.status==="aborted")return St.INVALID;n.status==="dirty"&&e.dirty(),s.push(n.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,r){let s=[];for(let n of r){let i=await n.key,o=await n.value;s.push({key:i,value:o})}return Vm.mergeObjectSync(e,s)}static mergeObjectSync(e,r){let s={};for(let n of r){let{key:i,value:o}=n;if(i.status==="aborted"||o.status==="aborted")return St.INVALID;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||n.alwaysSet)&&(s[i.value]=o.value)}return{status:e.value,value:s}}};St.ParseStatus=Vm;St.INVALID=Object.freeze({status:"aborted"});var j1e=t=>({status:"dirty",value:t});St.DIRTY=j1e;var F1e=t=>({status:"valid",value:t});St.OK=F1e;var B1e=t=>t.status==="aborted";St.isAborted=B1e;var z1e=t=>t.status==="dirty";St.isDirty=z1e;var U1e=t=>t.status==="valid";St.isValid=U1e;var V1e=t=>typeof Promise<"u"&&t instanceof Promise;St.isAsync=V1e});var PG=m(OG=>{"use strict";Object.defineProperty(OG,"__esModule",{value:!0})});var AG=m(Hm=>{"use strict";Object.defineProperty(Hm,"__esModule",{value:!0});Hm.errorUtil=void 0;var H1e;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(H1e=Hm.errorUtil||(Hm.errorUtil={}))});var BG=m(M=>{"use strict";var q_=M&&M.__classPrivateFieldGet||function(t,e,r,s){if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?s:r==="a"?s.call(t):s?s.value:e.get(t)},xG=M&&M.__classPrivateFieldSet||function(t,e,r,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(t,r):n?n.value=r:e.set(t,r),r},Gm,Km;Object.defineProperty(M,"__esModule",{value:!0});M.boolean=M.bigint=M.array=M.any=M.coerce=M.ZodFirstPartyTypeKind=M.late=M.ZodSchema=M.Schema=M.custom=M.ZodReadonly=M.ZodPipeline=M.ZodBranded=M.BRAND=M.ZodNaN=M.ZodCatch=M.ZodDefault=M.ZodNullable=M.ZodOptional=M.ZodTransformer=M.ZodEffects=M.ZodPromise=M.ZodNativeEnum=M.ZodEnum=M.ZodLiteral=M.ZodLazy=M.ZodFunction=M.ZodSet=M.ZodMap=M.ZodRecord=M.ZodTuple=M.ZodIntersection=M.ZodDiscriminatedUnion=M.ZodUnion=M.ZodObject=M.ZodArray=M.ZodVoid=M.ZodNever=M.ZodUnknown=M.ZodAny=M.ZodNull=M.ZodUndefined=M.ZodSymbol=M.ZodDate=M.ZodBoolean=M.ZodBigInt=M.ZodNumber=M.ZodString=M.datetimeRegex=M.ZodType=void 0;M.NEVER=M.void=M.unknown=M.union=M.undefined=M.tuple=M.transformer=M.symbol=M.string=M.strictObject=M.set=M.record=M.promise=M.preprocess=M.pipeline=M.ostring=M.optional=M.onumber=M.oboolean=M.object=M.number=M.nullable=M.null=M.never=M.nativeEnum=M.nan=M.map=M.literal=M.lazy=M.intersection=M.instanceof=M.function=M.enum=M.effect=M.discriminatedUnion=M.date=void 0;var $_=M_(),we=AG(),L=OA(),ie=Um(),re=D_(),Mn=class{constructor(e,r,s,n){this._cachedPath=[],this.parent=e,this.data=r,this._path=s,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},kG=(t,e)=>{if((0,L.isValid)(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let r=new re.ZodError(t.common.issues);return this._error=r,this._error}}};function Me(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:s,description:n}=t;if(e&&(r||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:n}:{errorMap:(o,a)=>{var l,u;let{message:c}=t;return o.code==="invalid_enum_value"?{message:c??a.defaultError}:typeof a.data>"u"?{message:(l=c??s)!==null&&l!==void 0?l:a.defaultError}:o.code!=="invalid_type"?{message:a.defaultError}:{message:(u=c??r)!==null&&u!==void 0?u:a.defaultError}},description:n}}var $e=class{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return(0,ie.getParsedType)(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:(0,ie.getParsedType)(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new L.ParseStatus,ctx:{common:e.parent.common,data:e.data,parsedType:(0,ie.getParsedType)(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if((0,L.isAsync)(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let s=this.safeParse(e,r);if(s.success)return s.data;throw s.error}safeParse(e,r){var s;let n={common:{issues:[],async:(s=r?.async)!==null&&s!==void 0?s:!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:(0,ie.getParsedType)(e)},i=this._parseSync({data:e,path:n.path,parent:n});return kG(n,i)}async parseAsync(e,r){let s=await this.safeParseAsync(e,r);if(s.success)return s.data;throw s.error}async safeParseAsync(e,r){let s={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:(0,ie.getParsedType)(e)},n=this._parse({data:e,path:s.path,parent:s}),i=await((0,L.isAsync)(n)?n:Promise.resolve(n));return kG(s,i)}refine(e,r){let s=n=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(n):r;return this._refinement((n,i)=>{let o=e(n),a=()=>i.addIssue({code:re.ZodIssueCode.custom,...s(n)});return typeof Promise<"u"&&o instanceof Promise?o.then(l=>l?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,r){return this._refinement((s,n)=>e(s)?!0:(n.addIssue(typeof r=="function"?r(s,n):r),!1))}_refinement(e){return new nn({schema:this,typeName:xe.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Dn.create(this,this._def)}nullable(){return co.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return sn.create(this,this._def)}promise(){return fl.create(this,this._def)}or(e){return Zu.create([this,e],this._def)}and(e){return Yu.create(this,e,this._def)}transform(e){return new nn({...Me(this._def),schema:this,typeName:xe.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let r=typeof e=="function"?e:()=>e;return new rc({...Me(this._def),innerType:this,defaultValue:r,typeName:xe.ZodDefault})}brand(){return new Qm({typeName:xe.ZodBranded,type:this,...Me(this._def)})}catch(e){let r=typeof e=="function"?e:()=>e;return new sc({...Me(this._def),innerType:this,catchValue:r,typeName:xe.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return nc.create(this,e)}readonly(){return ic.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}};M.ZodType=$e;M.Schema=$e;M.ZodSchema=$e;var G1e=/^c[^\s-]{8,}$/i,K1e=/^[0-9a-z]+$/,Q1e=/^[0-9A-HJKMNP-TV-Z]{26}$/,W1e=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Z1e=/^[a-z0-9_-]{21}$/i,Y1e=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,J1e=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,X1e="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",PA,eOe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,tOe=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,rOe=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,IG="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",sOe=new RegExp(`^${IG}$`);function NG(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function nOe(t){return new RegExp(`^${NG(t)}$`)}function DG(t){let e=`${IG}T${NG(t)}`,r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}M.datetimeRegex=DG;function iOe(t,e){return!!((e==="v4"||!e)&&eOe.test(t)||(e==="v6"||!e)&&tOe.test(t))}var rn=class extends $e{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ie.ZodParsedType.string){let i=this._getOrReturnCtx(e);return(0,L.addIssueToContext)(i,{code:re.ZodIssueCode.invalid_type,expected:ie.ZodParsedType.string,received:i.parsedType}),L.INVALID}let s=new L.ParseStatus,n;for(let i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(n=this._getOrReturnCtx(e,n),(0,L.addIssueToContext)(n,{code:re.ZodIssueCode.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),s.dirty());else if(i.kind==="max")e.data.length>i.value&&(n=this._getOrReturnCtx(e,n),(0,L.addIssueToContext)(n,{code:re.ZodIssueCode.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),s.dirty());else if(i.kind==="length"){let o=e.data.length>i.value,a=e.data.length<i.value;(o||a)&&(n=this._getOrReturnCtx(e,n),o?(0,L.addIssueToContext)(n,{code:re.ZodIssueCode.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):a&&(0,L.addIssueToContext)(n,{code:re.ZodIssueCode.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),s.dirty())}else if(i.kind==="email")J1e.test(e.data)||(n=this._getOrReturnCtx(e,n),(0,L.addIssueToContext)(n,{validation:"email",code:re.ZodIssueCode.invalid_string,message:i.message}),s.dirty());else if(i.kind==="emoji")PA||(PA=new RegExp(X1e,"u")),PA.test(e.data)||(n=this._getOrReturnCtx(e,n),(0,L.addIssueToContext)(n,{validation:"emoji",code:re.ZodIssueCode.invalid_string,message:i.message}),s.dirty());else if(i.kind==="uuid")W1e.test(e.data)||(n=this._getOrReturnCtx(e,n),(0,L.addIssueToContext)(n,{validation:"uuid",code:re.ZodIssueCode.invalid_string,message:i.message}),s.dirty());else if(i.kind==="nanoid")Z1e.test(e.data)||(n=this._getOrReturnCtx(e,n),(0,L.addIssueToContext)(n,{validation:"nanoid",code:re.ZodIssueCode.invalid_string,message:i.message}),s.dirty());else if(i.kind==="cuid")G1e.test(e.data)||(n=this._getOrReturnCtx(e,n),(0,L.addIssueToContext)(n,{validation:"cuid",code:re.ZodIssueCode.invalid_string,message:i.message}),s.dirty());else if(i.kind==="cuid2")K1e.test(e.data)||(n=this._getOrReturnCtx(e,n),(0,L.addIssueToContext)(n,{validation:"cuid2",code:re.ZodIssueCode.invalid_string,message:i.message}),s.dirty());else if(i.kind==="ulid")Q1e.test(e.data)||(n=this._getOrReturnCtx(e,n),(0,L.addIssueToContext)(n,{validation:"ulid",code:re.ZodIssueCode.invalid_string,message:i.message}),s.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{n=this._getOrReturnCtx(e,n),(0,L.addIssueToContext)(n,{validation:"url",code:re.ZodIssueCode.invalid_string,message:i.message}),s.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(n=this._getOrReturnCtx(e,n),(0,L.addIssueToContext)(n,{validation:"regex",code:re.ZodIssueCode.invalid_string,message:i.message}),s.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(n=this._getOrReturnCtx(e,n),(0,L.addIssueToContext)(n,{code:re.ZodIssueCode.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),s.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(n=this._getOrReturnCtx(e,n),(0,L.addIssueToContext)(n,{code:re.ZodIssueCode.invalid_string,validation:{startsWith:i.value},message:i.message}),s.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(n=this._getOrReturnCtx(e,n),(0,L.addIssueToContext)(n,{code:re.ZodIssueCode.invalid_string,validation:{endsWith:i.value},message:i.message}),s.dirty()):i.kind==="datetime"?DG(i).test(e.data)||(n=this._getOrReturnCtx(e,n),(0,L.addIssueToContext)(n,{code:re.ZodIssueCode.invalid_string,validation:"datetime",message:i.message}),s.dirty()):i.kind==="date"?sOe.test(e.data)||(n=this._getOrReturnCtx(e,n),(0,L.addIssueToContext)(n,{code:re.ZodIssueCode.invalid_string,validation:"date",message:i.message}),s.dirty()):i.kind==="time"?nOe(i).test(e.data)||(n=this._getOrReturnCtx(e,n),(0,L.addIssueToContext)(n,{code:re.ZodIssueCode.invalid_string,validation:"time",message:i.message}),s.dirty()):i.kind==="duration"?Y1e.test(e.data)||(n=this._getOrReturnCtx(e,n),(0,L.addIssueToContext)(n,{validation:"duration",code:re.ZodIssueCode.invalid_string,message:i.message}),s.dirty()):i.kind==="ip"?iOe(e.data,i.version)||(n=this._getOrReturnCtx(e,n),(0,L.addIssueToContext)(n,{validation:"ip",code:re.ZodIssueCode.invalid_string,message:i.message}),s.dirty()):i.kind==="base64"?rOe.test(e.data)||(n=this._getOrReturnCtx(e,n),(0,L.addIssueToContext)(n,{validation:"base64",code:re.ZodIssueCode.invalid_string,message:i.message}),s.dirty()):ie.util.assertNever(i);return{status:s.value,value:e.data}}_regex(e,r,s){return this.refinement(n=>e.test(n),{validation:r,code:re.ZodIssueCode.invalid_string,...we.errorUtil.errToObj(s)})}_addCheck(e){return new rn({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...we.errorUtil.errToObj(e)})}url(e){return this._addCheck({kind:"url",...we.errorUtil.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...we.errorUtil.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...we.errorUtil.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...we.errorUtil.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...we.errorUtil.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...we.errorUtil.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...we.errorUtil.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...we.errorUtil.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...we.errorUtil.errToObj(e)})}datetime(e){var r,s;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(r=e?.offset)!==null&&r!==void 0?r:!1,local:(s=e?.local)!==null&&s!==void 0?s:!1,...we.errorUtil.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...we.errorUtil.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...we.errorUtil.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...we.errorUtil.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...we.errorUtil.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...we.errorUtil.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...we.errorUtil.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...we.errorUtil.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...we.errorUtil.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...we.errorUtil.errToObj(r)})}nonempty(e){return this.min(1,we.errorUtil.errToObj(e))}trim(){return new rn({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new rn({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new rn({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get minLength(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};M.ZodString=rn;rn.create=t=>{var e;return new rn({checks:[],typeName:xe.ZodString,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...Me(t)})};function oOe(t,e){let r=(t.toString().split(".")[1]||"").length,s=(e.toString().split(".")[1]||"").length,n=r>s?r:s,i=parseInt(t.toFixed(n).replace(".","")),o=parseInt(e.toFixed(n).replace(".",""));return i%o/Math.pow(10,n)}var ao=class extends $e{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ie.ZodParsedType.number){let i=this._getOrReturnCtx(e);return(0,L.addIssueToContext)(i,{code:re.ZodIssueCode.invalid_type,expected:ie.ZodParsedType.number,received:i.parsedType}),L.INVALID}let s,n=new L.ParseStatus;for(let i of this._def.checks)i.kind==="int"?ie.util.isInteger(e.data)||(s=this._getOrReturnCtx(e,s),(0,L.addIssueToContext)(s,{code:re.ZodIssueCode.invalid_type,expected:"integer",received:"float",message:i.message}),n.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(s=this._getOrReturnCtx(e,s),(0,L.addIssueToContext)(s,{code:re.ZodIssueCode.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(s=this._getOrReturnCtx(e,s),(0,L.addIssueToContext)(s,{code:re.ZodIssueCode.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty()):i.kind==="multipleOf"?oOe(e.data,i.value)!==0&&(s=this._getOrReturnCtx(e,s),(0,L.addIssueToContext)(s,{code:re.ZodIssueCode.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(s=this._getOrReturnCtx(e,s),(0,L.addIssueToContext)(s,{code:re.ZodIssueCode.not_finite,message:i.message}),n.dirty()):ie.util.assertNever(i);return{status:n.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,we.errorUtil.toString(r))}gt(e,r){return this.setLimit("min",e,!1,we.errorUtil.toString(r))}lte(e,r){return this.setLimit("max",e,!0,we.errorUtil.toString(r))}lt(e,r){return this.setLimit("max",e,!1,we.errorUtil.toString(r))}setLimit(e,r,s,n){return new ao({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:s,message:we.errorUtil.toString(n)}]})}_addCheck(e){return new ao({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:we.errorUtil.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:we.errorUtil.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:we.errorUtil.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:we.errorUtil.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:we.errorUtil.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:we.errorUtil.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:we.errorUtil.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:we.errorUtil.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:we.errorUtil.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&ie.util.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(r===null||s.value>r)&&(r=s.value):s.kind==="max"&&(e===null||s.value<e)&&(e=s.value)}return Number.isFinite(r)&&Number.isFinite(e)}};M.ZodNumber=ao;ao.create=t=>new ao({checks:[],typeName:xe.ZodNumber,coerce:t?.coerce||!1,...Me(t)});var lo=class extends $e{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==ie.ZodParsedType.bigint){let i=this._getOrReturnCtx(e);return(0,L.addIssueToContext)(i,{code:re.ZodIssueCode.invalid_type,expected:ie.ZodParsedType.bigint,received:i.parsedType}),L.INVALID}let s,n=new L.ParseStatus;for(let i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(s=this._getOrReturnCtx(e,s),(0,L.addIssueToContext)(s,{code:re.ZodIssueCode.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(s=this._getOrReturnCtx(e,s),(0,L.addIssueToContext)(s,{code:re.ZodIssueCode.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(s=this._getOrReturnCtx(e,s),(0,L.addIssueToContext)(s,{code:re.ZodIssueCode.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):ie.util.assertNever(i);return{status:n.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,we.errorUtil.toString(r))}gt(e,r){return this.setLimit("min",e,!1,we.errorUtil.toString(r))}lte(e,r){return this.setLimit("max",e,!0,we.errorUtil.toString(r))}lt(e,r){return this.setLimit("max",e,!1,we.errorUtil.toString(r))}setLimit(e,r,s,n){return new lo({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:s,message:we.errorUtil.toString(n)}]})}_addCheck(e){return new lo({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:we.errorUtil.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:we.errorUtil.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:we.errorUtil.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:we.errorUtil.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:we.errorUtil.toString(r)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};M.ZodBigInt=lo;lo.create=t=>{var e;return new lo({checks:[],typeName:xe.ZodBigInt,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...Me(t)})};var Ku=class extends $e{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ie.ZodParsedType.boolean){let s=this._getOrReturnCtx(e);return(0,L.addIssueToContext)(s,{code:re.ZodIssueCode.invalid_type,expected:ie.ZodParsedType.boolean,received:s.parsedType}),L.INVALID}return(0,L.OK)(e.data)}};M.ZodBoolean=Ku;Ku.create=t=>new Ku({typeName:xe.ZodBoolean,coerce:t?.coerce||!1,...Me(t)});var ca=class extends $e{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ie.ZodParsedType.date){let i=this._getOrReturnCtx(e);return(0,L.addIssueToContext)(i,{code:re.ZodIssueCode.invalid_type,expected:ie.ZodParsedType.date,received:i.parsedType}),L.INVALID}if(isNaN(e.data.getTime())){let i=this._getOrReturnCtx(e);return(0,L.addIssueToContext)(i,{code:re.ZodIssueCode.invalid_date}),L.INVALID}let s=new L.ParseStatus,n;for(let i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(n=this._getOrReturnCtx(e,n),(0,L.addIssueToContext)(n,{code:re.ZodIssueCode.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),s.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(n=this._getOrReturnCtx(e,n),(0,L.addIssueToContext)(n,{code:re.ZodIssueCode.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),s.dirty()):ie.util.assertNever(i);return{status:s.value,value:new Date(e.data.getTime())}}_addCheck(e){return new ca({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:we.errorUtil.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:we.errorUtil.toString(r)})}get minDate(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}};M.ZodDate=ca;ca.create=t=>new ca({checks:[],coerce:t?.coerce||!1,typeName:xe.ZodDate,...Me(t)});var cf=class extends $e{_parse(e){if(this._getType(e)!==ie.ZodParsedType.symbol){let s=this._getOrReturnCtx(e);return(0,L.addIssueToContext)(s,{code:re.ZodIssueCode.invalid_type,expected:ie.ZodParsedType.symbol,received:s.parsedType}),L.INVALID}return(0,L.OK)(e.data)}};M.ZodSymbol=cf;cf.create=t=>new cf({typeName:xe.ZodSymbol,...Me(t)});var Qu=class extends $e{_parse(e){if(this._getType(e)!==ie.ZodParsedType.undefined){let s=this._getOrReturnCtx(e);return(0,L.addIssueToContext)(s,{code:re.ZodIssueCode.invalid_type,expected:ie.ZodParsedType.undefined,received:s.parsedType}),L.INVALID}return(0,L.OK)(e.data)}};M.ZodUndefined=Qu;Qu.create=t=>new Qu({typeName:xe.ZodUndefined,...Me(t)});var Wu=class extends $e{_parse(e){if(this._getType(e)!==ie.ZodParsedType.null){let s=this._getOrReturnCtx(e);return(0,L.addIssueToContext)(s,{code:re.ZodIssueCode.invalid_type,expected:ie.ZodParsedType.null,received:s.parsedType}),L.INVALID}return(0,L.OK)(e.data)}};M.ZodNull=Wu;Wu.create=t=>new Wu({typeName:xe.ZodNull,...Me(t)});var dl=class extends $e{constructor(){super(...arguments),this._any=!0}_parse(e){return(0,L.OK)(e.data)}};M.ZodAny=dl;dl.create=t=>new dl({typeName:xe.ZodAny,...Me(t)});var ua=class extends $e{constructor(){super(...arguments),this._unknown=!0}_parse(e){return(0,L.OK)(e.data)}};M.ZodUnknown=ua;ua.create=t=>new ua({typeName:xe.ZodUnknown,...Me(t)});var bi=class extends $e{_parse(e){let r=this._getOrReturnCtx(e);return(0,L.addIssueToContext)(r,{code:re.ZodIssueCode.invalid_type,expected:ie.ZodParsedType.never,received:r.parsedType}),L.INVALID}};M.ZodNever=bi;bi.create=t=>new bi({typeName:xe.ZodNever,...Me(t)});var df=class extends $e{_parse(e){if(this._getType(e)!==ie.ZodParsedType.undefined){let s=this._getOrReturnCtx(e);return(0,L.addIssueToContext)(s,{code:re.ZodIssueCode.invalid_type,expected:ie.ZodParsedType.void,received:s.parsedType}),L.INVALID}return(0,L.OK)(e.data)}};M.ZodVoid=df;df.create=t=>new df({typeName:xe.ZodVoid,...Me(t)});var sn=class extends $e{_parse(e){let{ctx:r,status:s}=this._processInputParams(e),n=this._def;if(r.parsedType!==ie.ZodParsedType.array)return(0,L.addIssueToContext)(r,{code:re.ZodIssueCode.invalid_type,expected:ie.ZodParsedType.array,received:r.parsedType}),L.INVALID;if(n.exactLength!==null){let o=r.data.length>n.exactLength.value,a=r.data.length<n.exactLength.value;(o||a)&&((0,L.addIssueToContext)(r,{code:o?re.ZodIssueCode.too_big:re.ZodIssueCode.too_small,minimum:a?n.exactLength.value:void 0,maximum:o?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),s.dirty())}if(n.minLength!==null&&r.data.length<n.minLength.value&&((0,L.addIssueToContext)(r,{code:re.ZodIssueCode.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),s.dirty()),n.maxLength!==null&&r.data.length>n.maxLength.value&&((0,L.addIssueToContext)(r,{code:re.ZodIssueCode.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),s.dirty()),r.common.async)return Promise.all([...r.data].map((o,a)=>n.type._parseAsync(new Mn(r,o,r.path,a)))).then(o=>L.ParseStatus.mergeArray(s,o));let i=[...r.data].map((o,a)=>n.type._parseSync(new Mn(r,o,r.path,a)));return L.ParseStatus.mergeArray(s,i)}get element(){return this._def.type}min(e,r){return new sn({...this._def,minLength:{value:e,message:we.errorUtil.toString(r)}})}max(e,r){return new sn({...this._def,maxLength:{value:e,message:we.errorUtil.toString(r)}})}length(e,r){return new sn({...this._def,exactLength:{value:e,message:we.errorUtil.toString(r)}})}nonempty(e){return this.min(1,e)}};M.ZodArray=sn;sn.create=(t,e)=>new sn({type:t,minLength:null,maxLength:null,exactLength:null,typeName:xe.ZodArray,...Me(e)});function uf(t){if(t instanceof zt){let e={};for(let r in t.shape){let s=t.shape[r];e[r]=Dn.create(uf(s))}return new zt({...t._def,shape:()=>e})}else return t instanceof sn?new sn({...t._def,type:uf(t.element)}):t instanceof Dn?Dn.create(uf(t.unwrap())):t instanceof co?co.create(uf(t.unwrap())):t instanceof $n?$n.create(t.items.map(e=>uf(e))):t}var zt=class extends $e{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),r=ie.util.objectKeys(e);return this._cached={shape:e,keys:r}}_parse(e){if(this._getType(e)!==ie.ZodParsedType.object){let u=this._getOrReturnCtx(e);return(0,L.addIssueToContext)(u,{code:re.ZodIssueCode.invalid_type,expected:ie.ZodParsedType.object,received:u.parsedType}),L.INVALID}let{status:s,ctx:n}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof bi&&this._def.unknownKeys==="strip"))for(let u in n.data)o.includes(u)||a.push(u);let l=[];for(let u of o){let c=i[u],d=n.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new Mn(n,d,n.path,u)),alwaysSet:u in n.data})}if(this._def.catchall instanceof bi){let u=this._def.unknownKeys;if(u==="passthrough")for(let c of a)l.push({key:{status:"valid",value:c},value:{status:"valid",value:n.data[c]}});else if(u==="strict")a.length>0&&((0,L.addIssueToContext)(n,{code:re.ZodIssueCode.unrecognized_keys,keys:a}),s.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let c of a){let d=n.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new Mn(n,d,n.path,c)),alwaysSet:c in n.data})}}return n.common.async?Promise.resolve().then(async()=>{let u=[];for(let c of l){let d=await c.key,f=await c.value;u.push({key:d,value:f,alwaysSet:c.alwaysSet})}return u}).then(u=>L.ParseStatus.mergeObjectSync(s,u)):L.ParseStatus.mergeObjectSync(s,l)}get shape(){return this._def.shape()}strict(e){return we.errorUtil.errToObj,new zt({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,s)=>{var n,i,o,a;let l=(o=(i=(n=this._def).errorMap)===null||i===void 0?void 0:i.call(n,r,s).message)!==null&&o!==void 0?o:s.defaultError;return r.code==="unrecognized_keys"?{message:(a=we.errorUtil.errToObj(e).message)!==null&&a!==void 0?a:l}:{message:l}}}:{}})}strip(){return new zt({...this._def,unknownKeys:"strip"})}passthrough(){return new zt({...this._def,unknownKeys:"passthrough"})}extend(e){return new zt({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new zt({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:xe.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new zt({...this._def,catchall:e})}pick(e){let r={};return ie.util.objectKeys(e).forEach(s=>{e[s]&&this.shape[s]&&(r[s]=this.shape[s])}),new zt({...this._def,shape:()=>r})}omit(e){let r={};return ie.util.objectKeys(this.shape).forEach(s=>{e[s]||(r[s]=this.shape[s])}),new zt({...this._def,shape:()=>r})}deepPartial(){return uf(this)}partial(e){let r={};return ie.util.objectKeys(this.shape).forEach(s=>{let n=this.shape[s];e&&!e[s]?r[s]=n:r[s]=n.optional()}),new zt({...this._def,shape:()=>r})}required(e){let r={};return ie.util.objectKeys(this.shape).forEach(s=>{if(e&&!e[s])r[s]=this.shape[s];else{let i=this.shape[s];for(;i instanceof Dn;)i=i._def.innerType;r[s]=i}}),new zt({...this._def,shape:()=>r})}keyof(){return MG(ie.util.objectKeys(this.shape))}};M.ZodObject=zt;zt.create=(t,e)=>new zt({shape:()=>t,unknownKeys:"strip",catchall:bi.create(),typeName:xe.ZodObject,...Me(e)});zt.strictCreate=(t,e)=>new zt({shape:()=>t,unknownKeys:"strict",catchall:bi.create(),typeName:xe.ZodObject,...Me(e)});zt.lazycreate=(t,e)=>new zt({shape:t,unknownKeys:"strip",catchall:bi.create(),typeName:xe.ZodObject,...Me(e)});var Zu=class extends $e{_parse(e){let{ctx:r}=this._processInputParams(e),s=this._def.options;function n(i){for(let a of i)if(a.result.status==="valid")return a.result;for(let a of i)if(a.result.status==="dirty")return r.common.issues.push(...a.ctx.common.issues),a.result;let o=i.map(a=>new re.ZodError(a.ctx.common.issues));return(0,L.addIssueToContext)(r,{code:re.ZodIssueCode.invalid_union,unionErrors:o}),L.INVALID}if(r.common.async)return Promise.all(s.map(async i=>{let o={...r,common:{...r.common,issues:[]},parent:null};return{result:await i._parseAsync({data:r.data,path:r.path,parent:o}),ctx:o}})).then(n);{let i,o=[];for(let l of s){let u={...r,common:{...r.common,issues:[]},parent:null},c=l._parseSync({data:r.data,path:r.path,parent:u});if(c.status==="valid")return c;c.status==="dirty"&&!i&&(i={result:c,ctx:u}),u.common.issues.length&&o.push(u.common.issues)}if(i)return r.common.issues.push(...i.ctx.common.issues),i.result;let a=o.map(l=>new re.ZodError(l));return(0,L.addIssueToContext)(r,{code:re.ZodIssueCode.invalid_union,unionErrors:a}),L.INVALID}}get options(){return this._def.options}};M.ZodUnion=Zu;Zu.create=(t,e)=>new Zu({options:t,typeName:xe.ZodUnion,...Me(e)});var la=t=>t instanceof Xu?la(t.schema):t instanceof nn?la(t.innerType()):t instanceof ec?[t.value]:t instanceof uo?t.options:t instanceof tc?ie.util.objectValues(t.enum):t instanceof rc?la(t._def.innerType):t instanceof Qu?[void 0]:t instanceof Wu?[null]:t instanceof Dn?[void 0,...la(t.unwrap())]:t instanceof co?[null,...la(t.unwrap())]:t instanceof Qm||t instanceof ic?la(t.unwrap()):t instanceof sc?la(t._def.innerType):[],ff=class extends $e{_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==ie.ZodParsedType.object)return(0,L.addIssueToContext)(r,{code:re.ZodIssueCode.invalid_type,expected:ie.ZodParsedType.object,received:r.parsedType}),L.INVALID;let s=this.discriminator,n=r.data[s],i=this.optionsMap.get(n);return i?r.common.async?i._parseAsync({data:r.data,path:r.path,parent:r}):i._parseSync({data:r.data,path:r.path,parent:r}):((0,L.addIssueToContext)(r,{code:re.ZodIssueCode.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[s]}),L.INVALID)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,s){let n=new Map;for(let i of r){let o=la(i.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let a of o){if(n.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);n.set(a,i)}}return new ff({typeName:xe.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:n,...Me(s)})}};M.ZodDiscriminatedUnion=ff;function AA(t,e){let r=(0,ie.getParsedType)(t),s=(0,ie.getParsedType)(e);if(t===e)return{valid:!0,data:t};if(r===ie.ZodParsedType.object&&s===ie.ZodParsedType.object){let n=ie.util.objectKeys(e),i=ie.util.objectKeys(t).filter(a=>n.indexOf(a)!==-1),o={...t,...e};for(let a of i){let l=AA(t[a],e[a]);if(!l.valid)return{valid:!1};o[a]=l.data}return{valid:!0,data:o}}else if(r===ie.ZodParsedType.array&&s===ie.ZodParsedType.array){if(t.length!==e.length)return{valid:!1};let n=[];for(let i=0;i<t.length;i++){let o=t[i],a=e[i],l=AA(o,a);if(!l.valid)return{valid:!1};n.push(l.data)}return{valid:!0,data:n}}else return r===ie.ZodParsedType.date&&s===ie.ZodParsedType.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}var Yu=class extends $e{_parse(e){let{status:r,ctx:s}=this._processInputParams(e),n=(i,o)=>{if((0,L.isAborted)(i)||(0,L.isAborted)(o))return L.INVALID;let a=AA(i.value,o.value);return a.valid?(((0,L.isDirty)(i)||(0,L.isDirty)(o))&&r.dirty(),{status:r.value,value:a.data}):((0,L.addIssueToContext)(s,{code:re.ZodIssueCode.invalid_intersection_types}),L.INVALID)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([i,o])=>n(i,o)):n(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}};M.ZodIntersection=Yu;Yu.create=(t,e,r)=>new Yu({left:t,right:e,typeName:xe.ZodIntersection,...Me(r)});var $n=class extends $e{_parse(e){let{status:r,ctx:s}=this._processInputParams(e);if(s.parsedType!==ie.ZodParsedType.array)return(0,L.addIssueToContext)(s,{code:re.ZodIssueCode.invalid_type,expected:ie.ZodParsedType.array,received:s.parsedType}),L.INVALID;if(s.data.length<this._def.items.length)return(0,L.addIssueToContext)(s,{code:re.ZodIssueCode.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),L.INVALID;!this._def.rest&&s.data.length>this._def.items.length&&((0,L.addIssueToContext)(s,{code:re.ZodIssueCode.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());let i=[...s.data].map((o,a)=>{let l=this._def.items[a]||this._def.rest;return l?l._parse(new Mn(s,o,s.path,a)):null}).filter(o=>!!o);return s.common.async?Promise.all(i).then(o=>L.ParseStatus.mergeArray(r,o)):L.ParseStatus.mergeArray(r,i)}get items(){return this._def.items}rest(e){return new $n({...this._def,rest:e})}};M.ZodTuple=$n;$n.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new $n({items:t,typeName:xe.ZodTuple,rest:null,...Me(e)})};var Ju=class extends $e{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:s}=this._processInputParams(e);if(s.parsedType!==ie.ZodParsedType.object)return(0,L.addIssueToContext)(s,{code:re.ZodIssueCode.invalid_type,expected:ie.ZodParsedType.object,received:s.parsedType}),L.INVALID;let n=[],i=this._def.keyType,o=this._def.valueType;for(let a in s.data)n.push({key:i._parse(new Mn(s,a,s.path,a)),value:o._parse(new Mn(s,s.data[a],s.path,a)),alwaysSet:a in s.data});return s.common.async?L.ParseStatus.mergeObjectAsync(r,n):L.ParseStatus.mergeObjectSync(r,n)}get element(){return this._def.valueType}static create(e,r,s){return r instanceof $e?new Ju({keyType:e,valueType:r,typeName:xe.ZodRecord,...Me(s)}):new Ju({keyType:rn.create(),valueType:e,typeName:xe.ZodRecord,...Me(r)})}};M.ZodRecord=Ju;var hf=class extends $e{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:s}=this._processInputParams(e);if(s.parsedType!==ie.ZodParsedType.map)return(0,L.addIssueToContext)(s,{code:re.ZodIssueCode.invalid_type,expected:ie.ZodParsedType.map,received:s.parsedType}),L.INVALID;let n=this._def.keyType,i=this._def.valueType,o=[...s.data.entries()].map(([a,l],u)=>({key:n._parse(new Mn(s,a,s.path,[u,"key"])),value:i._parse(new Mn(s,l,s.path,[u,"value"]))}));if(s.common.async){let a=new Map;return Promise.resolve().then(async()=>{for(let l of o){let u=await l.key,c=await l.value;if(u.status==="aborted"||c.status==="aborted")return L.INVALID;(u.status==="dirty"||c.status==="dirty")&&r.dirty(),a.set(u.value,c.value)}return{status:r.value,value:a}})}else{let a=new Map;for(let l of o){let u=l.key,c=l.value;if(u.status==="aborted"||c.status==="aborted")return L.INVALID;(u.status==="dirty"||c.status==="dirty")&&r.dirty(),a.set(u.value,c.value)}return{status:r.value,value:a}}}};M.ZodMap=hf;hf.create=(t,e,r)=>new hf({valueType:e,keyType:t,typeName:xe.ZodMap,...Me(r)});var da=class extends $e{_parse(e){let{status:r,ctx:s}=this._processInputParams(e);if(s.parsedType!==ie.ZodParsedType.set)return(0,L.addIssueToContext)(s,{code:re.ZodIssueCode.invalid_type,expected:ie.ZodParsedType.set,received:s.parsedType}),L.INVALID;let n=this._def;n.minSize!==null&&s.data.size<n.minSize.value&&((0,L.addIssueToContext)(s,{code:re.ZodIssueCode.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),r.dirty()),n.maxSize!==null&&s.data.size>n.maxSize.value&&((0,L.addIssueToContext)(s,{code:re.ZodIssueCode.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),r.dirty());let i=this._def.valueType;function o(l){let u=new Set;for(let c of l){if(c.status==="aborted")return L.INVALID;c.status==="dirty"&&r.dirty(),u.add(c.value)}return{status:r.value,value:u}}let a=[...s.data.values()].map((l,u)=>i._parse(new Mn(s,l,s.path,u)));return s.common.async?Promise.all(a).then(l=>o(l)):o(a)}min(e,r){return new da({...this._def,minSize:{value:e,message:we.errorUtil.toString(r)}})}max(e,r){return new da({...this._def,maxSize:{value:e,message:we.errorUtil.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}};M.ZodSet=da;da.create=(t,e)=>new da({valueType:t,minSize:null,maxSize:null,typeName:xe.ZodSet,...Me(e)});var cl=class extends $e{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==ie.ZodParsedType.function)return(0,L.addIssueToContext)(r,{code:re.ZodIssueCode.invalid_type,expected:ie.ZodParsedType.function,received:r.parsedType}),L.INVALID;function s(a,l){return(0,L.makeIssue)({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,(0,$_.getErrorMap)(),$_.defaultErrorMap].filter(u=>!!u),issueData:{code:re.ZodIssueCode.invalid_arguments,argumentsError:l}})}function n(a,l){return(0,L.makeIssue)({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,(0,$_.getErrorMap)(),$_.defaultErrorMap].filter(u=>!!u),issueData:{code:re.ZodIssueCode.invalid_return_type,returnTypeError:l}})}let i={errorMap:r.common.contextualErrorMap},o=r.data;if(this._def.returns instanceof fl){let a=this;return(0,L.OK)(async function(...l){let u=new re.ZodError([]),c=await a._def.args.parseAsync(l,i).catch(h=>{throw u.addIssue(s(l,h)),u}),d=await Reflect.apply(o,this,c);return await a._def.returns._def.type.parseAsync(d,i).catch(h=>{throw u.addIssue(n(d,h)),u})})}else{let a=this;return(0,L.OK)(function(...l){let u=a._def.args.safeParse(l,i);if(!u.success)throw new re.ZodError([s(l,u.error)]);let c=Reflect.apply(o,this,u.data),d=a._def.returns.safeParse(c,i);if(!d.success)throw new re.ZodError([n(c,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new cl({...this._def,args:$n.create(e).rest(ua.create())})}returns(e){return new cl({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,r,s){return new cl({args:e||$n.create([]).rest(ua.create()),returns:r||ua.create(),typeName:xe.ZodFunction,...Me(s)})}};M.ZodFunction=cl;var Xu=class extends $e{get schema(){return this._def.getter()}_parse(e){let{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}};M.ZodLazy=Xu;Xu.create=(t,e)=>new Xu({getter:t,typeName:xe.ZodLazy,...Me(e)});var ec=class extends $e{_parse(e){if(e.data!==this._def.value){let r=this._getOrReturnCtx(e);return(0,L.addIssueToContext)(r,{received:r.data,code:re.ZodIssueCode.invalid_literal,expected:this._def.value}),L.INVALID}return{status:"valid",value:e.data}}get value(){return this._def.value}};M.ZodLiteral=ec;ec.create=(t,e)=>new ec({value:t,typeName:xe.ZodLiteral,...Me(e)});function MG(t,e){return new uo({values:t,typeName:xe.ZodEnum,...Me(e)})}var uo=class extends $e{constructor(){super(...arguments),Gm.set(this,void 0)}_parse(e){if(typeof e.data!="string"){let r=this._getOrReturnCtx(e),s=this._def.values;return(0,L.addIssueToContext)(r,{expected:ie.util.joinValues(s),received:r.parsedType,code:re.ZodIssueCode.invalid_type}),L.INVALID}if(q_(this,Gm,"f")||xG(this,Gm,new Set(this._def.values),"f"),!q_(this,Gm,"f").has(e.data)){let r=this._getOrReturnCtx(e),s=this._def.values;return(0,L.addIssueToContext)(r,{received:r.data,code:re.ZodIssueCode.invalid_enum_value,options:s}),L.INVALID}return(0,L.OK)(e.data)}get options(){return this._def.values}get enum(){let e={};for(let r of this._def.values)e[r]=r;return e}get Values(){let e={};for(let r of this._def.values)e[r]=r;return e}get Enum(){let e={};for(let r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return uo.create(e,{...this._def,...r})}exclude(e,r=this._def){return uo.create(this.options.filter(s=>!e.includes(s)),{...this._def,...r})}};M.ZodEnum=uo;Gm=new WeakMap;uo.create=MG;var tc=class extends $e{constructor(){super(...arguments),Km.set(this,void 0)}_parse(e){let r=ie.util.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==ie.ZodParsedType.string&&s.parsedType!==ie.ZodParsedType.number){let n=ie.util.objectValues(r);return(0,L.addIssueToContext)(s,{expected:ie.util.joinValues(n),received:s.parsedType,code:re.ZodIssueCode.invalid_type}),L.INVALID}if(q_(this,Km,"f")||xG(this,Km,new Set(ie.util.getValidEnumValues(this._def.values)),"f"),!q_(this,Km,"f").has(e.data)){let n=ie.util.objectValues(r);return(0,L.addIssueToContext)(s,{received:s.data,code:re.ZodIssueCode.invalid_enum_value,options:n}),L.INVALID}return(0,L.OK)(e.data)}get enum(){return this._def.values}};M.ZodNativeEnum=tc;Km=new WeakMap;tc.create=(t,e)=>new tc({values:t,typeName:xe.ZodNativeEnum,...Me(e)});var fl=class extends $e{unwrap(){return this._def.type}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==ie.ZodParsedType.promise&&r.common.async===!1)return(0,L.addIssueToContext)(r,{code:re.ZodIssueCode.invalid_type,expected:ie.ZodParsedType.promise,received:r.parsedType}),L.INVALID;let s=r.parsedType===ie.ZodParsedType.promise?r.data:Promise.resolve(r.data);return(0,L.OK)(s.then(n=>this._def.type.parseAsync(n,{path:r.path,errorMap:r.common.contextualErrorMap})))}};M.ZodPromise=fl;fl.create=(t,e)=>new fl({type:t,typeName:xe.ZodPromise,...Me(e)});var nn=class extends $e{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===xe.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:r,ctx:s}=this._processInputParams(e),n=this._def.effect||null,i={addIssue:o=>{(0,L.addIssueToContext)(s,o),o.fatal?r.abort():r.dirty()},get path(){return s.path}};if(i.addIssue=i.addIssue.bind(i),n.type==="preprocess"){let o=n.transform(s.data,i);if(s.common.async)return Promise.resolve(o).then(async a=>{if(r.value==="aborted")return L.INVALID;let l=await this._def.schema._parseAsync({data:a,path:s.path,parent:s});return l.status==="aborted"?L.INVALID:l.status==="dirty"||r.value==="dirty"?(0,L.DIRTY)(l.value):l});{if(r.value==="aborted")return L.INVALID;let a=this._def.schema._parseSync({data:o,path:s.path,parent:s});return a.status==="aborted"?L.INVALID:a.status==="dirty"||r.value==="dirty"?(0,L.DIRTY)(a.value):a}}if(n.type==="refinement"){let o=a=>{let l=n.refinement(a,i);if(s.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(s.common.async===!1){let a=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return a.status==="aborted"?L.INVALID:(a.status==="dirty"&&r.dirty(),o(a.value),{status:r.value,value:a.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(a=>a.status==="aborted"?L.INVALID:(a.status==="dirty"&&r.dirty(),o(a.value).then(()=>({status:r.value,value:a.value}))))}if(n.type==="transform")if(s.common.async===!1){let o=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!(0,L.isValid)(o))return o;let a=n.transform(o.value,i);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:a}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(o=>(0,L.isValid)(o)?Promise.resolve(n.transform(o.value,i)).then(a=>({status:r.value,value:a})):o);ie.util.assertNever(n)}};M.ZodEffects=nn;M.ZodTransformer=nn;nn.create=(t,e,r)=>new nn({schema:t,typeName:xe.ZodEffects,effect:e,...Me(r)});nn.createWithPreprocess=(t,e,r)=>new nn({schema:e,effect:{type:"preprocess",transform:t},typeName:xe.ZodEffects,...Me(r)});var Dn=class extends $e{_parse(e){return this._getType(e)===ie.ZodParsedType.undefined?(0,L.OK)(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};M.ZodOptional=Dn;Dn.create=(t,e)=>new Dn({innerType:t,typeName:xe.ZodOptional,...Me(e)});var co=class extends $e{_parse(e){return this._getType(e)===ie.ZodParsedType.null?(0,L.OK)(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};M.ZodNullable=co;co.create=(t,e)=>new co({innerType:t,typeName:xe.ZodNullable,...Me(e)});var rc=class extends $e{_parse(e){let{ctx:r}=this._processInputParams(e),s=r.data;return r.parsedType===ie.ZodParsedType.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:r.path,parent:r})}removeDefault(){return this._def.innerType}};M.ZodDefault=rc;rc.create=(t,e)=>new rc({innerType:t,typeName:xe.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Me(e)});var sc=class extends $e{_parse(e){let{ctx:r}=this._processInputParams(e),s={...r,common:{...r.common,issues:[]}},n=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return(0,L.isAsync)(n)?n.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new re.ZodError(s.common.issues)},input:s.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new re.ZodError(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}};M.ZodCatch=sc;sc.create=(t,e)=>new sc({innerType:t,typeName:xe.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Me(e)});var pf=class extends $e{_parse(e){if(this._getType(e)!==ie.ZodParsedType.nan){let s=this._getOrReturnCtx(e);return(0,L.addIssueToContext)(s,{code:re.ZodIssueCode.invalid_type,expected:ie.ZodParsedType.nan,received:s.parsedType}),L.INVALID}return{status:"valid",value:e.data}}};M.ZodNaN=pf;pf.create=t=>new pf({typeName:xe.ZodNaN,...Me(t)});M.BRAND=Symbol("zod_brand");var Qm=class extends $e{_parse(e){let{ctx:r}=this._processInputParams(e),s=r.data;return this._def.type._parse({data:s,path:r.path,parent:r})}unwrap(){return this._def.type}};M.ZodBranded=Qm;var nc=class extends $e{_parse(e){let{status:r,ctx:s}=this._processInputParams(e);if(s.common.async)return(async()=>{let i=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return i.status==="aborted"?L.INVALID:i.status==="dirty"?(r.dirty(),(0,L.DIRTY)(i.value)):this._def.out._parseAsync({data:i.value,path:s.path,parent:s})})();{let n=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?L.INVALID:n.status==="dirty"?(r.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:s.path,parent:s})}}static create(e,r){return new nc({in:e,out:r,typeName:xe.ZodPipeline})}};M.ZodPipeline=nc;var ic=class extends $e{_parse(e){let r=this._def.innerType._parse(e),s=n=>((0,L.isValid)(n)&&(n.value=Object.freeze(n.value)),n);return(0,L.isAsync)(r)?r.then(n=>s(n)):s(r)}unwrap(){return this._def.innerType}};M.ZodReadonly=ic;ic.create=(t,e)=>new ic({innerType:t,typeName:xe.ZodReadonly,...Me(e)});function $G(t,e={},r){return t?dl.create().superRefine((s,n)=>{var i,o;if(!t(s)){let a=typeof e=="function"?e(s):typeof e=="string"?{message:e}:e,l=(o=(i=a.fatal)!==null&&i!==void 0?i:r)!==null&&o!==void 0?o:!0,u=typeof a=="string"?{message:a}:a;n.addIssue({code:"custom",...u,fatal:l})}}):dl.create()}M.custom=$G;M.late={object:zt.lazycreate};var xe;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(xe=M.ZodFirstPartyTypeKind||(M.ZodFirstPartyTypeKind={}));var aOe=(t,e={message:`Input not instance of ${t.name}`})=>$G(r=>r instanceof t,e);M.instanceof=aOe;var qG=rn.create;M.string=qG;var LG=ao.create;M.number=LG;var lOe=pf.create;M.nan=lOe;var uOe=lo.create;M.bigint=uOe;var jG=Ku.create;M.boolean=jG;var cOe=ca.create;M.date=cOe;var dOe=cf.create;M.symbol=dOe;var fOe=Qu.create;M.undefined=fOe;var hOe=Wu.create;M.null=hOe;var pOe=dl.create;M.any=pOe;var mOe=ua.create;M.unknown=mOe;var gOe=bi.create;M.never=gOe;var yOe=df.create;M.void=yOe;var vOe=sn.create;M.array=vOe;var _Oe=zt.create;M.object=_Oe;var SOe=zt.strictCreate;M.strictObject=SOe;var bOe=Zu.create;M.union=bOe;var EOe=ff.create;M.discriminatedUnion=EOe;var wOe=Yu.create;M.intersection=wOe;var TOe=$n.create;M.tuple=TOe;var COe=Ju.create;M.record=COe;var ROe=hf.create;M.map=ROe;var OOe=da.create;M.set=OOe;var POe=cl.create;M.function=POe;var AOe=Xu.create;M.lazy=AOe;var kOe=ec.create;M.literal=kOe;var xOe=uo.create;M.enum=xOe;var IOe=tc.create;M.nativeEnum=IOe;var NOe=fl.create;M.promise=NOe;var FG=nn.create;M.effect=FG;M.transformer=FG;var DOe=Dn.create;M.optional=DOe;var MOe=co.create;M.nullable=MOe;var $Oe=nn.createWithPreprocess;M.preprocess=$Oe;var qOe=nc.create;M.pipeline=qOe;var LOe=()=>qG().optional();M.ostring=LOe;var jOe=()=>LG().optional();M.onumber=jOe;var FOe=()=>jG().optional();M.oboolean=FOe;M.coerce={string:t=>rn.create({...t,coerce:!0}),number:t=>ao.create({...t,coerce:!0}),boolean:t=>Ku.create({...t,coerce:!0}),bigint:t=>lo.create({...t,coerce:!0}),date:t=>ca.create({...t,coerce:!0})};M.NEVER=L.INVALID});var kA=m(qn=>{"use strict";var BOe=qn&&qn.__createBinding||(Object.create?function(t,e,r,s){s===void 0&&(s=r),Object.defineProperty(t,s,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,s){s===void 0&&(s=r),t[s]=e[r]}),mf=qn&&qn.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&BOe(e,t,r)};Object.defineProperty(qn,"__esModule",{value:!0});mf(M_(),qn);mf(OA(),qn);mf(PG(),qn);mf(Um(),qn);mf(BG(),qn);mf(D_(),qn)});var L_=m(js=>{"use strict";var zG=js&&js.__createBinding||(Object.create?function(t,e,r,s){s===void 0&&(s=r),Object.defineProperty(t,s,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,s){s===void 0&&(s=r),t[s]=e[r]}),zOe=js&&js.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),UOe=js&&js.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&zG(e,t,r);return zOe(e,t),e},VOe=js&&js.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&zG(e,t,r)};Object.defineProperty(js,"__esModule",{value:!0});js.z=void 0;var UG=UOe(kA());js.z=UG;VOe(kA(),js);js.default=UG});var xA=m(j_=>{"use strict";Object.defineProperty(j_,"__esModule",{value:!0});j_.parseAnyDef=void 0;function HOe(){return{}}j_.parseAnyDef=HOe});var IA=m(B_=>{"use strict";Object.defineProperty(B_,"__esModule",{value:!0});B_.parseArrayDef=void 0;var GOe=L_(),F_=ll(),KOe=Sr();function QOe(t,e){let r={type:"array"};return t.type?._def?.typeName!==GOe.ZodFirstPartyTypeKind.ZodAny&&(r.items=(0,KOe.parseDef)(t.type._def,{...e,currentPath:[...e.currentPath,"items"]})),t.minLength&&(0,F_.setResponseValueAndErrors)(r,"minItems",t.minLength.value,t.minLength.message,e),t.maxLength&&(0,F_.setResponseValueAndErrors)(r,"maxItems",t.maxLength.value,t.maxLength.message,e),t.exactLength&&((0,F_.setResponseValueAndErrors)(r,"minItems",t.exactLength.value,t.exactLength.message,e),(0,F_.setResponseValueAndErrors)(r,"maxItems",t.exactLength.value,t.exactLength.message,e)),r}B_.parseArrayDef=QOe});var NA=m(z_=>{"use strict";Object.defineProperty(z_,"__esModule",{value:!0});z_.parseBigintDef=void 0;var oc=ll();function WOe(t,e){let r={type:"integer",format:"int64"};if(!t.checks)return r;for(let s of t.checks)switch(s.kind){case"min":e.target==="jsonSchema7"?s.inclusive?(0,oc.setResponseValueAndErrors)(r,"minimum",s.value,s.message,e):(0,oc.setResponseValueAndErrors)(r,"exclusiveMinimum",s.value,s.message,e):(s.inclusive||(r.exclusiveMinimum=!0),(0,oc.setResponseValueAndErrors)(r,"minimum",s.value,s.message,e));break;case"max":e.target==="jsonSchema7"?s.inclusive?(0,oc.setResponseValueAndErrors)(r,"maximum",s.value,s.message,e):(0,oc.setResponseValueAndErrors)(r,"exclusiveMaximum",s.value,s.message,e):(s.inclusive||(r.exclusiveMaximum=!0),(0,oc.setResponseValueAndErrors)(r,"maximum",s.value,s.message,e));break;case"multipleOf":(0,oc.setResponseValueAndErrors)(r,"multipleOf",s.value,s.message,e);break}return r}z_.parseBigintDef=WOe});var DA=m(U_=>{"use strict";Object.defineProperty(U_,"__esModule",{value:!0});U_.parseBooleanDef=void 0;function ZOe(){return{type:"boolean"}}U_.parseBooleanDef=ZOe});var MA=m(V_=>{"use strict";Object.defineProperty(V_,"__esModule",{value:!0});V_.parseBrandedDef=void 0;var YOe=Sr();function JOe(t,e){return(0,YOe.parseDef)(t.type._def,e)}V_.parseBrandedDef=JOe});var $A=m(H_=>{"use strict";Object.defineProperty(H_,"__esModule",{value:!0});H_.parseCatchDef=void 0;var XOe=Sr(),ePe=(t,e)=>(0,XOe.parseDef)(t.innerType._def,e);H_.parseCatchDef=ePe});var qA=m(G_=>{"use strict";Object.defineProperty(G_,"__esModule",{value:!0});G_.parseDateDef=void 0;var VG=ll();function HG(t,e,r){let s=r??e.dateStrategy;if(Array.isArray(s))return{anyOf:s.map((n,i)=>HG(t,e,n))};switch(s){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return tPe(t,e)}}G_.parseDateDef=HG;var tPe=(t,e)=>{let r={type:"integer",format:"unix-time"};if(e.target==="openApi3")return r;for(let s of t.checks)switch(s.kind){case"min":(0,VG.setResponseValueAndErrors)(r,"minimum",s.value,s.message,e);break;case"max":(0,VG.setResponseValueAndErrors)(r,"maximum",s.value,s.message,e);break}return r}});var LA=m(K_=>{"use strict";Object.defineProperty(K_,"__esModule",{value:!0});K_.parseDefaultDef=void 0;var rPe=Sr();function sPe(t,e){return{...(0,rPe.parseDef)(t.innerType._def,e),default:t.defaultValue()}}K_.parseDefaultDef=sPe});var jA=m(Q_=>{"use strict";Object.defineProperty(Q_,"__esModule",{value:!0});Q_.parseEffectsDef=void 0;var nPe=Sr();function iPe(t,e){return e.effectStrategy==="input"?(0,nPe.parseDef)(t.schema._def,e):{}}Q_.parseEffectsDef=iPe});var FA=m(W_=>{"use strict";Object.defineProperty(W_,"__esModule",{value:!0});W_.parseEnumDef=void 0;function oPe(t){return{type:"string",enum:t.values}}W_.parseEnumDef=oPe});var BA=m(Z_=>{"use strict";Object.defineProperty(Z_,"__esModule",{value:!0});Z_.parseIntersectionDef=void 0;var GG=Sr(),aPe=t=>"type"in t&&t.type==="string"?!1:"allOf"in t;function lPe(t,e){let r=[(0,GG.parseDef)(t.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),(0,GG.parseDef)(t.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(i=>!!i),s=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0,n=[];return r.forEach(i=>{if(aPe(i))n.push(...i.allOf),i.unevaluatedProperties===void 0&&(s=void 0);else{let o=i;if("additionalProperties"in i&&i.additionalProperties===!1){let{additionalProperties:a,...l}=i;o=l}else s=void 0;n.push(o)}}),n.length?{allOf:n,...s}:void 0}Z_.parseIntersectionDef=lPe});var zA=m(Y_=>{"use strict";Object.defineProperty(Y_,"__esModule",{value:!0});Y_.parseLiteralDef=void 0;function uPe(t,e){let r=typeof t.value;return r!=="bigint"&&r!=="number"&&r!=="boolean"&&r!=="string"?{type:Array.isArray(t.value)?"array":"object"}:e.target==="openApi3"?{type:r==="bigint"?"integer":r,enum:[t.value]}:{type:r==="bigint"?"integer":r,const:t.value}}Y_.parseLiteralDef=uPe});var J_=m(on=>{"use strict";Object.defineProperty(on,"__esModule",{value:!0});on.parseStringDef=on.zodPatterns=void 0;var ac=ll();on.zodPatterns={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u"),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function cPe(t,e){let r={type:"string"};function s(n){return e.patternStrategy==="escape"?dPe(n):n}if(t.checks)for(let n of t.checks)switch(n.kind){case"min":(0,ac.setResponseValueAndErrors)(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,n.value):n.value,n.message,e);break;case"max":(0,ac.setResponseValueAndErrors)(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,n.value):n.value,n.message,e);break;case"email":switch(e.emailStrategy){case"format:email":Ei(r,"email",n.message,e);break;case"format:idn-email":Ei(r,"idn-email",n.message,e);break;case"pattern:zod":wi(r,on.zodPatterns.email,n.message,e);break}break;case"url":Ei(r,"uri",n.message,e);break;case"uuid":Ei(r,"uuid",n.message,e);break;case"regex":wi(r,n.regex,n.message,e);break;case"cuid":wi(r,on.zodPatterns.cuid,n.message,e);break;case"cuid2":wi(r,on.zodPatterns.cuid2,n.message,e);break;case"startsWith":wi(r,RegExp(`^${s(n.value)}`),n.message,e);break;case"endsWith":wi(r,RegExp(`${s(n.value)}$`),n.message,e);break;case"datetime":Ei(r,"date-time",n.message,e);break;case"date":Ei(r,"date",n.message,e);break;case"time":Ei(r,"time",n.message,e);break;case"duration":Ei(r,"duration",n.message,e);break;case"length":(0,ac.setResponseValueAndErrors)(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,n.value):n.value,n.message,e),(0,ac.setResponseValueAndErrors)(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,n.value):n.value,n.message,e);break;case"includes":{wi(r,RegExp(s(n.value)),n.message,e);break}case"ip":{n.version!=="v6"&&Ei(r,"ipv4",n.message,e),n.version!=="v4"&&Ei(r,"ipv6",n.message,e);break}case"emoji":wi(r,on.zodPatterns.emoji,n.message,e);break;case"ulid":{wi(r,on.zodPatterns.ulid,n.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{Ei(r,"binary",n.message,e);break}case"contentEncoding:base64":{(0,ac.setResponseValueAndErrors)(r,"contentEncoding","base64",n.message,e);break}case"pattern:zod":{wi(r,on.zodPatterns.base64,n.message,e);break}}break}case"nanoid":wi(r,on.zodPatterns.nanoid,n.message,e);case"toLowerCase":case"toUpperCase":case"trim":break;default:(i=>{})(n)}return r}on.parseStringDef=cPe;var dPe=t=>Array.from(t).map(e=>/[a-zA-Z0-9]/.test(e)?e:`\\${e}`).join(""),Ei=(t,e,r,s)=>{t.format||t.anyOf?.some(n=>n.format)?(t.anyOf||(t.anyOf=[]),t.format&&(t.anyOf.push({format:t.format,...t.errorMessage&&s.errorMessages&&{errorMessage:{format:t.errorMessage.format}}}),delete t.format,t.errorMessage&&(delete t.errorMessage.format,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.anyOf.push({format:e,...r&&s.errorMessages&&{errorMessage:{format:r}}})):(0,ac.setResponseValueAndErrors)(t,"format",e,r,s)},wi=(t,e,r,s)=>{t.pattern||t.allOf?.some(n=>n.pattern)?(t.allOf||(t.allOf=[]),t.pattern&&(t.allOf.push({pattern:t.pattern,...t.errorMessage&&s.errorMessages&&{errorMessage:{pattern:t.errorMessage.pattern}}}),delete t.pattern,t.errorMessage&&(delete t.errorMessage.pattern,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.allOf.push({pattern:KG(e,s),...r&&s.errorMessages&&{errorMessage:{pattern:r}}})):(0,ac.setResponseValueAndErrors)(t,"pattern",KG(e,s),r,s)},KG=(t,e)=>{if(!e.applyRegexFlags||!t.flags)return t.source;let r={i:t.flags.includes("i"),m:t.flags.includes("m"),s:t.flags.includes("s")},s=r.i?t.source.toLowerCase():t.source,n="",i=!1,o=!1,a=!1;for(let l=0;l<s.length;l++){if(i){n+=s[l],i=!1;continue}if(r.i){if(o){if(s[l].match(/[a-z]/)){a?(n+=s[l],n+=`${s[l-2]}-${s[l]}`.toUpperCase(),a=!1):s[l+1]==="-"&&s[l+2]?.match(/[a-z]/)?(n+=s[l],a=!0):n+=`${s[l]}${s[l].toUpperCase()}`;continue}}else if(s[l].match(/[a-z]/)){n+=`[${s[l]}${s[l].toUpperCase()}]`;continue}}if(r.m){if(s[l]==="^"){n+=`(^|(?<=[\r
]))`;continue}else if(s[l]==="$"){n+=`($|(?=[\r
]))`;continue}}if(r.s&&s[l]==="."){n+=o?`${s[l]}\r
`:`[${s[l]}\r
]`;continue}n+=s[l],s[l]==="\\"?i=!0:o&&s[l]==="]"?o=!1:!o&&s[l]==="["&&(o=!0)}try{let l=new RegExp(n)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),t.source}return n}});var eS=m(X_=>{"use strict";Object.defineProperty(X_,"__esModule",{value:!0});X_.parseRecordDef=void 0;var UA=L_(),QG=Sr(),fPe=J_();function hPe(t,e){if(e.target==="openApi3"&&t.keyType?._def.typeName===UA.ZodFirstPartyTypeKind.ZodEnum)return{type:"object",required:t.keyType._def.values,properties:t.keyType._def.values.reduce((s,n)=>({...s,[n]:(0,QG.parseDef)(t.valueType._def,{...e,currentPath:[...e.currentPath,"properties",n]})??{}}),{}),additionalProperties:!1};let r={type:"object",additionalProperties:(0,QG.parseDef)(t.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??{}};if(e.target==="openApi3")return r;if(t.keyType?._def.typeName===UA.ZodFirstPartyTypeKind.ZodString&&t.keyType._def.checks?.length){let s=Object.entries((0,fPe.parseStringDef)(t.keyType._def,e)).reduce((n,[i,o])=>i==="type"?n:{...n,[i]:o},{});return{...r,propertyNames:s}}else if(t.keyType?._def.typeName===UA.ZodFirstPartyTypeKind.ZodEnum)return{...r,propertyNames:{enum:t.keyType._def.values}};return r}X_.parseRecordDef=hPe});var VA=m(tS=>{"use strict";Object.defineProperty(tS,"__esModule",{value:!0});tS.parseMapDef=void 0;var WG=Sr(),pPe=eS();function mPe(t,e){if(e.mapStrategy==="record")return(0,pPe.parseRecordDef)(t,e);let r=(0,WG.parseDef)(t.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},s=(0,WG.parseDef)(t.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[r,s],minItems:2,maxItems:2}}}tS.parseMapDef=mPe});var HA=m(rS=>{"use strict";Object.defineProperty(rS,"__esModule",{value:!0});rS.parseNativeEnumDef=void 0;function gPe(t){let e=t.values,s=Object.keys(t.values).filter(i=>typeof e[e[i]]!="number").map(i=>e[i]),n=Array.from(new Set(s.map(i=>typeof i)));return{type:n.length===1?n[0]==="string"?"string":"number":["string","number"],enum:s}}rS.parseNativeEnumDef=gPe});var GA=m(sS=>{"use strict";Object.defineProperty(sS,"__esModule",{value:!0});sS.parseNeverDef=void 0;function yPe(){return{not:{}}}sS.parseNeverDef=yPe});var KA=m(nS=>{"use strict";Object.defineProperty(nS,"__esModule",{value:!0});nS.parseNullDef=void 0;function vPe(t){return t.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}nS.parseNullDef=vPe});var iS=m(hl=>{"use strict";Object.defineProperty(hl,"__esModule",{value:!0});hl.parseUnionDef=hl.primitiveMappings=void 0;var _Pe=Sr();hl.primitiveMappings={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function SPe(t,e){if(e.target==="openApi3")return ZG(t,e);let r=t.options instanceof Map?Array.from(t.options.values()):t.options;if(r.every(s=>s._def.typeName in hl.primitiveMappings&&(!s._def.checks||!s._def.checks.length))){let s=r.reduce((n,i)=>{let o=hl.primitiveMappings[i._def.typeName];return o&&!n.includes(o)?[...n,o]:n},[]);return{type:s.length>1?s:s[0]}}else if(r.every(s=>s._def.typeName==="ZodLiteral"&&!s.description)){let s=r.reduce((n,i)=>{let o=typeof i._def.value;switch(o){case"string":case"number":case"boolean":return[...n,o];case"bigint":return[...n,"integer"];case"object":if(i._def.value===null)return[...n,"null"];case"symbol":case"undefined":case"function":default:return n}},[]);if(s.length===r.length){let n=s.filter((i,o,a)=>a.indexOf(i)===o);return{type:n.length>1?n:n[0],enum:r.reduce((i,o)=>i.includes(o._def.value)?i:[...i,o._def.value],[])}}}else if(r.every(s=>s._def.typeName==="ZodEnum"))return{type:"string",enum:r.reduce((s,n)=>[...s,...n._def.values.filter(i=>!s.includes(i))],[])};return ZG(t,e)}hl.parseUnionDef=SPe;var ZG=(t,e)=>{let r=(t.options instanceof Map?Array.from(t.options.values()):t.options).map((s,n)=>(0,_Pe.parseDef)(s._def,{...e,currentPath:[...e.currentPath,"anyOf",`${n}`]})).filter(s=>!!s&&(!e.strictUnions||typeof s=="object"&&Object.keys(s).length>0));return r.length?{anyOf:r}:void 0}});var QA=m(oS=>{"use strict";Object.defineProperty(oS,"__esModule",{value:!0});oS.parseNullableDef=void 0;var YG=Sr(),JG=iS();function bPe(t,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(t.innerType._def.typeName)&&(!t.innerType._def.checks||!t.innerType._def.checks.length))return e.target==="openApi3"?{type:JG.primitiveMappings[t.innerType._def.typeName],nullable:!0}:{type:[JG.primitiveMappings[t.innerType._def.typeName],"null"]};if(e.target==="openApi3"){let s=(0,YG.parseDef)(t.innerType._def,{...e,currentPath:[...e.currentPath]});return s&&"$ref"in s?{allOf:[s],nullable:!0}:s&&{...s,nullable:!0}}let r=(0,YG.parseDef)(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}oS.parseNullableDef=bPe});var WA=m(aS=>{"use strict";Object.defineProperty(aS,"__esModule",{value:!0});aS.parseNumberDef=void 0;var pl=ll();function EPe(t,e){let r={type:"number"};if(!t.checks)return r;for(let s of t.checks)switch(s.kind){case"int":r.type="integer",(0,pl.addErrorMessage)(r,"type",s.message,e);break;case"min":e.target==="jsonSchema7"?s.inclusive?(0,pl.setResponseValueAndErrors)(r,"minimum",s.value,s.message,e):(0,pl.setResponseValueAndErrors)(r,"exclusiveMinimum",s.value,s.message,e):(s.inclusive||(r.exclusiveMinimum=!0),(0,pl.setResponseValueAndErrors)(r,"minimum",s.value,s.message,e));break;case"max":e.target==="jsonSchema7"?s.inclusive?(0,pl.setResponseValueAndErrors)(r,"maximum",s.value,s.message,e):(0,pl.setResponseValueAndErrors)(r,"exclusiveMaximum",s.value,s.message,e):(s.inclusive||(r.exclusiveMaximum=!0),(0,pl.setResponseValueAndErrors)(r,"maximum",s.value,s.message,e));break;case"multipleOf":(0,pl.setResponseValueAndErrors)(r,"multipleOf",s.value,s.message,e);break}return r}aS.parseNumberDef=EPe});var YA=m(gf=>{"use strict";Object.defineProperty(gf,"__esModule",{value:!0});gf.parseObjectDef=gf.parseObjectDefX=void 0;var Wm=Sr();function ZA(t,e){return e.removeAdditionalStrategy==="strict"?t.catchall._def.typeName==="ZodNever"?t.unknownKeys!=="strict":(0,Wm.parseDef)(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0:t.catchall._def.typeName==="ZodNever"?t.unknownKeys==="passthrough":(0,Wm.parseDef)(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0}function wPe(t,e){Object.keys(t.shape()).reduce((s,n)=>{let i=t.shape()[n],o=i.isOptional();o||(i={...i._def.innerSchema});let a=(0,Wm.parseDef)(i._def,{...e,currentPath:[...e.currentPath,"properties",n],propertyPath:[...e.currentPath,"properties",n]});return a!==void 0&&(s.properties[n]=a,o||(s.required||(s.required=[]),s.required.push(n))),s},{type:"object",properties:{},additionalProperties:ZA(t,e)});let r={type:"object",...Object.entries(t.shape()).reduce((s,[n,i])=>{if(i===void 0||i._def===void 0)return s;let o=(0,Wm.parseDef)(i._def,{...e,currentPath:[...e.currentPath,"properties",n],propertyPath:[...e.currentPath,"properties",n]});return o===void 0?s:{properties:{...s.properties,[n]:o},required:i.isOptional()?s.required:[...s.required,n]}},{properties:{},required:[]}),additionalProperties:ZA(t,e)};return r.required.length||delete r.required,r}gf.parseObjectDefX=wPe;function TPe(t,e){let r={type:"object",...Object.entries(t.shape()).reduce((s,[n,i])=>{if(i===void 0||i._def===void 0)return s;let o=(0,Wm.parseDef)(i._def,{...e,currentPath:[...e.currentPath,"properties",n],propertyPath:[...e.currentPath,"properties",n]});return o===void 0?s:{properties:{...s.properties,[n]:o},required:i.isOptional()?s.required:[...s.required,n]}},{properties:{},required:[]}),additionalProperties:ZA(t,e)};return r.required.length||delete r.required,r}gf.parseObjectDef=TPe});var JA=m(lS=>{"use strict";Object.defineProperty(lS,"__esModule",{value:!0});lS.parseOptionalDef=void 0;var XG=Sr(),CPe=(t,e)=>{if(e.currentPath.toString()===e.propertyPath?.toString())return(0,XG.parseDef)(t.innerType._def,e);let r=(0,XG.parseDef)(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return r?{anyOf:[{not:{}},r]}:{}};lS.parseOptionalDef=CPe});var XA=m(cS=>{"use strict";Object.defineProperty(cS,"__esModule",{value:!0});cS.parsePipelineDef=void 0;var uS=Sr(),RPe=(t,e)=>{if(e.pipeStrategy==="input")return(0,uS.parseDef)(t.in._def,e);if(e.pipeStrategy==="output")return(0,uS.parseDef)(t.out._def,e);let r=(0,uS.parseDef)(t.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),s=(0,uS.parseDef)(t.out._def,{...e,currentPath:[...e.currentPath,"allOf",r?"1":"0"]});return{allOf:[r,s].filter(n=>n!==void 0)}};cS.parsePipelineDef=RPe});var ek=m(dS=>{"use strict";Object.defineProperty(dS,"__esModule",{value:!0});dS.parsePromiseDef=void 0;var OPe=Sr();function PPe(t,e){return(0,OPe.parseDef)(t.type._def,e)}dS.parsePromiseDef=PPe});var tk=m(fS=>{"use strict";Object.defineProperty(fS,"__esModule",{value:!0});fS.parseSetDef=void 0;var e8=ll(),APe=Sr();function kPe(t,e){let s={type:"array",uniqueItems:!0,items:(0,APe.parseDef)(t.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return t.minSize&&(0,e8.setResponseValueAndErrors)(s,"minItems",t.minSize.value,t.minSize.message,e),t.maxSize&&(0,e8.setResponseValueAndErrors)(s,"maxItems",t.maxSize.value,t.maxSize.message,e),s}fS.parseSetDef=kPe});var sk=m(hS=>{"use strict";Object.defineProperty(hS,"__esModule",{value:!0});hS.parseTupleDef=void 0;var rk=Sr();function xPe(t,e){return t.rest?{type:"array",minItems:t.items.length,items:t.items.map((r,s)=>(0,rk.parseDef)(r._def,{...e,currentPath:[...e.currentPath,"items",`${s}`]})).reduce((r,s)=>s===void 0?r:[...r,s],[]),additionalItems:(0,rk.parseDef)(t.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:t.items.length,maxItems:t.items.length,items:t.items.map((r,s)=>(0,rk.parseDef)(r._def,{...e,currentPath:[...e.currentPath,"items",`${s}`]})).reduce((r,s)=>s===void 0?r:[...r,s],[])}}hS.parseTupleDef=xPe});var nk=m(pS=>{"use strict";Object.defineProperty(pS,"__esModule",{value:!0});pS.parseUndefinedDef=void 0;function IPe(){return{not:{}}}pS.parseUndefinedDef=IPe});var ik=m(mS=>{"use strict";Object.defineProperty(mS,"__esModule",{value:!0});mS.parseUnknownDef=void 0;function NPe(){return{}}mS.parseUnknownDef=NPe});var ok=m(gS=>{"use strict";Object.defineProperty(gS,"__esModule",{value:!0});gS.parseReadonlyDef=void 0;var DPe=Sr(),MPe=(t,e)=>(0,DPe.parseDef)(t.innerType._def,e);gS.parseReadonlyDef=MPe});var Sr=m(yS=>{"use strict";Object.defineProperty(yS,"__esModule",{value:!0});yS.parseDef=void 0;var Xe=L_(),$Pe=xA(),qPe=IA(),LPe=NA(),jPe=DA(),FPe=MA(),BPe=$A(),zPe=qA(),UPe=LA(),VPe=jA(),HPe=FA(),GPe=BA(),KPe=zA(),QPe=VA(),WPe=HA(),ZPe=GA(),YPe=KA(),JPe=QA(),XPe=WA(),eAe=YA(),tAe=JA(),rAe=XA(),sAe=ek(),nAe=eS(),iAe=tk(),oAe=J_(),aAe=sk(),lAe=nk(),uAe=iS(),cAe=ik(),dAe=ok(),fAe=I_();function t8(t,e,r=!1){let s=e.seen.get(t);if(e.override){let o=e.override?.(t,e,s,r);if(o!==fAe.ignoreOverride)return o}if(s&&!r){let o=hAe(s,e);if(o!==void 0)return o}let n={def:t,path:e.currentPath,jsonSchema:void 0};e.seen.set(t,n);let i=mAe(t,t.typeName,e);return i&&gAe(t,e,i),n.jsonSchema=i,i}yS.parseDef=t8;var hAe=(t,e)=>{switch(e.$refStrategy){case"root":return{$ref:t.path.join("/")};case"relative":return{$ref:pAe(e.currentPath,t.path)};case"none":case"seen":return t.path.length<e.currentPath.length&&t.path.every((r,s)=>e.currentPath[s]===r)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},pAe=(t,e)=>{let r=0;for(;r<t.length&&r<e.length&&t[r]===e[r];r++);return[(t.length-r).toString(),...e.slice(r)].join("/")},mAe=(t,e,r)=>{switch(e){case Xe.ZodFirstPartyTypeKind.ZodString:return(0,oAe.parseStringDef)(t,r);case Xe.ZodFirstPartyTypeKind.ZodNumber:return(0,XPe.parseNumberDef)(t,r);case Xe.ZodFirstPartyTypeKind.ZodObject:return(0,eAe.parseObjectDef)(t,r);case Xe.ZodFirstPartyTypeKind.ZodBigInt:return(0,LPe.parseBigintDef)(t,r);case Xe.ZodFirstPartyTypeKind.ZodBoolean:return(0,jPe.parseBooleanDef)();case Xe.ZodFirstPartyTypeKind.ZodDate:return(0,zPe.parseDateDef)(t,r);case Xe.ZodFirstPartyTypeKind.ZodUndefined:return(0,lAe.parseUndefinedDef)();case Xe.ZodFirstPartyTypeKind.ZodNull:return(0,YPe.parseNullDef)(r);case Xe.ZodFirstPartyTypeKind.ZodArray:return(0,qPe.parseArrayDef)(t,r);case Xe.ZodFirstPartyTypeKind.ZodUnion:case Xe.ZodFirstPartyTypeKind.ZodDiscriminatedUnion:return(0,uAe.parseUnionDef)(t,r);case Xe.ZodFirstPartyTypeKind.ZodIntersection:return(0,GPe.parseIntersectionDef)(t,r);case Xe.ZodFirstPartyTypeKind.ZodTuple:return(0,aAe.parseTupleDef)(t,r);case Xe.ZodFirstPartyTypeKind.ZodRecord:return(0,nAe.parseRecordDef)(t,r);case Xe.ZodFirstPartyTypeKind.ZodLiteral:return(0,KPe.parseLiteralDef)(t,r);case Xe.ZodFirstPartyTypeKind.ZodEnum:return(0,HPe.parseEnumDef)(t);case Xe.ZodFirstPartyTypeKind.ZodNativeEnum:return(0,WPe.parseNativeEnumDef)(t);case Xe.ZodFirstPartyTypeKind.ZodNullable:return(0,JPe.parseNullableDef)(t,r);case Xe.ZodFirstPartyTypeKind.ZodOptional:return(0,tAe.parseOptionalDef)(t,r);case Xe.ZodFirstPartyTypeKind.ZodMap:return(0,QPe.parseMapDef)(t,r);case Xe.ZodFirstPartyTypeKind.ZodSet:return(0,iAe.parseSetDef)(t,r);case Xe.ZodFirstPartyTypeKind.ZodLazy:return t8(t.getter()._def,r);case Xe.ZodFirstPartyTypeKind.ZodPromise:return(0,sAe.parsePromiseDef)(t,r);case Xe.ZodFirstPartyTypeKind.ZodNaN:case Xe.ZodFirstPartyTypeKind.ZodNever:return(0,ZPe.parseNeverDef)();case Xe.ZodFirstPartyTypeKind.ZodEffects:return(0,VPe.parseEffectsDef)(t,r);case Xe.ZodFirstPartyTypeKind.ZodAny:return(0,$Pe.parseAnyDef)();case Xe.ZodFirstPartyTypeKind.ZodUnknown:return(0,cAe.parseUnknownDef)();case Xe.ZodFirstPartyTypeKind.ZodDefault:return(0,UPe.parseDefaultDef)(t,r);case Xe.ZodFirstPartyTypeKind.ZodBranded:return(0,FPe.parseBrandedDef)(t,r);case Xe.ZodFirstPartyTypeKind.ZodReadonly:return(0,dAe.parseReadonlyDef)(t,r);case Xe.ZodFirstPartyTypeKind.ZodCatch:return(0,BPe.parseCatchDef)(t,r);case Xe.ZodFirstPartyTypeKind.ZodPipeline:return(0,rAe.parsePipelineDef)(t,r);case Xe.ZodFirstPartyTypeKind.ZodFunction:case Xe.ZodFirstPartyTypeKind.ZodVoid:case Xe.ZodFirstPartyTypeKind.ZodSymbol:return;default:return(s=>{})(e)}},gAe=(t,e,r)=>(t.description&&(r.description=t.description,e.markdownDescription&&(r.markdownDescription=t.description)),r)});var ak=m(vS=>{"use strict";Object.defineProperty(vS,"__esModule",{value:!0});vS.zodToJsonSchema=void 0;var r8=Sr(),yAe=TA(),vAe=(t,e)=>{let r=(0,yAe.getRefs)(e),s=typeof e=="object"&&e.definitions?Object.entries(e.definitions).reduce((l,[u,c])=>({...l,[u]:(0,r8.parseDef)(c._def,{...r,currentPath:[...r.basePath,r.definitionPath,u]},!0)??{}}),{}):void 0,n=typeof e=="string"?e:e?.nameStrategy==="title"?void 0:e?.name,i=(0,r8.parseDef)(t._def,n===void 0?r:{...r,currentPath:[...r.basePath,r.definitionPath,n]},!1)??{},o=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;o!==void 0&&(i.title=o);let a=n===void 0?s?{...i,[r.definitionPath]:s}:i:{$ref:[...r.$refStrategy==="relative"?[]:r.basePath,r.definitionPath,n].join("/"),[r.definitionPath]:{...s,[n]:i}};return r.target==="jsonSchema7"?a.$schema="http://json-schema.org/draft-07/schema#":r.target==="jsonSchema2019-09"&&(a.$schema="https://json-schema.org/draft/2019-09/schema#"),a};vS.zodToJsonSchema=vAe});var s8=m(qe=>{"use strict";var _Ae=qe&&qe.__createBinding||(Object.create?function(t,e,r,s){s===void 0&&(s=r);var n=Object.getOwnPropertyDescriptor(e,r);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,s,n)}:function(t,e,r,s){s===void 0&&(s=r),t[s]=e[r]}),tt=qe&&qe.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&_Ae(e,t,r)};Object.defineProperty(qe,"__esModule",{value:!0});tt(I_(),qe);tt(TA(),qe);tt(ll(),qe);tt(Sr(),qe);tt(xA(),qe);tt(IA(),qe);tt(NA(),qe);tt(DA(),qe);tt(MA(),qe);tt($A(),qe);tt(qA(),qe);tt(LA(),qe);tt(jA(),qe);tt(FA(),qe);tt(BA(),qe);tt(zA(),qe);tt(VA(),qe);tt(HA(),qe);tt(GA(),qe);tt(KA(),qe);tt(QA(),qe);tt(WA(),qe);tt(YA(),qe);tt(JA(),qe);tt(XA(),qe);tt(ek(),qe);tt(ok(),qe);tt(eS(),qe);tt(tk(),qe);tt(J_(),qe);tt(sk(),qe);tt(nk(),qe);tt(iS(),qe);tt(ik(),qe);tt(ak(),qe);var SAe=ak();qe.default=SAe.zodToJsonSchema});var n8=m(_S=>{"use strict";Object.defineProperty(_S,"__esModule",{value:!0});_S.ResponseValidationError=void 0;var lk=class extends Error{constructor(e,r,s){super("Response doesn't match the schema"),this.name="ResponseValidationError",this.details={error:e.error?.issues??[],method:r,url:s}}};_S.ResponseValidationError=lk});var u8=m(Ti=>{"use strict";Object.defineProperty(Ti,"__esModule",{value:!0});Ti.serializerCompiler=Ti.validatorCompiler=Ti.jsonSchemaTransform=Ti.createJsonSchemaTransform=void 0;var i8=s8(),bAe=n8(),EAe=["/documentation/","/documentation/initOAuth","/documentation/json","/documentation/uiConfig","/documentation/yaml","/documentation/*","/documentation/static/*"],o8={target:"openApi3",$refStrategy:"none"},wAe=({skipList:t})=>({schema:e,url:r})=>{if(!e)return{schema:e,url:r};let{response:s,headers:n,querystring:i,body:o,params:a,hide:l,...u}=e,c={};if(t.includes(r)||l)return c.hide=!0,{schema:c,url:r};let d={headers:n,querystring:i,body:o,params:a};for(let f in d){let h=d[f];h&&(c[f]=(0,i8.zodToJsonSchema)(h,o8))}if(s){c.response={};for(let f in s){let h=l8(s[f]),p=(0,i8.zodToJsonSchema)(h,o8);c.response[f]=p}}for(let f in u){let h=u[f];h&&(c[f]=h)}return{schema:c,url:r}};Ti.createJsonSchemaTransform=wAe;Ti.jsonSchemaTransform=(0,Ti.createJsonSchemaTransform)({skipList:EAe});var TAe=({schema:t})=>e=>{try{return{value:t.parse(e)}}catch(r){return{error:r}}};Ti.validatorCompiler=TAe;function a8(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function l8(t){if(a8(t,"safeParse"))return t;if(a8(t,"properties"))return t.properties;throw new Error(`Invalid schema passed: ${JSON.stringify(t)}`)}var CAe=({schema:t,method:e,url:r})=>s=>{let i=l8(t).safeParse(s);if(i.success)return JSON.stringify(i.data);throw new bAe.ResponseValidationError(i,e,r)};Ti.serializerCompiler=CAe});var C8=m((RKe,kke)=>{kke.exports={acl:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},append:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},asking:{arity:1,flags:["fast"],keyStart:0,keyStop:0,step:0},auth:{arity:-2,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},bgrewriteaof:{arity:1,flags:["admin","noscript","no_async_loading"],keyStart:0,keyStop:0,step:0},bgsave:{arity:-1,flags:["admin","noscript","no_async_loading"],keyStart:0,keyStop:0,step:0},bitcount:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},bitfield:{arity:-2,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},bitfield_ro:{arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},bitop:{arity:-4,flags:["write","denyoom"],keyStart:2,keyStop:-1,step:1},bitpos:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},blmove:{arity:6,flags:["write","denyoom","noscript","blocking"],keyStart:1,keyStop:2,step:1},blmpop:{arity:-5,flags:["write","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},blpop:{arity:-3,flags:["write","noscript","blocking"],keyStart:1,keyStop:-2,step:1},brpop:{arity:-3,flags:["write","noscript","blocking"],keyStart:1,keyStop:-2,step:1},brpoplpush:{arity:4,flags:["write","denyoom","noscript","blocking"],keyStart:1,keyStop:2,step:1},bzmpop:{arity:-5,flags:["write","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},bzpopmax:{arity:-3,flags:["write","noscript","blocking","fast"],keyStart:1,keyStop:-2,step:1},bzpopmin:{arity:-3,flags:["write","noscript","blocking","fast"],keyStart:1,keyStop:-2,step:1},client:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},cluster:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},command:{arity:-1,flags:["loading","stale"],keyStart:0,keyStop:0,step:0},config:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},copy:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},dbsize:{arity:1,flags:["readonly","fast"],keyStart:0,keyStop:0,step:0},debug:{arity:-2,flags:["admin","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},decr:{arity:2,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},decrby:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},del:{arity:-2,flags:["write"],keyStart:1,keyStop:-1,step:1},discard:{arity:1,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:0,keyStop:0,step:0},dump:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},echo:{arity:2,flags:["fast"],keyStart:0,keyStop:0,step:0},eval:{arity:-3,flags:["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},eval_ro:{arity:-3,flags:["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},evalsha:{arity:-3,flags:["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},evalsha_ro:{arity:-3,flags:["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},exec:{arity:1,flags:["noscript","loading","stale","skip_slowlog"],keyStart:0,keyStop:0,step:0},exists:{arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:-1,step:1},expire:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},expireat:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},expiretime:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},failover:{arity:-1,flags:["admin","noscript","stale"],keyStart:0,keyStop:0,step:0},fcall:{arity:-3,flags:["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},fcall_ro:{arity:-3,flags:["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},flushall:{arity:-1,flags:["write"],keyStart:0,keyStop:0,step:0},flushdb:{arity:-1,flags:["write"],keyStart:0,keyStop:0,step:0},function:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},geoadd:{arity:-5,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},geodist:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},geohash:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},geopos:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},georadius:{arity:-6,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},georadius_ro:{arity:-6,flags:["readonly"],keyStart:1,keyStop:1,step:1},georadiusbymember:{arity:-5,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},georadiusbymember_ro:{arity:-5,flags:["readonly"],keyStart:1,keyStop:1,step:1},geosearch:{arity:-7,flags:["readonly"],keyStart:1,keyStop:1,step:1},geosearchstore:{arity:-8,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},get:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},getbit:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},getdel:{arity:2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},getex:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},getrange:{arity:4,flags:["readonly"],keyStart:1,keyStop:1,step:1},getset:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hdel:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},hello:{arity:-1,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},hexists:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hget:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hgetall:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},hincrby:{arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hincrbyfloat:{arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hkeys:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},hlen:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hmget:{arity:-3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hmset:{arity:-4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hrandfield:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},hscan:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},hset:{arity:-4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hsetnx:{arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hstrlen:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hvals:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},incr:{arity:2,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},incrby:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},incrbyfloat:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},info:{arity:-1,flags:["loading","stale"],keyStart:0,keyStop:0,step:0},keys:{arity:2,flags:["readonly"],keyStart:0,keyStop:0,step:0},lastsave:{arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},latency:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},lcs:{arity:-3,flags:["readonly"],keyStart:1,keyStop:2,step:1},lindex:{arity:3,flags:["readonly"],keyStart:1,keyStop:1,step:1},linsert:{arity:5,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},llen:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},lmove:{arity:5,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},lmpop:{arity:-4,flags:["write","movablekeys"],keyStart:0,keyStop:0,step:0},lolwut:{arity:-1,flags:["readonly","fast"],keyStart:0,keyStop:0,step:0},lpop:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},lpos:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},lpush:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},lpushx:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},lrange:{arity:4,flags:["readonly"],keyStart:1,keyStop:1,step:1},lrem:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},lset:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},ltrim:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},memory:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},mget:{arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:-1,step:1},migrate:{arity:-6,flags:["write","movablekeys"],keyStart:3,keyStop:3,step:1},module:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},monitor:{arity:1,flags:["admin","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},move:{arity:3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},mset:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:2},msetnx:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:2},multi:{arity:1,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:0,keyStop:0,step:0},object:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},persist:{arity:2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},pexpire:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},pexpireat:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},pexpiretime:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},pfadd:{arity:-2,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},pfcount:{arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},pfdebug:{arity:3,flags:["write","denyoom","admin"],keyStart:2,keyStop:2,step:1},pfmerge:{arity:-2,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},pfselftest:{arity:1,flags:["admin"],keyStart:0,keyStop:0,step:0},ping:{arity:-1,flags:["fast"],keyStart:0,keyStop:0,step:0},psetex:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},psubscribe:{arity:-2,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},psync:{arity:-3,flags:["admin","noscript","no_async_loading","no_multi"],keyStart:0,keyStop:0,step:0},pttl:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},publish:{arity:3,flags:["pubsub","loading","stale","fast"],keyStart:0,keyStop:0,step:0},pubsub:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},punsubscribe:{arity:-1,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},quit:{arity:-1,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},randomkey:{arity:1,flags:["readonly"],keyStart:0,keyStop:0,step:0},readonly:{arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},readwrite:{arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},rename:{arity:3,flags:["write"],keyStart:1,keyStop:2,step:1},renamenx:{arity:3,flags:["write","fast"],keyStart:1,keyStop:2,step:1},replconf:{arity:-1,flags:["admin","noscript","loading","stale","allow_busy"],keyStart:0,keyStop:0,step:0},replicaof:{arity:3,flags:["admin","noscript","stale","no_async_loading"],keyStart:0,keyStop:0,step:0},reset:{arity:1,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},restore:{arity:-4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},"restore-asking":{arity:-4,flags:["write","denyoom","asking"],keyStart:1,keyStop:1,step:1},role:{arity:1,flags:["noscript","loading","stale","fast"],keyStart:0,keyStop:0,step:0},rpop:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},rpoplpush:{arity:3,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},rpush:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},rpushx:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},sadd:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},save:{arity:1,flags:["admin","noscript","no_async_loading","no_multi"],keyStart:0,keyStop:0,step:0},scan:{arity:-2,flags:["readonly"],keyStart:0,keyStop:0,step:0},scard:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},script:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},sdiff:{arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},sdiffstore:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},select:{arity:2,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},set:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},setbit:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},setex:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},setnx:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},setrange:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},shutdown:{arity:-1,flags:["admin","noscript","loading","stale","no_multi","allow_busy"],keyStart:0,keyStop:0,step:0},sinter:{arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},sintercard:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},sinterstore:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},sismember:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},slaveof:{arity:3,flags:["admin","noscript","stale","no_async_loading"],keyStart:0,keyStop:0,step:0},slowlog:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},smembers:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},smismember:{arity:-3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},smove:{arity:4,flags:["write","fast"],keyStart:1,keyStop:2,step:1},sort:{arity:-2,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},sort_ro:{arity:-2,flags:["readonly","movablekeys"],keyStart:1,keyStop:1,step:1},spop:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},spublish:{arity:3,flags:["pubsub","loading","stale","fast"],keyStart:1,keyStop:1,step:1},srandmember:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},srem:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},sscan:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},ssubscribe:{arity:-2,flags:["pubsub","noscript","loading","stale"],keyStart:1,keyStop:-1,step:1},strlen:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},subscribe:{arity:-2,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},substr:{arity:4,flags:["readonly"],keyStart:1,keyStop:1,step:1},sunion:{arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},sunionstore:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},sunsubscribe:{arity:-1,flags:["pubsub","noscript","loading","stale"],keyStart:1,keyStop:-1,step:1},swapdb:{arity:3,flags:["write","fast"],keyStart:0,keyStop:0,step:0},sync:{arity:1,flags:["admin","noscript","no_async_loading","no_multi"],keyStart:0,keyStop:0,step:0},time:{arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},touch:{arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:-1,step:1},ttl:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},type:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},unlink:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:-1,step:1},unsubscribe:{arity:-1,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},unwatch:{arity:1,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:0,keyStop:0,step:0},wait:{arity:3,flags:["noscript"],keyStart:0,keyStop:0,step:0},watch:{arity:-2,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:1,keyStop:-1,step:1},xack:{arity:-4,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xadd:{arity:-5,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},xautoclaim:{arity:-6,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xclaim:{arity:-6,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xdel:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xgroup:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},xinfo:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},xlen:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},xpending:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},xrange:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},xread:{arity:-4,flags:["readonly","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},xreadgroup:{arity:-7,flags:["write","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},xrevrange:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},xsetid:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},xtrim:{arity:-4,flags:["write"],keyStart:1,keyStop:1,step:1},zadd:{arity:-4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},zcard:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zcount:{arity:4,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zdiff:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zdiffstore:{arity:-4,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},zincrby:{arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},zinter:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zintercard:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zinterstore:{arity:-4,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},zlexcount:{arity:4,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zmpop:{arity:-4,flags:["write","movablekeys"],keyStart:0,keyStop:0,step:0},zmscore:{arity:-3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zpopmax:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},zpopmin:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},zrandmember:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrange:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrangebylex:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrangebyscore:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrangestore:{arity:-5,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},zrank:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zrem:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},zremrangebylex:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},zremrangebyrank:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},zremrangebyscore:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},zrevrange:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrevrangebylex:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrevrangebyscore:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrevrank:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zscan:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},zscore:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zunion:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zunionstore:{arity:-4,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1}}});var Cf=m(cn=>{"use strict";var xke=cn&&cn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(cn,"__esModule",{value:!0});cn.getKeyIndexes=cn.hasFlag=cn.exists=cn.list=void 0;var TS=xke(C8());cn.list=Object.keys(TS.default);var pk={};cn.list.forEach(t=>{pk[t]=TS.default[t].flags.reduce(function(e,r){return e[r]=!0,e},{})});function Ike(t){return!!TS.default[t]}cn.exists=Ike;function Nke(t,e){if(!pk[t])throw new Error("Unknown command "+t);return!!pk[t][e]}cn.hasFlag=Nke;function Dke(t,e,r){let s=TS.default[t];if(!s)throw new Error("Unknown command "+t);if(!Array.isArray(e))throw new Error("Expect args to be an array");let n=[],i=!!(r&&r.parseExternalKey),o=(l,u)=>{let c=[],d=Number(l[u]);for(let f=0;f<d;f++)c.push(f+u+1);return c},a=(l,u,c)=>{for(let d=u;d<l.length-1;d+=1)if(String(l[d]).toLowerCase()===c.toLowerCase())return d+1;return null};switch(t){case"zunionstore":case"zinterstore":case"zdiffstore":n.push(0,...o(e,1));break;case"eval":case"evalsha":case"eval_ro":case"evalsha_ro":case"fcall":case"fcall_ro":case"blmpop":case"bzmpop":n.push(...o(e,1));break;case"sintercard":case"lmpop":case"zunion":case"zinter":case"zmpop":case"zintercard":case"zdiff":{n.push(...o(e,0));break}case"georadius":{n.push(0);let l=a(e,5,"STORE");l&&n.push(l);let u=a(e,5,"STOREDIST");u&&n.push(u);break}case"georadiusbymember":{n.push(0);let l=a(e,4,"STORE");l&&n.push(l);let u=a(e,4,"STOREDIST");u&&n.push(u);break}case"sort":case"sort_ro":n.push(0);for(let l=1;l<e.length-1;l++){let u=e[l];if(typeof u!="string")continue;let c=u.toUpperCase();c==="GET"?(l+=1,u=e[l],u!=="#"&&(i?n.push([l,R8(u)]):n.push(l))):c==="BY"?(l+=1,i?n.push([l,R8(e[l])]):n.push(l)):c==="STORE"&&(l+=1,n.push(l))}break;case"migrate":if(e[2]==="")for(let l=5;l<e.length-1;l++){let u=e[l];if(typeof u=="string"&&u.toUpperCase()==="KEYS"){for(let c=l+1;c<e.length;c++)n.push(c);break}}else n.push(2);break;case"xreadgroup":case"xread":for(let l=t==="xread"?0:3;l<e.length-1;l++)if(String(e[l]).toUpperCase()==="STREAMS"){for(let u=l+1;u<=l+(e.length-1-l)/2;u++)n.push(u);break}break;default:if(s.step>0){let l=s.keyStart-1,u=s.keyStop>0?s.keyStop:e.length+s.keyStop+1;for(let c=l;c<u;c+=s.step)n.push(c)}break}return n}cn.getKeyIndexes=Dke;function R8(t){typeof t!="string"&&(t=String(t));let e=t.indexOf("->");return e===-1?t.length:e}});var O8=m(_l=>{"use strict";Object.defineProperty(_l,"__esModule",{value:!0});_l.tryCatch=_l.errorObj=void 0;_l.errorObj={e:{}};var mk;function Mke(t,e){try{let r=mk;return mk=null,r.apply(this,arguments)}catch(r){return _l.errorObj.e=r,_l.errorObj}}function $ke(t){return mk=t,Mke}_l.tryCatch=$ke});var Sl=m(gk=>{"use strict";Object.defineProperty(gk,"__esModule",{value:!0});var Rf=O8();function P8(t){setTimeout(function(){throw t},0)}function qke(t,e,r){return typeof e=="function"&&t.then(s=>{let n;r!==void 0&&Object(r).spread&&Array.isArray(s)?n=Rf.tryCatch(e).apply(void 0,[null].concat(s)):n=s===void 0?Rf.tryCatch(e)(null):Rf.tryCatch(e)(null,s),n===Rf.errorObj&&P8(n.e)},s=>{if(!s){let i=new Error(s+"");Object.assign(i,{cause:s}),s=i}let n=Rf.tryCatch(e)(s);n===Rf.errorObj&&P8(n.e)}),t}gk.default=qke});var x8=m((kKe,k8)=>{"use strict";var A8=require("assert"),tg=require("util");function Of(t){Object.defineProperty(this,"message",{value:t||"",configurable:!0,writable:!0}),Error.captureStackTrace(this,this.constructor)}tg.inherits(Of,Error);Object.defineProperty(Of.prototype,"name",{value:"RedisError",configurable:!0,writable:!0});function yk(t,e,r){A8(e),A8.strictEqual(typeof r,"number"),Object.defineProperty(this,"message",{value:t||"",configurable:!0,writable:!0});let s=Error.stackTraceLimit;Error.stackTraceLimit=2,Error.captureStackTrace(this,this.constructor),Error.stackTraceLimit=s,this.offset=r,this.buffer=e}tg.inherits(yk,Of);Object.defineProperty(yk.prototype,"name",{value:"ParserError",configurable:!0,writable:!0});function vk(t){Object.defineProperty(this,"message",{value:t||"",configurable:!0,writable:!0});let e=Error.stackTraceLimit;Error.stackTraceLimit=2,Error.captureStackTrace(this,this.constructor),Error.stackTraceLimit=e}tg.inherits(vk,Of);Object.defineProperty(vk.prototype,"name",{value:"ReplyError",configurable:!0,writable:!0});function CS(t){Object.defineProperty(this,"message",{value:t||"",configurable:!0,writable:!0}),Error.captureStackTrace(this,this.constructor)}tg.inherits(CS,Of);Object.defineProperty(CS.prototype,"name",{value:"AbortError",configurable:!0,writable:!0});function _k(t){Object.defineProperty(this,"message",{value:t||"",configurable:!0,writable:!0}),Error.captureStackTrace(this,this.constructor)}tg.inherits(_k,CS);Object.defineProperty(_k.prototype,"name",{value:"InterruptError",configurable:!0,writable:!0});k8.exports={RedisError:Of,ParserError:yk,ReplyError:vk,AbortError:CS,InterruptError:_k}});var D8=m((xKe,N8)=>{"use strict";var I8=require("assert"),Pf=class extends Error{get name(){return this.constructor.name}},Sk=class extends Pf{constructor(e,r,s){I8(r),I8.strictEqual(typeof s,"number");let n=Error.stackTraceLimit;Error.stackTraceLimit=2,super(e),Error.stackTraceLimit=n,this.offset=s,this.buffer=r}get name(){return this.constructor.name}},bk=class extends Pf{constructor(e){let r=Error.stackTraceLimit;Error.stackTraceLimit=2,super(e),Error.stackTraceLimit=r}get name(){return this.constructor.name}},RS=class extends Pf{get name(){return this.constructor.name}},Ek=class extends RS{get name(){return this.constructor.name}};N8.exports={RedisError:Pf,ParserError:Sk,ReplyError:bk,AbortError:RS,InterruptError:Ek}});var bc=m((IKe,M8)=>{"use strict";var Lke=process.version.charCodeAt(1)<55&&process.version.charCodeAt(2)===46?x8():D8();M8.exports=Lke});var OS=m((NKe,wk)=>{var $8=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920],jke=function(e){for(var r,s=0,n=0,i=[],o=e.length;s<o;s++)r=e.charCodeAt(s),r<128?i[n++]=r:r<2048?(i[n++]=r>>6|192,i[n++]=r&63|128):(r&64512)===55296&&s+1<e.length&&(e.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(e.charCodeAt(++s)&1023),i[n++]=r>>18|240,i[n++]=r>>12&63|128,i[n++]=r>>6&63|128,i[n++]=r&63|128):(i[n++]=r>>12|224,i[n++]=r>>6&63|128,i[n++]=r&63|128);return i},q8=wk.exports=function(e){for(var r,s=0,n=-1,i=0,o=0,a=typeof e=="string"?jke(e):e,l=a.length;s<l;){if(r=a[s++],n===-1)r===123&&(n=s);else if(r!==125)o=$8[(r^o>>8)&255]^o<<8;else if(s-1!==n)return o&16383;i=$8[(r^i>>8)&255]^i<<8}return i&16383};wk.exports.generateMulti=function(e){for(var r=1,s=e.length,n=q8(e[0]);r<s;)if(q8(e[r++])!==n)return-1;return n}});var H8=m((DKe,V8)=>{var j8=9007199254740991,Fke="[object Arguments]",Bke="[object Function]",zke="[object GeneratorFunction]",Uke=/^(?:0|[1-9]\d*)$/;function F8(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function Vke(t,e){for(var r=-1,s=Array(t);++r<t;)s[r]=e(r);return s}var rg=Object.prototype,sg=rg.hasOwnProperty,B8=rg.toString,Hke=rg.propertyIsEnumerable,L8=Math.max;function Gke(t,e){var r=rxe(t)||txe(t)?Vke(t.length,String):[],s=r.length,n=!!s;for(var i in t)(e||sg.call(t,i))&&!(n&&(i=="length"||U8(i,s)))&&r.push(i);return r}function Kke(t,e,r,s){return t===void 0||Tk(t,rg[r])&&!sg.call(s,r)?e:t}function Qke(t,e,r){var s=t[e];(!(sg.call(t,e)&&Tk(s,r))||r===void 0&&!(e in t))&&(t[e]=r)}function Wke(t){if(!Rk(t))return exe(t);var e=Xke(t),r=[];for(var s in t)s=="constructor"&&(e||!sg.call(t,s))||r.push(s);return r}function z8(t,e){return e=L8(e===void 0?t.length-1:e,0),function(){for(var r=arguments,s=-1,n=L8(r.length-e,0),i=Array(n);++s<n;)i[s]=r[e+s];s=-1;for(var o=Array(e+1);++s<e;)o[s]=r[s];return o[e]=i,F8(t,this,o)}}function Zke(t,e,r,s){r||(r={});for(var n=-1,i=e.length;++n<i;){var o=e[n],a=s?s(r[o],t[o],o,r,t):void 0;Qke(r,o,a===void 0?t[o]:a)}return r}function Yke(t){return z8(function(e,r){var s=-1,n=r.length,i=n>1?r[n-1]:void 0,o=n>2?r[2]:void 0;for(i=t.length>3&&typeof i=="function"?(n--,i):void 0,o&&Jke(r[0],r[1],o)&&(i=n<3?void 0:i,n=1),e=Object(e);++s<n;){var a=r[s];a&&t(e,a,s,i)}return e})}function U8(t,e){return e=e??j8,!!e&&(typeof t=="number"||Uke.test(t))&&t>-1&&t%1==0&&t<e}function Jke(t,e,r){if(!Rk(r))return!1;var s=typeof e;return(s=="number"?Ck(r)&&U8(e,r.length):s=="string"&&e in r)?Tk(r[e],t):!1}function Xke(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||rg;return t===r}function exe(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}function Tk(t,e){return t===e||t!==t&&e!==e}function txe(t){return sxe(t)&&sg.call(t,"callee")&&(!Hke.call(t,"callee")||B8.call(t)==Fke)}var rxe=Array.isArray;function Ck(t){return t!=null&&ixe(t.length)&&!nxe(t)}function sxe(t){return oxe(t)&&Ck(t)}function nxe(t){var e=Rk(t)?B8.call(t):"";return e==Bke||e==zke}function ixe(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=j8}function Rk(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function oxe(t){return!!t&&typeof t=="object"}var axe=Yke(function(t,e,r,s){Zke(e,uxe(e),t,s)}),lxe=z8(function(t){return t.push(void 0,Kke),F8(axe,void 0,t)});function uxe(t){return Ck(t)?Gke(t,!0):Wke(t)}V8.exports=lxe});var Q8=m((MKe,K8)=>{var cxe=9007199254740991,dxe="[object Arguments]",fxe="[object Function]",hxe="[object GeneratorFunction]",Ok=Object.prototype,pxe=Ok.hasOwnProperty,G8=Ok.toString,mxe=Ok.propertyIsEnumerable;function gxe(t){return vxe(t)&&pxe.call(t,"callee")&&(!mxe.call(t,"callee")||G8.call(t)==dxe)}function yxe(t){return t!=null&&Sxe(t.length)&&!_xe(t)}function vxe(t){return Exe(t)&&yxe(t)}function _xe(t){var e=bxe(t)?G8.call(t):"";return e==fxe||e==hxe}function Sxe(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=cxe}function bxe(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function Exe(t){return!!t&&typeof t=="object"}K8.exports=gxe});var PS=m(bl=>{"use strict";Object.defineProperty(bl,"__esModule",{value:!0});bl.isArguments=bl.defaults=bl.noop=void 0;var wxe=H8();bl.defaults=wxe;var Txe=Q8();bl.isArguments=Txe;function Cxe(){}bl.noop=Cxe});var Z8=m((qKe,W8)=>{var Af=1e3,kf=Af*60,xf=kf*60,Ec=xf*24,Rxe=Ec*7,Oxe=Ec*365.25;W8.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return Pxe(t);if(r==="number"&&isFinite(t))return e.long?kxe(t):Axe(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function Pxe(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),s=(e[2]||"ms").toLowerCase();switch(s){case"years":case"year":case"yrs":case"yr":case"y":return r*Oxe;case"weeks":case"week":case"w":return r*Rxe;case"days":case"day":case"d":return r*Ec;case"hours":case"hour":case"hrs":case"hr":case"h":return r*xf;case"minutes":case"minute":case"mins":case"min":case"m":return r*kf;case"seconds":case"second":case"secs":case"sec":case"s":return r*Af;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function Axe(t){var e=Math.abs(t);return e>=Ec?Math.round(t/Ec)+"d":e>=xf?Math.round(t/xf)+"h":e>=kf?Math.round(t/kf)+"m":e>=Af?Math.round(t/Af)+"s":t+"ms"}function kxe(t){var e=Math.abs(t);return e>=Ec?AS(t,e,Ec,"day"):e>=xf?AS(t,e,xf,"hour"):e>=kf?AS(t,e,kf,"minute"):e>=Af?AS(t,e,Af,"second"):t+" ms"}function AS(t,e,r,s){var n=e>=r*1.5;return Math.round(t/r)+" "+s+(n?"s":"")}});var Pk=m((LKe,Y8)=>{function xxe(t){r.debug=r,r.default=r,r.coerce=l,r.disable=i,r.enable=n,r.enabled=o,r.humanize=Z8(),r.destroy=u,Object.keys(t).forEach(c=>{r[c]=t[c]}),r.names=[],r.skips=[],r.formatters={};function e(c){let d=0;for(let f=0;f<c.length;f++)d=(d<<5)-d+c.charCodeAt(f),d|=0;return r.colors[Math.abs(d)%r.colors.length]}r.selectColor=e;function r(c){let d,f=null,h,p;function g(..._){if(!g.enabled)return;let S=g,b=Number(new Date),v=b-(d||b);S.diff=v,S.prev=d,S.curr=b,d=b,_[0]=r.coerce(_[0]),typeof _[0]!="string"&&_.unshift("%O");let y=0;_[0]=_[0].replace(/%([a-zA-Z%])/g,(P,w)=>{if(P==="%%")return"%";y++;let O=r.formatters[w];if(typeof O=="function"){let $=_[y];P=O.call(S,$),_.splice(y,1),y--}return P}),r.formatArgs.call(S,_),(S.log||r.log).apply(S,_)}return g.namespace=c,g.useColors=r.useColors(),g.color=r.selectColor(c),g.extend=s,g.destroy=r.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>f!==null?f:(h!==r.namespaces&&(h=r.namespaces,p=r.enabled(c)),p),set:_=>{f=_}}),typeof r.init=="function"&&r.init(g),g}function s(c,d){let f=r(this.namespace+(typeof d>"u"?":":d)+c);return f.log=this.log,f}function n(c){r.save(c),r.namespaces=c,r.names=[],r.skips=[];let d,f=(typeof c=="string"?c:"").split(/[\s,]+/),h=f.length;for(d=0;d<h;d++)f[d]&&(c=f[d].replace(/\*/g,".*?"),c[0]==="-"?r.skips.push(new RegExp("^"+c.slice(1)+"$")):r.names.push(new RegExp("^"+c+"$")))}function i(){let c=[...r.names.map(a),...r.skips.map(a).map(d=>"-"+d)].join(",");return r.enable(""),c}function o(c){if(c[c.length-1]==="*")return!0;let d,f;for(d=0,f=r.skips.length;d<f;d++)if(r.skips[d].test(c))return!1;for(d=0,f=r.names.length;d<f;d++)if(r.names[d].test(c))return!0;return!1}function a(c){return c.toString().substring(2,c.toString().length-2).replace(/\.\*\?$/,"*")}function l(c){return c instanceof Error?c.stack||c.message:c}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}Y8.exports=xxe});var J8=m((dn,kS)=>{dn.formatArgs=Nxe;dn.save=Dxe;dn.load=Mxe;dn.useColors=Ixe;dn.storage=$xe();dn.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();dn.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Ixe(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function Nxe(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+kS.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,s=0;t[0].replace(/%[a-zA-Z%]/g,n=>{n!=="%%"&&(r++,n==="%c"&&(s=r))}),t.splice(s,0,e)}dn.log=console.debug||console.log||(()=>{});function Dxe(t){try{t?dn.storage.setItem("debug",t):dn.storage.removeItem("debug")}catch{}}function Mxe(){let t;try{t=dn.storage.getItem("debug")}catch{}return!t&&typeof process<"u"&&"env"in process&&(t=process.env.DEBUG),t}function $xe(){try{return localStorage}catch{}}kS.exports=Pk()(dn);var{formatters:qxe}=kS.exports;qxe.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var eK=m((jKe,X8)=>{"use strict";X8.exports=(t,e)=>{e=e||process.argv;let r=t.startsWith("-")?"":t.length===1?"-":"--",s=e.indexOf(r+t),n=e.indexOf("--");return s!==-1&&(n===-1?!0:s<n)}});var rK=m((FKe,tK)=>{"use strict";var Lxe=require("os"),Ri=eK(),ds=process.env,If;Ri("no-color")||Ri("no-colors")||Ri("color=false")?If=!1:(Ri("color")||Ri("colors")||Ri("color=true")||Ri("color=always"))&&(If=!0);"FORCE_COLOR"in ds&&(If=ds.FORCE_COLOR.length===0||parseInt(ds.FORCE_COLOR,10)!==0);function jxe(t){return t===0?!1:{level:t,hasBasic:!0,has256:t>=2,has16m:t>=3}}function Fxe(t){if(If===!1)return 0;if(Ri("color=16m")||Ri("color=full")||Ri("color=truecolor"))return 3;if(Ri("color=256"))return 2;if(t&&!t.isTTY&&If!==!0)return 0;let e=If?1:0;if(process.platform==="win32"){let r=Lxe.release().split(".");return Number(process.versions.node.split(".")[0])>=8&&Number(r[0])>=10&&Number(r[2])>=10586?Number(r[2])>=14931?3:2:1}if("CI"in ds)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some(r=>r in ds)||ds.CI_NAME==="codeship"?1:e;if("TEAMCITY_VERSION"in ds)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(ds.TEAMCITY_VERSION)?1:0;if(ds.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in ds){let r=parseInt((ds.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(ds.TERM_PROGRAM){case"iTerm.app":return r>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(ds.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(ds.TERM)||"COLORTERM"in ds?1:(ds.TERM==="dumb",e)}function Ak(t){let e=Fxe(t);return jxe(e)}tK.exports={supportsColor:Ak,stdout:Ak(process.stdout),stderr:Ak(process.stderr)}});var nK=m((Dr,IS)=>{var Bxe=require("tty"),xS=require("util");Dr.init=Qxe;Dr.log=Hxe;Dr.formatArgs=Uxe;Dr.save=Gxe;Dr.load=Kxe;Dr.useColors=zxe;Dr.destroy=xS.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");Dr.colors=[6,2,3,4,5,1];try{let t=rK();t&&(t.stderr||t).level>=2&&(Dr.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}Dr.inspectOpts=Object.keys(process.env).filter(t=>/^debug_/i.test(t)).reduce((t,e)=>{let r=e.substring(6).toLowerCase().replace(/_([a-z])/g,(n,i)=>i.toUpperCase()),s=process.env[e];return/^(yes|on|true|enabled)$/i.test(s)?s=!0:/^(no|off|false|disabled)$/i.test(s)?s=!1:s==="null"?s=null:s=Number(s),t[r]=s,t},{});function zxe(){return"colors"in Dr.inspectOpts?!!Dr.inspectOpts.colors:Bxe.isatty(process.stderr.fd)}function Uxe(t){let{namespace:e,useColors:r}=this;if(r){let s=this.color,n="\x1B[3"+(s<8?s:"8;5;"+s),i=`  ${n};1m${e} \x1B[0m`;t[0]=i+t[0].split(`
`).join(`
`+i),t.push(n+"m+"+IS.exports.humanize(this.diff)+"\x1B[0m")}else t[0]=Vxe()+e+" "+t[0]}function Vxe(){return Dr.inspectOpts.hideDate?"":new Date().toISOString()+" "}function Hxe(...t){return process.stderr.write(xS.formatWithOptions(Dr.inspectOpts,...t)+`
`)}function Gxe(t){t?process.env.DEBUG=t:delete process.env.DEBUG}function Kxe(){return process.env.DEBUG}function Qxe(t){t.inspectOpts={};let e=Object.keys(Dr.inspectOpts);for(let r=0;r<e.length;r++)t.inspectOpts[e[r]]=Dr.inspectOpts[e[r]]}IS.exports=Pk()(Dr);var{formatters:sK}=IS.exports;sK.o=function(t){return this.inspectOpts.colors=this.useColors,xS.inspect(t,this.inspectOpts).split(`
`).map(e=>e.trim()).join(" ")};sK.O=function(t){return this.inspectOpts.colors=this.useColors,xS.inspect(t,this.inspectOpts)}});var iK=m((BKe,kk)=>{typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?kk.exports=J8():kk.exports=nK()});var lK=m(ga=>{"use strict";Object.defineProperty(ga,"__esModule",{value:!0});ga.genRedactedString=ga.getStringValue=ga.MAX_ARGUMENT_LENGTH=void 0;var Wxe=iK(),xk=200;ga.MAX_ARGUMENT_LENGTH=xk;var Zxe="ioredis";function oK(t){if(t!==null)switch(typeof t){case"boolean":return;case"number":return;case"object":if(Buffer.isBuffer(t))return t.toString("hex");if(Array.isArray(t))return t.join(",");try{return JSON.stringify(t)}catch{return}case"string":return t}}ga.getStringValue=oK;function aK(t,e){let{length:r}=t;return r<=e?t:t.slice(0,e)+' ... <REDACTED full-length="'+r+'">'}ga.genRedactedString=aK;function Yxe(t){let e=(0,Wxe.default)(`${Zxe}:${t}`);function r(...s){if(e.enabled){for(let n=1;n<s.length;n++){let i=oK(s[n]);typeof i=="string"&&i.length>xk&&(s[n]=aK(i,xk))}return e.apply(null,s)}}return Object.defineProperties(r,{namespace:{get(){return e.namespace}},enabled:{get(){return e.enabled}},destroy:{get(){return e.destroy}},log:{get(){return e.log},set(s){e.log=s}}}),r}ga.default=Yxe});var cK=m(Ik=>{"use strict";Object.defineProperty(Ik,"__esModule",{value:!0});var uK=`-----BEGIN CERTIFICATE-----
MIIDTzCCAjegAwIBAgIJAKSVpiDswLcwMA0GCSqGSIb3DQEBBQUAMD4xFjAUBgNV
BAoMDUdhcmFudGlhIERhdGExJDAiBgNVBAMMG1NTTCBDZXJ0aWZpY2F0aW9uIEF1
dGhvcml0eTAeFw0xMzEwMDExMjE0NTVaFw0yMzA5MjkxMjE0NTVaMD4xFjAUBgNV
BAoMDUdhcmFudGlhIERhdGExJDAiBgNVBAMMG1NTTCBDZXJ0aWZpY2F0aW9uIEF1
dGhvcml0eTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALZqkh/DczWP
JnxnHLQ7QL0T4B4CDKWBKCcisriGbA6ZePWVNo4hfKQC6JrzfR+081NeD6VcWUiz
rmd+jtPhIY4c+WVQYm5PKaN6DT1imYdxQw7aqO5j2KUCEh/cznpLxeSHoTxlR34E
QwF28Wl3eg2vc5ct8LjU3eozWVk3gb7alx9mSA2SgmuX5lEQawl++rSjsBStemY2
BDwOpAMXIrdEyP/cVn8mkvi/BDs5M5G+09j0gfhyCzRWMQ7Hn71u1eolRxwVxgi3
TMn+/vTaFSqxKjgck6zuAYjBRPaHe7qLxHNr1So/Mc9nPy+3wHebFwbIcnUojwbp
4nctkWbjb2cCAwEAAaNQME4wHQYDVR0OBBYEFP1whtcrydmW3ZJeuSoKZIKjze3w
MB8GA1UdIwQYMBaAFP1whtcrydmW3ZJeuSoKZIKjze3wMAwGA1UdEwQFMAMBAf8w
DQYJKoZIhvcNAQEFBQADggEBAG2erXhwRAa7+ZOBs0B6X57Hwyd1R4kfmXcs0rta
lbPpvgULSiB+TCbf3EbhJnHGyvdCY1tvlffLjdA7HJ0PCOn+YYLBA0pTU/dyvrN6
Su8NuS5yubnt9mb13nDGYo1rnt0YRfxN+8DM3fXIVr038A30UlPX2Ou1ExFJT0MZ
uFKY6ZvLdI6/1cbgmguMlAhM+DhKyV6Sr5699LM3zqeI816pZmlREETYkGr91q7k
BpXJu/dtHaGxg1ZGu6w/PCsYGUcECWENYD4VQPd8N32JjOfu6vEgoEAwfPP+3oGp
Z4m3ewACcWOAenqflb+cQYC4PsF7qbXDmRaWrbKntOlZ3n0=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIGMTCCBBmgAwIBAgICEAAwDQYJKoZIhvcNAQELBQAwajELMAkGA1UEBhMCVVMx
CzAJBgNVBAgMAkNBMQswCQYDVQQHDAJDQTESMBAGA1UECgwJUmVkaXNMYWJzMS0w
KwYDVQQDDCRSZWRpc0xhYnMgUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkwHhcN
MTgwMjI1MTUzNzM3WhcNMjgwMjIzMTUzNzM3WjBfMQswCQYDVQQGEwJVUzELMAkG
A1UECAwCQ0ExEjAQBgNVBAoMCVJlZGlzTGFiczEvMC0GA1UEAwwmUkNQIEludGVy
bWVkaWF0ZSBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkwggIiMA0GCSqGSIb3DQEBAQUA
A4ICDwAwggIKAoICAQDf9dqbxc8Bq7Ctq9rWcxrGNKKHivqLAFpPq02yLPx6fsOv
Tq7GsDChAYBBc4v7Y2Ap9RD5Vs3dIhEANcnolf27QwrG9RMnnvzk8pCvp1o6zSU4
VuOE1W66/O1/7e2rVxyrnTcP7UgK43zNIXu7+tiAqWsO92uSnuMoGPGpeaUm1jym
hjWKtkAwDFSqvHY+XL5qDVBEjeUe+WHkYUg40cAXjusAqgm2hZt29c2wnVrxW25W
P0meNlzHGFdA2AC5z54iRiqj57dTfBTkHoBczQxcyw6hhzxZQ4e5I5zOKjXXEhZN
r0tA3YC14CTabKRus/JmZieyZzRgEy2oti64tmLYTqSlAD78pRL40VNoaSYetXLw
hhNsXCHgWaY6d5bLOc/aIQMAV5oLvZQKvuXAF1IDmhPA+bZbpWipp0zagf1P1H3s
UzsMdn2KM0ejzgotbtNlj5TcrVwpmvE3ktvUAuA+hi3FkVx1US+2Gsp5x4YOzJ7u
P1WPk6ShF0JgnJH2ILdj6kttTWwFzH17keSFICWDfH/+kM+k7Y1v3EXMQXE7y0T9
MjvJskz6d/nv+sQhY04xt64xFMGTnZjlJMzfQNi7zWFLTZnDD0lPowq7l3YiPoTT
t5Xky83lu0KZsZBo0WlWaDG00gLVdtRgVbcuSWxpi5BdLb1kRab66JptWjxwXQID
AQABo4HrMIHoMDoGA1UdHwQzMDEwL6AtoCuGKWh0dHBzOi8vcmwtY2Etc2VydmVy
LnJlZGlzbGFicy5jb20vdjEvY3JsMEYGCCsGAQUFBwEBBDowODA2BggrBgEFBQcw
AYYqaHR0cHM6Ly9ybC1jYS1zZXJ2ZXIucmVkaXNsYWJzLmNvbS92MS9vY3NwMB0G
A1UdDgQWBBQHar5OKvQUpP2qWt6mckzToeCOHDAfBgNVHSMEGDAWgBQi42wH6hM4
L2sujEvLM0/u8lRXTzASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIB
hjANBgkqhkiG9w0BAQsFAAOCAgEAirEn/iTsAKyhd+pu2W3Z5NjCko4NPU0EYUbr
AP7+POK2rzjIrJO3nFYQ/LLuC7KCXG+2qwan2SAOGmqWst13Y+WHp44Kae0kaChW
vcYLXXSoGQGC8QuFSNUdaeg3RbMDYFT04dOkqufeWVccoHVxyTSg9eD8LZuHn5jw
7QDLiEECBmIJHk5Eeo2TAZrx4Yx6ufSUX5HeVjlAzqwtAqdt99uCJ/EL8bgpWbe+
XoSpvUv0SEC1I1dCAhCKAvRlIOA6VBcmzg5Am12KzkqTul12/VEFIgzqu0Zy2Jbc
AUPrYVu/+tOGXQaijy7YgwH8P8n3s7ZeUa1VABJHcxrxYduDDJBLZi+MjheUDaZ1
jQRHYevI2tlqeSBqdPKG4zBY5lS0GiAlmuze5oENt0P3XboHoZPHiqcK3VECgTVh
/BkJcuudETSJcZDmQ8YfoKfBzRQNg2sv/hwvUv73Ss51Sco8GEt2lD8uEdib1Q6z
zDT5lXJowSzOD5ZA9OGDjnSRL+2riNtKWKEqvtEG3VBJoBzu9GoxbAc7wIZLxmli
iF5a/Zf5X+UXD3s4TMmy6C4QZJpAA2egsSQCnraWO2ULhh7iXMysSkF/nzVfZn43
iqpaB8++9a37hWq14ZmOv0TJIDz//b2+KC4VFXWQ5W5QC6whsjT+OlG4p5ZYG0jo
616pxqo=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIFujCCA6KgAwIBAgIJAJ1aTT1lu2ScMA0GCSqGSIb3DQEBCwUAMGoxCzAJBgNV
BAYTAlVTMQswCQYDVQQIDAJDQTELMAkGA1UEBwwCQ0ExEjAQBgNVBAoMCVJlZGlz
TGFiczEtMCsGA1UEAwwkUmVkaXNMYWJzIFJvb3QgQ2VydGlmaWNhdGUgQXV0aG9y
aXR5MB4XDTE4MDIyNTE1MjA0MloXDTM4MDIyMDE1MjA0MlowajELMAkGA1UEBhMC
VVMxCzAJBgNVBAgMAkNBMQswCQYDVQQHDAJDQTESMBAGA1UECgwJUmVkaXNMYWJz
MS0wKwYDVQQDDCRSZWRpc0xhYnMgUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkw
ggIiMA0GCSqGSIb3DQEBAQUAA4ICDwAwggIKAoICAQDLEjXy7YrbN5Waau5cd6g1
G5C2tMmeTpZ0duFAPxNU4oE3RHS5gGiok346fUXuUxbZ6QkuzeN2/2Z+RmRcJhQY
Dm0ZgdG4x59An1TJfnzKKoWj8ISmoHS/TGNBdFzXV7FYNLBuqZouqePI6ReC6Qhl
pp45huV32Q3a6IDrrvx7Wo5ZczEQeFNbCeCOQYNDdTmCyEkHqc2AGo8eoIlSTutT
ULOC7R5gzJVTS0e1hesQ7jmqHjbO+VQS1NAL4/5K6cuTEqUl+XhVhPdLWBXJQ5ag
54qhX4v+ojLzeU1R/Vc6NjMvVtptWY6JihpgplprN0Yh2556ewcXMeturcKgXfGJ
xeYzsjzXerEjrVocX5V8BNrg64NlifzTMKNOOv4fVZszq1SIHR8F9ROrqiOdh8iC
JpUbLpXH9hWCSEO6VRMB2xJoKu3cgl63kF30s77x7wLFMEHiwsQRKxooE1UhgS9K
2sO4TlQ1eWUvFvHSTVDQDlGQ6zu4qjbOpb3Q8bQwoK+ai2alkXVR4Ltxe9QlgYK3
StsnPhruzZGA0wbXdpw0bnM+YdlEm5ffSTpNIfgHeaa7Dtb801FtA71ZlH7A6TaI
SIQuUST9EKmv7xrJyx0W1pGoPOLw5T029aTjnICSLdtV9bLwysrLhIYG5bnPq78B
cS+jZHFGzD7PUVGQD01nOQIDAQABo2MwYTAdBgNVHQ4EFgQUIuNsB+oTOC9rLoxL
yzNP7vJUV08wHwYDVR0jBBgwFoAUIuNsB+oTOC9rLoxLyzNP7vJUV08wDwYDVR0T
AQH/BAUwAwEB/zAOBgNVHQ8BAf8EBAMCAYYwDQYJKoZIhvcNAQELBQADggIBAHfg
z5pMNUAKdMzK1aS1EDdK9yKz4qicILz5czSLj1mC7HKDRy8cVADUxEICis++CsCu
rYOvyCVergHQLREcxPq4rc5Nq1uj6J6649NEeh4WazOOjL4ZfQ1jVznMbGy+fJm3
3Hoelv6jWRG9iqeJZja7/1s6YC6bWymI/OY1e4wUKeNHAo+Vger7MlHV+RuabaX+
hSJ8bJAM59NCM7AgMTQpJCncrcdLeceYniGy5Q/qt2b5mJkQVkIdy4TPGGB+AXDJ
D0q3I/JDRkDUFNFdeW0js7fHdsvCR7O3tJy5zIgEV/o/BCkmJVtuwPYOrw/yOlKj
TY/U7ATAx9VFF6/vYEOMYSmrZlFX+98L6nJtwDqfLB5VTltqZ4H/KBxGE3IRSt9l
FXy40U+LnXzhhW+7VBAvyYX8GEXhHkKU8Gqk1xitrqfBXY74xKgyUSTolFSfFVgj
mcM/X4K45bka+qpkj7Kfv/8D4j6aZekwhN2ly6hhC1SmQ8qjMjpG/mrWOSSHZFmf
ybu9iD2AYHeIOkshIl6xYIa++Q/00/vs46IzAbQyriOi0XxlSMMVtPx0Q3isp+ji
n8Mq9eOuxYOEQ4of8twUkUDd528iwGtEdwf0Q01UyT84S62N8AySl1ZBKXJz6W4F
UhWfa/HQYOAPDdEjNgnVwLI23b8t0TozyCWw7q8h
-----END CERTIFICATE-----

-----BEGIN CERTIFICATE-----
MIIEjzCCA3egAwIBAgIQe55B/ALCKJDZtdNT8kD6hTANBgkqhkiG9w0BAQsFADBM
MSAwHgYDVQQLExdHbG9iYWxTaWduIFJvb3QgQ0EgLSBSMzETMBEGA1UEChMKR2xv
YmFsU2lnbjETMBEGA1UEAxMKR2xvYmFsU2lnbjAeFw0yMjAxMjYxMjAwMDBaFw0y
NTAxMjYwMDAwMDBaMFgxCzAJBgNVBAYTAkJFMRkwFwYDVQQKExBHbG9iYWxTaWdu
IG52LXNhMS4wLAYDVQQDEyVHbG9iYWxTaWduIEF0bGFzIFIzIE9WIFRMUyBDQSAy
MDIyIFEyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAmGmg1LW9b7Lf
8zDD83yBDTEkt+FOxKJZqF4veWc5KZsQj9HfnUS2e5nj/E+JImlGPsQuoiosLuXD
BVBNAMcUFa11buFMGMeEMwiTmCXoXRrXQmH0qjpOfKgYc5gHG3BsRGaRrf7VR4eg
ofNMG9wUBw4/g/TT7+bQJdA4NfE7Y4d5gEryZiBGB/swaX6Jp/8MF4TgUmOWmalK
dZCKyb4sPGQFRTtElk67F7vU+wdGcrcOx1tDcIB0ncjLPMnaFicagl+daWGsKqTh
counQb6QJtYHa91KvCfKWocMxQ7OIbB5UARLPmC4CJ1/f8YFm35ebfzAeULYdGXu
jE9CLor0OwIDAQABo4IBXzCCAVswDgYDVR0PAQH/BAQDAgGGMB0GA1UdJQQWMBQG
CCsGAQUFBwMBBggrBgEFBQcDAjASBgNVHRMBAf8ECDAGAQH/AgEAMB0GA1UdDgQW
BBSH5Zq7a7B/t95GfJWkDBpA8HHqdjAfBgNVHSMEGDAWgBSP8Et/qC5FJK5NUPpj
move4t0bvDB7BggrBgEFBQcBAQRvMG0wLgYIKwYBBQUHMAGGImh0dHA6Ly9vY3Nw
Mi5nbG9iYWxzaWduLmNvbS9yb290cjMwOwYIKwYBBQUHMAKGL2h0dHA6Ly9zZWN1
cmUuZ2xvYmFsc2lnbi5jb20vY2FjZXJ0L3Jvb3QtcjMuY3J0MDYGA1UdHwQvMC0w
K6ApoCeGJWh0dHA6Ly9jcmwuZ2xvYmFsc2lnbi5jb20vcm9vdC1yMy5jcmwwIQYD
VR0gBBowGDAIBgZngQwBAgIwDAYKKwYBBAGgMgoBAjANBgkqhkiG9w0BAQsFAAOC
AQEAKRic9/f+nmhQU/wz04APZLjgG5OgsuUOyUEZjKVhNGDwxGTvKhyXGGAMW2B/
3bRi+aElpXwoxu3pL6fkElbX3B0BeS5LoDtxkyiVEBMZ8m+sXbocwlPyxrPbX6mY
0rVIvnuUeBH8X0L5IwfpNVvKnBIilTbcebfHyXkPezGwz7E1yhUULjJFm2bt0SdX
y+4X/WeiiYIv+fTVgZZgl+/2MKIsu/qdBJc3f3TvJ8nz+Eax1zgZmww+RSQWeOj3
15Iw6Z5FX+NwzY/Ab+9PosR5UosSeq+9HhtaxZttXG1nVh+avYPGYddWmiMT90J5
ZgKnO/Fx2hBgTxhOTMYaD312kg==
-----END CERTIFICATE-----

-----BEGIN CERTIFICATE-----
MIIDXzCCAkegAwIBAgILBAAAAAABIVhTCKIwDQYJKoZIhvcNAQELBQAwTDEgMB4G
A1UECxMXR2xvYmFsU2lnbiBSb290IENBIC0gUjMxEzARBgNVBAoTCkdsb2JhbFNp
Z24xEzARBgNVBAMTCkdsb2JhbFNpZ24wHhcNMDkwMzE4MTAwMDAwWhcNMjkwMzE4
MTAwMDAwWjBMMSAwHgYDVQQLExdHbG9iYWxTaWduIFJvb3QgQ0EgLSBSMzETMBEG
A1UEChMKR2xvYmFsU2lnbjETMBEGA1UEAxMKR2xvYmFsU2lnbjCCASIwDQYJKoZI
hvcNAQEBBQADggEPADCCAQoCggEBAMwldpB5BngiFvXAg7aEyiie/QV2EcWtiHL8
RgJDx7KKnQRfJMsuS+FggkbhUqsMgUdwbN1k0ev1LKMPgj0MK66X17YUhhB5uzsT
gHeMCOFJ0mpiLx9e+pZo34knlTifBtc+ycsmWQ1z3rDI6SYOgxXG71uL0gRgykmm
KPZpO/bLyCiR5Z2KYVc3rHQU3HTgOu5yLy6c+9C7v/U9AOEGM+iCK65TpjoWc4zd
QQ4gOsC0p6Hpsk+QLjJg6VfLuQSSaGjlOCZgdbKfd/+RFO+uIEn8rUAVSNECMWEZ
XriX7613t2Saer9fwRPvm2L7DWzgVGkWqQPabumDk3F2xmmFghcCAwEAAaNCMEAw
DgYDVR0PAQH/BAQDAgEGMA8GA1UdEwEB/wQFMAMBAf8wHQYDVR0OBBYEFI/wS3+o
LkUkrk1Q+mOai97i3Ru8MA0GCSqGSIb3DQEBCwUAA4IBAQBLQNvAUKr+yAzv95ZU
RUm7lgAJQayzE4aGKAczymvmdLm6AC2upArT9fHxD4q/c2dKg8dEe3jgr25sbwMp
jjM5RcOO5LlXbKr8EpbsU8Yt5CRsuZRj+9xTaGdWPoO4zzUhw8lo/s7awlOqzJCK
6fBdRoyV3XpYKBovHd7NADdBj+1EbddTKJd+82cEHhXXipa0095MJ6RMG3NzdvQX
mcIfeg7jLQitChws/zyrVQ4PkX4268NXSb7hLi18YIvDQVETI53O9zJrlAGomecs
Mx86OyXShkDOOyyGeMlhLxS67ttVb9+E7gUJTb0o2HLO02JQZR7rkpeDMdmztcpH
WD9f
-----END CERTIFICATE-----`,Jxe={RedisCloudFixed:{ca:uK},RedisCloudFlexible:{ca:uK}};Ik.default=Jxe});var fs=m(Ge=>{"use strict";Object.defineProperty(Ge,"__esModule",{value:!0});Ge.noop=Ge.defaults=Ge.Debug=Ge.zipMap=Ge.CONNECTION_CLOSED_ERROR_MSG=Ge.shuffle=Ge.sample=Ge.resolveTLSProfile=Ge.parseURL=Ge.optimizeErrorStack=Ge.toArg=Ge.convertMapToArray=Ge.convertObjectToArray=Ge.timeout=Ge.packObject=Ge.isInt=Ge.wrapMultiResult=Ge.convertBufferToString=void 0;var dK=require("url"),Nk=PS();Object.defineProperty(Ge,"defaults",{enumerable:!0,get:function(){return Nk.defaults}});Object.defineProperty(Ge,"noop",{enumerable:!0,get:function(){return Nk.noop}});var Xxe=lK();Ge.Debug=Xxe.default;var eIe=cK();function fK(t,e){if(t instanceof Buffer)return t.toString(e);if(Array.isArray(t)){let r=t.length,s=Array(r);for(let n=0;n<r;++n)s[n]=t[n]instanceof Buffer&&e==="utf8"?t[n].toString():fK(t[n],e);return s}return t}Ge.convertBufferToString=fK;function tIe(t){if(!t)return null;let e=[],r=t.length;for(let s=0;s<r;++s){let n=t[s];n instanceof Error?e.push([n]):e.push([null,n])}return e}Ge.wrapMultiResult=tIe;function hK(t){let e=parseFloat(t);return!isNaN(t)&&(e|0)===e}Ge.isInt=hK;function rIe(t){let e={},r=t.length;for(let s=1;s<r;s+=2)e[t[s-1]]=t[s];return e}Ge.packObject=rIe;function sIe(t,e){let r=null,s=function(){r&&(clearTimeout(r),r=null,t.apply(this,arguments))};return r=setTimeout(s,e,new Error("timeout")),s}Ge.timeout=sIe;function nIe(t){let e=[],r=Object.keys(t);for(let s=0,n=r.length;s<n;s++)e.push(r[s],t[r[s]]);return e}Ge.convertObjectToArray=nIe;function iIe(t){let e=[],r=0;return t.forEach(function(s,n){e[r]=n,e[r+1]=s,r+=2}),e}Ge.convertMapToArray=iIe;function oIe(t){return t===null||typeof t>"u"?"":String(t)}Ge.toArg=oIe;function aIe(t,e,r){let s=e.split(`
`),n="",i;for(i=1;i<s.length&&s[i].indexOf(r)!==-1;++i);for(let o=i;o<s.length;++o)n+=`
`+s[o];if(t.stack){let o=t.stack.indexOf(`
`);t.stack=t.stack.slice(0,o)+n}return t}Ge.optimizeErrorStack=aIe;function lIe(t){if(hK(t))return{port:t};let e=(0,dK.parse)(t,!0,!0);!e.slashes&&t[0]!=="/"&&(t="//"+t,e=(0,dK.parse)(t,!0,!0));let r=e.query||{},s={};if(e.auth){let n=e.auth.indexOf(":");s.username=n===-1?e.auth:e.auth.slice(0,n),s.password=n===-1?"":e.auth.slice(n+1)}if(e.pathname&&(e.protocol==="redis:"||e.protocol==="rediss:"?e.pathname.length>1&&(s.db=e.pathname.slice(1)):s.path=e.pathname),e.host&&(s.host=e.hostname),e.port&&(s.port=e.port),typeof r.family=="string"){let n=Number.parseInt(r.family,10);Number.isNaN(n)||(s.family=n)}return(0,Nk.defaults)(s,r),s}Ge.parseURL=lIe;function uIe(t){let e=t?.tls;typeof e=="string"&&(e={profile:e});let r=eIe.default[e?.profile];return r&&(e=Object.assign({},r,e),delete e.profile,t=Object.assign({},t,{tls:e})),t}Ge.resolveTLSProfile=uIe;function cIe(t,e=0){let r=t.length;return e>=r?null:t[e+Math.floor(Math.random()*(r-e))]}Ge.sample=cIe;function dIe(t){let e=t.length;for(;e>0;){let r=Math.floor(Math.random()*e);e--,[t[e],t[r]]=[t[r],t[e]]}return t}Ge.shuffle=dIe;Ge.CONNECTION_CLOSED_ERROR_MSG="Connection is closed.";function fIe(t,e){let r=new Map;return t.forEach((s,n)=>{r.set(s,e[n])}),r}Ge.zipMap=fIe});var ya=m(Mk=>{"use strict";Object.defineProperty(Mk,"__esModule",{value:!0});var pK=Cf(),hIe=OS(),pIe=Sl(),wc=fs(),Cs=class{constructor(e,r=[],s={},n){if(this.name=e,this.inTransaction=!1,this.isResolved=!1,this.transformed=!1,this.replyEncoding=s.replyEncoding,this.errorStack=s.errorStack,this.args=r.flat(),this.callback=n,this.initPromise(),s.keyPrefix){let i=s.keyPrefix instanceof Buffer,o=i?s.keyPrefix:null;this._iterateKeys(a=>a instanceof Buffer?(o===null&&(o=Buffer.from(s.keyPrefix)),Buffer.concat([o,a])):i?Buffer.concat([s.keyPrefix,Buffer.from(String(a))]):s.keyPrefix+a)}s.readOnly&&(this.isReadOnly=!0)}static checkFlag(e,r){return!!this.getFlagMap()[e][r]}static setArgumentTransformer(e,r){this._transformer.argument[e]=r}static setReplyTransformer(e,r){this._transformer.reply[e]=r}static getFlagMap(){return this.flagMap||(this.flagMap=Object.keys(Cs.FLAGS).reduce((e,r)=>(e[r]={},Cs.FLAGS[r].forEach(s=>{e[r][s]=!0}),e),{})),this.flagMap}getSlot(){if(typeof this.slot>"u"){let e=this.getKeys()[0];this.slot=e==null?null:hIe(e)}return this.slot}getKeys(){return this._iterateKeys()}toWritable(e){let r,s="*"+(this.args.length+1)+`\r
$`+Buffer.byteLength(this.name)+`\r
`+this.name+`\r
`;if(this.bufferMode){let n=new Dk;n.push(s);for(let i=0;i<this.args.length;++i){let o=this.args[i];o instanceof Buffer?o.length===0?n.push(`$0\r
\r
`):(n.push("$"+o.length+`\r
`),n.push(o),n.push(`\r
`)):n.push("$"+Buffer.byteLength(o)+`\r
`+o+`\r
`)}r=n.toBuffer()}else{r=s;for(let n=0;n<this.args.length;++n){let i=this.args[n];r+="$"+Buffer.byteLength(i)+`\r
`+i+`\r
`}}return r}stringifyArguments(){for(let e=0;e<this.args.length;++e){let r=this.args[e];typeof r=="string"||(r instanceof Buffer?this.bufferMode=!0:this.args[e]=(0,wc.toArg)(r))}}transformReply(e){this.replyEncoding&&(e=(0,wc.convertBufferToString)(e,this.replyEncoding));let r=Cs._transformer.reply[this.name];return r&&(e=r(e)),e}setTimeout(e){this._commandTimeoutTimer||(this._commandTimeoutTimer=setTimeout(()=>{this.isResolved||this.reject(new Error("Command timed out"))},e))}initPromise(){let e=new Promise((r,s)=>{if(!this.transformed){this.transformed=!0;let n=Cs._transformer.argument[this.name];n&&(this.args=n(this.args)),this.stringifyArguments()}this.resolve=this._convertValue(r),this.errorStack?this.reject=n=>{s((0,wc.optimizeErrorStack)(n,this.errorStack.stack,__dirname))}:this.reject=s});this.promise=(0,pIe.default)(e,this.callback)}_iterateKeys(e=r=>r){if(typeof this.keys>"u"&&(this.keys=[],(0,pK.exists)(this.name))){let r=(0,pK.getKeyIndexes)(this.name,this.args);for(let s of r)this.args[s]=e(this.args[s]),this.keys.push(this.args[s])}return this.keys}_convertValue(e){return r=>{try{let s=this._commandTimeoutTimer;s&&(clearTimeout(s),delete this._commandTimeoutTimer),e(this.transformReply(r)),this.isResolved=!0}catch(s){this.reject(s)}return this.promise}}};Mk.default=Cs;Cs.FLAGS={VALID_IN_SUBSCRIBER_MODE:["subscribe","psubscribe","unsubscribe","punsubscribe","ssubscribe","sunsubscribe","ping","quit"],VALID_IN_MONITOR_MODE:["monitor","auth"],ENTER_SUBSCRIBER_MODE:["subscribe","psubscribe","ssubscribe"],EXIT_SUBSCRIBER_MODE:["unsubscribe","punsubscribe","sunsubscribe"],WILL_DISCONNECT:["quit"]};Cs._transformer={argument:{},reply:{}};var mK=function(t){if(t.length===1){if(t[0]instanceof Map)return(0,wc.convertMapToArray)(t[0]);if(typeof t[0]=="object"&&t[0]!==null)return(0,wc.convertObjectToArray)(t[0])}return t},gK=function(t){if(t.length===2){if(t[1]instanceof Map)return[t[0]].concat((0,wc.convertMapToArray)(t[1]));if(typeof t[1]=="object"&&t[1]!==null)return[t[0]].concat((0,wc.convertObjectToArray)(t[1]))}return t};Cs.setArgumentTransformer("mset",mK);Cs.setArgumentTransformer("msetnx",mK);Cs.setArgumentTransformer("hset",gK);Cs.setArgumentTransformer("hmset",gK);Cs.setReplyTransformer("hgetall",function(t){if(Array.isArray(t)){let e={};for(let r=0;r<t.length;r+=2){let s=t[r],n=t[r+1];s in e?Object.defineProperty(e,s,{value:n,configurable:!0,enumerable:!0,writable:!0}):e[s]=n}return e}return t});var Dk=class{constructor(){this.length=0,this.items=[]}push(e){this.length+=Buffer.byteLength(e),this.items.push(e)}toBuffer(){let e=Buffer.allocUnsafe(this.length),r=0;for(let s of this.items){let n=Buffer.byteLength(s);Buffer.isBuffer(s)?s.copy(e,r):e.write(s,r,n),r+=n}return e}}});var yK=m($k=>{"use strict";Object.defineProperty($k,"__esModule",{value:!0});var mIe=bc(),NS=class extends mIe.RedisError{constructor(e,r){super(e),this.lastNodeError=r,Error.captureStackTrace(this,this.constructor)}get name(){return this.constructor.name}};$k.default=NS;NS.defaultMessage="Failed to refresh slots cache."});var DS=m(Lk=>{"use strict";Object.defineProperty(Lk,"__esModule",{value:!0});var gIe=require("stream"),qk=class extends gIe.Readable{constructor(e){super(e),this.opt=e,this._redisCursor="0",this._redisDrained=!1}_read(){if(this._redisDrained){this.push(null);return}let e=[this._redisCursor];this.opt.key&&e.unshift(this.opt.key),this.opt.match&&e.push("MATCH",this.opt.match),this.opt.type&&e.push("TYPE",this.opt.type),this.opt.count&&e.push("COUNT",String(this.opt.count)),this.opt.redis[this.opt.command](e,(r,s)=>{if(r){this.emit("error",r);return}this._redisCursor=s[0]instanceof Buffer?s[0].toString():s[0],this._redisCursor==="0"&&(this._redisDrained=!0),this.push(s[1])})}close(){this._redisDrained=!0}};Lk.default=qk});var wK=m(rr=>{"use strict";Object.defineProperty(rr,"__esModule",{value:!0});rr.executeWithAutoPipelining=rr.getFirstValueInFlattenedArray=rr.shouldUseAutoPipelining=rr.notAllowedAutoPipelineCommands=rr.kCallbacks=rr.kExec=void 0;var _K=PS(),yIe=OS(),vK=Sl();rr.kExec=Symbol("exec");rr.kCallbacks=Symbol("callbacks");rr.notAllowedAutoPipelineCommands=["auth","info","script","quit","cluster","pipeline","multi","subscribe","psubscribe","unsubscribe","unpsubscribe","select"];function SK(t,e){if(t._runningAutoPipelines.has(e)||!t._autoPipelines.has(e))return;t._runningAutoPipelines.add(e);let r=t._autoPipelines.get(e);t._autoPipelines.delete(e);let s=r[rr.kCallbacks];r[rr.kCallbacks]=null,r.exec(function(n,i){if(t._runningAutoPipelines.delete(e),n)for(let o=0;o<s.length;o++)process.nextTick(s[o],n);else for(let o=0;o<s.length;o++)process.nextTick(s[o],...i[o]);t._autoPipelines.has(e)&&SK(t,e)})}function vIe(t,e,r){return e&&t.options.enableAutoPipelining&&!t.isPipeline&&!rr.notAllowedAutoPipelineCommands.includes(r)&&!t.options.autoPipeliningIgnoredCommands.includes(r)}rr.shouldUseAutoPipelining=vIe;function bK(t){for(let e=0;e<t.length;e++){let r=t[e];if(typeof r=="string")return r;if(Array.isArray(r)||(0,_K.isArguments)(r)){if(r.length===0)continue;return r[0]}let s=[r].flat();if(s.length>0)return s[0]}}rr.getFirstValueInFlattenedArray=bK;function EK(t,e,r,s,n){if(t.isCluster&&!t.slots.length)return t.status==="wait"&&t.connect().catch(_K.noop),(0,vK.default)(new Promise(function(u,c){t.delayUntilReady(d=>{if(d){c(d);return}EK(t,e,r,s,null).then(u,c)})}),n);let i=t.options.keyPrefix||"",o=t.isCluster?t.slots[yIe(`${i}${bK(s)}`)].join(","):"main";if(!t._autoPipelines.has(o)){let u=t.pipeline();u[rr.kExec]=!1,u[rr.kCallbacks]=[],t._autoPipelines.set(o,u)}let a=t._autoPipelines.get(o);a[rr.kExec]||(a[rr.kExec]=!0,setImmediate(SK,t,o));let l=new Promise(function(u,c){a[rr.kCallbacks].push(function(d,f){if(d){c(d);return}u(f)}),e==="call"&&s.unshift(r),a[e](...s)});return(0,vK.default)(l,n)}rr.executeWithAutoPipelining=EK});var TK=m(Fk=>{"use strict";Object.defineProperty(Fk,"__esModule",{value:!0});var _Ie=require("crypto"),SIe=ya(),bIe=Sl(),jk=class{constructor(e,r=null,s="",n=!1){this.lua=e,this.numberOfKeys=r,this.keyPrefix=s,this.readOnly=n,this.sha=(0,_Ie.createHash)("sha1").update(e).digest("hex");let i=this.sha,o=new WeakSet;this.Command=class extends SIe.default{toWritable(l){let u=this.reject;return this.reject=c=>{c.message.indexOf("NOSCRIPT")!==-1&&o.delete(l),u.call(this,c)},o.has(l)?this.name==="eval"&&(this.name="evalsha",this.args[0]=i):(o.add(l),this.name="eval",this.args[0]=e),super.toWritable(l)}}}execute(e,r,s,n){typeof this.numberOfKeys=="number"&&r.unshift(this.numberOfKeys),this.keyPrefix&&(s.keyPrefix=this.keyPrefix),this.readOnly&&(s.readOnly=!0);let i=new this.Command("evalsha",[this.sha,...r],s);return i.promise=i.promise.catch(o=>{if(o.message.indexOf("NOSCRIPT")===-1)throw o;let a=new this.Command("evalsha",[this.sha,...r],s);return(e.isPipeline?e.redis:e).sendCommand(a)}),(0,bIe.default)(i.promise,n),e.sendCommand(i)}};Fk.default=jk});var $S=m(zk=>{"use strict";Object.defineProperty(zk,"__esModule",{value:!0});var EIe=Cf(),MS=wK(),wIe=ya(),TIe=TK(),va=class{constructor(){this.options={},this.scriptsSet={},this.addedBuiltinSet=new Set}getBuiltinCommands(){return Bk.slice(0)}createBuiltinCommand(e){return{string:El(null,e,"utf8"),buffer:El(null,e,null)}}addBuiltinCommand(e){this.addedBuiltinSet.add(e),this[e]=El(e,e,"utf8"),this[e+"Buffer"]=El(e+"Buffer",e,null)}defineCommand(e,r){let s=new TIe.default(r.lua,r.numberOfKeys,this.options.keyPrefix,r.readOnly);this.scriptsSet[e]=s,this[e]=CK(e,e,s,"utf8"),this[e+"Buffer"]=CK(e+"Buffer",e,s,null)}sendCommand(e,r,s){throw new Error('"sendCommand" is not implemented')}},Bk=EIe.list.filter(t=>t!=="monitor");Bk.push("sentinel");Bk.forEach(function(t){va.prototype[t]=El(t,t,"utf8"),va.prototype[t+"Buffer"]=El(t+"Buffer",t,null)});va.prototype.call=El("call","utf8");va.prototype.callBuffer=El("callBuffer",null);va.prototype.send_command=va.prototype.call;function El(t,e,r){return typeof r>"u"&&(r=e,e=null),function(...s){let n=e||s.shift(),i=s[s.length-1];typeof i=="function"?s.pop():i=void 0;let o={errorStack:this.options.showFriendlyErrorStack?new Error:void 0,keyPrefix:this.options.keyPrefix,replyEncoding:r};return(0,MS.shouldUseAutoPipelining)(this,t,n)?(0,MS.executeWithAutoPipelining)(this,t,n,s,i):this.sendCommand(new wIe.default(n,s,o,i))}}function CK(t,e,r,s){return function(...n){let i=typeof n[n.length-1]=="function"?n.pop():void 0,o={replyEncoding:s};return this.options.showFriendlyErrorStack&&(o.errorStack=new Error),(0,MS.shouldUseAutoPipelining)(this,t,e)?(0,MS.executeWithAutoPipelining)(this,t,e,n,i):r.execute(this,n,o,i)}}zk.default=va});var Hk=m(Vk=>{"use strict";Object.defineProperty(Vk,"__esModule",{value:!0});var Uk=OS(),RK=Cf(),OK=Sl(),CIe=require("util"),RIe=ya(),OIe=fs(),PIe=$S();function AIe(t,e){let r=Uk(e[0]),s=t._groupsBySlot[r];for(let n=1;n<e.length;n++)if(t._groupsBySlot[Uk(e[n])]!==s)return-1;return r}var wl=class extends PIe.default{constructor(e){super(),this.redis=e,this.isPipeline=!0,this.replyPending=0,this._queue=[],this._result=[],this._transactions=0,this._shaToScript={},this.isCluster=this.redis.constructor.name==="Cluster"||this.redis.isCluster,this.options=e.options,Object.keys(e.scriptsSet).forEach(s=>{let n=e.scriptsSet[s];this._shaToScript[n.sha]=n,this[s]=e[s],this[s+"Buffer"]=e[s+"Buffer"]}),e.addedBuiltinSet.forEach(s=>{this[s]=e[s],this[s+"Buffer"]=e[s+"Buffer"]}),this.promise=new Promise((s,n)=>{this.resolve=s,this.reject=n});let r=this;Object.defineProperty(this,"length",{get:function(){return r._queue.length}})}fillResult(e,r){if(this._queue[r].name==="exec"&&Array.isArray(e[1])){let n=e[1].length;for(let i=0;i<n;i++){if(e[1][i]instanceof Error)continue;let o=this._queue[r-(n-i)];try{e[1][i]=o.transformReply(e[1][i])}catch(a){e[1][i]=a}}}if(this._result[r]=e,--this.replyPending)return;if(this.isCluster){let n=!0,i;for(let o=0;o<this._result.length;++o){let a=this._result[o][0],l=this._queue[o];if(a){if(l.name==="exec"&&a.message==="EXECABORT Transaction discarded because of previous errors.")continue;if(!i)i={name:a.name,message:a.message};else if(i.name!==a.name||i.message!==a.message){n=!1;break}}else if(!l.inTransaction&&!((0,RK.exists)(l.name)&&(0,RK.hasFlag)(l.name,"readonly"))){n=!1;break}}if(i&&n){let o=this,a=i.message.split(" "),l=this._queue,u=!1;this._queue=[];for(let h=0;h<l.length;++h){if(a[0]==="ASK"&&!u&&l[h].name!=="asking"&&(!l[h-1]||l[h-1].name!=="asking")){let p=new RIe.default("asking");p.ignore=!0,this.sendCommand(p)}l[h].initPromise(),this.sendCommand(l[h]),u=l[h].inTransaction}let c=!0;typeof this.leftRedirections>"u"&&(this.leftRedirections={});let d=function(){o.exec()},f=this.redis;if(f.handleError(i,this.leftRedirections,{moved:function(h,p){o.preferKey=p,f.slots[a[1]]=[p],f._groupsBySlot[a[1]]=f._groupsIds[f.slots[a[1]].join(";")],f.refreshSlotsCache(),o.exec()},ask:function(h,p){o.preferKey=p,o.exec()},tryagain:d,clusterDown:d,connectionClosed:d,maxRedirections:()=>{c=!1},defaults:()=>{c=!1}}),c)return}}let s=0;for(let n=0;n<this._queue.length-s;++n)this._queue[n+s].ignore&&(s+=1),this._result[n]=this._result[n+s];this.resolve(this._result.slice(0,this._result.length-s))}sendCommand(e){this._transactions>0&&(e.inTransaction=!0);let r=this._queue.length;return e.pipelineIndex=r,e.promise.then(s=>{this.fillResult([null,s],r)}).catch(s=>{this.fillResult([s],r)}),this._queue.push(e),this}addBatch(e){let r,s,n;for(let i=0;i<e.length;++i)r=e[i],s=r[0],n=r.slice(1),this[s].apply(this,n);return this}};Vk.default=wl;var kIe=wl.prototype.multi;wl.prototype.multi=function(){return this._transactions+=1,kIe.apply(this,arguments)};var PK=wl.prototype.execBuffer;wl.prototype.execBuffer=(0,CIe.deprecate)(function(){return this._transactions>0&&(this._transactions-=1),PK.apply(this,arguments)},"Pipeline#execBuffer: Use Pipeline#exec instead");wl.prototype.exec=function(t){if(this.isCluster&&!this.redis.slots.length)return this.redis.status==="wait"&&this.redis.connect().catch(OIe.noop),t&&!this.nodeifiedPromise&&(this.nodeifiedPromise=!0,(0,OK.default)(this.promise,t)),this.redis.delayUntilReady(n=>{if(n){this.reject(n);return}this.exec(t)}),this.promise;if(this._transactions>0)return this._transactions-=1,PK.apply(this,arguments);this.nodeifiedPromise||(this.nodeifiedPromise=!0,(0,OK.default)(this.promise,t)),this._queue.length||this.resolve([]);let e;if(this.isCluster){let n=[];for(let i=0;i<this._queue.length;i++){let o=this._queue[i].getKeys();if(o.length&&n.push(o[0]),o.length&&Uk.generateMulti(o)<0)return this.reject(new Error("All the keys in a pipeline command should belong to the same slot")),this.promise}if(n.length){if(e=AIe(this.redis,n),e<0)return this.reject(new Error("All keys in the pipeline should belong to the same slots allocation group")),this.promise}else e=Math.random()*16384|0}let r=this;return s(),this.promise;function s(){let n=r.replyPending=r._queue.length,i;r.isCluster&&(i={slot:e,redis:r.redis.connectionPool.nodes.all[r.preferKey]});let o="",a,l={isPipeline:!0,destination:r.isCluster?i:{redis:r.redis},write(u){typeof u!="string"?(a||(a=[]),o&&(a.push(Buffer.from(o,"utf8")),o=""),a.push(u)):o+=u,--n||(a?(o&&a.push(Buffer.from(o,"utf8")),l.destination.redis.stream.write(Buffer.concat(a))):l.destination.redis.stream.write(o),n=r._queue.length,o="",a=void 0)}};for(let u=0;u<r._queue.length;++u)r.redis.sendCommand(r._queue[u],l,i);return r.promise}}});var Qk=m(qS=>{"use strict";Object.defineProperty(qS,"__esModule",{value:!0});qS.addTransactionSupport=void 0;var Gk=fs(),Kk=Sl(),AK=Hk();function xIe(t){t.pipeline=function(s){let n=new AK.default(this);return Array.isArray(s)&&n.addBatch(s),n};let{multi:e}=t;t.multi=function(s,n){if(typeof n>"u"&&!Array.isArray(s)&&(n=s,s=null),n&&n.pipeline===!1)return e.call(this);let i=new AK.default(this);i.multi(),Array.isArray(s)&&i.addBatch(s);let o=i.exec;i.exec=function(l){if(this.isCluster&&!this.redis.slots.length)return this.redis.status==="wait"&&this.redis.connect().catch(Gk.noop),(0,Kk.default)(new Promise((c,d)=>{this.redis.delayUntilReady(f=>{if(f){d(f);return}this.exec(i).then(c,d)})}),l);if(this._transactions>0&&o.call(i),this.nodeifiedPromise)return o.call(i);let u=o.call(i);return(0,Kk.default)(u.then(function(c){let d=c[c.length-1];if(typeof d>"u")throw new Error("Pipeline cannot be used to send any commands when the `exec()` has been called on it.");if(d[0]){d[0].previousErrors=[];for(let f=0;f<c.length-1;++f)c[f][0]&&d[0].previousErrors.push(c[f][0]);throw d[0]}return(0,Gk.wrapMultiResult)(d[1])}),l)};let{execBuffer:a}=i;return i.execBuffer=function(l){return this._transactions>0&&a.call(i),i.exec(l)},i};let{exec:r}=t;t.exec=function(s){return(0,Kk.default)(r.call(this).then(function(n){return Array.isArray(n)&&(n=(0,Gk.wrapMultiResult)(n)),n}),s)}}qS.addTransactionSupport=xIe});var Zk=m(Wk=>{"use strict";Object.defineProperty(Wk,"__esModule",{value:!0});function IIe(t,e){Object.getOwnPropertyNames(e.prototype).forEach(r=>{Object.defineProperty(t.prototype,r,Object.getOwnPropertyDescriptor(e.prototype,r))})}Wk.default=IIe});var xK=m(LS=>{"use strict";Object.defineProperty(LS,"__esModule",{value:!0});LS.DEFAULT_CLUSTER_OPTIONS=void 0;var kK=require("dns");LS.DEFAULT_CLUSTER_OPTIONS={clusterRetryStrategy:t=>Math.min(100+t*2,2e3),enableOfflineQueue:!0,enableReadyCheck:!0,scaleReads:"master",maxRedirections:16,retryDelayOnMoved:0,retryDelayOnFailover:100,retryDelayOnClusterDown:100,retryDelayOnTryAgain:100,slotsRefreshTimeout:1e3,useSRVRecords:!1,resolveSrv:kK.resolveSrv,dnsLookup:kK.lookup,enableAutoPipelining:!1,autoPipeliningIgnoredCommands:[]}});var jS=m(hs=>{"use strict";Object.defineProperty(hs,"__esModule",{value:!0});hs.getConnectionName=hs.weightSrvRecords=hs.groupSrvRecords=hs.getUniqueHostnamesFromOptions=hs.normalizeNodeOptions=hs.nodeKeyToRedisOptions=hs.getNodeKey=void 0;var IK=fs(),NIe=require("net");function DIe(t){return t.port=t.port||6379,t.host=t.host||"127.0.0.1",t.host+":"+t.port}hs.getNodeKey=DIe;function MIe(t){let e=t.lastIndexOf(":");if(e===-1)throw new Error(`Invalid node key ${t}`);return{host:t.slice(0,e),port:Number(t.slice(e+1))}}hs.nodeKeyToRedisOptions=MIe;function $Ie(t){return t.map(e=>{let r={};if(typeof e=="object")Object.assign(r,e);else if(typeof e=="string")Object.assign(r,(0,IK.parseURL)(e));else if(typeof e=="number")r.port=e;else throw new Error("Invalid argument "+e);return typeof r.port=="string"&&(r.port=parseInt(r.port,10)),delete r.db,r.port||(r.port=6379),r.host||(r.host="127.0.0.1"),(0,IK.resolveTLSProfile)(r)})}hs.normalizeNodeOptions=$Ie;function qIe(t){let e={};return t.forEach(r=>{e[r.host]=!0}),Object.keys(e).filter(r=>!(0,NIe.isIP)(r))}hs.getUniqueHostnamesFromOptions=qIe;function LIe(t){let e={};for(let r of t)e.hasOwnProperty(r.priority)?(e[r.priority].totalWeight+=r.weight,e[r.priority].records.push(r)):e[r.priority]={totalWeight:r.weight,records:[r]};return e}hs.groupSrvRecords=LIe;function jIe(t){if(t.records.length===1)return t.totalWeight=0,t.records.shift();let e=Math.floor(Math.random()*(t.totalWeight+t.records.length)),r=0;for(let[s,n]of t.records.entries())if(r+=1+n.weight,r>e)return t.totalWeight-=n.weight,t.records.splice(s,1),n}hs.weightSrvRecords=jIe;function FIe(t,e){let r=`ioredis-cluster(${t})`;return e?`${r}:${e}`:r}hs.getConnectionName=FIe});var DK=m(Xk=>{"use strict";Object.defineProperty(Xk,"__esModule",{value:!0});var NK=jS(),Yk=fs(),BIe=Tl(),go=(0,Yk.Debug)("cluster:subscriber"),Jk=class{constructor(e,r){this.connectionPool=e,this.emitter=r,this.started=!1,this.subscriber=null,this.onSubscriberEnd=()=>{if(!this.started){go("subscriber has disconnected, but ClusterSubscriber is not started, so not reconnecting.");return}go("subscriber has disconnected, selecting a new one..."),this.selectSubscriber()},this.connectionPool.on("-node",(s,n)=>{!this.started||!this.subscriber||(0,NK.getNodeKey)(this.subscriber.options)===n&&(go("subscriber has left, selecting a new one..."),this.selectSubscriber())}),this.connectionPool.on("+node",()=>{!this.started||this.subscriber||(go("a new node is discovered and there is no subscriber, selecting a new one..."),this.selectSubscriber())})}getInstance(){return this.subscriber}start(){this.started=!0,this.selectSubscriber(),go("started")}stop(){this.started=!1,this.subscriber&&(this.subscriber.disconnect(),this.subscriber=null),go("stopped")}selectSubscriber(){let e=this.lastActiveSubscriber;e&&(e.off("end",this.onSubscriberEnd),e.disconnect()),this.subscriber&&(this.subscriber.off("end",this.onSubscriberEnd),this.subscriber.disconnect());let r=(0,Yk.sample)(this.connectionPool.getNodes());if(!r){go("selecting subscriber failed since there is no node discovered in the cluster yet"),this.subscriber=null;return}let{options:s}=r;go("selected a subscriber %s:%s",s.host,s.port),this.subscriber=new BIe.default({port:s.port,host:s.host,username:s.username,password:s.password,enableReadyCheck:!0,connectionName:(0,NK.getConnectionName)("subscriber",s.connectionName),lazyConnect:!0,tls:s.tls,retryStrategy:null}),this.subscriber.on("error",Yk.noop),this.subscriber.once("end",this.onSubscriberEnd);let n={subscribe:[],psubscribe:[],ssubscribe:[]};if(e){let i=e.condition||e.prevCondition;i&&i.subscriber&&(n.subscribe=i.subscriber.channels("subscribe"),n.psubscribe=i.subscriber.channels("psubscribe"),n.ssubscribe=i.subscriber.channels("ssubscribe"))}if(n.subscribe.length||n.psubscribe.length||n.ssubscribe.length){let i=0;for(let o of["subscribe","psubscribe","ssubscribe"]){let a=n[o];a.length&&(i+=1,go("%s %d channels",o,a.length),this.subscriber[o](a).then(()=>{--i||(this.lastActiveSubscriber=this.subscriber)}).catch(()=>{go("failed to %s %d channels",o,a.length)}))}}else this.lastActiveSubscriber=this.subscriber;for(let i of["message","messageBuffer","smessage","smessageBuffer"])this.subscriber.on(i,(o,a)=>{this.emitter.emit(i,o,a)});for(let i of["pmessage","pmessageBuffer"])this.subscriber.on(i,(o,a,l)=>{this.emitter.emit(i,o,a,l)})}};Xk.default=Jk});var $K=m(tx=>{"use strict";Object.defineProperty(tx,"__esModule",{value:!0});var zIe=require("events"),FS=fs(),MK=jS(),UIe=Tl(),ng=(0,FS.Debug)("cluster:connectionPool"),ex=class extends zIe.EventEmitter{constructor(e){super(),this.redisOptions=e,this.nodes={all:{},master:{},slave:{}},this.specifiedOptions={}}getNodes(e="all"){let r=this.nodes[e];return Object.keys(r).map(s=>r[s])}getInstanceByKey(e){return this.nodes.all[e]}getSampleInstance(e){let r=Object.keys(this.nodes[e]),s=(0,FS.sample)(r);return this.nodes[e][s]}findOrCreate(e,r=!1){let s=(0,MK.getNodeKey)(e);r=!!r,this.specifiedOptions[s]?Object.assign(e,this.specifiedOptions[s]):this.specifiedOptions[s]=e;let n;return this.nodes.all[s]?(n=this.nodes.all[s],n.options.readOnly!==r&&(n.options.readOnly=r,ng("Change role of %s to %s",s,r?"slave":"master"),n[r?"readonly":"readwrite"]().catch(FS.noop),r?(delete this.nodes.master[s],this.nodes.slave[s]=n):(delete this.nodes.slave[s],this.nodes.master[s]=n))):(ng("Connecting to %s as %s",s,r?"slave":"master"),n=new UIe.default((0,FS.defaults)({retryStrategy:null,enableOfflineQueue:!0,readOnly:r},e,this.redisOptions,{lazyConnect:!0})),this.nodes.all[s]=n,this.nodes[r?"slave":"master"][s]=n,n.once("end",()=>{this.removeNode(s),this.emit("-node",n,s),Object.keys(this.nodes.all).length||this.emit("drain")}),this.emit("+node",n,s),n.on("error",function(i){this.emit("nodeError",i,s)})),n}reset(e){ng("Reset with %O",e);let r={};e.forEach(s=>{let n=(0,MK.getNodeKey)(s);s.readOnly&&r[n]||(r[n]=s)}),Object.keys(this.nodes.all).forEach(s=>{r[s]||(ng("Disconnect %s because the node does not hold any slot",s),this.nodes.all[s].disconnect(),this.removeNode(s))}),Object.keys(r).forEach(s=>{let n=r[s];this.findOrCreate(n,n.readOnly)})}removeNode(e){let{nodes:r}=this;r.all[e]&&(ng("Remove %s from the pool",e),delete r.all[e]),delete r.master[e],delete r.slave[e]}};tx.default=ex});var BS=m((iQe,qK)=>{"use strict";function Wt(t,r){var r=r||{};this._capacity=r.capacity,this._head=0,this._tail=0,Array.isArray(t)?this._fromArray(t):(this._capacityMask=3,this._list=new Array(4))}Wt.prototype.peekAt=function(e){var r=e;if(r===(r|0)){var s=this.size();if(!(r>=s||r<-s))return r<0&&(r+=s),r=this._head+r&this._capacityMask,this._list[r]}};Wt.prototype.get=function(e){return this.peekAt(e)};Wt.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]};Wt.prototype.peekFront=function(){return this.peek()};Wt.prototype.peekBack=function(){return this.peekAt(-1)};Object.defineProperty(Wt.prototype,"length",{get:function(){return this.size()}});Wt.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Wt.prototype.unshift=function(e){if(arguments.length===0)return this.size();var r=this._list.length;return this._head=this._head-1+r&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Wt.prototype.shift=function(){var e=this._head;if(e!==this._tail){var r=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),r}};Wt.prototype.push=function(e){if(arguments.length===0)return this.size();var r=this._tail;return this._list[r]=e,this._tail=r+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Wt.prototype.pop=function(){var e=this._tail;if(e!==this._head){var r=this._list.length;this._tail=e-1+r&this._capacityMask;var s=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=r>>>2&&this._shrinkArray(),s}};Wt.prototype.removeOne=function(e){var r=e;if(r===(r|0)&&this._head!==this._tail){var s=this.size(),n=this._list.length;if(!(r>=s||r<-s)){r<0&&(r+=s),r=this._head+r&this._capacityMask;var i=this._list[r],o;if(e<s/2){for(o=e;o>0;o--)this._list[r]=this._list[r=r-1+n&this._capacityMask];this._list[r]=void 0,this._head=this._head+1+n&this._capacityMask}else{for(o=s-1-e;o>0;o--)this._list[r]=this._list[r=r+1+n&this._capacityMask];this._list[r]=void 0,this._tail=this._tail-1+n&this._capacityMask}return i}}};Wt.prototype.remove=function(e,r){var s=e,n,i=r;if(s===(s|0)&&this._head!==this._tail){var o=this.size(),a=this._list.length;if(!(s>=o||s<-o||r<1)){if(s<0&&(s+=o),r===1||!r)return n=new Array(1),n[0]=this.removeOne(s),n;if(s===0&&s+r>=o)return n=this.toArray(),this.clear(),n;s+r>o&&(r=o-s);var l;for(n=new Array(r),l=0;l<r;l++)n[l]=this._list[this._head+s+l&this._capacityMask];if(s=this._head+s&this._capacityMask,e+r===o){for(this._tail=this._tail-r+a&this._capacityMask,l=r;l>0;l--)this._list[s=s+1+a&this._capacityMask]=void 0;return n}if(e===0){for(this._head=this._head+r+a&this._capacityMask,l=r-1;l>0;l--)this._list[s=s+1+a&this._capacityMask]=void 0;return n}if(s<o/2){for(this._head=this._head+e+r+a&this._capacityMask,l=e;l>0;l--)this.unshift(this._list[s=s-1+a&this._capacityMask]);for(s=this._head-1+a&this._capacityMask;i>0;)this._list[s=s-1+a&this._capacityMask]=void 0,i--;e<0&&(this._tail=s)}else{for(this._tail=s,s=s+r+a&this._capacityMask,l=o-(r+e);l>0;l--)this.push(this._list[s++]);for(s=this._tail;i>0;)this._list[s=s+1+a&this._capacityMask]=void 0,i--}return this._head<2&&this._tail>1e4&&this._tail<=a>>>2&&this._shrinkArray(),n}}};Wt.prototype.splice=function(e,r){var s=e;if(s===(s|0)){var n=this.size();if(s<0&&(s+=n),!(s>n))if(arguments.length>2){var i,o,a,l=arguments.length,u=this._list.length,c=2;if(!n||s<n/2){for(o=new Array(s),i=0;i<s;i++)o[i]=this._list[this._head+i&this._capacityMask];for(r===0?(a=[],s>0&&(this._head=this._head+s+u&this._capacityMask)):(a=this.remove(s,r),this._head=this._head+s+u&this._capacityMask);l>c;)this.unshift(arguments[--l]);for(i=s;i>0;i--)this.unshift(o[i-1])}else{o=new Array(n-(s+r));var d=o.length;for(i=0;i<d;i++)o[i]=this._list[this._head+s+r+i&this._capacityMask];for(r===0?(a=[],s!=n&&(this._tail=this._head+s+u&this._capacityMask)):(a=this.remove(s,r),this._tail=this._tail-d+u&this._capacityMask);c<l;)this.push(arguments[c++]);for(i=0;i<d;i++)this.push(o[i])}return a}else return this.remove(s,r)}};Wt.prototype.clear=function(){this._list=new Array(this._list.length),this._head=0,this._tail=0};Wt.prototype.isEmpty=function(){return this._head===this._tail};Wt.prototype.toArray=function(){return this._copyArray(!1)};Wt.prototype._fromArray=function(e){var r=e.length,s=this._nextPowerOf2(r);this._list=new Array(s),this._capacityMask=s-1,this._tail=r;for(var n=0;n<r;n++)this._list[n]=e[n]};Wt.prototype._copyArray=function(e,r){var s=this._list,n=s.length,i=this.length;if(r=r|i,r==i&&this._head<this._tail)return this._list.slice(this._head,this._tail);var o=new Array(r),a=0,l;if(e||this._head>this._tail){for(l=this._head;l<n;l++)o[a++]=s[l];for(l=0;l<this._tail;l++)o[a++]=s[l]}else for(l=this._head;l<this._tail;l++)o[a++]=s[l];return o};Wt.prototype._growArray=function(){if(this._head!=0){var e=this._copyArray(!0,this._list.length<<1);this._tail=this._list.length,this._head=0,this._list=e}else this._tail=this._list.length,this._list.length<<=1;this._capacityMask=this._capacityMask<<1|1};Wt.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1};Wt.prototype._nextPowerOf2=function(e){var r=Math.log(e)/Math.log(2),s=1<<r+1;return Math.max(s,4)};qK.exports=Wt});var LK=m(sx=>{"use strict";Object.defineProperty(sx,"__esModule",{value:!0});var VIe=fs(),HIe=BS(),GIe=(0,VIe.Debug)("delayqueue"),rx=class{constructor(){this.queues={},this.timeouts={}}push(e,r,s){let n=s.callback||process.nextTick;this.queues[e]||(this.queues[e]=new HIe),this.queues[e].push(r),this.timeouts[e]||(this.timeouts[e]=setTimeout(()=>{n(()=>{this.timeouts[e]=null,this.execute(e)})},s.timeout))}execute(e){let r=this.queues[e];if(!r)return;let{length:s}=r;if(s)for(GIe("send %d commands in %s queue",s,e),this.queues[e]=null;r.length>0;)r.shift()()}};sx.default=rx});var ox=m(ix=>{"use strict";Object.defineProperty(ix,"__esModule",{value:!0});var jK=Cf(),VK=require("events"),zS=bc(),FK=Sl(),BK=ya(),nx=yK(),KIe=Tl(),QIe=DS(),WIe=Qk(),fn=fs(),ZIe=Zk(),YIe=$S(),JIe=xK(),XIe=DK(),eNe=$K(),tNe=LK(),Nf=jS(),zK=BS(),sr=(0,fn.Debug)("cluster"),UK=new WeakSet,Tc=class extends YIe.default{constructor(e,r={}){if(super(),this.slots=[],this._groupsIds={},this._groupsBySlot=Array(16384),this.isCluster=!0,this.retryAttempts=0,this.delayQueue=new tNe.default,this.offlineQueue=new zK,this.isRefreshing=!1,this._refreshSlotsCacheCallbacks=[],this._autoPipelines=new Map,this._runningAutoPipelines=new Set,this._readyDelayedCallbacks=[],this.connectionEpoch=0,VK.EventEmitter.call(this),this.startupNodes=e,this.options=(0,fn.defaults)({},r,JIe.DEFAULT_CLUSTER_OPTIONS,this.options),this.options.redisOptions&&this.options.redisOptions.keyPrefix&&!this.options.keyPrefix&&(this.options.keyPrefix=this.options.redisOptions.keyPrefix),typeof this.options.scaleReads!="function"&&["all","master","slave"].indexOf(this.options.scaleReads)===-1)throw new Error('Invalid option scaleReads "'+this.options.scaleReads+'". Expected "all", "master", "slave" or a custom function');this.connectionPool=new eNe.default(this.options.redisOptions),this.connectionPool.on("-node",(s,n)=>{this.emit("-node",s)}),this.connectionPool.on("+node",s=>{this.emit("+node",s)}),this.connectionPool.on("drain",()=>{this.setStatus("close")}),this.connectionPool.on("nodeError",(s,n)=>{this.emit("node error",s,n)}),this.subscriber=new XIe.default(this.connectionPool,this),this.options.scripts&&Object.entries(this.options.scripts).forEach(([s,n])=>{this.defineCommand(s,n)}),this.options.lazyConnect?this.setStatus("wait"):this.connect().catch(s=>{sr("connecting failed: %s",s)})}connect(){return new Promise((e,r)=>{if(this.status==="connecting"||this.status==="connect"||this.status==="ready"){r(new Error("Redis is already connecting/connected"));return}let s=++this.connectionEpoch;this.setStatus("connecting"),this.resolveStartupNodeHostnames().then(n=>{if(this.connectionEpoch!==s){sr("discard connecting after resolving startup nodes because epoch not match: %d != %d",s,this.connectionEpoch),r(new zS.RedisError("Connection is discarded because a new connection is made"));return}if(this.status!=="connecting"){sr("discard connecting after resolving startup nodes because the status changed to %s",this.status),r(new zS.RedisError("Connection is aborted"));return}this.connectionPool.reset(n);let i=()=>{this.setStatus("ready"),this.retryAttempts=0,this.executeOfflineCommands(),this.resetNodesRefreshInterval(),e()},o,a=()=>{this.invokeReadyDelayedCallbacks(void 0),this.removeListener("close",o),this.manuallyClosing=!1,this.setStatus("connect"),this.options.enableReadyCheck?this.readyCheck((l,u)=>{l||u?(sr("Ready check failed (%s). Reconnecting...",l||u),this.status==="connect"&&this.disconnect(!0)):i()}):i()};o=()=>{let l=new Error("None of startup nodes is available");this.removeListener("refresh",a),this.invokeReadyDelayedCallbacks(l),r(l)},this.once("refresh",a),this.once("close",o),this.once("close",this.handleCloseEvent.bind(this)),this.refreshSlotsCache(l=>{l&&l.message===nx.default.defaultMessage&&(KIe.default.prototype.silentEmit.call(this,"error",l),this.connectionPool.reset([]))}),this.subscriber.start()}).catch(n=>{this.setStatus("close"),this.handleCloseEvent(n),this.invokeReadyDelayedCallbacks(n),r(n)})})}disconnect(e=!1){let r=this.status;this.setStatus("disconnecting"),e||(this.manuallyClosing=!0),this.reconnectTimeout&&!e&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null,sr("Canceled reconnecting attempts")),this.clearNodesRefreshInterval(),this.subscriber.stop(),r==="wait"?(this.setStatus("close"),this.handleCloseEvent()):this.connectionPool.reset([])}quit(e){let r=this.status;if(this.setStatus("disconnecting"),this.manuallyClosing=!0,this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null),this.clearNodesRefreshInterval(),this.subscriber.stop(),r==="wait"){let s=(0,FK.default)(Promise.resolve("OK"),e);return setImmediate(function(){this.setStatus("close"),this.handleCloseEvent()}.bind(this)),s}return(0,FK.default)(Promise.all(this.nodes().map(s=>s.quit().catch(n=>{if(n.message===fn.CONNECTION_CLOSED_ERROR_MSG)return"OK";throw n}))).then(()=>"OK"),e)}duplicate(e=[],r={}){let s=e.length>0?e:this.startupNodes.slice(0),n=Object.assign({},this.options,r);return new Tc(s,n)}nodes(e="all"){if(e!=="all"&&e!=="master"&&e!=="slave")throw new Error('Invalid role "'+e+'". Expected "all", "master" or "slave"');return this.connectionPool.getNodes(e)}delayUntilReady(e){this._readyDelayedCallbacks.push(e)}get autoPipelineQueueSize(){let e=0;for(let r of this._autoPipelines.values())e+=r.length;return e}refreshSlotsCache(e){if(e&&this._refreshSlotsCacheCallbacks.push(e),this.isRefreshing)return;this.isRefreshing=!0;let r=this,s=a=>{this.isRefreshing=!1;for(let l of this._refreshSlotsCacheCallbacks)l(a);this._refreshSlotsCacheCallbacks=[]},n=(0,fn.shuffle)(this.connectionPool.getNodes()),i=null;function o(a){if(a===n.length){let c=new nx.default(nx.default.defaultMessage,i);return s(c)}let l=n[a],u=`${l.options.host}:${l.options.port}`;sr("getting slot cache from %s",u),r.getInfoFromNode(l,function(c){switch(r.status){case"close":case"end":return s(new Error("Cluster is disconnected."));case"disconnecting":return s(new Error("Cluster is disconnecting."))}c?(r.emit("node error",c,u),i=c,o(a+1)):(r.emit("refresh"),s())})}o(0)}sendCommand(e,r,s){if(this.status==="wait"&&this.connect().catch(fn.noop),this.status==="end")return e.reject(new Error(fn.CONNECTION_CLOSED_ERROR_MSG)),e.promise;let n=this.options.scaleReads;n!=="master"&&(e.isReadOnly||(0,jK.exists)(e.name)&&(0,jK.hasFlag)(e.name,"readonly")||(n="master"));let i=s?s.slot:e.getSlot(),o={},a=this;if(!s&&!UK.has(e)){UK.add(e);let u=e.reject;e.reject=function(c){let d=l.bind(null,!0);a.handleError(c,o,{moved:function(f,h){sr("command %s is moved to %s",e.name,h),i=Number(f),a.slots[f]?a.slots[f][0]=h:a.slots[f]=[h],a._groupsBySlot[f]=a._groupsIds[a.slots[f].join(";")],a.connectionPool.findOrCreate(a.natMapper(h)),l(),sr("refreshing slot caches... (triggered by MOVED error)"),a.refreshSlotsCache()},ask:function(f,h){sr("command %s is required to ask %s:%s",e.name,h);let p=a.natMapper(h);a.connectionPool.findOrCreate(p),l(!1,`${p.host}:${p.port}`)},tryagain:d,clusterDown:d,connectionClosed:d,maxRedirections:function(f){u.call(e,f)},defaults:function(){u.call(e,c)}})}}l();function l(u,c){if(a.status==="end"){e.reject(new zS.AbortError("Cluster is ended."));return}let d;if(a.status==="ready"||e.name==="cluster"){if(s&&s.redis)d=s.redis;else if(BK.default.checkFlag("ENTER_SUBSCRIBER_MODE",e.name)||BK.default.checkFlag("EXIT_SUBSCRIBER_MODE",e.name)){if(d=a.subscriber.getInstance(),!d){e.reject(new zS.AbortError("No subscriber for the cluster"));return}}else{if(!u){if(typeof i=="number"&&a.slots[i]){let f=a.slots[i];if(typeof n=="function"){let h=f.map(function(p){return a.connectionPool.getInstanceByKey(p)});d=n(h,e),Array.isArray(d)&&(d=(0,fn.sample)(d)),d||(d=h[0])}else{let h;n==="all"?h=(0,fn.sample)(f):n==="slave"&&f.length>1?h=(0,fn.sample)(f,1):h=f[0],d=a.connectionPool.getInstanceByKey(h)}}c&&(d=a.connectionPool.getInstanceByKey(c),d.asking())}d||(d=(typeof n=="function"?null:a.connectionPool.getSampleInstance(n))||a.connectionPool.getSampleInstance("all"))}s&&!s.redis&&(s.redis=d)}d?d.sendCommand(e,r):a.options.enableOfflineQueue?a.offlineQueue.push({command:e,stream:r,node:s}):e.reject(new Error("Cluster isn't ready and enableOfflineQueue options is false"))}return e.promise}sscanStream(e,r){return this.createScanStream("sscan",{key:e,options:r})}sscanBufferStream(e,r){return this.createScanStream("sscanBuffer",{key:e,options:r})}hscanStream(e,r){return this.createScanStream("hscan",{key:e,options:r})}hscanBufferStream(e,r){return this.createScanStream("hscanBuffer",{key:e,options:r})}zscanStream(e,r){return this.createScanStream("zscan",{key:e,options:r})}zscanBufferStream(e,r){return this.createScanStream("zscanBuffer",{key:e,options:r})}handleError(e,r,s){if(typeof r.value>"u"?r.value=this.options.maxRedirections:r.value-=1,r.value<=0){s.maxRedirections(new Error("Too many Cluster redirections. Last error: "+e));return}let n=e.message.split(" ");if(n[0]==="MOVED"){let i=this.options.retryDelayOnMoved;i&&typeof i=="number"?this.delayQueue.push("moved",s.moved.bind(null,n[1],n[2]),{timeout:i}):s.moved(n[1],n[2])}else n[0]==="ASK"?s.ask(n[1],n[2]):n[0]==="TRYAGAIN"?this.delayQueue.push("tryagain",s.tryagain,{timeout:this.options.retryDelayOnTryAgain}):n[0]==="CLUSTERDOWN"&&this.options.retryDelayOnClusterDown>0?this.delayQueue.push("clusterdown",s.connectionClosed,{timeout:this.options.retryDelayOnClusterDown,callback:this.refreshSlotsCache.bind(this)}):e.message===fn.CONNECTION_CLOSED_ERROR_MSG&&this.options.retryDelayOnFailover>0&&this.status==="ready"?this.delayQueue.push("failover",s.connectionClosed,{timeout:this.options.retryDelayOnFailover,callback:this.refreshSlotsCache.bind(this)}):s.defaults()}resetOfflineQueue(){this.offlineQueue=new zK}clearNodesRefreshInterval(){this.slotsTimer&&(clearTimeout(this.slotsTimer),this.slotsTimer=null)}resetNodesRefreshInterval(){if(this.slotsTimer||!this.options.slotsRefreshInterval)return;let e=()=>{this.slotsTimer=setTimeout(()=>{sr('refreshing slot caches... (triggered by "slotsRefreshInterval" option)'),this.refreshSlotsCache(()=>{e()})},this.options.slotsRefreshInterval)};e()}setStatus(e){sr("status: %s -> %s",this.status||"[empty]",e),this.status=e,process.nextTick(()=>{this.emit(e)})}handleCloseEvent(e){e&&sr("closed because %s",e);let r;!this.manuallyClosing&&typeof this.options.clusterRetryStrategy=="function"&&(r=this.options.clusterRetryStrategy.call(this,++this.retryAttempts,e)),typeof r=="number"?(this.setStatus("reconnecting"),this.reconnectTimeout=setTimeout(()=>{this.reconnectTimeout=null,sr("Cluster is disconnected. Retrying after %dms",r),this.connect().catch(function(s){sr("Got error %s when reconnecting. Ignoring...",s)})},r)):(this.setStatus("end"),this.flushQueue(new Error("None of startup nodes is available")))}flushQueue(e){let r;for(;r=this.offlineQueue.shift();)r.command.reject(e)}executeOfflineCommands(){if(this.offlineQueue.length){sr("send %d commands in offline queue",this.offlineQueue.length);let e=this.offlineQueue;this.resetOfflineQueue();let r;for(;r=e.shift();)this.sendCommand(r.command,r.stream,r.node)}}natMapper(e){if(this.options.natMap&&typeof this.options.natMap=="object"){let r=typeof e=="string"?e:`${e.host}:${e.port}`,s=this.options.natMap[r];if(s)return sr("NAT mapping %s -> %O",r,s),Object.assign({},s)}return typeof e=="string"?(0,Nf.nodeKeyToRedisOptions)(e):e}getInfoFromNode(e,r){if(!e)return r(new Error("Node is disconnected"));let s=e.duplicate({enableOfflineQueue:!0,enableReadyCheck:!1,retryStrategy:null,connectionName:(0,Nf.getConnectionName)("refresher",this.options.redisOptions&&this.options.redisOptions.connectionName)});s.on("error",fn.noop),s.cluster("SLOTS",(0,fn.timeout)((n,i)=>{if(s.disconnect(),n)return r(n);if(this.status==="disconnecting"||this.status==="close"||this.status==="end"){sr("ignore CLUSTER.SLOTS results (count: %d) since cluster status is %s",i.length,this.status),r();return}let o=[];sr("cluster slots result count: %d",i.length);for(let l=0;l<i.length;++l){let u=i[l],c=u[0],d=u[1],f=[];for(let h=2;h<u.length;h++){if(!u[h][0])continue;let p=this.natMapper({host:u[h][0],port:u[h][1]});p.readOnly=h!==2,o.push(p),f.push(p.host+":"+p.port)}sr("cluster slots result [%d]: slots %d~%d served by %s",l,c,d,f);for(let h=c;h<=d;h++)this.slots[h]=f}this._groupsIds=Object.create(null);let a=0;for(let l=0;l<16384;l++){let u=(this.slots[l]||[]).join(";");if(!u.length){this._groupsBySlot[l]=void 0;continue}this._groupsIds[u]||(this._groupsIds[u]=++a),this._groupsBySlot[l]=this._groupsIds[u]}this.connectionPool.reset(o),r()},this.options.slotsRefreshTimeout))}invokeReadyDelayedCallbacks(e){for(let r of this._readyDelayedCallbacks)process.nextTick(r,e);this._readyDelayedCallbacks=[]}readyCheck(e){this.cluster("INFO",(r,s)=>{if(r)return e(r);if(typeof s!="string")return e();let n,i=s.split(`\r
`);for(let o=0;o<i.length;++o){let a=i[o].split(":");if(a[0]==="cluster_state"){n=a[1];break}}n==="fail"?(sr("cluster state not ok (%s)",n),e(null,n)):e()})}resolveSrv(e){return new Promise((r,s)=>{this.options.resolveSrv(e,(n,i)=>{if(n)return s(n);let o=this,a=(0,Nf.groupSrvRecords)(i),l=Object.keys(a).sort((c,d)=>parseInt(c)-parseInt(d));function u(c){if(!l.length)return s(c);let d=l[0],f=a[d],h=(0,Nf.weightSrvRecords)(f);f.records.length||l.shift(),o.dnsLookup(h.name).then(p=>r({host:p,port:h.port}),u)}u()})})}dnsLookup(e){return new Promise((r,s)=>{this.options.dnsLookup(e,(n,i)=>{n?(sr("failed to resolve hostname %s to IP: %s",e,n.message),s(n)):(sr("resolved hostname %s to IP %s",e,i),r(i))})})}async resolveStartupNodeHostnames(){if(!Array.isArray(this.startupNodes)||this.startupNodes.length===0)throw new Error("`startupNodes` should contain at least one node.");let e=(0,Nf.normalizeNodeOptions)(this.startupNodes),r=(0,Nf.getUniqueHostnamesFromOptions)(e);if(r.length===0)return e;let s=await Promise.all(r.map((this.options.useSRVRecords?this.resolveSrv:this.dnsLookup).bind(this))),n=(0,fn.zipMap)(r,s);return e.map(i=>{let o=n.get(i.host);return o?this.options.useSRVRecords?Object.assign({},i,o):Object.assign({},i,{host:o}):i})}createScanStream(e,{key:r,options:s={}}){return new QIe.default({objectMode:!0,key:r,redis:this,command:e,...s})}};(0,ZIe.default)(Tc,VK.EventEmitter);(0,WIe.addTransactionSupport)(Tc.prototype);ix.default=Tc});var US=m(lx=>{"use strict";Object.defineProperty(lx,"__esModule",{value:!0});var rNe=fs(),sNe=(0,rNe.Debug)("AbstractConnector"),ax=class{constructor(e){this.connecting=!1,this.disconnectTimeout=e}check(e){return!0}disconnect(){if(this.connecting=!1,this.stream){let e=this.stream,r=setTimeout(()=>{sNe("stream %s:%s still open, destroying it",e.remoteAddress,e.remotePort),e.destroy()},this.disconnectTimeout);e.on("close",()=>clearTimeout(r)),e.end()}}};lx.default=ax});var HK=m(cx=>{"use strict";Object.defineProperty(cx,"__esModule",{value:!0});var nNe=require("net"),iNe=require("tls"),oNe=fs(),aNe=US(),ux=class extends aNe.default{constructor(e){super(e.disconnectTimeout),this.options=e}connect(e){let{options:r}=this;this.connecting=!0;let s;return"path"in r&&r.path?s={path:r.path}:(s={},"port"in r&&r.port!=null&&(s.port=r.port),"host"in r&&r.host!=null&&(s.host=r.host),"family"in r&&r.family!=null&&(s.family=r.family)),r.tls&&Object.assign(s,r.tls),new Promise((n,i)=>{process.nextTick(()=>{if(!this.connecting){i(new Error(oNe.CONNECTION_CLOSED_ERROR_MSG));return}try{r.tls?this.stream=(0,iNe.connect)(s):this.stream=(0,nNe.createConnection)(s)}catch(o){i(o);return}this.stream.once("error",o=>{this.firstError=o}),n(this.stream)})})}};cx.default=ux});var GK=m(fx=>{"use strict";Object.defineProperty(fx,"__esModule",{value:!0});function lNe(t,e){return(t.host||"127.0.0.1")===(e.host||"127.0.0.1")&&(t.port||26379)===(e.port||26379)}var dx=class{constructor(e){this.cursor=0,this.sentinels=e.slice(0)}next(){let e=this.cursor>=this.sentinels.length;return{done:e,value:e?void 0:this.sentinels[this.cursor++]}}reset(e){e&&this.sentinels.length>1&&this.cursor!==1&&this.sentinels.unshift(...this.sentinels.splice(this.cursor-1)),this.cursor=0}add(e){for(let r=0;r<this.sentinels.length;r++)if(lNe(e,this.sentinels[r]))return!1;return this.sentinels.push(e),!0}toString(){return`${JSON.stringify(this.sentinels)} @${this.cursor}`}};fx.default=dx});var QK=m(VS=>{"use strict";Object.defineProperty(VS,"__esModule",{value:!0});VS.FailoverDetector=void 0;var uNe=fs(),hx=(0,uNe.Debug)("FailoverDetector"),KK="+switch-master",px=class{constructor(e,r){this.isDisconnected=!1,this.connector=e,this.sentinels=r}cleanup(){this.isDisconnected=!0;for(let e of this.sentinels)e.client.disconnect()}async subscribe(){hx("Starting FailoverDetector");let e=[];for(let r of this.sentinels){let s=r.client.subscribe(KK).catch(n=>{hx("Failed to subscribe to failover messages on sentinel %s:%s (%s)",r.address.host||"127.0.0.1",r.address.port||26739,n.message)});e.push(s),r.client.on("message",n=>{!this.isDisconnected&&n===KK&&this.disconnect()})}await Promise.all(e)}disconnect(){this.isDisconnected=!0,hx("Failover detected, disconnecting"),this.connector.disconnect()}};VS.FailoverDetector=px});var HS=m(og=>{"use strict";Object.defineProperty(og,"__esModule",{value:!0});og.SentinelIterator=void 0;var cNe=require("net"),ig=fs(),dNe=require("tls"),WK=GK();og.SentinelIterator=WK.default;var fNe=US(),hNe=Tl(),pNe=QK(),Df=(0,ig.Debug)("SentinelConnector"),mx=class extends fNe.default{constructor(e){if(super(e.disconnectTimeout),this.options=e,this.emitter=null,this.failoverDetector=null,!this.options.sentinels.length)throw new Error("Requires at least one sentinel to connect to.");if(!this.options.name)throw new Error("Requires the name of master.");this.sentinelIterator=new WK.default(this.options.sentinels)}check(e){let r=!e.role||this.options.role===e.role;return r||(Df("role invalid, expected %s, but got %s",this.options.role,e.role),this.sentinelIterator.next(),this.sentinelIterator.next(),this.sentinelIterator.reset(!0)),r}disconnect(){super.disconnect(),this.failoverDetector&&this.failoverDetector.cleanup()}connect(e){this.connecting=!0,this.retryAttempts=0;let r,s=async()=>{let n=this.sentinelIterator.next();if(n.done){this.sentinelIterator.reset(!1);let l=typeof this.options.sentinelRetryStrategy=="function"?this.options.sentinelRetryStrategy(++this.retryAttempts):null,u=typeof l!="number"?"All sentinels are unreachable and retry is disabled.":`All sentinels are unreachable. Retrying from scratch after ${l}ms.`;r&&(u+=` Last error: ${r.message}`),Df(u);let c=new Error(u);if(typeof l=="number")return e("error",c),await new Promise(d=>setTimeout(d,l)),s();throw c}let i=null,o=null;try{i=await this.resolve(n.value)}catch(l){o=l}if(!this.connecting)throw new Error(ig.CONNECTION_CLOSED_ERROR_MSG);let a=n.value.host+":"+n.value.port;if(i)return Df("resolved: %s:%s from sentinel %s",i.host,i.port,a),this.options.enableTLSForSentinelMode&&this.options.tls?(Object.assign(i,this.options.tls),this.stream=(0,dNe.connect)(i),this.stream.once("secureConnect",this.initFailoverDetector.bind(this))):(this.stream=(0,cNe.createConnection)(i),this.stream.once("connect",this.initFailoverDetector.bind(this))),this.stream.once("error",l=>{this.firstError=l}),this.stream;{let l=o?"failed to connect to sentinel "+a+" because "+o.message:"connected to sentinel "+a+" successfully, but got an invalid reply: "+i;return Df(l),e("sentinelError",new Error(l)),o&&(r=o),s()}};return s()}async updateSentinels(e){if(!this.options.updateSentinels)return;let r=await e.sentinel("sentinels",this.options.name);Array.isArray(r)&&(r.map(ig.packObject).forEach(s=>{if((s.flags?s.flags.split(","):[]).indexOf("disconnected")===-1&&s.ip&&s.port){let i=this.sentinelNatResolve(ZK(s));this.sentinelIterator.add(i)&&Df("adding sentinel %s:%s",i.host,i.port)}}),Df("Updated internal sentinels: %s",this.sentinelIterator))}async resolveMaster(e){let r=await e.sentinel("get-master-addr-by-name",this.options.name);return await this.updateSentinels(e),this.sentinelNatResolve(Array.isArray(r)?{host:r[0],port:Number(r[1])}:null)}async resolveSlave(e){let r=await e.sentinel("slaves",this.options.name);if(!Array.isArray(r))return null;let s=r.map(ig.packObject).filter(n=>n.flags&&!n.flags.match(/(disconnected|s_down|o_down)/));return this.sentinelNatResolve(mNe(s,this.options.preferredSlaves))}sentinelNatResolve(e){return!e||!this.options.natMap?e:this.options.natMap[`${e.host}:${e.port}`]||e}connectToSentinel(e,r){return new hNe.default({port:e.port||26379,host:e.host,username:this.options.sentinelUsername||null,password:this.options.sentinelPassword||null,family:e.family||("path"in this.options&&this.options.path?void 0:this.options.family),tls:this.options.sentinelTLS,retryStrategy:null,enableReadyCheck:!1,connectTimeout:this.options.connectTimeout,commandTimeout:this.options.sentinelCommandTimeout,...r})}async resolve(e){let r=this.connectToSentinel(e);r.on("error",gNe);try{return this.options.role==="slave"?await this.resolveSlave(r):await this.resolveMaster(r)}finally{r.disconnect()}}async initFailoverDetector(){var e;if(!this.options.failoverDetector)return;this.sentinelIterator.reset(!0);let r=[];for(;r.length<this.options.sentinelMaxConnections;){let{done:s,value:n}=this.sentinelIterator.next();if(s)break;let i=this.connectToSentinel(n,{lazyConnect:!0,retryStrategy:this.options.sentinelReconnectStrategy});i.on("reconnecting",()=>{var o;(o=this.emitter)===null||o===void 0||o.emit("sentinelReconnecting")}),r.push({address:n,client:i})}this.sentinelIterator.reset(!1),this.failoverDetector&&this.failoverDetector.cleanup(),this.failoverDetector=new pNe.FailoverDetector(this,r),await this.failoverDetector.subscribe(),(e=this.emitter)===null||e===void 0||e.emit("failoverSubscribed")}};og.default=mx;function mNe(t,e){if(t.length===0)return null;let r;if(typeof e=="function")r=e(t);else if(e!==null&&typeof e=="object"){let s=Array.isArray(e)?e:[e];s.sort((n,i)=>(n.prio||(n.prio=1),i.prio||(i.prio=1),n.prio<i.prio?-1:n.prio>i.prio?1:0));for(let n=0;n<s.length;n++){for(let i=0;i<t.length;i++){let o=t[i];if(o.ip===s[n].ip&&o.port===s[n].port){r=o;break}}if(r)break}}return r||(r=(0,ig.sample)(t)),ZK(r)}function ZK(t){return{host:t.ip,port:Number(t.port)}}function gNe(){}});var YK=m(Mf=>{"use strict";Object.defineProperty(Mf,"__esModule",{value:!0});Mf.SentinelConnector=Mf.StandaloneConnector=void 0;var yNe=HK();Mf.StandaloneConnector=yNe.default;var vNe=HS();Mf.SentinelConnector=vNe.default});var JK=m(yx=>{"use strict";Object.defineProperty(yx,"__esModule",{value:!0});var _Ne=bc(),gx=class extends _Ne.AbortError{constructor(e){let r=`Reached the max retries per request limit (which is ${e}). Refer to "maxRetriesPerRequest" option for details.`;super(r),Error.captureStackTrace(this,this.constructor)}get name(){return this.constructor.name}};yx.default=gx});var XK=m(GS=>{"use strict";Object.defineProperty(GS,"__esModule",{value:!0});GS.MaxRetriesPerRequestError=void 0;var SNe=JK();GS.MaxRetriesPerRequestError=SNe.default});var oQ=m((gQe,iQ)=>{"use strict";var wx=require("buffer").Buffer,bNe=require("string_decoder").StringDecoder,vx=new bNe,eQ=bc(),ENe=eQ.ReplyError,wNe=eQ.ParserError,Oi=wx.allocUnsafe(32*1024),Rs=0,KS=null,ag=0,_x=0;function TNe(t){let e=t.buffer.length-1;var r=t.offset,s=0,n=1;for(t.buffer[r]===45&&(n=-1,r++);r<e;){let i=t.buffer[r++];if(i===13)return t.offset=r+1,n*s;s=s*10+(i-48)}}function CNe(t){let e=t.buffer.length-1;var r=t.offset,s=0,n="";for(t.buffer[r]===45&&(n+="-",r++);r<e;){var i=t.buffer[r++];if(i===13)return t.offset=r+1,s!==0&&(n+=s),n;s>429496728?(n+=s*10+(i-48),s=0):i===48&&s===0?n+=0:s=s*10+(i-48)}}function tQ(t){let e=t.offset,r=t.buffer,s=r.length-1;for(var n=e;n<s;)if(r[n++]===13)return t.offset=n+1,t.optionReturnBuffers===!0?t.buffer.slice(e,n-1):t.buffer.toString("utf8",e,n-1)}function rQ(t){let e=t.buffer.length-1;for(var r=t.offset,s=0;r<e;){let n=t.buffer[r++];if(n===13)return t.offset=r+1,s;s=s*10+(n-48)}}function RNe(t){return t.optionStringNumbers===!0?CNe(t):TNe(t)}function ONe(t){let e=rQ(t);if(e===void 0)return;if(e<0)return null;let r=t.offset+e;if(r+2>t.buffer.length){t.bigStrSize=r+2,t.totalChunkSize=t.buffer.length,t.bufferCache.push(t.buffer);return}let s=t.offset;return t.offset=r+2,t.optionReturnBuffers===!0?t.buffer.slice(s,r):t.buffer.toString("utf8",s,r)}function PNe(t){var e=tQ(t);if(e!==void 0)return t.optionReturnBuffers===!0&&(e=e.toString()),new ENe(e)}function ANe(t,e){let r=new wNe("Protocol error, got "+JSON.stringify(String.fromCharCode(e))+" as reply type byte",JSON.stringify(t.buffer),t.offset);t.buffer=null,t.returnFatalError(r)}function kNe(t){let e=rQ(t);if(e===void 0)return;if(e<0)return null;let r=new Array(e);return sQ(t,r,0)}function Sx(t,e,r){t.arrayCache.push(e),t.arrayPos.push(r)}function bx(t){let e=t.arrayCache.pop();var r=t.arrayPos.pop();if(t.arrayCache.length){let s=bx(t);if(s===void 0){Sx(t,e,r);return}e[r++]=s}return sQ(t,e,r)}function sQ(t,e,r){let s=t.buffer.length;for(;r<e.length;){let n=t.offset;if(t.offset>=s){Sx(t,e,r);return}let i=nQ(t,t.buffer[t.offset++]);if(i===void 0){t.arrayCache.length||t.bufferCache.length||(t.offset=n),Sx(t,e,r);return}e[r]=i,r++}return e}function nQ(t,e){switch(e){case 36:return ONe(t);case 43:return tQ(t);case 42:return kNe(t);case 58:return RNe(t);case 45:return PNe(t);default:return ANe(t,e)}}function xNe(){if(Oi.length>50*1024)if(ag===1||_x>ag*2){let t=Math.floor(Oi.length/10),e=t<Rs?Rs:t;Rs=0,Oi=Oi.slice(e,Oi.length)}else _x++,ag--;else clearInterval(KS),ag=0,_x=0,KS=null}function INe(t){if(Oi.length<t+Rs){let e=t>78643200?2:3;Rs>1024*1024*111&&(Rs=1024*1024*50),Oi=wx.allocUnsafe(t*e+Rs),Rs=0,ag++,KS===null&&(KS=setInterval(xNe,50))}}function NNe(t){let e=t.bufferCache,r=t.offset;var s=e.length,n=t.bigStrSize-t.totalChunkSize;if(t.offset=n,n<=2){if(s===2)return e[0].toString("utf8",r,e[0].length+n-2);s--,n=e[e.length-2].length+n}for(var i=vx.write(e[0].slice(r)),o=1;o<s-1;o++)i+=vx.write(e[o]);return i+=vx.end(e[o].slice(0,n-2)),i}function DNe(t){let e=t.bufferCache,r=t.offset,s=t.bigStrSize-r-2;var n=e.length,i=t.bigStrSize-t.totalChunkSize;if(t.offset=i,i<=2){if(n===2)return e[0].slice(r,e[0].length+i-2);n--,i=e[e.length-2].length+i}INe(s);let o=Rs;e[0].copy(Oi,o,r,e[0].length),Rs+=e[0].length-r;for(var a=1;a<n-1;a++)e[a].copy(Oi,Rs),Rs+=e[a].length;return e[a].copy(Oi,Rs,0,i-2),Rs+=i-2,Oi.slice(o,Rs)}var Ex=class{constructor(e){if(!e)throw new TypeError("Options are mandatory.");if(typeof e.returnError!="function"||typeof e.returnReply!="function")throw new TypeError("The returnReply and returnError options have to be functions.");this.setReturnBuffers(!!e.returnBuffers),this.setStringNumbers(!!e.stringNumbers),this.returnError=e.returnError,this.returnFatalError=e.returnFatalError||e.returnError,this.returnReply=e.returnReply,this.reset()}reset(){this.offset=0,this.buffer=null,this.bigStrSize=0,this.totalChunkSize=0,this.bufferCache=[],this.arrayCache=[],this.arrayPos=[]}setReturnBuffers(e){if(typeof e!="boolean")throw new TypeError("The returnBuffers argument has to be a boolean");this.optionReturnBuffers=e}setStringNumbers(e){if(typeof e!="boolean")throw new TypeError("The stringNumbers argument has to be a boolean");this.optionStringNumbers=e}execute(e){if(this.buffer===null)this.buffer=e,this.offset=0;else if(this.bigStrSize===0){let s=this.buffer.length,n=s-this.offset,i=wx.allocUnsafe(n+e.length);if(this.buffer.copy(i,0,this.offset,s),e.copy(i,n,0,e.length),this.buffer=i,this.offset=0,this.arrayCache.length){let o=bx(this);if(o===void 0)return;this.returnReply(o)}}else if(this.totalChunkSize+e.length>=this.bigStrSize){this.bufferCache.push(e);var r=this.optionReturnBuffers?DNe(this):NNe(this);if(this.bigStrSize=0,this.bufferCache=[],this.buffer=e,this.arrayCache.length&&(this.arrayCache[0][this.arrayPos[0]++]=r,r=bx(this),r===void 0))return;this.returnReply(r)}else{this.bufferCache.push(e),this.totalChunkSize+=e.length;return}for(;this.offset<this.buffer.length;){let s=this.offset,n=this.buffer[this.offset++],i=nQ(this,n);if(i===void 0){this.arrayCache.length||this.bufferCache.length||(this.offset=s);return}n===45?this.returnError(i):this.returnReply(i)}this.buffer=null}};iQ.exports=Ex});var lQ=m((yQe,aQ)=>{"use strict";aQ.exports=oQ()});var uQ=m(Rx=>{"use strict";Object.defineProperty(Rx,"__esModule",{value:!0});var Cx=class{constructor(){this.set={subscribe:{},psubscribe:{},ssubscribe:{}}}add(e,r){this.set[Tx(e)][r]=!0}del(e,r){delete this.set[Tx(e)][r]}channels(e){return Object.keys(this.set[Tx(e)])}isEmpty(){return this.channels("subscribe").length===0&&this.channels("psubscribe").length===0&&this.channels("ssubscribe").length===0}};Rx.default=Cx;function Tx(t){return t==="unsubscribe"?"subscribe":t==="punsubscribe"?"psubscribe":t==="sunsubscribe"?"ssubscribe":t}});var hQ=m(Px=>{"use strict";Object.defineProperty(Px,"__esModule",{value:!0});var cQ=ya(),MNe=fs(),$Ne=lQ(),qNe=uQ(),LNe=(0,MNe.Debug)("dataHandler"),Ox=class{constructor(e,r){this.redis=e;let s=new $Ne({stringNumbers:r.stringNumbers,returnBuffers:!0,returnError:n=>{this.returnError(n)},returnFatalError:n=>{this.returnFatalError(n)},returnReply:n=>{this.returnReply(n)}});e.stream.on("data",n=>{s.execute(n)})}returnFatalError(e){e.message+=". Please report this.",this.redis.recoverFromFatalError(e,e,{offlineQueue:!1})}returnError(e){let r=this.shiftCommand(e);r&&(e.command={name:r.command.name,args:r.command.args},this.redis.handleReconnection(e,r))}returnReply(e){if(this.handleMonitorReply(e)||this.handleSubscriberReply(e))return;let r=this.shiftCommand(e);r&&(cQ.default.checkFlag("ENTER_SUBSCRIBER_MODE",r.command.name)?(this.redis.condition.subscriber=new qNe.default,this.redis.condition.subscriber.add(r.command.name,e[1].toString()),dQ(r.command,e[2])||this.redis.commandQueue.unshift(r)):cQ.default.checkFlag("EXIT_SUBSCRIBER_MODE",r.command.name)?fQ(r.command,e[2])||this.redis.commandQueue.unshift(r):r.command.resolve(e))}handleSubscriberReply(e){if(!this.redis.condition.subscriber)return!1;let r=Array.isArray(e)?e[0].toString():null;switch(LNe('receive reply "%s" in subscriber mode',r),r){case"message":this.redis.listeners("message").length>0&&this.redis.emit("message",e[1].toString(),e[2]?e[2].toString():""),this.redis.emit("messageBuffer",e[1],e[2]);break;case"pmessage":{let s=e[1].toString();this.redis.listeners("pmessage").length>0&&this.redis.emit("pmessage",s,e[2].toString(),e[3].toString()),this.redis.emit("pmessageBuffer",s,e[2],e[3]);break}case"smessage":{this.redis.listeners("smessage").length>0&&this.redis.emit("smessage",e[1].toString(),e[2]?e[2].toString():""),this.redis.emit("smessageBuffer",e[1],e[2]);break}case"ssubscribe":case"subscribe":case"psubscribe":{let s=e[1].toString();this.redis.condition.subscriber.add(r,s);let n=this.shiftCommand(e);if(!n)return;dQ(n.command,e[2])||this.redis.commandQueue.unshift(n);break}case"sunsubscribe":case"unsubscribe":case"punsubscribe":{let s=e[1]?e[1].toString():null;s&&this.redis.condition.subscriber.del(r,s);let n=e[2];Number(n)===0&&(this.redis.condition.subscriber=!1);let i=this.shiftCommand(e);if(!i)return;fQ(i.command,n)||this.redis.commandQueue.unshift(i);break}default:{let s=this.shiftCommand(e);if(!s)return;s.command.resolve(e)}}return!0}handleMonitorReply(e){if(this.redis.status!=="monitoring")return!1;let r=e.toString();if(r==="OK")return!1;let s=r.indexOf(" "),n=r.slice(0,s),i=r.indexOf('"'),o=r.slice(i+1,-1).split('" "').map(l=>l.replace(/\\"/g,'"')),a=r.slice(s+2,i-2).split(" ");return this.redis.emit("monitor",n,o,a[1],a[0]),!0}shiftCommand(e){let r=this.redis.commandQueue.shift();if(!r){let s="Command queue state error. If you can reproduce this, please report it.",n=new Error(s+(e instanceof Error?` Last error: ${e.message}`:` Last reply: ${e.toString()}`));return this.redis.emit("error",n),null}return r}};Px.default=Ox;var Cl=new WeakMap;function dQ(t,e){let r=Cl.has(t)?Cl.get(t):t.args.length;return r-=1,r<=0?(t.resolve(e),Cl.delete(t),!0):(Cl.set(t,r),!1)}function fQ(t,e){let r=Cl.has(t)?Cl.get(t):t.args.length;return r===0?Number(e)===0?(Cl.delete(t),t.resolve(e),!0):!1:(r-=1,r<=0?(t.resolve(e),!0):(Cl.set(t,r),!1))}});var pQ=m(Bn=>{"use strict";Object.defineProperty(Bn,"__esModule",{value:!0});Bn.readyHandler=Bn.errorHandler=Bn.closeHandler=Bn.connectHandler=void 0;var jNe=bc(),FNe=ya(),BNe=XK(),lg=fs(),zNe=hQ(),ps=(0,lg.Debug)("connection");function UNe(t){return function(){t.setStatus("connect"),t.resetCommandQueue();let e=!1,{connectionEpoch:r}=t;t.condition.auth&&t.auth(t.condition.auth,function(s){r===t.connectionEpoch&&s&&(s.message.indexOf("no password is set")!==-1?console.warn("[WARN] Redis server does not require a password, but a password was supplied."):s.message.indexOf("without any password configured for the default user")!==-1?console.warn("[WARN] This Redis server's `default` user does not require a password, but a password was supplied"):s.message.indexOf("wrong number of arguments for 'auth' command")!==-1?console.warn(`[ERROR] The server returned "wrong number of arguments for 'auth' command". You are probably passing both username and password to Redis version 5 or below. You should only pass the 'password' option for Redis version 5 and under.`):(e=!0,t.recoverFromFatalError(s,s)))}),t.condition.select&&t.select(t.condition.select).catch(s=>{t.silentEmit("error",s)}),t.options.enableReadyCheck||Bn.readyHandler(t)(),new zNe.default(t,{stringNumbers:t.options.stringNumbers}),t.options.enableReadyCheck&&t._readyCheck(function(s,n){r===t.connectionEpoch&&(s?e||t.recoverFromFatalError(new Error("Ready check failed: "+s.message),s):t.connector.check(n)?Bn.readyHandler(t)():t.disconnect(!0))})}}Bn.connectHandler=UNe;function Ax(t){let e=new jNe.AbortError("Command aborted due to connection close");return e.command={name:t.name,args:t.args},e}function VNe(t){var e;let r=0;for(let s=0;s<t.length;){let n=(e=t.peekAt(s))===null||e===void 0?void 0:e.command,i=n.pipelineIndex;if((i===void 0||i===0)&&(r=0),i!==void 0&&i!==r++){t.remove(s,1),n.reject(Ax(n));continue}s++}}function HNe(t){var e;for(let r=0;r<t.length;){let s=(e=t.peekAt(r))===null||e===void 0?void 0:e.command;if(s.name==="multi")break;if(s.name==="exec"){t.remove(r,1),s.reject(Ax(s));break}s.inTransaction?(t.remove(r,1),s.reject(Ax(s))):r++}}function GNe(t){return function(){let r=t.status;if(t.setStatus("close"),t.commandQueue.length&&VNe(t.commandQueue),t.offlineQueue.length&&HNe(t.offlineQueue),r==="ready"&&(t.prevCondition||(t.prevCondition=t.condition),t.commandQueue.length&&(t.prevCommandQueue=t.commandQueue)),t.manuallyClosing)return t.manuallyClosing=!1,ps("skip reconnecting since the connection is manually closed."),e();if(typeof t.options.retryStrategy!="function")return ps("skip reconnecting because `retryStrategy` is not a function"),e();let s=t.options.retryStrategy(++t.retryAttempts);if(typeof s!="number")return ps("skip reconnecting because `retryStrategy` doesn't return a number"),e();ps("reconnect in %sms",s),t.setStatus("reconnecting",s),t.reconnectTimeout=setTimeout(function(){t.reconnectTimeout=null,t.connect().catch(lg.noop)},s);let{maxRetriesPerRequest:n}=t.options;typeof n=="number"&&(n<0?ps("maxRetriesPerRequest is negative, ignoring..."):t.retryAttempts%(n+1)===0&&(ps("reach maxRetriesPerRequest limitation, flushing command queue..."),t.flushQueue(new BNe.MaxRetriesPerRequestError(n))))};function e(){t.setStatus("end"),t.flushQueue(new Error(lg.CONNECTION_CLOSED_ERROR_MSG))}}Bn.closeHandler=GNe;function KNe(t){return function(e){ps("error: %s",e),t.silentEmit("error",e)}}Bn.errorHandler=KNe;function QNe(t){return function(){if(t.setStatus("ready"),t.retryAttempts=0,t.options.monitor){t.call("monitor").then(()=>t.setStatus("monitoring"),s=>t.emit("error",s));let{sendCommand:r}=t;t.sendCommand=function(s){return FNe.default.checkFlag("VALID_IN_MONITOR_MODE",s.name)?r.call(t,s):(s.reject(new Error("Connection is in monitoring mode, can't process commands.")),s.promise)},t.once("close",function(){delete t.sendCommand});return}let e=t.prevCondition?t.prevCondition.select:t.condition.select;if(t.options.connectionName&&(ps("set the connection name [%s]",t.options.connectionName),t.client("setname",t.options.connectionName).catch(lg.noop)),t.options.readOnly&&(ps("set the connection to readonly mode"),t.readonly().catch(lg.noop)),t.prevCondition){let r=t.prevCondition;if(t.prevCondition=null,r.subscriber&&t.options.autoResubscribe){t.condition.select!==e&&(ps("connect to db [%d]",e),t.select(e));let s=r.subscriber.channels("subscribe");s.length&&(ps("subscribe %d channels",s.length),t.subscribe(s));let n=r.subscriber.channels("psubscribe");n.length&&(ps("psubscribe %d channels",n.length),t.psubscribe(n));let i=r.subscriber.channels("ssubscribe");i.length&&(ps("ssubscribe %d channels",i.length),t.ssubscribe(i))}}if(t.prevCommandQueue)if(t.options.autoResendUnfulfilledCommands)for(ps("resend %d unfulfilled commands",t.prevCommandQueue.length);t.prevCommandQueue.length>0;){let r=t.prevCommandQueue.shift();r.select!==t.condition.select&&r.command.name!=="select"&&t.select(r.select),t.sendCommand(r.command,r.stream)}else t.prevCommandQueue=null;if(t.offlineQueue.length){ps("send %d commands in offline queue",t.offlineQueue.length);let r=t.offlineQueue;for(t.resetOfflineQueue();r.length>0;){let s=r.shift();s.select!==t.condition.select&&s.command.name!=="select"&&t.select(s.select),t.sendCommand(s.command,s.stream)}}t.condition.select!==e&&(ps("connect to db [%d]",e),t.select(e))}}Bn.readyHandler=QNe});var mQ=m(QS=>{"use strict";Object.defineProperty(QS,"__esModule",{value:!0});QS.DEFAULT_REDIS_OPTIONS=void 0;QS.DEFAULT_REDIS_OPTIONS={port:6379,host:"localhost",family:4,connectTimeout:1e4,disconnectTimeout:2e3,retryStrategy:function(t){return Math.min(t*50,2e3)},keepAlive:0,noDelay:!0,connectionName:null,sentinels:null,name:null,role:"master",sentinelRetryStrategy:function(t){return Math.min(t*10,1e3)},sentinelReconnectStrategy:function(){return 6e4},natMap:null,enableTLSForSentinelMode:!1,updateSentinels:!0,failoverDetector:!1,username:null,password:null,db:0,enableOfflineQueue:!0,enableReadyCheck:!0,autoResubscribe:!0,autoResendUnfulfilledCommands:!0,lazyConnect:!1,keyPrefix:"",reconnectOnError:null,readOnly:!1,stringNumbers:!1,maxRetriesPerRequest:20,maxLoadingRetryTime:1e4,enableAutoPipelining:!1,autoPipeliningIgnoredCommands:[],sentinelMaxConnections:10}});var Tl=m(Ix=>{"use strict";Object.defineProperty(Ix,"__esModule",{value:!0});var gQ=Cf(),vQ=require("events"),kx=Sl(),WNe=ox(),xx=ya(),ZNe=YK(),YNe=HS(),Rl=pQ(),JNe=mQ(),XNe=DS(),eDe=Qk(),Cc=fs(),tDe=Zk(),rDe=$S(),Ol=PS(),yQ=BS(),Pl=(0,Cc.Debug)("redis"),zn=class extends rDe.default{constructor(e,r,s){if(super(),this.status="wait",this.isCluster=!1,this.reconnectTimeout=null,this.connectionEpoch=0,this.retryAttempts=0,this.manuallyClosing=!1,this._autoPipelines=new Map,this._runningAutoPipelines=new Set,this.parseOptions(e,r,s),vQ.EventEmitter.call(this),this.resetCommandQueue(),this.resetOfflineQueue(),this.options.Connector)this.connector=new this.options.Connector(this.options);else if(this.options.sentinels){let n=new YNe.default(this.options);n.emitter=this,this.connector=n}else this.connector=new ZNe.StandaloneConnector(this.options);this.options.scripts&&Object.entries(this.options.scripts).forEach(([n,i])=>{this.defineCommand(n,i)}),this.options.lazyConnect?this.setStatus("wait"):this.connect().catch(Ol.noop)}static createClient(...e){return new zn(...e)}get autoPipelineQueueSize(){let e=0;for(let r of this._autoPipelines.values())e+=r.length;return e}connect(e){let r=new Promise((s,n)=>{if(this.status==="connecting"||this.status==="connect"||this.status==="ready"){n(new Error("Redis is already connecting/connected"));return}this.connectionEpoch+=1,this.setStatus("connecting");let{options:i}=this;this.condition={select:i.db,auth:i.username?[i.username,i.password]:i.password,subscriber:!1};let o=this;(0,kx.default)(this.connector.connect(function(a,l){o.silentEmit(a,l)}),function(a,l){if(a){o.flushQueue(a),o.silentEmit("error",a),n(a),o.setStatus("end");return}let u=i.tls?"secureConnect":"connect";if("sentinels"in i&&i.sentinels&&!i.enableTLSForSentinelMode&&(u="connect"),o.stream=l,i.noDelay&&l.setNoDelay(!0),typeof i.keepAlive=="number"&&(l.connecting?l.once(u,()=>{l.setKeepAlive(!0,i.keepAlive)}):l.setKeepAlive(!0,i.keepAlive)),l.connecting){if(l.once(u,Rl.connectHandler(o)),i.connectTimeout){let f=!1;l.setTimeout(i.connectTimeout,function(){if(f)return;l.setTimeout(0),l.destroy();let h=new Error("connect ETIMEDOUT");h.errorno="ETIMEDOUT",h.code="ETIMEDOUT",h.syscall="connect",Rl.errorHandler(o)(h)}),l.once(u,function(){f=!0,l.setTimeout(0)})}}else if(l.destroyed){let f=o.connector.firstError;f&&process.nextTick(()=>{Rl.errorHandler(o)(f)}),process.nextTick(Rl.closeHandler(o))}else process.nextTick(Rl.connectHandler(o));l.destroyed||(l.once("error",Rl.errorHandler(o)),l.once("close",Rl.closeHandler(o)));let c=function(){o.removeListener("close",d),s()};var d=function(){o.removeListener("ready",c),n(new Error(Cc.CONNECTION_CLOSED_ERROR_MSG))};o.once("ready",c),o.once("close",d)})});return(0,kx.default)(r,e)}disconnect(e=!1){e||(this.manuallyClosing=!0),this.reconnectTimeout&&!e&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null),this.status==="wait"?Rl.closeHandler(this)():this.connector.disconnect()}end(){this.disconnect()}duplicate(e){return new zn({...this.options,...e})}get mode(){var e;return this.options.monitor?"monitor":!((e=this.condition)===null||e===void 0)&&e.subscriber?"subscriber":"normal"}monitor(e){let r=this.duplicate({monitor:!0,lazyConnect:!1});return(0,kx.default)(new Promise(function(s,n){r.once("error",n),r.once("monitoring",function(){s(r)})}),e)}sendCommand(e,r){var s,n;if(this.status==="wait"&&this.connect().catch(Ol.noop),this.status==="end")return e.reject(new Error(Cc.CONNECTION_CLOSED_ERROR_MSG)),e.promise;if(!((s=this.condition)===null||s===void 0)&&s.subscriber&&!xx.default.checkFlag("VALID_IN_SUBSCRIBER_MODE",e.name))return e.reject(new Error("Connection in subscriber mode, only subscriber commands may be used")),e.promise;typeof this.options.commandTimeout=="number"&&e.setTimeout(this.options.commandTimeout);let i=this.status==="ready"||!r&&this.status==="connect"&&(0,gQ.exists)(e.name)&&(0,gQ.hasFlag)(e.name,"loading");if(this.stream&&this.stream.writable?this.stream._writableState&&this.stream._writableState.ended&&(i=!1):i=!1,i)Pl.enabled&&Pl("write command[%s]: %d -> %s(%o)",this._getDescription(),(n=this.condition)===null||n===void 0?void 0:n.select,e.name,e.args),r?"isPipeline"in r&&r.isPipeline?r.write(e.toWritable(r.destination.redis.stream)):r.write(e.toWritable(r)):this.stream.write(e.toWritable(this.stream)),this.commandQueue.push({command:e,stream:r,select:this.condition.select}),xx.default.checkFlag("WILL_DISCONNECT",e.name)&&(this.manuallyClosing=!0),this.options.socketTimeout!==void 0&&this.socketTimeoutTimer===void 0&&this.setSocketTimeout();else{if(!this.options.enableOfflineQueue)return e.reject(new Error("Stream isn't writeable and enableOfflineQueue options is false")),e.promise;if(e.name==="quit"&&this.offlineQueue.length===0)return this.disconnect(),e.resolve(Buffer.from("OK")),e.promise;Pl.enabled&&Pl("queue command[%s]: %d -> %s(%o)",this._getDescription(),this.condition.select,e.name,e.args),this.offlineQueue.push({command:e,stream:r,select:this.condition.select})}if(e.name==="select"&&(0,Cc.isInt)(e.args[0])){let o=parseInt(e.args[0],10);this.condition.select!==o&&(this.condition.select=o,this.emit("select",o),Pl("switch to db [%d]",this.condition.select))}return e.promise}setSocketTimeout(){this.socketTimeoutTimer=setTimeout(()=>{this.stream.destroy(new Error(`Socket timeout. Expecting data, but didn't receive any in ${this.options.socketTimeout}ms.`)),this.socketTimeoutTimer=void 0},this.options.socketTimeout),this.stream.once("data",()=>{clearTimeout(this.socketTimeoutTimer),this.socketTimeoutTimer=void 0,this.commandQueue.length!==0&&this.setSocketTimeout()})}scanStream(e){return this.createScanStream("scan",{options:e})}scanBufferStream(e){return this.createScanStream("scanBuffer",{options:e})}sscanStream(e,r){return this.createScanStream("sscan",{key:e,options:r})}sscanBufferStream(e,r){return this.createScanStream("sscanBuffer",{key:e,options:r})}hscanStream(e,r){return this.createScanStream("hscan",{key:e,options:r})}hscanBufferStream(e,r){return this.createScanStream("hscanBuffer",{key:e,options:r})}zscanStream(e,r){return this.createScanStream("zscan",{key:e,options:r})}zscanBufferStream(e,r){return this.createScanStream("zscanBuffer",{key:e,options:r})}silentEmit(e,r){let s;if(!(e==="error"&&(s=r,this.status==="end"||this.manuallyClosing&&s instanceof Error&&(s.message===Cc.CONNECTION_CLOSED_ERROR_MSG||s.syscall==="connect"||s.syscall==="read"))))return this.listeners(e).length>0?this.emit.apply(this,arguments):(s&&s instanceof Error&&console.error("[ioredis] Unhandled error event:",s.stack),!1)}recoverFromFatalError(e,r,s){this.flushQueue(r,s),this.silentEmit("error",r),this.disconnect(!0)}handleReconnection(e,r){var s;let n=!1;switch(this.options.reconnectOnError&&(n=this.options.reconnectOnError(e)),n){case 1:case!0:this.status!=="reconnecting"&&this.disconnect(!0),r.command.reject(e);break;case 2:this.status!=="reconnecting"&&this.disconnect(!0),((s=this.condition)===null||s===void 0?void 0:s.select)!==r.select&&r.command.name!=="select"&&this.select(r.select),this.sendCommand(r.command);break;default:r.command.reject(e)}}_getDescription(){let e;return"path"in this.options&&this.options.path?e=this.options.path:this.stream&&this.stream.remoteAddress&&this.stream.remotePort?e=this.stream.remoteAddress+":"+this.stream.remotePort:"host"in this.options&&this.options.host?e=this.options.host+":"+this.options.port:e="",this.options.connectionName&&(e+=` (${this.options.connectionName})`),e}resetCommandQueue(){this.commandQueue=new yQ}resetOfflineQueue(){this.offlineQueue=new yQ}parseOptions(...e){let r={},s=!1;for(let n=0;n<e.length;++n){let i=e[n];if(!(i===null||typeof i>"u"))if(typeof i=="object")(0,Ol.defaults)(r,i);else if(typeof i=="string")(0,Ol.defaults)(r,(0,Cc.parseURL)(i)),i.startsWith("rediss://")&&(s=!0);else if(typeof i=="number")r.port=i;else throw new Error("Invalid argument "+i)}s&&(0,Ol.defaults)(r,{tls:!0}),(0,Ol.defaults)(r,zn.defaultOptions),typeof r.port=="string"&&(r.port=parseInt(r.port,10)),typeof r.db=="string"&&(r.db=parseInt(r.db,10)),this.options=(0,Cc.resolveTLSProfile)(r)}setStatus(e,r){Pl.enabled&&Pl("status[%s]: %s -> %s",this._getDescription(),this.status||"[empty]",e),this.status=e,process.nextTick(this.emit.bind(this,e,r))}createScanStream(e,{key:r,options:s={}}){return new XNe.default({objectMode:!0,key:r,redis:this,command:e,...s})}flushQueue(e,r){r=(0,Ol.defaults)({},r,{offlineQueue:!0,commandQueue:!0});let s;if(r.offlineQueue)for(;s=this.offlineQueue.shift();)s.command.reject(e);if(r.commandQueue&&this.commandQueue.length>0)for(this.stream&&this.stream.removeAllListeners("data");s=this.commandQueue.shift();)s.command.reject(e)}_readyCheck(e){let r=this;this.info(function(s,n){if(s)return s.message&&s.message.includes("NOPERM")?(console.warn(`Skipping the ready check because INFO command fails: "${s.message}". You can disable ready check with "enableReadyCheck". More: https://github.com/luin/ioredis/wiki/Disable-ready-check.`),e(null,{})):e(s);if(typeof n!="string")return e(null,n);let i={},o=n.split(`\r
`);for(let a=0;a<o.length;++a){let[l,...u]=o[a].split(":"),c=u.join(":");c&&(i[l]=c)}if(!i.loading||i.loading==="0")e(null,i);else{let a=(i.loading_eta_seconds||1)*1e3,l=r.options.maxLoadingRetryTime&&r.options.maxLoadingRetryTime<a?r.options.maxLoadingRetryTime:a;Pl("Redis server still loading, trying again in "+l+"ms"),setTimeout(function(){r._readyCheck(e)},l)}}).catch(Ol.noop)}};zn.Cluster=WNe.default;zn.Command=xx.default;zn.defaultOptions=JNe.DEFAULT_REDIS_OPTIONS;(0,tDe.default)(zn,vQ.EventEmitter);(0,eDe.addTransactionSupport)(zn.prototype);Ix.default=zn});var bQ=m((Dt,SQ)=>{"use strict";Object.defineProperty(Dt,"__esModule",{value:!0});Dt.print=Dt.ReplyError=Dt.SentinelIterator=Dt.SentinelConnector=Dt.AbstractConnector=Dt.Pipeline=Dt.ScanStream=Dt.Command=Dt.Cluster=Dt.Redis=Dt.default=void 0;Dt=SQ.exports=Tl().default;var sDe=Tl();Object.defineProperty(Dt,"default",{enumerable:!0,get:function(){return sDe.default}});var nDe=Tl();Object.defineProperty(Dt,"Redis",{enumerable:!0,get:function(){return nDe.default}});var iDe=ox();Object.defineProperty(Dt,"Cluster",{enumerable:!0,get:function(){return iDe.default}});var oDe=ya();Object.defineProperty(Dt,"Command",{enumerable:!0,get:function(){return oDe.default}});var aDe=DS();Object.defineProperty(Dt,"ScanStream",{enumerable:!0,get:function(){return aDe.default}});var lDe=Hk();Object.defineProperty(Dt,"Pipeline",{enumerable:!0,get:function(){return lDe.default}});var uDe=US();Object.defineProperty(Dt,"AbstractConnector",{enumerable:!0,get:function(){return uDe.default}});var _Q=HS();Object.defineProperty(Dt,"SentinelConnector",{enumerable:!0,get:function(){return _Q.default}});Object.defineProperty(Dt,"SentinelIterator",{enumerable:!0,get:function(){return _Q.SentinelIterator}});Dt.ReplyError=bc().ReplyError;Object.defineProperty(Dt,"Promise",{get(){return console.warn("ioredis v5 does not support plugging third-party Promise library anymore. Native Promise will be used."),Promise},set(t){console.warn("ioredis v5 does not support plugging third-party Promise library anymore. Native Promise will be used.")}});function cDe(t,e){console.log(t?"Error: "+t:"Reply: "+e)}Dt.print=cDe});var Nx=m(CQ=>{"use strict";CQ.parse=function(t,e){return new ug(t,e).parse()};var ug=class{constructor(e,r){this.source=e,this.transform=r||fDe,this.position=0,this.entries=[],this.recorded=[],this.dimension=0}isEof(){return this.position>=this.source.length}nextCharacter(){var e=this.source[this.position++];return e==="\\"?{value:this.source[this.position++],escaped:!0}:{value:e,escaped:!1}}record(e){this.recorded.push(e)}newEntry(e){var r;(this.recorded.length>0||e)&&(r=this.recorded.join(""),r==="NULL"&&!e&&(r=null),r!==null&&(r=this.transform(r)),this.entries.push(r),this.recorded=[])}consumeDimensions(){if(this.source[0]==="[")for(;!this.isEof();){var e=this.nextCharacter();if(e.value==="=")break}}parse(e){var r,s,n;for(this.consumeDimensions();!this.isEof();)if(r=this.nextCharacter(),r.value==="{"&&!n)this.dimension++,this.dimension>1&&(s=new ug(this.source.substr(this.position-1),this.transform),this.entries.push(s.parse(!0)),this.position+=s.position-2);else if(r.value==="}"&&!n){if(this.dimension--,!this.dimension&&(this.newEntry(),e))return this.entries}else r.value==='"'&&!r.escaped?(n&&this.newEntry(!0),n=!n):r.value===","&&!n?this.newEntry():this.record(r.value);if(this.dimension!==0)throw new Error("array dimension not balanced");return this.entries}};function fDe(t){return t}});var Dx=m((CQe,RQ)=>{var hDe=Nx();RQ.exports={create:function(t,e){return{parse:function(){return hDe.parse(t,e)}}}}});var AQ=m((RQe,PQ)=>{"use strict";var pDe=/(\d{1,})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(\.\d{1,})?.*?( BC)?$/,mDe=/^(\d{1,})-(\d{2})-(\d{2})( BC)?$/,gDe=/([Z+-])(\d{2})?:?(\d{2})?:?(\d{2})?/,yDe=/^-?infinity$/;PQ.exports=function(e){if(yDe.test(e))return Number(e.replace("i","I"));var r=pDe.exec(e);if(!r)return vDe(e)||null;var s=!!r[8],n=parseInt(r[1],10);s&&(n=OQ(n));var i=parseInt(r[2],10)-1,o=r[3],a=parseInt(r[4],10),l=parseInt(r[5],10),u=parseInt(r[6],10),c=r[7];c=c?1e3*parseFloat(c):0;var d,f=_De(e);return f!=null?(d=new Date(Date.UTC(n,i,o,a,l,u,c)),Mx(n)&&d.setUTCFullYear(n),f!==0&&d.setTime(d.getTime()-f)):(d=new Date(n,i,o,a,l,u,c),Mx(n)&&d.setFullYear(n)),d};function vDe(t){var e=mDe.exec(t);if(e){var r=parseInt(e[1],10),s=!!e[4];s&&(r=OQ(r));var n=parseInt(e[2],10)-1,i=e[3],o=new Date(r,n,i);return Mx(r)&&o.setFullYear(r),o}}function _De(t){if(t.endsWith("+00"))return 0;var e=gDe.exec(t.split(" ")[1]);if(e){var r=e[1];if(r==="Z")return 0;var s=r==="-"?-1:1,n=parseInt(e[2],10)*3600+parseInt(e[3]||0,10)*60+parseInt(e[4]||0,10);return n*s*1e3}}function OQ(t){return-(t-1)}function Mx(t){return t>=0&&t<100}});var xQ=m((OQe,kQ)=>{kQ.exports=bDe;var SDe=Object.prototype.hasOwnProperty;function bDe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var s in r)SDe.call(r,s)&&(t[s]=r[s])}return t}});var DQ=m((PQe,NQ)=>{"use strict";var EDe=xQ();NQ.exports=$f;function $f(t){if(!(this instanceof $f))return new $f(t);EDe(this,DDe(t))}var wDe=["seconds","minutes","hours","days","months","years"];$f.prototype.toPostgres=function(){var t=wDe.filter(this.hasOwnProperty,this);return this.milliseconds&&t.indexOf("seconds")<0&&t.push("seconds"),t.length===0?"0":t.map(function(e){var r=this[e]||0;return e==="seconds"&&this.milliseconds&&(r=(r+this.milliseconds/1e3).toFixed(6).replace(/\.?0+$/,"")),r+" "+e},this).join(" ")};var TDe={years:"Y",months:"M",days:"D",hours:"H",minutes:"M",seconds:"S"},CDe=["years","months","days"],RDe=["hours","minutes","seconds"];$f.prototype.toISOString=$f.prototype.toISO=function(){var t=CDe.map(r,this).join(""),e=RDe.map(r,this).join("");return"P"+t+"T"+e;function r(s){var n=this[s]||0;return s==="seconds"&&this.milliseconds&&(n=(n+this.milliseconds/1e3).toFixed(6).replace(/0+$/,"")),n+TDe[s]}};var $x="([+-]?\\d+)",ODe=$x+"\\s+years?",PDe=$x+"\\s+mons?",ADe=$x+"\\s+days?",kDe="([+-])?([\\d]*):(\\d\\d):(\\d\\d)\\.?(\\d{1,6})?",xDe=new RegExp([ODe,PDe,ADe,kDe].map(function(t){return"("+t+")?"}).join("\\s*")),IQ={years:2,months:4,days:6,hours:9,minutes:10,seconds:11,milliseconds:12},IDe=["hours","minutes","seconds","milliseconds"];function NDe(t){var e=t+"000000".slice(t.length);return parseInt(e,10)/1e3}function DDe(t){if(!t)return{};var e=xDe.exec(t),r=e[8]==="-";return Object.keys(IQ).reduce(function(s,n){var i=IQ[n],o=e[i];return!o||(o=n==="milliseconds"?NDe(o):parseInt(o,10),!o)||(r&&~IDe.indexOf(n)&&(o*=-1),s[n]=o),s},{})}});var $Q=m((AQe,MQ)=>{"use strict";MQ.exports=function(e){if(/^\\x/.test(e))return new Buffer(e.substr(2),"hex");for(var r="",s=0;s<e.length;)if(e[s]!=="\\")r+=e[s],++s;else if(/[0-7]{3}/.test(e.substr(s+1,3)))r+=String.fromCharCode(parseInt(e.substr(s+1,3),8)),s+=4;else{for(var n=1;s+n<e.length&&e[s+n]==="\\";)n++;for(var i=0;i<Math.floor(n/2);++i)r+="\\";s+=Math.floor(n/2)*2}return new Buffer(r,"binary")}});var UQ=m((kQe,zQ)=>{var cg=Nx(),dg=Dx(),WS=AQ(),LQ=DQ(),jQ=$Q();function ZS(t){return function(r){return r===null?r:t(r)}}function FQ(t){return t===null?t:t==="TRUE"||t==="t"||t==="true"||t==="y"||t==="yes"||t==="on"||t==="1"}function MDe(t){return t?cg.parse(t,FQ):null}function $De(t){return parseInt(t,10)}function qx(t){return t?cg.parse(t,ZS($De)):null}function qDe(t){return t?cg.parse(t,ZS(function(e){return BQ(e).trim()})):null}var LDe=function(t){if(!t)return null;var e=dg.create(t,function(r){return r!==null&&(r=Bx(r)),r});return e.parse()},Lx=function(t){if(!t)return null;var e=dg.create(t,function(r){return r!==null&&(r=parseFloat(r)),r});return e.parse()},Un=function(t){if(!t)return null;var e=dg.create(t);return e.parse()},jx=function(t){if(!t)return null;var e=dg.create(t,function(r){return r!==null&&(r=WS(r)),r});return e.parse()},jDe=function(t){if(!t)return null;var e=dg.create(t,function(r){return r!==null&&(r=LQ(r)),r});return e.parse()},FDe=function(t){return t?cg.parse(t,ZS(jQ)):null},Fx=function(t){return parseInt(t,10)},BQ=function(t){var e=String(t);return/^\d+$/.test(e)?e:t},qQ=function(t){return t?cg.parse(t,ZS(JSON.parse)):null},Bx=function(t){return t[0]!=="("?null:(t=t.substring(1,t.length-1).split(","),{x:parseFloat(t[0]),y:parseFloat(t[1])})},BDe=function(t){if(t[0]!=="<"&&t[1]!=="(")return null;for(var e="(",r="",s=!1,n=2;n<t.length-1;n++){if(s||(e+=t[n]),t[n]===")"){s=!0;continue}else if(!s)continue;t[n]!==","&&(r+=t[n])}var i=Bx(e);return i.radius=parseFloat(r),i},zDe=function(t){t(20,BQ),t(21,Fx),t(23,Fx),t(26,Fx),t(700,parseFloat),t(701,parseFloat),t(16,FQ),t(1082,WS),t(1114,WS),t(1184,WS),t(600,Bx),t(651,Un),t(718,BDe),t(1e3,MDe),t(1001,FDe),t(1005,qx),t(1007,qx),t(1028,qx),t(1016,qDe),t(1017,LDe),t(1021,Lx),t(1022,Lx),t(1231,Lx),t(1014,Un),t(1015,Un),t(1008,Un),t(1009,Un),t(1040,Un),t(1041,Un),t(1115,jx),t(1182,jx),t(1185,jx),t(1186,LQ),t(1187,jDe),t(17,jQ),t(114,JSON.parse.bind(JSON)),t(3802,JSON.parse.bind(JSON)),t(199,qQ),t(3807,qQ),t(3907,Un),t(2951,Un),t(791,Un),t(1183,Un),t(1270,Un)};zQ.exports={init:zDe}});var HQ=m((xQe,VQ)=>{"use strict";var Bs=1e6;function UDe(t){var e=t.readInt32BE(0),r=t.readUInt32BE(4),s="";e<0&&(e=~e+(r===0),r=~r+1>>>0,s="-");var n="",i,o,a,l,u,c;{if(i=e%Bs,e=e/Bs>>>0,o=4294967296*i+r,r=o/Bs>>>0,a=""+(o-Bs*r),r===0&&e===0)return s+a+n;for(l="",u=6-a.length,c=0;c<u;c++)l+="0";n=l+a+n}{if(i=e%Bs,e=e/Bs>>>0,o=4294967296*i+r,r=o/Bs>>>0,a=""+(o-Bs*r),r===0&&e===0)return s+a+n;for(l="",u=6-a.length,c=0;c<u;c++)l+="0";n=l+a+n}{if(i=e%Bs,e=e/Bs>>>0,o=4294967296*i+r,r=o/Bs>>>0,a=""+(o-Bs*r),r===0&&e===0)return s+a+n;for(l="",u=6-a.length,c=0;c<u;c++)l+="0";n=l+a+n}return i=e%Bs,o=4294967296*i+r,a=""+o%Bs,s+a+n}VQ.exports=UDe});var ZQ=m((IQe,WQ)=>{var VDe=HQ(),Zt=function(t,e,r,s,n){r=r||0,s=s||!1,n=n||function(h,p,g){return h*Math.pow(2,g)+p};var i=r>>3,o=function(h){return s?~h&255:h},a=255,l=8-r%8;e<l&&(a=255<<8-e&255,l=e),r&&(a=a>>r%8);var u=0;r%8+e>=8&&(u=n(0,o(t[i])&a,l));for(var c=e+r>>3,d=i+1;d<c;d++)u=n(u,o(t[d]),8);var f=(e+r)%8;return f>0&&(u=n(u,o(t[c])>>8-f,f)),u},QQ=function(t,e,r){var s=Math.pow(2,r-1)-1,n=Zt(t,1),i=Zt(t,r,1);if(i===0)return 0;var o=1,a=function(u,c,d){u===0&&(u=1);for(var f=1;f<=d;f++)o/=2,(c&1<<d-f)>0&&(u+=o);return u},l=Zt(t,e,r+1,!1,a);return i==Math.pow(2,r+1)-1?l===0?n===0?1/0:-1/0:NaN:(n===0?1:-1)*Math.pow(2,i-s)*l},HDe=function(t){return Zt(t,1)==1?-1*(Zt(t,15,1,!0)+1):Zt(t,15,1)},GQ=function(t){return Zt(t,1)==1?-1*(Zt(t,31,1,!0)+1):Zt(t,31,1)},GDe=function(t){return QQ(t,23,8)},KDe=function(t){return QQ(t,52,11)},QDe=function(t){var e=Zt(t,16,32);if(e==49152)return NaN;for(var r=Math.pow(1e4,Zt(t,16,16)),s=0,n=[],i=Zt(t,16),o=0;o<i;o++)s+=Zt(t,16,64+16*o)*r,r/=1e4;var a=Math.pow(10,Zt(t,16,48));return(e===0?1:-1)*Math.round(s*a)/a},KQ=function(t,e){var r=Zt(e,1),s=Zt(e,63,1),n=new Date((r===0?1:-1)*s/1e3+9466848e5);return t||n.setTime(n.getTime()+n.getTimezoneOffset()*6e4),n.usec=s%1e3,n.getMicroSeconds=function(){return this.usec},n.setMicroSeconds=function(i){this.usec=i},n.getUTCMicroSeconds=function(){return this.usec},n},fg=function(t){for(var e=Zt(t,32),r=Zt(t,32,32),s=Zt(t,32,64),n=96,i=[],o=0;o<e;o++)i[o]=Zt(t,32,n),n+=32,n+=32;var a=function(u){var c=Zt(t,32,n);if(n+=32,c==4294967295)return null;var d;if(u==23||u==20)return d=Zt(t,c*8,n),n+=c*8,d;if(u==25)return d=t.toString(this.encoding,n>>3,(n+=c<<3)>>3),d;console.log("ERROR: ElementType not implemented: "+u)},l=function(u,c){var d=[],f;if(u.length>1){var h=u.shift();for(f=0;f<h;f++)d[f]=l(u,c);u.unshift(h)}else for(f=0;f<u[0];f++)d[f]=a(c);return d};return l(i,s)},WDe=function(t){return t.toString("utf8")},ZDe=function(t){return t===null?null:Zt(t,8)>0},YDe=function(t){t(20,VDe),t(21,HDe),t(23,GQ),t(26,GQ),t(1700,QDe),t(700,GDe),t(701,KDe),t(16,ZDe),t(1114,KQ.bind(null,!1)),t(1184,KQ.bind(null,!0)),t(1e3,fg),t(1007,fg),t(1016,fg),t(1008,fg),t(1009,fg),t(25,WDe)};WQ.exports={init:YDe}});var JQ=m((NQe,YQ)=>{YQ.exports={BOOL:16,BYTEA:17,CHAR:18,INT8:20,INT2:21,INT4:23,REGPROC:24,TEXT:25,OID:26,TID:27,XID:28,CID:29,JSON:114,XML:142,PG_NODE_TREE:194,SMGR:210,PATH:602,POLYGON:604,CIDR:650,FLOAT4:700,FLOAT8:701,ABSTIME:702,RELTIME:703,TINTERVAL:704,CIRCLE:718,MACADDR8:774,MONEY:790,MACADDR:829,INET:869,ACLITEM:1033,BPCHAR:1042,VARCHAR:1043,DATE:1082,TIME:1083,TIMESTAMP:1114,TIMESTAMPTZ:1184,INTERVAL:1186,TIMETZ:1266,BIT:1560,VARBIT:1562,NUMERIC:1700,REFCURSOR:1790,REGPROCEDURE:2202,REGOPER:2203,REGOPERATOR:2204,REGCLASS:2205,REGTYPE:2206,UUID:2950,TXID_SNAPSHOT:2970,PG_LSN:3220,PG_NDISTINCT:3361,PG_DEPENDENCIES:3402,TSVECTOR:3614,TSQUERY:3615,GTSVECTOR:3642,REGCONFIG:3734,REGDICTIONARY:3769,JSONB:3802,REGNAMESPACE:4089,REGROLE:4096}});var mg=m(pg=>{var JDe=UQ(),XDe=ZQ(),eMe=Dx(),tMe=JQ();pg.getTypeParser=rMe;pg.setTypeParser=sMe;pg.arrayParser=eMe;pg.builtins=tMe;var hg={text:{},binary:{}};function XQ(t){return String(t)}function rMe(t,e){return e=e||"text",hg[e]&&hg[e][t]||XQ}function sMe(t,e,r){typeof e=="function"&&(r=e,e="text"),hg[e][t]=r}JDe.init(function(t,e){hg.text[t]=e});XDe.init(function(t,e){hg.binary[t]=e})});var gg=m((MQe,zx)=>{"use strict";zx.exports={host:"localhost",user:process.platform==="win32"?process.env.USERNAME:process.env.USER,database:void 0,password:null,connectionString:void 0,port:5432,rows:0,binary:!1,max:10,idleTimeoutMillis:3e4,client_encoding:"",ssl:!1,application_name:void 0,fallback_application_name:void 0,options:void 0,parseInputDatesAsUTC:!1,statement_timeout:!1,lock_timeout:!1,idle_in_transaction_session_timeout:!1,query_timeout:!1,connect_timeout:0,keepalives:1,keepalives_idle:0};var qf=mg(),nMe=qf.getTypeParser(20,"text"),iMe=qf.getTypeParser(1016,"text");zx.exports.__defineSetter__("parseInt8",function(t){qf.setTypeParser(20,"text",t?qf.getTypeParser(23,"text"):nMe),qf.setTypeParser(1016,"text",t?qf.getTypeParser(1007,"text"):iMe)})});var yg=m(($Qe,tW)=>{"use strict";var oMe=gg();function aMe(t){var e=t.replace(/\\/g,"\\\\").replace(/"/g,'\\"');return'"'+e+'"'}function eW(t){for(var e="{",r=0;r<t.length;r++)if(r>0&&(e=e+","),t[r]===null||typeof t[r]>"u")e=e+"NULL";else if(Array.isArray(t[r]))e=e+eW(t[r]);else if(ArrayBuffer.isView(t[r])){var s=t[r];if(!(s instanceof Buffer)){var n=Buffer.from(s.buffer,s.byteOffset,s.byteLength);n.length===s.byteLength?s=n:s=n.slice(s.byteOffset,s.byteOffset+s.byteLength)}e+="\\\\x"+s.toString("hex")}else e+=aMe(YS(t[r]));return e=e+"}",e}var YS=function(t,e){if(t==null)return null;if(t instanceof Buffer)return t;if(ArrayBuffer.isView(t)){var r=Buffer.from(t.buffer,t.byteOffset,t.byteLength);return r.length===t.byteLength?r:r.slice(t.byteOffset,t.byteOffset+t.byteLength)}return t instanceof Date?oMe.parseInputDatesAsUTC?cMe(t):uMe(t):Array.isArray(t)?eW(t):typeof t=="object"?lMe(t,e):t.toString()};function lMe(t,e){if(t&&typeof t.toPostgres=="function"){if(e=e||[],e.indexOf(t)!==-1)throw new Error('circular reference detected while preparing "'+t+'" for query');return e.push(t),YS(t.toPostgres(YS),e)}return JSON.stringify(t)}function ms(t,e){for(t=""+t;t.length<e;)t="0"+t;return t}function uMe(t){var e=-t.getTimezoneOffset(),r=t.getFullYear(),s=r<1;s&&(r=Math.abs(r)+1);var n=ms(r,4)+"-"+ms(t.getMonth()+1,2)+"-"+ms(t.getDate(),2)+"T"+ms(t.getHours(),2)+":"+ms(t.getMinutes(),2)+":"+ms(t.getSeconds(),2)+"."+ms(t.getMilliseconds(),3);return e<0?(n+="-",e*=-1):n+="+",n+=ms(Math.floor(e/60),2)+":"+ms(e%60,2),s&&(n+=" BC"),n}function cMe(t){var e=t.getUTCFullYear(),r=e<1;r&&(e=Math.abs(e)+1);var s=ms(e,4)+"-"+ms(t.getUTCMonth()+1,2)+"-"+ms(t.getUTCDate(),2)+"T"+ms(t.getUTCHours(),2)+":"+ms(t.getUTCMinutes(),2)+":"+ms(t.getUTCSeconds(),2)+"."+ms(t.getUTCMilliseconds(),3);return s+="+00:00",r&&(s+=" BC"),s}function dMe(t,e,r){return t=typeof t=="string"?{text:t}:t,e&&(typeof e=="function"?t.callback=e:t.values=e),r&&(t.callback=r),t}var fMe=function(t){return'"'+t.replace(/"/g,'""')+'"'},hMe=function(t){for(var e=!1,r="'",s=0;s<t.length;s++){var n=t[s];n==="'"?r+=n+n:n==="\\"?(r+=n+n,e=!0):r+=n}return r+="'",e===!0&&(r=" E"+r),r};tW.exports={prepareValue:function(e){return YS(e)},normalizeQueryConfig:dMe,escapeIdentifier:fMe,escapeLiteral:hMe}});var sW=m((qQe,rW)=>{"use strict";var vg=require("crypto");function Ux(t){return vg.createHash("md5").update(t,"utf-8").digest("hex")}function pMe(t,e,r){var s=Ux(e+t),n=Ux(Buffer.concat([Buffer.from(s),r]));return"md5"+n}function mMe(t){return vg.createHash("sha256").update(t).digest()}function gMe(t,e){return vg.createHmac("sha256",t).update(e).digest()}async function yMe(t,e,r){return vg.pbkdf2Sync(t,e,r,32,"sha256")}rW.exports={postgresMd5PasswordHash:pMe,randomBytes:vg.randomBytes,deriveKey:yMe,sha256:mMe,hmacSha256:gMe,md5:Ux}});var aW=m((LQe,oW)=>{var nW=require("crypto");oW.exports={postgresMd5PasswordHash:_Me,randomBytes:vMe,deriveKey:EMe,sha256:SMe,hmacSha256:bMe,md5:Vx};var iW=nW.webcrypto||globalThis.crypto,Lf=iW.subtle,Hx=new TextEncoder;function vMe(t){return iW.getRandomValues(Buffer.alloc(t))}async function Vx(t){try{return nW.createHash("md5").update(t,"utf-8").digest("hex")}catch{let r=typeof t=="string"?Hx.encode(t):t,s=await Lf.digest("MD5",r);return Array.from(new Uint8Array(s)).map(n=>n.toString(16).padStart(2,"0")).join("")}}async function _Me(t,e,r){var s=await Vx(e+t),n=await Vx(Buffer.concat([Buffer.from(s),r]));return"md5"+n}async function SMe(t){return await Lf.digest("SHA-256",t)}async function bMe(t,e){let r=await Lf.importKey("raw",t,{name:"HMAC",hash:"SHA-256"},!1,["sign"]);return await Lf.sign("HMAC",r,Hx.encode(e))}async function EMe(t,e,r){let s=await Lf.importKey("raw",Hx.encode(t),"PBKDF2",!1,["deriveBits"]),n={name:"PBKDF2",hash:"SHA-256",salt:e,iterations:r};return await Lf.deriveBits(n,s,32*8,["deriveBits"])}});var Kx=m((jQe,Gx)=>{"use strict";var wMe=parseInt(process.versions&&process.versions.node&&process.versions.node.split(".")[0])<15;wMe?Gx.exports=sW():Gx.exports=aW()});var dW=m((FQe,cW)=>{"use strict";var Rc=Kx();function TMe(t){if(t.indexOf("SCRAM-SHA-256")===-1)throw new Error("SASL: Only mechanism SCRAM-SHA-256 is currently supported");let e=Rc.randomBytes(18).toString("base64");return{mechanism:"SCRAM-SHA-256",clientNonce:e,response:"n,,n=*,r="+e,message:"SASLInitialResponse"}}async function CMe(t,e,r){if(t.message!=="SASLInitialResponse")throw new Error("SASL: Last message was not SASLInitialResponse");if(typeof e!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string");if(e==="")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a non-empty string");if(typeof r!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: serverData must be a string");let s=PMe(r);if(s.nonce.startsWith(t.clientNonce)){if(s.nonce.length===t.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");var n="n=*,r="+t.clientNonce,i="r="+s.nonce+",s="+s.salt+",i="+s.iteration,o="c=biws,r="+s.nonce,a=n+","+i+","+o,l=Buffer.from(s.salt,"base64"),u=await Rc.deriveKey(e,l,s.iteration),c=await Rc.hmacSha256(u,"Client Key"),d=await Rc.sha256(c),f=await Rc.hmacSha256(d,a),h=kMe(Buffer.from(c),Buffer.from(f)).toString("base64"),p=await Rc.hmacSha256(u,"Server Key"),g=await Rc.hmacSha256(p,a);t.message="SASLResponse",t.serverSignature=Buffer.from(g).toString("base64"),t.response=o+",p="+h}function RMe(t,e){if(t.message!=="SASLResponse")throw new Error("SASL: Last message was not SASLResponse");if(typeof e!="string")throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: serverData must be a string");let{serverSignature:r}=AMe(e);if(r!==t.serverSignature)throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature does not match")}function OMe(t){if(typeof t!="string")throw new TypeError("SASL: text must be a string");return t.split("").map((e,r)=>t.charCodeAt(r)).every(e=>e>=33&&e<=43||e>=45&&e<=126)}function lW(t){return/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(t)}function uW(t){if(typeof t!="string")throw new TypeError("SASL: attribute pairs text must be a string");return new Map(t.split(",").map(e=>{if(!/^.=/.test(e))throw new Error("SASL: Invalid attribute pair entry");let r=e[0],s=e.substring(2);return[r,s]}))}function PMe(t){let e=uW(t),r=e.get("r");if(r){if(!OMe(r))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce must only contain printable characters")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing");let s=e.get("s");if(s){if(!lW(s))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt must be base64")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing");let n=e.get("i");if(n){if(!/^[1-9][0-9]*$/.test(n))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: invalid iteration count")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: iteration missing");let i=parseInt(n,10);return{nonce:r,salt:s,iteration:i}}function AMe(t){let r=uW(t).get("v");if(r){if(!lW(r))throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature must be base64")}else throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature is missing");return{serverSignature:r}}function kMe(t,e){if(!Buffer.isBuffer(t))throw new TypeError("first argument must be a Buffer");if(!Buffer.isBuffer(e))throw new TypeError("second argument must be a Buffer");if(t.length!==e.length)throw new Error("Buffer lengths must match");if(t.length===0)throw new Error("Buffers cannot be empty");return Buffer.from(t.map((r,s)=>t[s]^e[s]))}cW.exports={startSession:TMe,continueSession:CMe,finalizeSession:RMe}});var Qx=m((BQe,fW)=>{"use strict";var xMe=mg();function JS(t){this._types=t||xMe,this.text={},this.binary={}}JS.prototype.getOverrides=function(t){switch(t){case"text":return this.text;case"binary":return this.binary;default:return{}}};JS.prototype.setTypeParser=function(t,e,r){typeof e=="function"&&(r=e,e="text"),this.getOverrides(e)[t]=r};JS.prototype.getTypeParser=function(t,e){return e=e||"text",this.getOverrides(e)[t]||this._types.getTypeParser(t,e)};fW.exports=JS});var pW=m((zQe,hW)=>{"use strict";function Wx(t){if(t.charAt(0)==="/"){let a=t.split(" ");return{host:a[0],database:a[1]}}let e={},r,s=!1;/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(t)&&(t=encodeURI(t).replace(/\%25(\d\d)/g,"%$1"));try{r=new URL(t,"postgres://base")}catch{r=new URL(t.replace("@/","@___DUMMY___/"),"postgres://base"),s=!0}for(let a of r.searchParams.entries())e[a[0]]=a[1];if(e.user=e.user||decodeURIComponent(r.username),e.password=e.password||decodeURIComponent(r.password),r.protocol=="socket:")return e.host=decodeURI(r.pathname),e.database=r.searchParams.get("db"),e.client_encoding=r.searchParams.get("encoding"),e;let n=s?"":r.hostname;e.host?n&&/^%2f/i.test(n)&&(r.pathname=n+r.pathname):e.host=decodeURIComponent(n),e.port||(e.port=r.port);let i=r.pathname.slice(1)||null;e.database=i?decodeURI(i):null,(e.ssl==="true"||e.ssl==="1")&&(e.ssl=!0),e.ssl==="0"&&(e.ssl=!1),(e.sslcert||e.sslkey||e.sslrootcert||e.sslmode)&&(e.ssl={});let o=e.sslcert||e.sslkey||e.sslrootcert?require("fs"):null;switch(e.sslcert&&(e.ssl.cert=o.readFileSync(e.sslcert).toString()),e.sslkey&&(e.ssl.key=o.readFileSync(e.sslkey).toString()),e.sslrootcert&&(e.ssl.ca=o.readFileSync(e.sslrootcert).toString()),e.sslmode){case"disable":{e.ssl=!1;break}case"prefer":case"require":case"verify-ca":case"verify-full":break;case"no-verify":{e.ssl.rejectUnauthorized=!1;break}}return e}hW.exports=Wx;Wx.parse=Wx});var Yx=m((UQe,yW)=>{"use strict";var IMe=require("dns"),gW=gg(),mW=pW().parse,Os=function(t,e,r){return r===void 0?r=process.env["PG"+t.toUpperCase()]:r===!1||(r=process.env[r]),e[t]||r||gW[t]},NMe=function(){switch(process.env.PGSSLMODE){case"disable":return!1;case"prefer":case"require":case"verify-ca":case"verify-full":return!0;case"no-verify":return{rejectUnauthorized:!1}}return gW.ssl},jf=function(t){return"'"+(""+t).replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"},Vn=function(t,e,r){var s=e[r];s!=null&&t.push(r+"="+jf(s))},Zx=class{constructor(e){e=typeof e=="string"?mW(e):e||{},e.connectionString&&(e=Object.assign({},e,mW(e.connectionString))),this.user=Os("user",e),this.database=Os("database",e),this.database===void 0&&(this.database=this.user),this.port=parseInt(Os("port",e),10),this.host=Os("host",e),Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:Os("password",e)}),this.binary=Os("binary",e),this.options=Os("options",e),this.ssl=typeof e.ssl>"u"?NMe():e.ssl,typeof this.ssl=="string"&&this.ssl==="true"&&(this.ssl=!0),this.ssl==="no-verify"&&(this.ssl={rejectUnauthorized:!1}),this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this.client_encoding=Os("client_encoding",e),this.replication=Os("replication",e),this.isDomainSocket=!(this.host||"").indexOf("/"),this.application_name=Os("application_name",e,"PGAPPNAME"),this.fallback_application_name=Os("fallback_application_name",e,!1),this.statement_timeout=Os("statement_timeout",e,!1),this.lock_timeout=Os("lock_timeout",e,!1),this.idle_in_transaction_session_timeout=Os("idle_in_transaction_session_timeout",e,!1),this.query_timeout=Os("query_timeout",e,!1),e.connectionTimeoutMillis===void 0?this.connect_timeout=process.env.PGCONNECT_TIMEOUT||0:this.connect_timeout=Math.floor(e.connectionTimeoutMillis/1e3),e.keepAlive===!1?this.keepalives=0:e.keepAlive===!0&&(this.keepalives=1),typeof e.keepAliveInitialDelayMillis=="number"&&(this.keepalives_idle=Math.floor(e.keepAliveInitialDelayMillis/1e3))}getLibpqConnectionString(e){var r=[];Vn(r,this,"user"),Vn(r,this,"password"),Vn(r,this,"port"),Vn(r,this,"application_name"),Vn(r,this,"fallback_application_name"),Vn(r,this,"connect_timeout"),Vn(r,this,"options");var s=typeof this.ssl=="object"?this.ssl:this.ssl?{sslmode:this.ssl}:{};if(Vn(r,s,"sslmode"),Vn(r,s,"sslca"),Vn(r,s,"sslkey"),Vn(r,s,"sslcert"),Vn(r,s,"sslrootcert"),this.database&&r.push("dbname="+jf(this.database)),this.replication&&r.push("replication="+jf(this.replication)),this.host&&r.push("host="+jf(this.host)),this.isDomainSocket)return e(null,r.join(" "));this.client_encoding&&r.push("client_encoding="+jf(this.client_encoding)),IMe.lookup(this.host,function(n,i){return n?e(n,null):(r.push("hostaddr="+jf(i)),e(null,r.join(" ")))})}};yW.exports=Zx});var SW=m((VQe,_W)=>{"use strict";var DMe=mg(),vW=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/,Jx=class{constructor(e,r){this.command=null,this.rowCount=null,this.oid=null,this.rows=[],this.fields=[],this._parsers=void 0,this._types=r,this.RowCtor=null,this.rowAsArray=e==="array",this.rowAsArray&&(this.parseRow=this._parseRowAsArray),this._prebuiltEmptyResultObject=null}addCommandComplete(e){var r;e.text?r=vW.exec(e.text):r=vW.exec(e.command),r&&(this.command=r[1],r[3]?(this.oid=parseInt(r[2],10),this.rowCount=parseInt(r[3],10)):r[2]&&(this.rowCount=parseInt(r[2],10)))}_parseRowAsArray(e){for(var r=new Array(e.length),s=0,n=e.length;s<n;s++){var i=e[s];i!==null?r[s]=this._parsers[s](i):r[s]=null}return r}parseRow(e){for(var r={...this._prebuiltEmptyResultObject},s=0,n=e.length;s<n;s++){var i=e[s],o=this.fields[s].name;i!==null?r[o]=this._parsers[s](i):r[o]=null}return r}addRow(e){this.rows.push(e)}addFields(e){this.fields=e,this.fields.length&&(this._parsers=new Array(e.length));for(var r={},s=0;s<e.length;s++){var n=e[s];r[n.name]=null,this._types?this._parsers[s]=this._types.getTypeParser(n.dataTypeID,n.format||"text"):this._parsers[s]=DMe.getTypeParser(n.dataTypeID,n.format||"text")}this._prebuiltEmptyResultObject={...r}}};_W.exports=Jx});var TW=m((HQe,wW)=>{"use strict";var{EventEmitter:MMe}=require("events"),bW=SW(),EW=yg(),Xx=class extends MMe{constructor(e,r,s){super(),e=EW.normalizeQueryConfig(e,r,s),this.text=e.text,this.values=e.values,this.rows=e.rows,this.types=e.types,this.name=e.name,this.queryMode=e.queryMode,this.binary=e.binary,this.portal=e.portal||"",this.callback=e.callback,this._rowMode=e.rowMode,process.domain&&e.callback&&(this.callback=process.domain.bind(e.callback)),this._result=new bW(this._rowMode,this.types),this._results=this._result,this._canceledDueToError=!1}requiresPreparation(){return this.queryMode==="extended"||this.name||this.rows?!0:!this.text||!this.values?!1:this.values.length>0}_checkForMultirow(){this._result.command&&(Array.isArray(this._results)||(this._results=[this._result]),this._result=new bW(this._rowMode,this.types),this._results.push(this._result))}handleRowDescription(e){this._checkForMultirow(),this._result.addFields(e.fields),this._accumulateRows=this.callback||!this.listeners("row").length}handleDataRow(e){let r;if(!this._canceledDueToError){try{r=this._result.parseRow(e.fields)}catch(s){this._canceledDueToError=s;return}this.emit("row",r,this._result),this._accumulateRows&&this._result.addRow(r)}}handleCommandComplete(e,r){this._checkForMultirow(),this._result.addCommandComplete(e),this.rows&&r.sync()}handleEmptyQuery(e){this.rows&&e.sync()}handleError(e,r){if(this._canceledDueToError&&(e=this._canceledDueToError,this._canceledDueToError=!1),this.callback)return this.callback(e);this.emit("error",e)}handleReadyForQuery(e){if(this._canceledDueToError)return this.handleError(this._canceledDueToError,e);if(this.callback)try{this.callback(null,this._results)}catch(r){process.nextTick(()=>{throw r})}this.emit("end",this._results)}submit(e){if(typeof this.text!="string"&&typeof this.name!="string")return new Error("A query must have either text or a name. Supplying neither is unsupported.");let r=e.parsedStatements[this.name];return this.text&&r&&this.text!==r?new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`):this.values&&!Array.isArray(this.values)?new Error("Query values must be an array"):(this.requiresPreparation()?this.prepare(e):e.query(this.text),null)}hasBeenParsed(e){return this.name&&e.parsedStatements[this.name]}handlePortalSuspended(e){this._getRows(e,this.rows)}_getRows(e,r){e.execute({portal:this.portal,rows:r}),r?e.flush():e.sync()}prepare(e){this.hasBeenParsed(e)||e.parse({text:this.text,name:this.name,types:this.types});try{e.bind({portal:this.portal,statement:this.name,values:this.values,binary:this.binary,valueMapper:EW.prepareValue})}catch(r){this.handleError(r,e);return}e.describe({type:"P",name:this.portal||""}),this._getRows(e,this.rows)}handleCopyInResponse(e){e.sendCopyFail("No source stream defined")}handleCopyData(e,r){}};wW.exports=Xx});var pI=m(Ne=>{"use strict";Object.defineProperty(Ne,"__esModule",{value:!0});Ne.NoticeMessage=Ne.DataRowMessage=Ne.CommandCompleteMessage=Ne.ReadyForQueryMessage=Ne.NotificationResponseMessage=Ne.BackendKeyDataMessage=Ne.AuthenticationMD5Password=Ne.ParameterStatusMessage=Ne.ParameterDescriptionMessage=Ne.RowDescriptionMessage=Ne.Field=Ne.CopyResponse=Ne.CopyDataMessage=Ne.DatabaseError=Ne.copyDone=Ne.emptyQuery=Ne.replicationStart=Ne.portalSuspended=Ne.noData=Ne.closeComplete=Ne.bindComplete=Ne.parseComplete=void 0;Ne.parseComplete={name:"parseComplete",length:5};Ne.bindComplete={name:"bindComplete",length:5};Ne.closeComplete={name:"closeComplete",length:5};Ne.noData={name:"noData",length:5};Ne.portalSuspended={name:"portalSuspended",length:5};Ne.replicationStart={name:"replicationStart",length:4};Ne.emptyQuery={name:"emptyQuery",length:4};Ne.copyDone={name:"copyDone",length:4};var eI=class extends Error{constructor(e,r,s){super(e),this.length=r,this.name=s}};Ne.DatabaseError=eI;var tI=class{constructor(e,r){this.length=e,this.chunk=r,this.name="copyData"}};Ne.CopyDataMessage=tI;var rI=class{constructor(e,r,s,n){this.length=e,this.name=r,this.binary=s,this.columnTypes=new Array(n)}};Ne.CopyResponse=rI;var sI=class{constructor(e,r,s,n,i,o,a){this.name=e,this.tableID=r,this.columnID=s,this.dataTypeID=n,this.dataTypeSize=i,this.dataTypeModifier=o,this.format=a}};Ne.Field=sI;var nI=class{constructor(e,r){this.length=e,this.fieldCount=r,this.name="rowDescription",this.fields=new Array(this.fieldCount)}};Ne.RowDescriptionMessage=nI;var iI=class{constructor(e,r){this.length=e,this.parameterCount=r,this.name="parameterDescription",this.dataTypeIDs=new Array(this.parameterCount)}};Ne.ParameterDescriptionMessage=iI;var oI=class{constructor(e,r,s){this.length=e,this.parameterName=r,this.parameterValue=s,this.name="parameterStatus"}};Ne.ParameterStatusMessage=oI;var aI=class{constructor(e,r){this.length=e,this.salt=r,this.name="authenticationMD5Password"}};Ne.AuthenticationMD5Password=aI;var lI=class{constructor(e,r,s){this.length=e,this.processID=r,this.secretKey=s,this.name="backendKeyData"}};Ne.BackendKeyDataMessage=lI;var uI=class{constructor(e,r,s,n){this.length=e,this.processId=r,this.channel=s,this.payload=n,this.name="notification"}};Ne.NotificationResponseMessage=uI;var cI=class{constructor(e,r){this.length=e,this.status=r,this.name="readyForQuery"}};Ne.ReadyForQueryMessage=cI;var dI=class{constructor(e,r){this.length=e,this.text=r,this.name="commandComplete"}};Ne.CommandCompleteMessage=dI;var fI=class{constructor(e,r){this.length=e,this.fields=r,this.name="dataRow",this.fieldCount=r.length}};Ne.DataRowMessage=fI;var hI=class{constructor(e,r){this.length=e,this.message=r,this.name="notice"}};Ne.NoticeMessage=hI});var CW=m(XS=>{"use strict";Object.defineProperty(XS,"__esModule",{value:!0});XS.Writer=void 0;var mI=class{constructor(e=256){this.size=e,this.offset=5,this.headerPosition=0,this.buffer=Buffer.allocUnsafe(e)}ensure(e){var r=this.buffer.length-this.offset;if(r<e){var s=this.buffer,n=s.length+(s.length>>1)+e;this.buffer=Buffer.allocUnsafe(n),s.copy(this.buffer)}}addInt32(e){return this.ensure(4),this.buffer[this.offset++]=e>>>24&255,this.buffer[this.offset++]=e>>>16&255,this.buffer[this.offset++]=e>>>8&255,this.buffer[this.offset++]=e>>>0&255,this}addInt16(e){return this.ensure(2),this.buffer[this.offset++]=e>>>8&255,this.buffer[this.offset++]=e>>>0&255,this}addCString(e){if(!e)this.ensure(1);else{var r=Buffer.byteLength(e);this.ensure(r+1),this.buffer.write(e,this.offset,"utf-8"),this.offset+=r}return this.buffer[this.offset++]=0,this}addString(e=""){var r=Buffer.byteLength(e);return this.ensure(r),this.buffer.write(e,this.offset),this.offset+=r,this}add(e){return this.ensure(e.length),e.copy(this.buffer,this.offset),this.offset+=e.length,this}join(e){if(e){this.buffer[this.headerPosition]=e;let r=this.offset-(this.headerPosition+1);this.buffer.writeInt32BE(r,this.headerPosition+1)}return this.buffer.slice(e?0:5,this.offset)}flush(e){var r=this.join(e);return this.offset=5,this.headerPosition=0,this.buffer=Buffer.allocUnsafe(this.size),r}};XS.Writer=mI});var OW=m(tb=>{"use strict";Object.defineProperty(tb,"__esModule",{value:!0});tb.serialize=void 0;var gI=CW(),Yt=new gI.Writer,$Me=t=>{Yt.addInt16(3).addInt16(0);for(let s of Object.keys(t))Yt.addCString(s).addCString(t[s]);Yt.addCString("client_encoding").addCString("UTF8");var e=Yt.addCString("").flush(),r=e.length+4;return new gI.Writer().addInt32(r).add(e).flush()},qMe=()=>{let t=Buffer.allocUnsafe(8);return t.writeInt32BE(8,0),t.writeInt32BE(80877103,4),t},LMe=t=>Yt.addCString(t).flush(112),jMe=function(t,e){return Yt.addCString(t).addInt32(Buffer.byteLength(e)).addString(e),Yt.flush(112)},FMe=function(t){return Yt.addString(t).flush(112)},BMe=t=>Yt.addCString(t).flush(81),RW=[],zMe=t=>{let e=t.name||"";e.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",e,e.length),console.error("This can cause conflicts and silent errors executing queries"));let r=t.types||RW;for(var s=r.length,n=Yt.addCString(e).addCString(t.text).addInt16(s),i=0;i<s;i++)n.addInt32(r[i]);return Yt.flush(80)},Ff=new gI.Writer,UMe=function(t,e){for(let r=0;r<t.length;r++){let s=e?e(t[r],r):t[r];s==null?(Yt.addInt16(0),Ff.addInt32(-1)):s instanceof Buffer?(Yt.addInt16(1),Ff.addInt32(s.length),Ff.add(s)):(Yt.addInt16(0),Ff.addInt32(Buffer.byteLength(s)),Ff.addString(s))}},VMe=(t={})=>{let e=t.portal||"",r=t.statement||"",s=t.binary||!1,n=t.values||RW,i=n.length;return Yt.addCString(e).addCString(r),Yt.addInt16(i),UMe(n,t.valueMapper),Yt.addInt16(i),Yt.add(Ff.flush()),Yt.addInt16(s?1:0),Yt.flush(66)},HMe=Buffer.from([69,0,0,0,9,0,0,0,0,0]),GMe=t=>{if(!t||!t.portal&&!t.rows)return HMe;let e=t.portal||"",r=t.rows||0,s=Buffer.byteLength(e),n=4+s+1+4,i=Buffer.allocUnsafe(1+n);return i[0]=69,i.writeInt32BE(n,1),i.write(e,5,"utf-8"),i[s+5]=0,i.writeUInt32BE(r,i.length-4),i},KMe=(t,e)=>{let r=Buffer.allocUnsafe(16);return r.writeInt32BE(16,0),r.writeInt16BE(1234,4),r.writeInt16BE(5678,6),r.writeInt32BE(t,8),r.writeInt32BE(e,12),r},yI=(t,e)=>{let s=4+Buffer.byteLength(e)+1,n=Buffer.allocUnsafe(1+s);return n[0]=t,n.writeInt32BE(s,1),n.write(e,5,"utf-8"),n[s]=0,n},QMe=Yt.addCString("P").flush(68),WMe=Yt.addCString("S").flush(68),ZMe=t=>t.name?yI(68,`${t.type}${t.name||""}`):t.type==="P"?QMe:WMe,YMe=t=>{let e=`${t.type}${t.name||""}`;return yI(67,e)},JMe=t=>Yt.add(t).flush(100),XMe=t=>yI(102,t),eb=t=>Buffer.from([t,0,0,0,4]),e$e=eb(72),t$e=eb(83),r$e=eb(88),s$e=eb(99),n$e={startup:$Me,password:LMe,requestSsl:qMe,sendSASLInitialResponseMessage:jMe,sendSCRAMClientFinalMessage:FMe,query:BMe,parse:zMe,bind:VMe,execute:GMe,describe:ZMe,close:YMe,flush:()=>e$e,sync:()=>t$e,end:()=>r$e,copyData:JMe,copyDone:()=>s$e,copyFail:XMe,cancel:KMe};tb.serialize=n$e});var PW=m(rb=>{"use strict";Object.defineProperty(rb,"__esModule",{value:!0});rb.BufferReader=void 0;var i$e=Buffer.allocUnsafe(0),vI=class{constructor(e=0){this.offset=e,this.buffer=i$e,this.encoding="utf-8"}setBuffer(e,r){this.offset=e,this.buffer=r}int16(){let e=this.buffer.readInt16BE(this.offset);return this.offset+=2,e}byte(){let e=this.buffer[this.offset];return this.offset++,e}int32(){let e=this.buffer.readInt32BE(this.offset);return this.offset+=4,e}string(e){let r=this.buffer.toString(this.encoding,this.offset,this.offset+e);return this.offset+=e,r}cstring(){let e=this.offset,r=e;for(;this.buffer[r++]!==0;);return this.offset=r,this.buffer.toString(this.encoding,e,r-1)}bytes(e){let r=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,r}};rb.BufferReader=vI});var xW=m(sb=>{"use strict";Object.defineProperty(sb,"__esModule",{value:!0});sb.Parser=void 0;var Jt=pI(),o$e=PW(),_I=1,a$e=4,AW=_I+a$e,kW=Buffer.allocUnsafe(0),SI=class{constructor(e){if(this.buffer=kW,this.bufferLength=0,this.bufferOffset=0,this.reader=new o$e.BufferReader,e?.mode==="binary")throw new Error("Binary mode not supported yet");this.mode=e?.mode||"text"}parse(e,r){this.mergeBuffer(e);let s=this.bufferOffset+this.bufferLength,n=this.bufferOffset;for(;n+AW<=s;){let i=this.buffer[n],o=this.buffer.readUInt32BE(n+_I),a=_I+o;if(a+n<=s){let l=this.handlePacket(n+AW,i,o,this.buffer);r(l),n+=a}else break}n===s?(this.buffer=kW,this.bufferLength=0,this.bufferOffset=0):(this.bufferLength=s-n,this.bufferOffset=n)}mergeBuffer(e){if(this.bufferLength>0){let r=this.bufferLength+e.byteLength;if(r+this.bufferOffset>this.buffer.byteLength){let n;if(r<=this.buffer.byteLength&&this.bufferOffset>=this.bufferLength)n=this.buffer;else{let i=this.buffer.byteLength*2;for(;r>=i;)i*=2;n=Buffer.allocUnsafe(i)}this.buffer.copy(n,0,this.bufferOffset,this.bufferOffset+this.bufferLength),this.buffer=n,this.bufferOffset=0}e.copy(this.buffer,this.bufferOffset+this.bufferLength),this.bufferLength=r}else this.buffer=e,this.bufferOffset=0,this.bufferLength=e.byteLength}handlePacket(e,r,s,n){switch(r){case 50:return Jt.bindComplete;case 49:return Jt.parseComplete;case 51:return Jt.closeComplete;case 110:return Jt.noData;case 115:return Jt.portalSuspended;case 99:return Jt.copyDone;case 87:return Jt.replicationStart;case 73:return Jt.emptyQuery;case 68:return this.parseDataRowMessage(e,s,n);case 67:return this.parseCommandCompleteMessage(e,s,n);case 90:return this.parseReadyForQueryMessage(e,s,n);case 65:return this.parseNotificationMessage(e,s,n);case 82:return this.parseAuthenticationResponse(e,s,n);case 83:return this.parseParameterStatusMessage(e,s,n);case 75:return this.parseBackendKeyData(e,s,n);case 69:return this.parseErrorMessage(e,s,n,"error");case 78:return this.parseErrorMessage(e,s,n,"notice");case 84:return this.parseRowDescriptionMessage(e,s,n);case 116:return this.parseParameterDescriptionMessage(e,s,n);case 71:return this.parseCopyInMessage(e,s,n);case 72:return this.parseCopyOutMessage(e,s,n);case 100:return this.parseCopyData(e,s,n);default:return new Jt.DatabaseError("received invalid response: "+r.toString(16),s,"error")}}parseReadyForQueryMessage(e,r,s){this.reader.setBuffer(e,s);let n=this.reader.string(1);return new Jt.ReadyForQueryMessage(r,n)}parseCommandCompleteMessage(e,r,s){this.reader.setBuffer(e,s);let n=this.reader.cstring();return new Jt.CommandCompleteMessage(r,n)}parseCopyData(e,r,s){let n=s.slice(e,e+(r-4));return new Jt.CopyDataMessage(r,n)}parseCopyInMessage(e,r,s){return this.parseCopyMessage(e,r,s,"copyInResponse")}parseCopyOutMessage(e,r,s){return this.parseCopyMessage(e,r,s,"copyOutResponse")}parseCopyMessage(e,r,s,n){this.reader.setBuffer(e,s);let i=this.reader.byte()!==0,o=this.reader.int16(),a=new Jt.CopyResponse(r,n,i,o);for(let l=0;l<o;l++)a.columnTypes[l]=this.reader.int16();return a}parseNotificationMessage(e,r,s){this.reader.setBuffer(e,s);let n=this.reader.int32(),i=this.reader.cstring(),o=this.reader.cstring();return new Jt.NotificationResponseMessage(r,n,i,o)}parseRowDescriptionMessage(e,r,s){this.reader.setBuffer(e,s);let n=this.reader.int16(),i=new Jt.RowDescriptionMessage(r,n);for(let o=0;o<n;o++)i.fields[o]=this.parseField();return i}parseField(){let e=this.reader.cstring(),r=this.reader.int32(),s=this.reader.int16(),n=this.reader.int32(),i=this.reader.int16(),o=this.reader.int32(),a=this.reader.int16()===0?"text":"binary";return new Jt.Field(e,r,s,n,i,o,a)}parseParameterDescriptionMessage(e,r,s){this.reader.setBuffer(e,s);let n=this.reader.int16(),i=new Jt.ParameterDescriptionMessage(r,n);for(let o=0;o<n;o++)i.dataTypeIDs[o]=this.reader.int32();return i}parseDataRowMessage(e,r,s){this.reader.setBuffer(e,s);let n=this.reader.int16(),i=new Array(n);for(let o=0;o<n;o++){let a=this.reader.int32();i[o]=a===-1?null:this.reader.string(a)}return new Jt.DataRowMessage(r,i)}parseParameterStatusMessage(e,r,s){this.reader.setBuffer(e,s);let n=this.reader.cstring(),i=this.reader.cstring();return new Jt.ParameterStatusMessage(r,n,i)}parseBackendKeyData(e,r,s){this.reader.setBuffer(e,s);let n=this.reader.int32(),i=this.reader.int32();return new Jt.BackendKeyDataMessage(r,n,i)}parseAuthenticationResponse(e,r,s){this.reader.setBuffer(e,s);let n=this.reader.int32(),i={name:"authenticationOk",length:r};switch(n){case 0:break;case 3:i.length===8&&(i.name="authenticationCleartextPassword");break;case 5:if(i.length===12){i.name="authenticationMD5Password";let a=this.reader.bytes(4);return new Jt.AuthenticationMD5Password(r,a)}break;case 10:i.name="authenticationSASL",i.mechanisms=[];let o;do o=this.reader.cstring(),o&&i.mechanisms.push(o);while(o);break;case 11:i.name="authenticationSASLContinue",i.data=this.reader.string(r-8);break;case 12:i.name="authenticationSASLFinal",i.data=this.reader.string(r-8);break;default:throw new Error("Unknown authenticationOk message type "+n)}return i}parseErrorMessage(e,r,s,n){this.reader.setBuffer(e,s);let i={},o=this.reader.string(1);for(;o!=="\0";)i[o]=this.reader.cstring(),o=this.reader.string(1);let a=i.M,l=n==="notice"?new Jt.NoticeMessage(r,a):new Jt.DatabaseError(a,r,n);return l.severity=i.S,l.code=i.C,l.detail=i.D,l.hint=i.H,l.position=i.P,l.internalPosition=i.p,l.internalQuery=i.q,l.where=i.W,l.schema=i.s,l.table=i.t,l.column=i.c,l.dataType=i.d,l.constraint=i.n,l.file=i.F,l.line=i.L,l.routine=i.R,l}};sb.Parser=SI});var bI=m(Al=>{"use strict";Object.defineProperty(Al,"__esModule",{value:!0});Al.DatabaseError=Al.serialize=Al.parse=void 0;var l$e=pI();Object.defineProperty(Al,"DatabaseError",{enumerable:!0,get:function(){return l$e.DatabaseError}});var u$e=OW();Object.defineProperty(Al,"serialize",{enumerable:!0,get:function(){return u$e.serialize}});var c$e=xW();function d$e(t,e){let r=new c$e.Parser;return t.on("data",s=>r.parse(s,e)),new Promise(s=>t.on("end",()=>s()))}Al.parse=d$e});var IW={};Rte(IW,{default:()=>f$e});var f$e,NW=Cte(()=>{f$e={}});var DW=m((JQe,EI)=>{EI.exports.getStream=function(e){let r=require("net");if(typeof r.Socket=="function")return new r.Socket;{let{CloudflareSocket:s}=(NW(),Ote(IW));return new s(e)}};EI.exports.getSecureStream=function(e){var r=require("tls");return r.connect?r.connect(e):(e.socket.startTls(e),e.socket)}});var TI=m((eWe,MW)=>{"use strict";var XQe=require("net"),h$e=require("events").EventEmitter,{parse:p$e,serialize:Mr}=bI(),{getStream:m$e,getSecureStream:g$e}=DW(),y$e=Mr.flush(),v$e=Mr.sync(),_$e=Mr.end(),wI=class extends h$e{constructor(e){super(),e=e||{},this.stream=e.stream||m$e(e.ssl),typeof this.stream=="function"&&(this.stream=this.stream(e)),this._keepAlive=e.keepAlive,this._keepAliveInitialDelayMillis=e.keepAliveInitialDelayMillis,this.lastBuffer=!1,this.parsedStatements={},this.ssl=e.ssl||!1,this._ending=!1,this._emitMessage=!1;var r=this;this.on("newListener",function(s){s==="message"&&(r._emitMessage=!0)})}connect(e,r){var s=this;this._connecting=!0,this.stream.setNoDelay(!0),this.stream.connect(e,r),this.stream.once("connect",function(){s._keepAlive&&s.stream.setKeepAlive(!0,s._keepAliveInitialDelayMillis),s.emit("connect")});let n=function(i){s._ending&&(i.code==="ECONNRESET"||i.code==="EPIPE")||s.emit("error",i)};if(this.stream.on("error",n),this.stream.on("close",function(){s.emit("end")}),!this.ssl)return this.attachListeners(this.stream);this.stream.once("data",function(i){var o=i.toString("utf8");switch(o){case"S":break;case"N":return s.stream.end(),s.emit("error",new Error("The server does not support SSL connections"));default:return s.stream.end(),s.emit("error",new Error("There was an error establishing an SSL connection"))}let a={socket:s.stream};s.ssl!==!0&&(Object.assign(a,s.ssl),"key"in s.ssl&&(a.key=s.ssl.key));var l=require("net");l.isIP&&l.isIP(r)===0&&(a.servername=r);try{s.stream=g$e(a)}catch(u){return s.emit("error",u)}s.attachListeners(s.stream),s.stream.on("error",n),s.emit("sslconnect")})}attachListeners(e){p$e(e,r=>{var s=r.name==="error"?"errorMessage":r.name;this._emitMessage&&this.emit("message",r),this.emit(s,r)})}requestSsl(){this.stream.write(Mr.requestSsl())}startup(e){this.stream.write(Mr.startup(e))}cancel(e,r){this._send(Mr.cancel(e,r))}password(e){this._send(Mr.password(e))}sendSASLInitialResponseMessage(e,r){this._send(Mr.sendSASLInitialResponseMessage(e,r))}sendSCRAMClientFinalMessage(e){this._send(Mr.sendSCRAMClientFinalMessage(e))}_send(e){return this.stream.writable?this.stream.write(e):!1}query(e){this._send(Mr.query(e))}parse(e){this._send(Mr.parse(e))}bind(e){this._send(Mr.bind(e))}execute(e){this._send(Mr.execute(e))}flush(){this.stream.writable&&this.stream.write(y$e)}sync(){this._ending=!0,this._send(v$e)}ref(){this.stream.ref()}unref(){this.stream.unref()}end(){if(this._ending=!0,!this._connecting||!this.stream.writable){this.stream.end();return}return this.stream.write(_$e,()=>{this.stream.end()})}close(e){this._send(Mr.close(e))}describe(e){this._send(Mr.describe(e))}sendCopyFromChunk(e){this._send(Mr.copyData(e))}endCopyFrom(){this._send(Mr.copyDone())}sendCopyFail(e){this._send(Mr.copyFail(e))}};MW.exports=wI});var jW=m((tWe,LW)=>{"use strict";var{Transform:S$e}=require("stream"),{StringDecoder:b$e}=require("string_decoder"),kl=Symbol("last"),nb=Symbol("decoder");function E$e(t,e,r){let s;if(this.overflow){if(s=this[nb].write(t).split(this.matcher),s.length===1)return r();s.shift(),this.overflow=!1}else this[kl]+=this[nb].write(t),s=this[kl].split(this.matcher);this[kl]=s.pop();for(let n=0;n<s.length;n++)try{qW(this,this.mapper(s[n]))}catch(i){return r(i)}if(this.overflow=this[kl].length>this.maxLength,this.overflow&&!this.skipOverflow){r(new Error("maximum buffer reached"));return}r()}function w$e(t){if(this[kl]+=this[nb].end(),this[kl])try{qW(this,this.mapper(this[kl]))}catch(e){return t(e)}t()}function qW(t,e){e!==void 0&&t.push(e)}function $W(t){return t}function T$e(t,e,r){switch(t=t||/\r?\n/,e=e||$W,r=r||{},arguments.length){case 1:typeof t=="function"?(e=t,t=/\r?\n/):typeof t=="object"&&!(t instanceof RegExp)&&!t[Symbol.split]&&(r=t,t=/\r?\n/);break;case 2:typeof t=="function"?(r=e,e=t,t=/\r?\n/):typeof e=="object"&&(r=e,e=$W)}r=Object.assign({},r),r.autoDestroy=!0,r.transform=E$e,r.flush=w$e,r.readableObjectMode=!0;let s=new S$e(r);return s[kl]="",s[nb]=new b$e("utf8"),s.matcher=t,s.mapper=e,s.maxLength=r.maxLength,s.skipOverflow=r.skipOverflow||!1,s.overflow=!1,s._destroy=function(n,i){this._writableState.errorEmitted=!1,i(n)},s}LW.exports=T$e});var zW=m((rWe,_a)=>{"use strict";var FW=require("path"),C$e=require("stream").Stream,R$e=jW(),BW=require("util"),O$e=5432,ib=process.platform==="win32",_g=process.stderr,P$e=56,A$e=7,k$e=61440,x$e=32768;function I$e(t){return(t&k$e)==x$e}var Bf=["host","port","database","user","password"],CI=Bf.length,N$e=Bf[CI-1];function RI(){var t=_g instanceof C$e&&_g.writable===!0;if(t){var e=Array.prototype.slice.call(arguments).concat(`
`);_g.write(BW.format.apply(BW,e))}}Object.defineProperty(_a.exports,"isWin",{get:function(){return ib},set:function(t){ib=t}});_a.exports.warnTo=function(t){var e=_g;return _g=t,e};_a.exports.getFileName=function(t){var e=t||process.env,r=e.PGPASSFILE||(ib?FW.join(e.APPDATA||"./","postgresql","pgpass.conf"):FW.join(e.HOME||"./",".pgpass"));return r};_a.exports.usePgPass=function(t,e){return Object.prototype.hasOwnProperty.call(process.env,"PGPASSWORD")?!1:ib?!0:(e=e||"<unkn>",I$e(t.mode)?t.mode&(P$e|A$e)?(RI('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',e),!1):!0:(RI('WARNING: password file "%s" is not a plain file',e),!1))};var D$e=_a.exports.match=function(t,e){return Bf.slice(0,-1).reduce(function(r,s,n){return n==1&&Number(t[s]||O$e)===Number(e[s])?r&&!0:r&&(e[s]==="*"||e[s]===t[s])},!0)};_a.exports.getPassword=function(t,e,r){var s,n=e.pipe(R$e());function i(l){var u=M$e(l);u&&$$e(u)&&D$e(t,u)&&(s=u[N$e],n.end())}var o=function(){e.destroy(),r(s)},a=function(l){e.destroy(),RI("WARNING: error on reading file: %s",l),r(void 0)};e.on("error",a),n.on("data",i).on("end",o).on("error",a)};var M$e=_a.exports.parseLine=function(t){if(t.length<11||t.match(/^\s+#/))return null;for(var e="",r="",s=0,n=0,i=0,o={},a=!1,l=function(c,d,f){var h=t.substring(d,f);Object.hasOwnProperty.call(process.env,"PGPASS_NO_DEESCAPE")||(h=h.replace(/\\([:\\])/g,"$1")),o[Bf[c]]=h},u=0;u<t.length-1;u+=1){if(e=t.charAt(u+1),r=t.charAt(u),a=s==CI-1,a){l(s,n);break}u>=0&&e==":"&&r!=="\\"&&(l(s,n,u+1),n=u+2,s+=1)}return o=Object.keys(o).length===CI?o:null,o},$$e=_a.exports.isValidEntry=function(t){for(var e={0:function(o){return o.length>0},1:function(o){return o==="*"?!0:(o=Number(o),isFinite(o)&&o>0&&o<9007199254740992&&Math.floor(o)===o)},2:function(o){return o.length>0},3:function(o){return o.length>0},4:function(o){return o.length>0}},r=0;r<Bf.length;r+=1){var s=e[r],n=t[Bf[r]]||"",i=s(n);if(!i)return!1}return!0}});var VW=m((nWe,OI)=>{"use strict";var sWe=require("path"),UW=require("fs"),ob=zW();OI.exports=function(t,e){var r=ob.getFileName();UW.stat(r,function(s,n){if(s||!ob.usePgPass(n,r))return e(void 0);var i=UW.createReadStream(r);ob.getPassword(t,i,e)})};OI.exports.warnTo=ob.warnTo});var QW=m((iWe,KW)=>{"use strict";var q$e=require("events").EventEmitter,HW=yg(),PI=dW(),L$e=Qx(),j$e=Yx(),GW=TW(),F$e=gg(),B$e=TI(),z$e=Kx(),ab=class extends q$e{constructor(e){super(),this.connectionParameters=new j$e(e),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;var r=e||{};this._Promise=r.Promise||global.Promise,this._types=new L$e(r.types),this._ending=!1,this._ended=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.connection=r.connection||new B$e({stream:r.stream,ssl:this.connectionParameters.ssl,keepAlive:r.keepAlive||!1,keepAliveInitialDelayMillis:r.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=r.binary||F$e.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=r.connectionTimeoutMillis||0}_errorAllQueries(e){let r=s=>{process.nextTick(()=>{s.handleError(e,this.connection)})};this.activeQuery&&(r(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(r),this.queryQueue.length=0}_connect(e){var r=this,s=this.connection;if(this._connectionCallback=e,this._connecting||this._connected){let n=new Error("Client has already been connected. You cannot reuse a client.");process.nextTick(()=>{e(n)});return}this._connecting=!0,this.connectionTimeoutHandle,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{s._ending=!0,s.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis)),this.host&&this.host.indexOf("/")===0?s.connect(this.host+"/.s.PGSQL."+this.port):s.connect(this.port,this.host),s.on("connect",function(){r.ssl?s.requestSsl():s.startup(r.getStartupConf())}),s.on("sslconnect",function(){s.startup(r.getStartupConf())}),this._attachListeners(s),s.once("end",()=>{let n=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(n),this._ended=!0,this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(n):this._handleErrorEvent(n):this._connectionError||this._handleErrorEvent(n)),process.nextTick(()=>{this.emit("end")})})}connect(e){if(e){this._connect(e);return}return new this._Promise((r,s)=>{this._connect(n=>{n?s(n):r()})})}_attachListeners(e){e.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),e.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),e.on("authenticationSASL",this._handleAuthSASL.bind(this)),e.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),e.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),e.on("backendKeyData",this._handleBackendKeyData.bind(this)),e.on("error",this._handleErrorEvent.bind(this)),e.on("errorMessage",this._handleErrorMessage.bind(this)),e.on("readyForQuery",this._handleReadyForQuery.bind(this)),e.on("notice",this._handleNotice.bind(this)),e.on("rowDescription",this._handleRowDescription.bind(this)),e.on("dataRow",this._handleDataRow.bind(this)),e.on("portalSuspended",this._handlePortalSuspended.bind(this)),e.on("emptyQuery",this._handleEmptyQuery.bind(this)),e.on("commandComplete",this._handleCommandComplete.bind(this)),e.on("parseComplete",this._handleParseComplete.bind(this)),e.on("copyInResponse",this._handleCopyInResponse.bind(this)),e.on("copyData",this._handleCopyData.bind(this)),e.on("notification",this._handleNotification.bind(this))}_checkPgPass(e){let r=this.connection;if(typeof this.password=="function")this._Promise.resolve().then(()=>this.password()).then(s=>{if(s!==void 0){if(typeof s!="string"){r.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=s}else this.connectionParameters.password=this.password=null;e()}).catch(s=>{r.emit("error",s)});else if(this.password!==null)e();else try{VW()(this.connectionParameters,n=>{n!==void 0&&(this.connectionParameters.password=this.password=n),e()})}catch(s){this.emit("error",s)}}_handleAuthCleartextPassword(e){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(e){this._checkPgPass(async()=>{try{let r=await z$e.postgresMd5PasswordHash(this.user,this.password,e.salt);this.connection.password(r)}catch(r){this.emit("error",r)}})}_handleAuthSASL(e){this._checkPgPass(()=>{try{this.saslSession=PI.startSession(e.mechanisms),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)}catch(r){this.connection.emit("error",r)}})}async _handleAuthSASLContinue(e){try{await PI.continueSession(this.saslSession,this.password,e.data),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}catch(r){this.connection.emit("error",r)}}_handleAuthSASLFinal(e){try{PI.finalizeSession(this.saslSession,e.data),this.saslSession=null}catch(r){this.connection.emit("error",r)}}_handleBackendKeyData(e){this.processID=e.processID,this.secretKey=e.secretKey}_handleReadyForQuery(e){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:r}=this;this.activeQuery=null,this.readyForQuery=!0,r&&r.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(e){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(e);this.emit("error",e)}}_handleErrorEvent(e){if(this._connecting)return this._handleErrorWhileConnecting(e);this._queryable=!1,this._errorAllQueries(e),this.emit("error",e)}_handleErrorMessage(e){if(this._connecting)return this._handleErrorWhileConnecting(e);let r=this.activeQuery;if(!r){this._handleErrorEvent(e);return}this.activeQuery=null,r.handleError(e,this.connection)}_handleRowDescription(e){this.activeQuery.handleRowDescription(e)}_handleDataRow(e){this.activeQuery.handleDataRow(e)}_handlePortalSuspended(e){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(e){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(e){this.activeQuery.handleCommandComplete(e,this.connection)}_handleParseComplete(e){this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(e){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(e){this.activeQuery.handleCopyData(e,this.connection)}_handleNotification(e){this.emit("notification",e)}_handleNotice(e){this.emit("notice",e)}getStartupConf(){var e=this.connectionParameters,r={user:e.user,database:e.database},s=e.application_name||e.fallback_application_name;return s&&(r.application_name=s),e.replication&&(r.replication=""+e.replication),e.statement_timeout&&(r.statement_timeout=String(parseInt(e.statement_timeout,10))),e.lock_timeout&&(r.lock_timeout=String(parseInt(e.lock_timeout,10))),e.idle_in_transaction_session_timeout&&(r.idle_in_transaction_session_timeout=String(parseInt(e.idle_in_transaction_session_timeout,10))),e.options&&(r.options=e.options),r}cancel(e,r){if(e.activeQuery===r){var s=this.connection;this.host&&this.host.indexOf("/")===0?s.connect(this.host+"/.s.PGSQL."+this.port):s.connect(this.port,this.host),s.on("connect",function(){s.cancel(e.processID,e.secretKey)})}else e.queryQueue.indexOf(r)!==-1&&e.queryQueue.splice(e.queryQueue.indexOf(r),1)}setTypeParser(e,r,s){return this._types.setTypeParser(e,r,s)}getTypeParser(e,r){return this._types.getTypeParser(e,r)}escapeIdentifier(e){return HW.escapeIdentifier(e)}escapeLiteral(e){return HW.escapeLiteral(e)}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let e=this.activeQuery.submit(this.connection);e&&process.nextTick(()=>{this.activeQuery.handleError(e,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(e,r,s){var n,i,o,a,l;if(e==null)throw new TypeError("Client was passed a null or undefined query");return typeof e.submit=="function"?(o=e.query_timeout||this.connectionParameters.query_timeout,i=n=e,typeof r=="function"&&(n.callback=n.callback||r)):(o=this.connectionParameters.query_timeout,n=new GW(e,r,s),n.callback||(i=new this._Promise((u,c)=>{n.callback=(d,f)=>d?c(d):u(f)}).catch(u=>{throw Error.captureStackTrace(u),u}))),o&&(l=n.callback,a=setTimeout(()=>{var u=new Error("Query read timeout");process.nextTick(()=>{n.handleError(u,this.connection)}),l(u),n.callback=()=>{};var c=this.queryQueue.indexOf(n);c>-1&&this.queryQueue.splice(c,1),this._pulseQueryQueue()},o),n.callback=(u,c)=>{clearTimeout(a),l(u,c)}),this.binary&&!n.binary&&(n.binary=!0),n._result&&!n._result._types&&(n._result._types=this._types),this._queryable?this._ending?(process.nextTick(()=>{n.handleError(new Error("Client was closed and is not queryable"),this.connection)}),i):(this.queryQueue.push(n),this._pulseQueryQueue(),i):(process.nextTick(()=>{n.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),i)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(e){if(this._ending=!0,!this.connection._connecting||this._ended)if(e)e();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),e)this.connection.once("end",e);else return new this._Promise(r=>{this.connection.once("end",r)})}};ab.Query=GW;KW.exports=ab});var JW=m((oWe,YW)=>{"use strict";var U$e=require("events").EventEmitter,WW=function(){},ZW=(t,e)=>{let r=t.findIndex(e);return r===-1?void 0:t.splice(r,1)[0]},AI=class{constructor(e,r,s){this.client=e,this.idleListener=r,this.timeoutId=s}},zf=class{constructor(e){this.callback=e}};function V$e(){throw new Error("Release called on client which has already been released to the pool.")}function lb(t,e){if(e)return{callback:e,result:void 0};let r,s,n=function(o,a){o?r(o):s(a)},i=new t(function(o,a){s=o,r=a}).catch(o=>{throw Error.captureStackTrace(o),o});return{callback:n,result:i}}function H$e(t,e){return function r(s){s.client=e,e.removeListener("error",r),e.on("error",()=>{t.log("additional client error after disconnection due to error",s)}),t._remove(e),t.emit("error",s,e)}}var kI=class extends U$e{constructor(e,r){super(),this.options=Object.assign({},e),e!=null&&"password"in e&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),e!=null&&e.ssl&&e.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||r||Sg().Client,this.Promise=this.options.Promise||global.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(r=>{this._remove(r.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let e=this._pendingQueue.shift();if(this._idle.length){let r=this._idle.pop();clearTimeout(r.timeoutId);let s=r.client;s.ref&&s.ref();let n=r.idleListener;return this._acquireClient(s,e,n,!1)}if(!this._isFull())return this.newClient(e);throw new Error("unexpected condition")}_remove(e){let r=ZW(this._idle,s=>s.client===e);r!==void 0&&clearTimeout(r.timeoutId),this._clients=this._clients.filter(s=>s!==e),e.end(),this.emit("remove",e)}connect(e){if(this.ending){let n=new Error("Cannot use a pool after calling end on the pool");return e?e(n):this.Promise.reject(n)}let r=lb(this.Promise,e),s=r.result;if(this._isFull()||this._idle.length){if(this._idle.length&&process.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new zf(r.callback)),s;let n=(a,l,u)=>{clearTimeout(o),r.callback(a,l,u)},i=new zf(n),o=setTimeout(()=>{ZW(this._pendingQueue,a=>a.callback===n),i.timedOut=!0,r.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return this._pendingQueue.push(i),s}return this.newClient(new zf(r.callback)),s}newClient(e){let r=new this.Client(this.options);this._clients.push(r);let s=H$e(this,r);this.log("checking client timeout");let n,i=!1;this.options.connectionTimeoutMillis&&(n=setTimeout(()=>{this.log("ending client due to timeout"),i=!0,r.connection?r.connection.stream.destroy():r.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),r.connect(o=>{if(n&&clearTimeout(n),r.on("error",s),o)this.log("client failed to connect",o),this._clients=this._clients.filter(a=>a!==r),i&&(o.message="Connection terminated due to connection timeout"),this._pulseQueue(),e.timedOut||e.callback(o,void 0,WW);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let a=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(r),this._idle.findIndex(u=>u.client===r)!==-1&&this._acquireClient(r,new zf((u,c,d)=>d()),s,!1)},this.options.maxLifetimeSeconds*1e3);a.unref(),r.once("end",()=>clearTimeout(a))}return this._acquireClient(r,e,s,!0)}})}_acquireClient(e,r,s,n){n&&this.emit("connect",e),this.emit("acquire",e),e.release=this._releaseOnce(e,s),e.removeListener("error",s),r.timedOut?n&&this.options.verify?this.options.verify(e,e.release):e.release():n&&this.options.verify?this.options.verify(e,i=>{if(i)return e.release(i),r.callback(i,void 0,WW);r.callback(void 0,e,e.release)}):r.callback(void 0,e,e.release)}_releaseOnce(e,r){let s=!1;return n=>{s&&V$e(),s=!0,this._release(e,r,n)}}_release(e,r,s){if(e.on("error",r),e._poolUseCount=(e._poolUseCount||0)+1,this.emit("release",s,e),s||this.ending||!e._queryable||e._ending||e._poolUseCount>=this.options.maxUses){e._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(e),this._pulseQueue();return}if(this._expired.has(e)){this.log("remove expired client"),this._expired.delete(e),this._remove(e),this._pulseQueue();return}let i;this.options.idleTimeoutMillis&&(i=setTimeout(()=>{this.log("remove idle client"),this._remove(e)},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&i.unref()),this.options.allowExitOnIdle&&e.unref(),this._idle.push(new AI(e,r,i)),this._pulseQueue()}query(e,r,s){if(typeof e=="function"){let i=lb(this.Promise,e);return setImmediate(function(){return i.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),i.result}typeof r=="function"&&(s=r,r=void 0);let n=lb(this.Promise,s);return s=n.callback,this.connect((i,o)=>{if(i)return s(i);let a=!1,l=u=>{a||(a=!0,o.release(u),s(u))};o.once("error",l),this.log("dispatching query");try{o.query(e,r,(u,c)=>{if(this.log("query dispatched"),o.removeListener("error",l),!a)return a=!0,o.release(u),u?s(u):s(void 0,c)})}catch(u){return o.release(u),s(u)}}),n.result}end(e){if(this.log("ending"),this.ending){let s=new Error("Called end on pool more than once");return e?e(s):this.Promise.reject(s)}this.ending=!0;let r=lb(this.Promise,e);return this._endCallback=r.callback,this._pulseQueue(),r.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((e,r)=>e+(this._expired.has(r)?1:0),0)}get totalCount(){return this._clients.length}};YW.exports=kI});var tZ=m((aWe,eZ)=>{"use strict";var XW=require("events").EventEmitter,G$e=require("util"),xI=yg(),Uf=eZ.exports=function(t,e,r){XW.call(this),t=xI.normalizeQueryConfig(t,e,r),this.text=t.text,this.values=t.values,this.name=t.name,this.queryMode=t.queryMode,this.callback=t.callback,this.state="new",this._arrayMode=t.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(s){s==="row"&&(this._emitRowEvents=!0)}.bind(this))};G$e.inherits(Uf,XW);var K$e={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};Uf.prototype.handleError=function(t){var e=this.native.pq.resultErrorFields();if(e)for(var r in e){var s=K$e[r]||r;t[s]=e[r]}this.callback?this.callback(t):this.emit("error",t),this.state="error"};Uf.prototype.then=function(t,e){return this._getPromise().then(t,e)};Uf.prototype.catch=function(t){return this._getPromise().catch(t)};Uf.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(t,e){this._once("end",t),this._once("error",e)}.bind(this)),this._promise)};Uf.prototype.submit=function(t){this.state="running";var e=this;this.native=t.native,t.native.arrayMode=this._arrayMode;var r=function(i,o,a){if(t.native.arrayMode=!1,setImmediate(function(){e.emit("_done")}),i)return e.handleError(i);e._emitRowEvents&&(a.length>1?o.forEach((l,u)=>{l.forEach(c=>{e.emit("row",c,a[u])})}):o.forEach(function(l){e.emit("row",l,a)})),e.state="end",e.emit("end",a),e.callback&&e.callback(null,a)};if(process.domain&&(r=process.domain.bind(r)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));var s=(this.values||[]).map(xI.prepareValue);if(t.namedQueries[this.name]){if(this.text&&t.namedQueries[this.name]!==this.text){let i=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return r(i)}return t.native.execute(this.name,s,r)}return t.native.prepare(this.name,this.text,s.length,function(i){return i?r(i):(t.namedQueries[e.name]=e.text,e.native.execute(e.name,s,r))})}else if(this.values){if(!Array.isArray(this.values)){let i=new Error("Query values must be an array");return r(i)}var n=this.values.map(xI.prepareValue);t.native.query(this.text,n,r)}else this.queryMode==="extended"?t.native.query(this.text,[],r):t.native.query(this.text,r)}});var oZ=m((lWe,iZ)=>{"use strict";var rZ;try{rZ=require("pg-native")}catch(t){throw t}var Q$e=Qx(),sZ=require("events").EventEmitter,W$e=require("util"),Z$e=Yx(),nZ=tZ(),zs=iZ.exports=function(t){sZ.call(this),t=t||{},this._Promise=t.Promise||global.Promise,this._types=new Q$e(t.types),this.native=new rZ({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;var e=this.connectionParameters=new Z$e(t);t.nativeConnectionString&&(e.nativeConnectionString=t.nativeConnectionString),this.user=e.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),this.database=e.database,this.host=e.host,this.port=e.port,this.namedQueries={}};zs.Query=nZ;W$e.inherits(zs,sZ);zs.prototype._errorAllQueries=function(t){let e=r=>{process.nextTick(()=>{r.native=this.native,r.handleError(t)})};this._hasActiveQuery()&&(e(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(e),this._queryQueue.length=0};zs.prototype._connect=function(t){var e=this;if(this._connecting){process.nextTick(()=>t(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(r,s){if(e.connectionParameters.nativeConnectionString&&(s=e.connectionParameters.nativeConnectionString),r)return t(r);e.native.connect(s,function(n){if(n)return e.native.end(),t(n);e._connected=!0,e.native.on("error",function(i){e._queryable=!1,e._errorAllQueries(i),e.emit("error",i)}),e.native.on("notification",function(i){e.emit("notification",{channel:i.relname,payload:i.extra})}),e.emit("connect"),e._pulseQueryQueue(!0),t()})})};zs.prototype.connect=function(t){if(t){this._connect(t);return}return new this._Promise((e,r)=>{this._connect(s=>{s?r(s):e()})})};zs.prototype.query=function(t,e,r){var s,n,i,o,a;if(t==null)throw new TypeError("Client was passed a null or undefined query");if(typeof t.submit=="function")i=t.query_timeout||this.connectionParameters.query_timeout,n=s=t,typeof e=="function"&&(t.callback=e);else if(i=this.connectionParameters.query_timeout,s=new nZ(t,e,r),!s.callback){let l,u;n=new this._Promise((c,d)=>{l=c,u=d}).catch(c=>{throw Error.captureStackTrace(c),c}),s.callback=(c,d)=>c?u(c):l(d)}return i&&(a=s.callback,o=setTimeout(()=>{var l=new Error("Query read timeout");process.nextTick(()=>{s.handleError(l,this.connection)}),a(l),s.callback=()=>{};var u=this._queryQueue.indexOf(s);u>-1&&this._queryQueue.splice(u,1),this._pulseQueryQueue()},i),s.callback=(l,u)=>{clearTimeout(o),a(l,u)}),this._queryable?this._ending?(s.native=this.native,process.nextTick(()=>{s.handleError(new Error("Client was closed and is not queryable"))}),n):(this._queryQueue.push(s),this._pulseQueryQueue(),n):(s.native=this.native,process.nextTick(()=>{s.handleError(new Error("Client has encountered a connection error and is not queryable"))}),n)};zs.prototype.end=function(t){var e=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,t));var r;return t||(r=new this._Promise(function(s,n){t=i=>i?n(i):s()})),this.native.end(function(){e._errorAllQueries(new Error("Connection terminated")),process.nextTick(()=>{e.emit("end"),t&&t()})}),r};zs.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"};zs.prototype._pulseQueryQueue=function(t){if(this._connected&&!this._hasActiveQuery()){var e=this._queryQueue.shift();if(!e){t||this.emit("drain");return}this._activeQuery=e,e.submit(this);var r=this;e.once("_done",function(){r._pulseQueryQueue()})}};zs.prototype.cancel=function(t){this._activeQuery===t?this.native.cancel(function(){}):this._queryQueue.indexOf(t)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(t),1)};zs.prototype.ref=function(){};zs.prototype.unref=function(){};zs.prototype.setTypeParser=function(t,e,r){return this._types.setTypeParser(t,e,r)};zs.prototype.getTypeParser=function(t,e){return this._types.getTypeParser(t,e)}});var II=m((uWe,aZ)=>{"use strict";aZ.exports=oZ()});var Sg=m((dWe,bg)=>{"use strict";var Y$e=QW(),J$e=gg(),X$e=TI(),eqe=JW(),{DatabaseError:tqe}=bI(),{escapeIdentifier:rqe,escapeLiteral:sqe}=yg(),nqe=t=>class extends eqe{constructor(r){super(r,t)}},NI=function(t){this.defaults=J$e,this.Client=t,this.Query=this.Client.Query,this.Pool=nqe(this.Client),this._pools=[],this.Connection=X$e,this.types=mg(),this.DatabaseError=tqe,this.escapeIdentifier=rqe,this.escapeLiteral=sqe};typeof process.env.NODE_PG_FORCE_NATIVE<"u"?bg.exports=new NI(II()):(bg.exports=new NI(Y$e),Object.defineProperty(bg.exports,"native",{configurable:!0,enumerable:!1,get(){var t=null;try{t=new NI(II())}catch(e){if(e.code!=="MODULE_NOT_FOUND")throw e}return Object.defineProperty(bg.exports,"native",{value:t}),t}}))});var ft=m(Kn=>{"use strict";Object.defineProperty(Kn,"__esModule",{value:!0});Kn.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=Kn.DEFAULT_MAX_SEND_MESSAGE_LENGTH=Kn.Propagate=Kn.LogVerbosity=Kn.Status=void 0;var c7;(function(t){t[t.OK=0]="OK",t[t.CANCELLED=1]="CANCELLED",t[t.UNKNOWN=2]="UNKNOWN",t[t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",t[t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",t[t.NOT_FOUND=5]="NOT_FOUND",t[t.ALREADY_EXISTS=6]="ALREADY_EXISTS",t[t.PERMISSION_DENIED=7]="PERMISSION_DENIED",t[t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",t[t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",t[t.ABORTED=10]="ABORTED",t[t.OUT_OF_RANGE=11]="OUT_OF_RANGE",t[t.UNIMPLEMENTED=12]="UNIMPLEMENTED",t[t.INTERNAL=13]="INTERNAL",t[t.UNAVAILABLE=14]="UNAVAILABLE",t[t.DATA_LOSS=15]="DATA_LOSS",t[t.UNAUTHENTICATED=16]="UNAUTHENTICATED"})(c7||(Kn.Status=c7={}));var d7;(function(t){t[t.DEBUG=0]="DEBUG",t[t.INFO=1]="INFO",t[t.ERROR=2]="ERROR",t[t.NONE=3]="NONE"})(d7||(Kn.LogVerbosity=d7={}));var f7;(function(t){t[t.DEADLINE=1]="DEADLINE",t[t.CENSUS_STATS_CONTEXT=2]="CENSUS_STATS_CONTEXT",t[t.CENSUS_TRACING_CONTEXT=4]="CENSUS_TRACING_CONTEXT",t[t.CANCELLATION=8]="CANCELLATION",t[t.DEFAULTS=65535]="DEFAULTS"})(f7||(Kn.Propagate=f7={}));Kn.DEFAULT_MAX_SEND_MESSAGE_LENGTH=-1;Kn.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=4*1024*1024});var fN=m((met,pje)=>{pje.exports={name:"@grpc/grpc-js",version:"1.10.10",description:"gRPC Library for Node - pure JS implementation",homepage:"https://grpc.io/",repository:"https://github.com/grpc/grpc-node/tree/master/packages/grpc-js",main:"build/src/index.js",engines:{node:">=12.10.0"},keywords:[],author:{name:"Google Inc."},types:"build/src/index.d.ts",license:"Apache-2.0",devDependencies:{"@types/gulp":"^4.0.17","@types/gulp-mocha":"0.0.37","@types/lodash":"^4.14.202","@types/mocha":"^10.0.6","@types/ncp":"^2.0.8","@types/node":">=20.11.20","@types/pify":"^5.0.4","@types/semver":"^7.5.8","@typescript-eslint/eslint-plugin":"^7.1.0","@typescript-eslint/parser":"^7.1.0","@typescript-eslint/typescript-estree":"^7.1.0","clang-format":"^1.8.0",eslint:"^8.42.0","eslint-config-prettier":"^8.8.0","eslint-plugin-node":"^11.1.0","eslint-plugin-prettier":"^4.2.1",execa:"^2.0.3",gulp:"^4.0.2","gulp-mocha":"^6.0.0",lodash:"^4.17.21",madge:"^5.0.1","mocha-jenkins-reporter":"^0.4.1",ncp:"^2.0.0",pify:"^4.0.1",prettier:"^2.8.8",rimraf:"^3.0.2",semver:"^7.6.0","ts-node":"^10.9.2",typescript:"^5.3.3"},contributors:[{name:"Google Inc."}],scripts:{build:"npm run compile",clean:"rimraf ./build",compile:"tsc -p .",format:'clang-format -i -style="{Language: JavaScript, BasedOnStyle: Google, ColumnLimit: 80}" src/*.ts test/*.ts',lint:"eslint src/*.ts test/*.ts",prepare:"npm run generate-types && npm run compile",test:"gulp test",check:"npm run lint",fix:"eslint --fix src/*.ts test/*.ts",pretest:"npm run generate-types && npm run generate-test-types && npm run compile",posttest:"npm run check && madge -c ./build/src","generate-types":"proto-loader-gen-types --keepCase --longs String --enums String --defaults --oneofs --includeComments --includeDirs proto/ --include-dirs test/fixtures/ -O src/generated/ --grpcLib ../index channelz.proto","generate-test-types":"proto-loader-gen-types --keepCase --longs String --enums String --defaults --oneofs --includeComments --include-dirs test/fixtures/ -O test/generated/ --grpcLib ../../src/index test_service.proto"},dependencies:{"@grpc/proto-loader":"^0.7.13","@js-sdsl/ordered-map":"^4.4.2"},files:["src/**/*.ts","build/src/**/*.{js,d.ts,js.map}","proto/*.proto","LICENSE","deps/envoy-api/envoy/api/v2/**/*.proto","deps/envoy-api/envoy/config/**/*.proto","deps/envoy-api/envoy/service/**/*.proto","deps/envoy-api/envoy/type/**/*.proto","deps/udpa/udpa/**/*.proto","deps/googleapis/google/api/*.proto","deps/googleapis/google/rpc/*.proto","deps/protoc-gen-validate/validate/**/*.proto"]}});var er=m(Ps=>{"use strict";var hN,pN,mN,gN;Object.defineProperty(Ps,"__esModule",{value:!0});Ps.isTracerEnabled=Ps.trace=Ps.log=Ps.setLoggerVerbosity=Ps.setLogger=Ps.getLogger=void 0;var Fl=ft(),mje=require("process"),gje=fN().version,yje={error:(t,...e)=>{console.error("E "+t,...e)},info:(t,...e)=>{console.error("I "+t,...e)},debug:(t,...e)=>{console.error("D "+t,...e)}},Ic=yje,dh=Fl.LogVerbosity.ERROR,vje=(pN=(hN=process.env.GRPC_NODE_VERBOSITY)!==null&&hN!==void 0?hN:process.env.GRPC_VERBOSITY)!==null&&pN!==void 0?pN:"";switch(vje.toUpperCase()){case"DEBUG":dh=Fl.LogVerbosity.DEBUG;break;case"INFO":dh=Fl.LogVerbosity.INFO;break;case"ERROR":dh=Fl.LogVerbosity.ERROR;break;case"NONE":dh=Fl.LogVerbosity.NONE;break;default:}var _je=()=>Ic;Ps.getLogger=_je;var Sje=t=>{Ic=t};Ps.setLogger=Sje;var bje=t=>{dh=t};Ps.setLoggerVerbosity=bje;var Eje=(t,...e)=>{let r;if(t>=dh){switch(t){case Fl.LogVerbosity.DEBUG:r=Ic.debug;break;case Fl.LogVerbosity.INFO:r=Ic.info;break;case Fl.LogVerbosity.ERROR:r=Ic.error;break}r||(r=Ic.error),r&&r.bind(Ic)(...e)}};Ps.log=Eje;var wje=(gN=(mN=process.env.GRPC_NODE_TRACE)!==null&&mN!==void 0?mN:process.env.GRPC_TRACE)!==null&&gN!==void 0?gN:"",yN=new Set,h7=new Set;for(let t of wje.split(","))t.startsWith("-")?h7.add(t.substring(1)):yN.add(t);var Tje=yN.has("all");function Cje(t,e,r){p7(e)&&(0,Ps.log)(t,new Date().toISOString()+" | v"+gje+" "+mje.pid+" | "+e+" | "+r)}Ps.trace=Cje;function p7(t){return!h7.has(t)&&(Tje||yN.has(t))}Ps.isTracerEnabled=p7});var Zb=m(fh=>{"use strict";Object.defineProperty(fh,"__esModule",{value:!0});fh.getErrorCode=fh.getErrorMessage=void 0;function Rje(t){return t instanceof Error?t.message:String(t)}fh.getErrorMessage=Rje;function Oje(t){return typeof t=="object"&&t!==null&&"code"in t&&typeof t.code=="number"?t.code:null}fh.getErrorCode=Oje});var As=m(Jb=>{"use strict";Object.defineProperty(Jb,"__esModule",{value:!0});Jb.Metadata=void 0;var Pje=er(),Aje=ft(),kje=Zb(),xje=/^[0-9a-z_.-]+$/,Ije=/^[ -~]*$/;function Nje(t){return xje.test(t)}function Dje(t){return Ije.test(t)}function g7(t){return t.endsWith("-bin")}function Mje(t){return!t.startsWith("grpc-")}function Yb(t){return t.toLowerCase()}function m7(t,e){if(!Nje(t))throw new Error('Metadata key "'+t+'" contains illegal characters');if(e!=null)if(g7(t)){if(!Buffer.isBuffer(e))throw new Error("keys that end with '-bin' must have Buffer values")}else{if(Buffer.isBuffer(e))throw new Error("keys that don't end with '-bin' must have String values");if(!Dje(e))throw new Error('Metadata string value "'+e+'" contains illegal characters')}}var hh=class{constructor(e={}){this.internalRepr=new Map,this.options=e}set(e,r){e=Yb(e),m7(e,r),this.internalRepr.set(e,[r])}add(e,r){e=Yb(e),m7(e,r);let s=this.internalRepr.get(e);s===void 0?this.internalRepr.set(e,[r]):s.push(r)}remove(e){e=Yb(e),this.internalRepr.delete(e)}get(e){return e=Yb(e),this.internalRepr.get(e)||[]}getMap(){let e={};for(let[r,s]of this.internalRepr)if(s.length>0){let n=s[0];e[r]=Buffer.isBuffer(n)?Buffer.from(n):n}return e}clone(){let e=new hh(this.options),r=e.internalRepr;for(let[s,n]of this.internalRepr){let i=n.map(o=>Buffer.isBuffer(o)?Buffer.from(o):o);r.set(s,i)}return e}merge(e){for(let[r,s]of e.internalRepr){let n=(this.internalRepr.get(r)||[]).concat(s);this.internalRepr.set(r,n)}}setOptions(e){this.options=e}getOptions(){return this.options}toHttp2Headers(){let e={};for(let[r,s]of this.internalRepr)e[r]=s.map($je);return e}toJSON(){let e={};for(let[r,s]of this.internalRepr)e[r]=s;return e}static fromHttp2Headers(e){let r=new hh;for(let s of Object.keys(e)){if(s.charAt(0)===":")continue;let n=e[s];try{g7(s)?Array.isArray(n)?n.forEach(i=>{r.add(s,Buffer.from(i,"base64"))}):n!==void 0&&(Mje(s)?n.split(",").forEach(i=>{r.add(s,Buffer.from(i.trim(),"base64"))}):r.add(s,Buffer.from(n,"base64"))):Array.isArray(n)?n.forEach(i=>{r.add(s,i)}):n!==void 0&&r.add(s,n)}catch(i){let o=`Failed to add metadata entry ${s}: ${n}. ${(0,kje.getErrorMessage)(i)}. For more information see https://github.com/grpc/grpc-node/issues/1173`;(0,Pje.log)(Aje.LogVerbosity.ERROR,o)}}return r}};Jb.Metadata=hh;var $je=t=>Buffer.isBuffer(t)?t.toString("base64"):t});var _N=m(Xb=>{"use strict";Object.defineProperty(Xb,"__esModule",{value:!0});Xb.CallCredentials=void 0;var vN=As();function qje(t){return"getRequestHeaders"in t&&typeof t.getRequestHeaders=="function"}var Bl=class{static createFromMetadataGenerator(e){return new Vg(e)}static createFromGoogleCredential(e){return Bl.createFromMetadataGenerator((r,s)=>{let n;qje(e)?n=e.getRequestHeaders(r.service_url):n=new Promise((i,o)=>{e.getRequestMetadata(r.service_url,(a,l)=>{if(a){o(a);return}if(!l){o(new Error("Headers not set by metadata plugin"));return}i(l)})}),n.then(i=>{let o=new vN.Metadata;for(let a of Object.keys(i))o.add(a,i[a]);s(null,o)},i=>{s(i)})})}static createEmpty(){return new Hg}};Xb.CallCredentials=Bl;var ph=class extends Bl{constructor(e){super(),this.creds=e}async generateMetadata(e){let r=new vN.Metadata,s=await Promise.all(this.creds.map(n=>n.generateMetadata(e)));for(let n of s)r.merge(n);return r}compose(e){return new ph(this.creds.concat([e]))}_equals(e){return this===e?!0:e instanceof ph?this.creds.every((r,s)=>r._equals(e.creds[s])):!1}},Vg=class extends Bl{constructor(e){super(),this.metadataGenerator=e}generateMetadata(e){return new Promise((r,s)=>{this.metadataGenerator(e,(n,i)=>{i!==void 0?r(i):s(n)})})}compose(e){return new ph([this,e])}_equals(e){return this===e?!0:e instanceof Vg?this.metadataGenerator===e.metadataGenerator:!1}},Hg=class extends Bl{generateMetadata(e){return Promise.resolve(new vN.Metadata)}compose(e){return e}_equals(e){return e instanceof Hg}}});var bN=m(mh=>{"use strict";Object.defineProperty(mh,"__esModule",{value:!0});mh.getDefaultRootsData=mh.CIPHER_SUITES=void 0;var Lje=require("fs");mh.CIPHER_SUITES=process.env.GRPC_SSL_CIPHER_SUITES;var y7=process.env.GRPC_DEFAULT_SSL_ROOTS_FILE_PATH,SN=null;function jje(){return y7?(SN===null&&(SN=Lje.readFileSync(y7)),SN):null}mh.getDefaultRootsData=jje});var tE=m(eE=>{"use strict";Object.defineProperty(eE,"__esModule",{value:!0});eE.ChannelCredentials=void 0;var Fje=require("tls"),Bje=_N(),v7=bN();function EN(t,e){if(t&&!(t instanceof Buffer))throw new TypeError(`${e}, if provided, must be a Buffer.`)}var gh=class{constructor(e){this.callCredentials=e||Bje.CallCredentials.createEmpty()}_getCallCredentials(){return this.callCredentials}static createSsl(e,r,s,n){var i;if(EN(e,"Root certificate"),EN(r,"Private key"),EN(s,"Certificate chain"),r&&!s)throw new Error("Private key must be given with accompanying certificate chain");if(!r&&s)throw new Error("Certificate chain must be given with accompanying private key");let o=(0,Fje.createSecureContext)({ca:(i=e??(0,v7.getDefaultRootsData)())!==null&&i!==void 0?i:void 0,key:r??void 0,cert:s??void 0,ciphers:v7.CIPHER_SUITES});return new yh(o,n??{})}static createFromSecureContext(e,r){return new yh(e,r??{})}static createInsecure(){return new Gg}};eE.ChannelCredentials=gh;var Gg=class extends gh{constructor(){super()}compose(e){throw new Error("Cannot compose insecure credentials")}_getConnectionOptions(){return null}_isSecure(){return!1}_equals(e){return e instanceof Gg}},yh=class extends gh{constructor(e,r){super(),this.secureContext=e,this.verifyOptions=r,this.connectionOptions={secureContext:e},r?.checkServerIdentity&&(this.connectionOptions.checkServerIdentity=r.checkServerIdentity)}compose(e){let r=this.callCredentials.compose(e);return new vh(this,r)}_getConnectionOptions(){return Object.assign({},this.connectionOptions)}_isSecure(){return!0}_equals(e){return this===e?!0:e instanceof yh?this.secureContext===e.secureContext&&this.verifyOptions.checkServerIdentity===e.verifyOptions.checkServerIdentity:!1}},vh=class extends gh{constructor(e,r){super(r),this.channelCredentials=e}compose(e){let r=this.callCredentials.compose(e);return new vh(this.channelCredentials,r)}_getConnectionOptions(){return this.channelCredentials._getConnectionOptions()}_isSecure(){return!0}_equals(e){return this===e?!0:e instanceof vh?this.channelCredentials._equals(e.channelCredentials)&&this.callCredentials._equals(e.callCredentials):!1}}});var Nc=m(Lr=>{"use strict";Object.defineProperty(Lr,"__esModule",{value:!0});Lr.selectLbConfigFromList=Lr.getDefaultConfig=Lr.parseLoadBalancingConfig=Lr.isLoadBalancerNameRegistered=Lr.createLoadBalancer=Lr.registerDefaultLoadBalancerType=Lr.registerLoadBalancerType=Lr.createChildChannelControlHelper=void 0;var zje=er(),Uje=ft();function Vje(t,e){var r,s,n,i,o,a,l,u,c,d;return{createSubchannel:(s=(r=e.createSubchannel)===null||r===void 0?void 0:r.bind(e))!==null&&s!==void 0?s:t.createSubchannel.bind(t),updateState:(i=(n=e.updateState)===null||n===void 0?void 0:n.bind(e))!==null&&i!==void 0?i:t.updateState.bind(t),requestReresolution:(a=(o=e.requestReresolution)===null||o===void 0?void 0:o.bind(e))!==null&&a!==void 0?a:t.requestReresolution.bind(t),addChannelzChild:(u=(l=e.addChannelzChild)===null||l===void 0?void 0:l.bind(e))!==null&&u!==void 0?u:t.addChannelzChild.bind(t),removeChannelzChild:(d=(c=e.removeChannelzChild)===null||c===void 0?void 0:c.bind(e))!==null&&d!==void 0?d:t.removeChannelzChild.bind(t)}}Lr.createChildChannelControlHelper=Vje;var zl={},Kg=null;function Hje(t,e,r){zl[t]={LoadBalancer:e,LoadBalancingConfig:r}}Lr.registerLoadBalancerType=Hje;function Gje(t){Kg=t}Lr.registerDefaultLoadBalancerType=Gje;function Kje(t,e,r){let s=t.getLoadBalancerName();return s in zl?new zl[s].LoadBalancer(e,r):null}Lr.createLoadBalancer=Kje;function Qje(t){return t in zl}Lr.isLoadBalancerNameRegistered=Qje;function _7(t){let e=Object.keys(t);if(e.length!==1)throw new Error("Provided load balancing config has multiple conflicting entries");let r=e[0];if(r in zl)try{return zl[r].LoadBalancingConfig.createFromJson(t[r])}catch(s){throw new Error(`${r}: ${s.message}`)}else throw new Error(`Unrecognized load balancing config name ${r}`)}Lr.parseLoadBalancingConfig=_7;function Wje(){if(!Kg)throw new Error("No default load balancer type registered");return new zl[Kg].LoadBalancingConfig}Lr.getDefaultConfig=Wje;function Zje(t,e=!1){for(let r of t)try{return _7(r)}catch(s){(0,zje.log)(Uje.LogVerbosity.DEBUG,"Config parsing failed with error",s.message);continue}return e&&Kg?new zl[Kg].LoadBalancingConfig:null}Lr.selectLbConfigFromList=Zje});var wN=m(Ul=>{"use strict";Object.defineProperty(Ul,"__esModule",{value:!0});Ul.extractAndSelectServiceConfig=Ul.validateServiceConfig=Ul.validateRetryThrottling=void 0;var Yje=require("os"),rE=ft(),sE=/^\d+(\.\d{1,9})?s$/,Jje="node";function Xje(t){if("service"in t&&t.service!==""){if(typeof t.service!="string")throw new Error(`Invalid method config name: invalid service: expected type string, got ${typeof t.service}`);if("method"in t&&t.method!==""){if(typeof t.method!="string")throw new Error(`Invalid method config name: invalid method: expected type string, got ${typeof t.service}`);return{service:t.service,method:t.method}}else return{service:t.service}}else{if("method"in t&&t.method!==void 0)throw new Error("Invalid method config name: method set with empty or unset service");return{}}}function e2e(t){if(!("maxAttempts"in t)||!Number.isInteger(t.maxAttempts)||t.maxAttempts<2)throw new Error("Invalid method config retry policy: maxAttempts must be an integer at least 2");if(!("initialBackoff"in t)||typeof t.initialBackoff!="string"||!sE.test(t.initialBackoff))throw new Error("Invalid method config retry policy: initialBackoff must be a string consisting of a positive integer followed by s");if(!("maxBackoff"in t)||typeof t.maxBackoff!="string"||!sE.test(t.maxBackoff))throw new Error("Invalid method config retry policy: maxBackoff must be a string consisting of a positive integer followed by s");if(!("backoffMultiplier"in t)||typeof t.backoffMultiplier!="number"||t.backoffMultiplier<=0)throw new Error("Invalid method config retry policy: backoffMultiplier must be a number greater than 0");if(!("retryableStatusCodes"in t&&Array.isArray(t.retryableStatusCodes)))throw new Error("Invalid method config retry policy: retryableStatusCodes is required");if(t.retryableStatusCodes.length===0)throw new Error("Invalid method config retry policy: retryableStatusCodes must be non-empty");for(let e of t.retryableStatusCodes)if(typeof e=="number"){if(!Object.values(rE.Status).includes(e))throw new Error("Invalid method config retry policy: retryableStatusCodes value not in status code range")}else if(typeof e=="string"){if(!Object.values(rE.Status).includes(e.toUpperCase()))throw new Error("Invalid method config retry policy: retryableStatusCodes value not a status code name")}else throw new Error("Invalid method config retry policy: retryableStatusCodes value must be a string or number");return{maxAttempts:t.maxAttempts,initialBackoff:t.initialBackoff,maxBackoff:t.maxBackoff,backoffMultiplier:t.backoffMultiplier,retryableStatusCodes:t.retryableStatusCodes}}function t2e(t){if(!("maxAttempts"in t)||!Number.isInteger(t.maxAttempts)||t.maxAttempts<2)throw new Error("Invalid method config hedging policy: maxAttempts must be an integer at least 2");if("hedgingDelay"in t&&(typeof t.hedgingDelay!="string"||!sE.test(t.hedgingDelay)))throw new Error("Invalid method config hedging policy: hedgingDelay must be a string consisting of a positive integer followed by s");if("nonFatalStatusCodes"in t&&Array.isArray(t.nonFatalStatusCodes))for(let r of t.nonFatalStatusCodes)if(typeof r=="number"){if(!Object.values(rE.Status).includes(r))throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value not in status code range")}else if(typeof r=="string"){if(!Object.values(rE.Status).includes(r.toUpperCase()))throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value not a status code name")}else throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value must be a string or number");let e={maxAttempts:t.maxAttempts};return t.hedgingDelay&&(e.hedgingDelay=t.hedgingDelay),t.nonFatalStatusCodes&&(e.nonFatalStatusCodes=t.nonFatalStatusCodes),e}function r2e(t){var e;let r={name:[]};if(!("name"in t)||!Array.isArray(t.name))throw new Error("Invalid method config: invalid name array");for(let s of t.name)r.name.push(Xje(s));if("waitForReady"in t){if(typeof t.waitForReady!="boolean")throw new Error("Invalid method config: invalid waitForReady");r.waitForReady=t.waitForReady}if("timeout"in t)if(typeof t.timeout=="object"){if(!("seconds"in t.timeout)||typeof t.timeout.seconds!="number")throw new Error("Invalid method config: invalid timeout.seconds");if(!("nanos"in t.timeout)||typeof t.timeout.nanos!="number")throw new Error("Invalid method config: invalid timeout.nanos");r.timeout=t.timeout}else if(typeof t.timeout=="string"&&sE.test(t.timeout)){let s=t.timeout.substring(0,t.timeout.length-1).split(".");r.timeout={seconds:s[0]|0,nanos:((e=s[1])!==null&&e!==void 0?e:0)|0}}else throw new Error("Invalid method config: invalid timeout");if("maxRequestBytes"in t){if(typeof t.maxRequestBytes!="number")throw new Error("Invalid method config: invalid maxRequestBytes");r.maxRequestBytes=t.maxRequestBytes}if("maxResponseBytes"in t){if(typeof t.maxResponseBytes!="number")throw new Error("Invalid method config: invalid maxRequestBytes");r.maxResponseBytes=t.maxResponseBytes}if("retryPolicy"in t){if("hedgingPolicy"in t)throw new Error("Invalid method config: retryPolicy and hedgingPolicy cannot both be specified");r.retryPolicy=e2e(t.retryPolicy)}else"hedgingPolicy"in t&&(r.hedgingPolicy=t2e(t.hedgingPolicy));return r}function S7(t){if(!("maxTokens"in t)||typeof t.maxTokens!="number"||t.maxTokens<=0||t.maxTokens>1e3)throw new Error("Invalid retryThrottling: maxTokens must be a number in (0, 1000]");if(!("tokenRatio"in t)||typeof t.tokenRatio!="number"||t.tokenRatio<=0)throw new Error("Invalid retryThrottling: tokenRatio must be a number greater than 0");return{maxTokens:+t.maxTokens.toFixed(3),tokenRatio:+t.tokenRatio.toFixed(3)}}Ul.validateRetryThrottling=S7;function s2e(t){if(!(typeof t=="object"&&t!==null))throw new Error(`Invalid loadBalancingConfig: unexpected type ${typeof t}`);let e=Object.keys(t);if(e.length>1)throw new Error(`Invalid loadBalancingConfig: unexpected multiple keys ${e}`);if(e.length===0)throw new Error("Invalid loadBalancingConfig: load balancing policy name required");return{[e[0]]:t[e[0]]}}function b7(t){let e={loadBalancingConfig:[],methodConfig:[]};if("loadBalancingPolicy"in t)if(typeof t.loadBalancingPolicy=="string")e.loadBalancingPolicy=t.loadBalancingPolicy;else throw new Error("Invalid service config: invalid loadBalancingPolicy");if("loadBalancingConfig"in t)if(Array.isArray(t.loadBalancingConfig))for(let s of t.loadBalancingConfig)e.loadBalancingConfig.push(s2e(s));else throw new Error("Invalid service config: invalid loadBalancingConfig");if("methodConfig"in t&&Array.isArray(t.methodConfig))for(let s of t.methodConfig)e.methodConfig.push(r2e(s));"retryThrottling"in t&&(e.retryThrottling=S7(t.retryThrottling));let r=[];for(let s of e.methodConfig)for(let n of s.name){for(let i of r)if(n.service===i.service&&n.method===i.method)throw new Error(`Invalid service config: duplicate name ${n.service}/${n.method}`);r.push(n)}return e}Ul.validateServiceConfig=b7;function n2e(t){if(!("serviceConfig"in t))throw new Error("Invalid service config choice: missing service config");let e={serviceConfig:b7(t.serviceConfig)};if("clientLanguage"in t)if(Array.isArray(t.clientLanguage)){e.clientLanguage=[];for(let s of t.clientLanguage)if(typeof s=="string")e.clientLanguage.push(s);else throw new Error("Invalid service config choice: invalid clientLanguage")}else throw new Error("Invalid service config choice: invalid clientLanguage");if("clientHostname"in t)if(Array.isArray(t.clientHostname)){e.clientHostname=[];for(let s of t.clientHostname)if(typeof s=="string")e.clientHostname.push(s);else throw new Error("Invalid service config choice: invalid clientHostname")}else throw new Error("Invalid service config choice: invalid clientHostname");if("percentage"in t)if(typeof t.percentage=="number"&&0<=t.percentage&&t.percentage<=100)e.percentage=t.percentage;else throw new Error("Invalid service config choice: invalid percentage");let r=["clientLanguage","percentage","clientHostname","serviceConfig"];for(let s in t)if(!r.includes(s))throw new Error(`Invalid service config choice: unexpected field ${s}`);return e}function i2e(t,e){if(!Array.isArray(t))throw new Error("Invalid service config list");for(let r of t){let s=n2e(r);if(!(typeof s.percentage=="number"&&e>s.percentage)){if(Array.isArray(s.clientHostname)){let n=!1;for(let i of s.clientHostname)i===Yje.hostname()&&(n=!0);if(!n)continue}if(Array.isArray(s.clientLanguage)){let n=!1;for(let i of s.clientLanguage)i===Jje&&(n=!0);if(!n)continue}return s.serviceConfig}}throw new Error("No matching service config found")}function o2e(t,e){for(let r of t)if(r.length>0&&r[0].startsWith("grpc_config=")){let s=r.join("").substring(12),n=JSON.parse(s);return i2e(n,e)}return null}Ul.extractAndSelectServiceConfig=o2e});var Qn=m(nE=>{"use strict";Object.defineProperty(nE,"__esModule",{value:!0});nE.ConnectivityState=void 0;var E7;(function(t){t[t.IDLE=0]="IDLE",t[t.CONNECTING=1]="CONNECTING",t[t.READY=2]="READY",t[t.TRANSIENT_FAILURE=3]="TRANSIENT_FAILURE",t[t.SHUTDOWN=4]="SHUTDOWN"})(E7||(nE.ConnectivityState=E7={}))});var hn=m(bo=>{"use strict";Object.defineProperty(bo,"__esModule",{value:!0});bo.uriToString=bo.combineHostPort=bo.splitHostPort=bo.parseUri=void 0;var a2e=/^(?:([A-Za-z0-9+.-]+):)?(?:\/\/([^/]*)\/)?(.+)$/;function l2e(t){let e=a2e.exec(t);return e===null?null:{scheme:e[1],authority:e[2],path:e[3]}}bo.parseUri=l2e;var w7=/^\d+$/;function u2e(t){if(t.startsWith("[")){let e=t.indexOf("]");if(e===-1)return null;let r=t.substring(1,e);if(r.indexOf(":")===-1)return null;if(t.length>e+1)if(t[e+1]===":"){let s=t.substring(e+2);return w7.test(s)?{host:r,port:+s}:null}else return null;else return{host:r}}else{let e=t.split(":");return e.length===2?w7.test(e[1])?{host:e[0],port:+e[1]}:null:{host:t}}}bo.splitHostPort=u2e;function c2e(t){return t.port===void 0?t.host:t.host.includes(":")?`[${t.host}]:${t.port}`:`${t.host}:${t.port}`}bo.combineHostPort=c2e;function d2e(t){let e="";return t.scheme!==void 0&&(e+=t.scheme+":"),t.authority!==void 0&&(e+="//"+t.authority+"/"),e+=t.path,e}bo.uriToString=d2e});var Eo=m(Wn=>{"use strict";Object.defineProperty(Wn,"__esModule",{value:!0});Wn.mapUriDefaultScheme=Wn.getDefaultAuthority=Wn.createResolver=Wn.registerDefaultScheme=Wn.registerResolver=void 0;var CN=hn(),_h={},TN=null;function f2e(t,e){_h[t]=e}Wn.registerResolver=f2e;function h2e(t){TN=t}Wn.registerDefaultScheme=h2e;function p2e(t,e,r){if(t.scheme!==void 0&&t.scheme in _h)return new _h[t.scheme](t,e,r);throw new Error(`No resolver could be created for target ${(0,CN.uriToString)(t)}`)}Wn.createResolver=p2e;function m2e(t){if(t.scheme!==void 0&&t.scheme in _h)return _h[t.scheme].getDefaultAuthority(t);throw new Error(`Invalid target ${(0,CN.uriToString)(t)}`)}Wn.getDefaultAuthority=m2e;function g2e(t){return t.scheme===void 0||!(t.scheme in _h)?TN!==null?{scheme:TN,authority:void 0,path:(0,CN.uriToString)(t)}:null:t}Wn.mapUriDefaultScheme=g2e});var Hl=m(Vl=>{"use strict";Object.defineProperty(Vl,"__esModule",{value:!0});Vl.QueuePicker=Vl.UnavailablePicker=Vl.PickResultType=void 0;var y2e=As(),v2e=ft(),iE;(function(t){t[t.COMPLETE=0]="COMPLETE",t[t.QUEUE=1]="QUEUE",t[t.TRANSIENT_FAILURE=2]="TRANSIENT_FAILURE",t[t.DROP=3]="DROP"})(iE||(Vl.PickResultType=iE={}));var RN=class{constructor(e){this.status=Object.assign({code:v2e.Status.UNAVAILABLE,details:"No connection established",metadata:new y2e.Metadata},e)}pick(e){return{pickResultType:iE.TRANSIENT_FAILURE,subchannel:null,status:this.status,onCallStarted:null,onCallEnded:null}}};Vl.UnavailablePicker=RN;var ON=class{constructor(e,r){this.loadBalancer=e,this.childPicker=r,this.calledExitIdle=!1}pick(e){return this.calledExitIdle||(process.nextTick(()=>{this.loadBalancer.exitIdle()}),this.calledExitIdle=!0),this.childPicker?this.childPicker.pick(e):{pickResultType:iE.QUEUE,subchannel:null,status:null,onCallStarted:null,onCallEnded:null}}};Vl.QueuePicker=ON});var Qg=m(oE=>{"use strict";Object.defineProperty(oE,"__esModule",{value:!0});oE.BackoffTimeout=void 0;var _2e=1e3,S2e=1.6,b2e=12e4,E2e=.2;function w2e(t,e){return Math.random()*(e-t)+t}var PN=class{constructor(e,r){this.callback=e,this.initialDelay=_2e,this.multiplier=S2e,this.maxDelay=b2e,this.jitter=E2e,this.running=!1,this.hasRef=!0,this.startTime=new Date,this.endTime=new Date,r&&(r.initialDelay&&(this.initialDelay=r.initialDelay),r.multiplier&&(this.multiplier=r.multiplier),r.jitter&&(this.jitter=r.jitter),r.maxDelay&&(this.maxDelay=r.maxDelay)),this.nextDelay=this.initialDelay,this.timerId=setTimeout(()=>{},0),clearTimeout(this.timerId)}runTimer(e){var r,s;this.endTime=this.startTime,this.endTime.setMilliseconds(this.endTime.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.callback(),this.running=!1},e),this.hasRef||(s=(r=this.timerId).unref)===null||s===void 0||s.call(r)}runOnce(){this.running=!0,this.startTime=new Date,this.runTimer(this.nextDelay);let e=Math.min(this.nextDelay*this.multiplier,this.maxDelay),r=e*this.jitter;this.nextDelay=e+w2e(-r,r)}stop(){clearTimeout(this.timerId),this.running=!1}reset(){if(this.nextDelay=this.initialDelay,this.running){let e=new Date,r=this.startTime;r.setMilliseconds(r.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),e<r?this.runTimer(r.getTime()-e.getTime()):this.running=!1}}isRunning(){return this.running}ref(){var e,r;this.hasRef=!0,(r=(e=this.timerId).ref)===null||r===void 0||r.call(e)}unref(){var e,r;this.hasRef=!1,(r=(e=this.timerId).unref)===null||r===void 0||r.call(e)}getEndTime(){return this.endTime}};oE.BackoffTimeout=PN});var lE=m(aE=>{"use strict";Object.defineProperty(aE,"__esModule",{value:!0});aE.ChildLoadBalancerHandler=void 0;var T2e=Nc(),C2e=Qn(),R2e="child_load_balancer_helper",AN=class{constructor(e,r){this.channelControlHelper=e,this.options=r,this.currentChild=null,this.pendingChild=null,this.latestConfig=null,this.ChildPolicyHelper=class{constructor(s){this.parent=s,this.child=null}createSubchannel(s,n){return this.parent.channelControlHelper.createSubchannel(s,n)}updateState(s,n){var i;if(this.calledByPendingChild()){if(s===C2e.ConnectivityState.CONNECTING)return;(i=this.parent.currentChild)===null||i===void 0||i.destroy(),this.parent.currentChild=this.parent.pendingChild,this.parent.pendingChild=null}else if(!this.calledByCurrentChild())return;this.parent.channelControlHelper.updateState(s,n)}requestReresolution(){var s;let n=(s=this.parent.pendingChild)!==null&&s!==void 0?s:this.parent.currentChild;this.child===n&&this.parent.channelControlHelper.requestReresolution()}setChild(s){this.child=s}addChannelzChild(s){this.parent.channelControlHelper.addChannelzChild(s)}removeChannelzChild(s){this.parent.channelControlHelper.removeChannelzChild(s)}calledByPendingChild(){return this.child===this.parent.pendingChild}calledByCurrentChild(){return this.child===this.parent.currentChild}}}configUpdateRequiresNewPolicyInstance(e,r){return e.getLoadBalancerName()!==r.getLoadBalancerName()}updateAddressList(e,r,s){let n;if(this.currentChild===null||this.latestConfig===null||this.configUpdateRequiresNewPolicyInstance(this.latestConfig,r)){let i=new this.ChildPolicyHelper(this),o=(0,T2e.createLoadBalancer)(r,i,this.options);i.setChild(o),this.currentChild===null?(this.currentChild=o,n=this.currentChild):(this.pendingChild&&this.pendingChild.destroy(),this.pendingChild=o,n=this.pendingChild)}else this.pendingChild===null?n=this.currentChild:n=this.pendingChild;this.latestConfig=r,n.updateAddressList(e,r,s)}exitIdle(){this.currentChild&&(this.currentChild.exitIdle(),this.pendingChild&&this.pendingChild.exitIdle())}resetBackoff(){this.currentChild&&(this.currentChild.resetBackoff(),this.pendingChild&&this.pendingChild.resetBackoff())}destroy(){this.currentChild&&(this.currentChild.destroy(),this.currentChild=null),this.pendingChild&&(this.pendingChild.destroy(),this.pendingChild=null)}getTypeName(){return R2e}};aE.ChildLoadBalancerHandler=AN});var C7=m(uE=>{"use strict";Object.defineProperty(uE,"__esModule",{value:!0});uE.ResolvingLoadBalancer=void 0;var O2e=Nc(),P2e=wN(),Hs=Qn(),A2e=Eo(),Wg=Hl(),k2e=Qg(),kN=ft(),x2e=As(),I2e=er(),N2e=ft(),D2e=hn(),M2e=lE(),$2e="resolving_load_balancer";function T7(t){I2e.trace(N2e.LogVerbosity.DEBUG,$2e,t)}var q2e=["SERVICE_AND_METHOD","SERVICE","EMPTY"];function L2e(t,e,r,s){for(let n of r.name)switch(s){case"EMPTY":if(!n.service&&!n.method)return!0;break;case"SERVICE":if(n.service===t&&!n.method)return!0;break;case"SERVICE_AND_METHOD":if(n.service===t&&n.method===e)return!0}return!1}function j2e(t,e,r,s){for(let n of r)if(L2e(t,e,n,s))return n;return null}function F2e(t){return function(r,s){var n,i;let o=r.split("/").filter(u=>u.length>0),a=(n=o[0])!==null&&n!==void 0?n:"",l=(i=o[1])!==null&&i!==void 0?i:"";if(t&&t.methodConfig)for(let u of q2e){let c=j2e(a,l,t.methodConfig,u);if(c)return{methodConfig:c,pickInformation:{},status:kN.Status.OK,dynamicFilterFactories:[]}}return{methodConfig:{name:[]},pickInformation:{},status:kN.Status.OK,dynamicFilterFactories:[]}}}var xN=class{constructor(e,r,s,n,i){this.target=e,this.channelControlHelper=r,this.onSuccessfulResolution=n,this.onFailedResolution=i,this.latestChildState=Hs.ConnectivityState.IDLE,this.latestChildPicker=new Wg.QueuePicker(this),this.currentState=Hs.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1,s["grpc.service_config"]?this.defaultServiceConfig=(0,P2e.validateServiceConfig)(JSON.parse(s["grpc.service_config"])):this.defaultServiceConfig={loadBalancingConfig:[],methodConfig:[]},this.updateState(Hs.ConnectivityState.IDLE,new Wg.QueuePicker(this)),this.childLoadBalancer=new M2e.ChildLoadBalancerHandler({createSubchannel:r.createSubchannel.bind(r),requestReresolution:()=>{this.backoffTimeout.isRunning()?(T7("requestReresolution delayed by backoff timer until "+this.backoffTimeout.getEndTime().toISOString()),this.continueResolving=!0):this.updateResolution()},updateState:(a,l)=>{this.latestChildState=a,this.latestChildPicker=l,this.updateState(a,l)},addChannelzChild:r.addChannelzChild.bind(r),removeChannelzChild:r.removeChannelzChild.bind(r)},s),this.innerResolver=(0,A2e.createResolver)(e,{onSuccessfulResolution:(a,l,u,c,d)=>{var f;this.backoffTimeout.stop(),this.backoffTimeout.reset();let h=null;l===null?u===null?(this.previousServiceConfig=null,h=this.defaultServiceConfig):this.previousServiceConfig===null?this.handleResolutionFailure(u):h=this.previousServiceConfig:(h=l,this.previousServiceConfig=l);let p=(f=h?.loadBalancingConfig)!==null&&f!==void 0?f:[],g=(0,O2e.selectLbConfigFromList)(p,!0);if(g===null){this.handleResolutionFailure({code:kN.Status.UNAVAILABLE,details:"All load balancer options in service config are not compatible",metadata:new x2e.Metadata});return}this.childLoadBalancer.updateAddressList(a,g,d);let _=h??this.defaultServiceConfig;this.onSuccessfulResolution(_,c??F2e(_))},onError:a=>{this.handleResolutionFailure(a)}},s);let o={initialDelay:s["grpc.initial_reconnect_backoff_ms"],maxDelay:s["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new k2e.BackoffTimeout(()=>{this.continueResolving?(this.updateResolution(),this.continueResolving=!1):this.updateState(this.latestChildState,this.latestChildPicker)},o),this.backoffTimeout.unref()}updateResolution(){this.innerResolver.updateResolution(),this.currentState===Hs.ConnectivityState.IDLE&&this.updateState(Hs.ConnectivityState.CONNECTING,this.latestChildPicker),this.backoffTimeout.runOnce()}updateState(e,r){T7((0,D2e.uriToString)(this.target)+" "+Hs.ConnectivityState[this.currentState]+" -> "+Hs.ConnectivityState[e]),e===Hs.ConnectivityState.IDLE&&(r=new Wg.QueuePicker(this,r)),this.currentState=e,this.channelControlHelper.updateState(e,r)}handleResolutionFailure(e){this.latestChildState===Hs.ConnectivityState.IDLE&&(this.updateState(Hs.ConnectivityState.TRANSIENT_FAILURE,new Wg.UnavailablePicker(e)),this.onFailedResolution(e))}exitIdle(){(this.currentState===Hs.ConnectivityState.IDLE||this.currentState===Hs.ConnectivityState.TRANSIENT_FAILURE)&&(this.backoffTimeout.isRunning()?this.continueResolving=!0:this.updateResolution()),this.childLoadBalancer.exitIdle()}updateAddressList(e,r){throw new Error("updateAddressList not supported on ResolvingLoadBalancer")}resetBackoff(){this.backoffTimeout.reset(),this.childLoadBalancer.resetBackoff()}destroy(){this.childLoadBalancer.destroy(),this.innerResolver.destroy(),this.backoffTimeout.reset(),this.backoffTimeout.stop(),this.latestChildState=Hs.ConnectivityState.IDLE,this.latestChildPicker=new Wg.QueuePicker(this),this.currentState=Hs.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1}getTypeName(){return"resolving_load_balancer"}};uE.ResolvingLoadBalancer=xN});var R7=m(Sh=>{"use strict";Object.defineProperty(Sh,"__esModule",{value:!0});Sh.channelOptionsEqual=Sh.recognizedOptions=void 0;Sh.recognizedOptions={"grpc.ssl_target_name_override":!0,"grpc.primary_user_agent":!0,"grpc.secondary_user_agent":!0,"grpc.default_authority":!0,"grpc.keepalive_time_ms":!0,"grpc.keepalive_timeout_ms":!0,"grpc.keepalive_permit_without_calls":!0,"grpc.service_config":!0,"grpc.max_concurrent_streams":!0,"grpc.initial_reconnect_backoff_ms":!0,"grpc.max_reconnect_backoff_ms":!0,"grpc.use_local_subchannel_pool":!0,"grpc.max_send_message_length":!0,"grpc.max_receive_message_length":!0,"grpc.enable_http_proxy":!0,"grpc.enable_channelz":!0,"grpc.dns_min_time_between_resolutions_ms":!0,"grpc.enable_retries":!0,"grpc.per_rpc_retry_buffer_size":!0,"grpc.retry_buffer_size":!0,"grpc.max_connection_age_ms":!0,"grpc.max_connection_age_grace_ms":!0,"grpc-node.max_session_memory":!0,"grpc.service_config_disable_resolution":!0,"grpc.client_idle_timeout_ms":!0,"grpc-node.tls_enable_trace":!0,"grpc.lb.ring_hash.ring_size_cap":!0};function B2e(t,e){let r=Object.keys(t).sort(),s=Object.keys(e).sort();if(r.length!==s.length)return!1;for(let n=0;n<r.length;n+=1)if(r[n]!==s[n]||t[r[n]]!==e[s[n]])return!1;return!0}Sh.channelOptionsEqual=B2e});var Ai=m(jr=>{"use strict";Object.defineProperty(jr,"__esModule",{value:!0});jr.EndpointMap=jr.endpointHasAddress=jr.endpointToString=jr.endpointEqual=jr.stringToSubchannelAddress=jr.subchannelAddressToString=jr.subchannelAddressEqual=jr.isTcpSubchannelAddress=void 0;var O7=require("net");function Yg(t){return"port"in t}jr.isTcpSubchannelAddress=Yg;function cE(t,e){return!t&&!e?!0:!t||!e?!1:Yg(t)?Yg(e)&&t.host===e.host&&t.port===e.port:!Yg(e)&&t.path===e.path}jr.subchannelAddressEqual=cE;function P7(t){return Yg(t)?(0,O7.isIPv6)(t.host)?"["+t.host+"]:"+t.port:t.host+":"+t.port:t.path}jr.subchannelAddressToString=P7;var z2e=443;function U2e(t,e){return(0,O7.isIP)(t)?{host:t,port:e??z2e}:{path:t}}jr.stringToSubchannelAddress=U2e;function V2e(t,e){if(t.addresses.length!==e.addresses.length)return!1;for(let r=0;r<t.addresses.length;r++)if(!cE(t.addresses[r],e.addresses[r]))return!1;return!0}jr.endpointEqual=V2e;function H2e(t){return"["+t.addresses.map(P7).join(", ")+"]"}jr.endpointToString=H2e;function A7(t,e){for(let r of t.addresses)if(cE(r,e))return!0;return!1}jr.endpointHasAddress=A7;function Zg(t,e){if(t.addresses.length!==e.addresses.length)return!1;for(let r of t.addresses){let s=!1;for(let n of e.addresses)if(cE(r,n)){s=!0;break}if(!s)return!1}return!0}var IN=class{constructor(){this.map=new Set}get size(){return this.map.size}getForSubchannelAddress(e){for(let r of this.map)if(A7(r.key,e))return r.value}deleteMissing(e){let r=[];for(let s of this.map){let n=!1;for(let i of e)Zg(i,s.key)&&(n=!0);n||(r.push(s.value),this.map.delete(s))}return r}get(e){for(let r of this.map)if(Zg(e,r.key))return r.value}set(e,r){for(let s of this.map)if(Zg(e,s.key)){s.value=r;return}this.map.add({key:e,value:r})}delete(e){for(let r of this.map)if(Zg(e,r.key)){this.map.delete(r);return}}has(e){for(let r of this.map)if(Zg(e,r.key))return!0;return!1}clear(){this.map.clear()}*keys(){for(let e of this.map)yield e.key}*values(){for(let e of this.map)yield e.value}*entries(){for(let e of this.map)yield[e.key,e.value]}};jr.EndpointMap=IN});var k7=m(FN=>{"use strict";Object.defineProperty(FN,"t",{value:!0});var dE=class{constructor(e,r,s=1){this.i=void 0,this.h=void 0,this.o=void 0,this.u=e,this.l=r,this.p=s}I(){let e=this,r=e.o.o===e;if(r&&e.p===1)e=e.h;else if(e.i)for(e=e.i;e.h;)e=e.h;else{if(r)return e.o;let s=e.o;for(;s.i===e;)e=s,s=e.o;e=s}return e}B(){let e=this;if(e.h){for(e=e.h;e.i;)e=e.i;return e}else{let r=e.o;for(;r.h===e;)e=r,r=e.o;return e.h!==r?r:e}}_(){let e=this.o,r=this.h,s=r.i;return e.o===this?e.o=r:e.i===this?e.i=r:e.h=r,r.o=e,r.i=this,this.o=r,this.h=s,s&&(s.o=this),r}g(){let e=this.o,r=this.i,s=r.h;return e.o===this?e.o=r:e.i===this?e.i=r:e.h=r,r.o=e,r.h=this,this.o=r,this.i=s,s&&(s.o=this),r}},NN=class extends dE{constructor(){super(...arguments),this.M=1}_(){let e=super._();return this.O(),e.O(),e}g(){let e=super.g();return this.O(),e.O(),e}O(){this.M=1,this.i&&(this.M+=this.i.M),this.h&&(this.M+=this.h.M)}},DN=class{constructor(e=0){this.iteratorType=e}equals(e){return this.T===e.T}},MN=class{constructor(){this.m=0}get length(){return this.m}size(){return this.m}empty(){return this.m===0}},$N=class extends MN{};function Dc(){throw new RangeError("Iterator access denied!")}var qN=class extends $N{constructor(e=function(s,n){return s<n?-1:s>n?1:0},r=!1){super(),this.v=void 0,this.A=e,this.enableIndex=r,this.N=r?NN:dE,this.C=new this.N}R(e,r){let s=this.C;for(;e;){let n=this.A(e.u,r);if(n<0)e=e.h;else if(n>0)s=e,e=e.i;else return e}return s}K(e,r){let s=this.C;for(;e;)this.A(e.u,r)<=0?e=e.h:(s=e,e=e.i);return s}L(e,r){let s=this.C;for(;e;){let n=this.A(e.u,r);if(n<0)s=e,e=e.h;else if(n>0)e=e.i;else return e}return s}k(e,r){let s=this.C;for(;e;)this.A(e.u,r)<0?(s=e,e=e.h):e=e.i;return s}P(e){for(;;){let r=e.o;if(r===this.C)return;if(e.p===1){e.p=0;return}if(e===r.i){let s=r.h;if(s.p===1)s.p=0,r.p=1,r===this.v?this.v=r._():r._();else if(s.h&&s.h.p===1){s.p=r.p,r.p=0,s.h.p=0,r===this.v?this.v=r._():r._();return}else s.i&&s.i.p===1?(s.p=1,s.i.p=0,s.g()):(s.p=1,e=r)}else{let s=r.i;if(s.p===1)s.p=0,r.p=1,r===this.v?this.v=r.g():r.g();else if(s.i&&s.i.p===1){s.p=r.p,r.p=0,s.i.p=0,r===this.v?this.v=r.g():r.g();return}else s.h&&s.h.p===1?(s.p=1,s.h.p=0,s._()):(s.p=1,e=r)}}}S(e){if(this.m===1){this.clear();return}let r=e;for(;r.i||r.h;){if(r.h)for(r=r.h;r.i;)r=r.i;else r=r.i;let n=e.u;e.u=r.u,r.u=n;let i=e.l;e.l=r.l,r.l=i,e=r}this.C.i===r?this.C.i=r.o:this.C.h===r&&(this.C.h=r.o),this.P(r);let s=r.o;if(r===s.i?s.i=void 0:s.h=void 0,this.m-=1,this.v.p=0,this.enableIndex)for(;s!==this.C;)s.M-=1,s=s.o}U(e){let r=typeof e=="number"?e:void 0,s=typeof e=="function"?e:void 0,n=typeof e>"u"?[]:void 0,i=0,o=this.v,a=[];for(;a.length||o;)if(o)a.push(o),o=o.i;else{if(o=a.pop(),i===r)return o;n&&n.push(o),s&&s(o,i,this),i+=1,o=o.h}return n}j(e){for(;;){let r=e.o;if(r.p===0)return;let s=r.o;if(r===s.i){let n=s.h;if(n&&n.p===1){if(n.p=r.p=0,s===this.v)return;s.p=1,e=s;continue}else if(e===r.h){if(e.p=0,e.i&&(e.i.o=r),e.h&&(e.h.o=s),r.h=e.i,s.i=e.h,e.i=r,e.h=s,s===this.v)this.v=e,this.C.o=e;else{let i=s.o;i.i===s?i.i=e:i.h=e}e.o=s.o,r.o=e,s.o=e,s.p=1}else{r.p=0,s===this.v?this.v=s.g():s.g(),s.p=1;return}}else{let n=s.i;if(n&&n.p===1){if(n.p=r.p=0,s===this.v)return;s.p=1,e=s;continue}else if(e===r.i){if(e.p=0,e.i&&(e.i.o=s),e.h&&(e.h.o=r),s.h=e.i,r.i=e.h,e.i=s,e.h=r,s===this.v)this.v=e,this.C.o=e;else{let i=s.o;i.i===s?i.i=e:i.h=e}e.o=s.o,r.o=e,s.o=e,s.p=1}else{r.p=0,s===this.v?this.v=s._():s._(),s.p=1;return}}this.enableIndex&&(r.O(),s.O(),e.O());return}}q(e,r,s){if(this.v===void 0)return this.m+=1,this.v=new this.N(e,r,0),this.v.o=this.C,this.C.o=this.C.i=this.C.h=this.v,this.m;let n,i=this.C.i,o=this.A(i.u,e);if(o===0)return i.l=r,this.m;if(o>0)i.i=new this.N(e,r),i.i.o=i,n=i.i,this.C.i=n;else{let a=this.C.h,l=this.A(a.u,e);if(l===0)return a.l=r,this.m;if(l<0)a.h=new this.N(e,r),a.h.o=a,n=a.h,this.C.h=n;else{if(s!==void 0){let u=s.T;if(u!==this.C){let c=this.A(u.u,e);if(c===0)return u.l=r,this.m;if(c>0){let d=u.I(),f=this.A(d.u,e);if(f===0)return d.l=r,this.m;f<0&&(n=new this.N(e,r),d.h===void 0?(d.h=n,n.o=d):(u.i=n,n.o=u))}}}if(n===void 0)for(n=this.v;;){let u=this.A(n.u,e);if(u>0){if(n.i===void 0){n.i=new this.N(e,r),n.i.o=n,n=n.i;break}n=n.i}else if(u<0){if(n.h===void 0){n.h=new this.N(e,r),n.h.o=n,n=n.h;break}n=n.h}else return n.l=r,this.m}}}if(this.enableIndex){let a=n.o;for(;a!==this.C;)a.M+=1,a=a.o}return this.j(n),this.m+=1,this.m}H(e,r){for(;e;){let s=this.A(e.u,r);if(s<0)e=e.h;else if(s>0)e=e.i;else return e}return e||this.C}clear(){this.m=0,this.v=void 0,this.C.o=void 0,this.C.i=this.C.h=void 0}updateKeyByIterator(e,r){let s=e.T;if(s===this.C&&Dc(),this.m===1)return s.u=r,!0;let n=s.B().u;if(s===this.C.i)return this.A(n,r)>0?(s.u=r,!0):!1;let i=s.I().u;return s===this.C.h?this.A(i,r)<0?(s.u=r,!0):!1:this.A(i,r)>=0||this.A(n,r)<=0?!1:(s.u=r,!0)}eraseElementByPos(e){if(e<0||e>this.m-1)throw new RangeError;let r=this.U(e);return this.S(r),this.m}eraseElementByKey(e){if(this.m===0)return!1;let r=this.H(this.v,e);return r===this.C?!1:(this.S(r),!0)}eraseElementByIterator(e){let r=e.T;r===this.C&&Dc();let s=r.h===void 0;return e.iteratorType===0?s&&e.next():(!s||r.i===void 0)&&e.next(),this.S(r),e}getHeight(){if(this.m===0)return 0;function e(r){return r?Math.max(e(r.i),e(r.h))+1:0}return e(this.v)}},LN=class extends DN{constructor(e,r,s){super(s),this.T=e,this.C=r,this.iteratorType===0?(this.pre=function(){return this.T===this.C.i&&Dc(),this.T=this.T.I(),this},this.next=function(){return this.T===this.C&&Dc(),this.T=this.T.B(),this}):(this.pre=function(){return this.T===this.C.h&&Dc(),this.T=this.T.B(),this},this.next=function(){return this.T===this.C&&Dc(),this.T=this.T.I(),this})}get index(){let e=this.T,r=this.C.o;if(e===this.C)return r?r.M-1:0;let s=0;for(e.i&&(s+=e.i.M);e!==r;){let n=e.o;e===n.h&&(s+=1,n.i&&(s+=n.i.M)),e=n}return s}isAccessible(){return this.T!==this.C}},pn=class extends LN{constructor(e,r,s,n){super(e,r,n),this.container=s}get pointer(){this.T===this.C&&Dc();let e=this;return new Proxy([],{get(r,s){return s==="0"?e.T.u:s==="1"?e.T.l:(r[0]=e.T.u,r[1]=e.T.l,r[s])},set(r,s,n){if(s!=="1")throw new TypeError("prop must be 1");return e.T.l=n,!0}})}copy(){return new pn(this.T,this.C,this.container,this.iteratorType)}},jN=class extends qN{constructor(e=[],r,s){super(r,s);let n=this;e.forEach(function(i){n.setElement(i[0],i[1])})}begin(){return new pn(this.C.i||this.C,this.C,this)}end(){return new pn(this.C,this.C,this)}rBegin(){return new pn(this.C.h||this.C,this.C,this,1)}rEnd(){return new pn(this.C,this.C,this,1)}front(){if(this.m===0)return;let e=this.C.i;return[e.u,e.l]}back(){if(this.m===0)return;let e=this.C.h;return[e.u,e.l]}lowerBound(e){let r=this.R(this.v,e);return new pn(r,this.C,this)}upperBound(e){let r=this.K(this.v,e);return new pn(r,this.C,this)}reverseLowerBound(e){let r=this.L(this.v,e);return new pn(r,this.C,this)}reverseUpperBound(e){let r=this.k(this.v,e);return new pn(r,this.C,this)}forEach(e){this.U(function(r,s,n){e([r.u,r.l],s,n)})}setElement(e,r,s){return this.q(e,r,s)}getElementByPos(e){if(e<0||e>this.m-1)throw new RangeError;let r=this.U(e);return[r.u,r.l]}find(e){let r=this.H(this.v,e);return new pn(r,this.C,this)}getElementByKey(e){return this.H(this.v,e).l}union(e){let r=this;return e.forEach(function(s){r.setElement(s[0],s[1])}),this.m}*[Symbol.iterator](){let e=this.m,r=this.U();for(let s=0;s<e;++s){let n=r[s];yield[n.u,n.l]}}};FN.OrderedMap=jN});var fE=m(bh=>{"use strict";Object.defineProperty(bh,"__esModule",{value:!0});bh.addAdminServicesToServer=bh.registerAdminService=void 0;var x7=[];function G2e(t,e){x7.push({getServiceDefinition:t,getHandlers:e})}bh.registerAdminService=G2e;function K2e(t){for(let{getServiceDefinition:e,getHandlers:r}of x7)t.addService(e(),r())}bh.addAdminServicesToServer=K2e});var I7=m(Zn=>{"use strict";Object.defineProperty(Zn,"__esModule",{value:!0});Zn.ClientDuplexStreamImpl=Zn.ClientWritableStreamImpl=Zn.ClientReadableStreamImpl=Zn.ClientUnaryCallImpl=Zn.callErrorFromStatus=void 0;var Q2e=require("events"),HN=require("stream"),Jg=ft();function W2e(t,e){let r=`${t.code} ${Jg.Status[t.code]}: ${t.details}`,n=`${new Error(r).stack}
for call at
${e}`;return Object.assign(new Error(r),t,{stack:n})}Zn.callErrorFromStatus=W2e;var BN=class extends Q2e.EventEmitter{constructor(){super()}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(Jg.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,r;return(r=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&r!==void 0?r:"unknown"}};Zn.ClientUnaryCallImpl=BN;var zN=class extends HN.Readable{constructor(e){super({objectMode:!0}),this.deserialize=e}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(Jg.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,r;return(r=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&r!==void 0?r:"unknown"}_read(e){var r;(r=this.call)===null||r===void 0||r.startRead()}};Zn.ClientReadableStreamImpl=zN;var UN=class extends HN.Writable{constructor(e){super({objectMode:!0}),this.serialize=e}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(Jg.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,r;return(r=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&r!==void 0?r:"unknown"}_write(e,r,s){var n;let i={callback:s},o=Number(r);Number.isNaN(o)||(i.flags=o),(n=this.call)===null||n===void 0||n.sendMessageWithContext(i,e)}_final(e){var r;(r=this.call)===null||r===void 0||r.halfClose(),e()}};Zn.ClientWritableStreamImpl=UN;var VN=class extends HN.Duplex{constructor(e,r){super({objectMode:!0}),this.serialize=e,this.deserialize=r}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(Jg.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,r;return(r=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&r!==void 0?r:"unknown"}_read(e){var r;(r=this.call)===null||r===void 0||r.startRead()}_write(e,r,s){var n;let i={callback:s},o=Number(r);Number.isNaN(o)||(i.flags=o),(n=this.call)===null||n===void 0||n.sendMessageWithContext(i,e)}_final(e){var r;(r=this.call)===null||r===void 0||r.halfClose(),e()}};Zn.ClientDuplexStreamImpl=VN});var N7=m(Eh=>{"use strict";Object.defineProperty(Eh,"__esModule",{value:!0});Eh.InterceptingListenerImpl=Eh.isInterceptingListener=void 0;function Z2e(t){return t.onReceiveMetadata!==void 0&&t.onReceiveMetadata.length===1}Eh.isInterceptingListener=Z2e;var GN=class{constructor(e,r){this.listener=e,this.nextListener=r,this.processingMetadata=!1,this.hasPendingMessage=!1,this.processingMessage=!1,this.pendingStatus=null}processPendingMessage(){this.hasPendingMessage&&(this.nextListener.onReceiveMessage(this.pendingMessage),this.pendingMessage=null,this.hasPendingMessage=!1)}processPendingStatus(){this.pendingStatus&&this.nextListener.onReceiveStatus(this.pendingStatus)}onReceiveMetadata(e){this.processingMetadata=!0,this.listener.onReceiveMetadata(e,r=>{this.processingMetadata=!1,this.nextListener.onReceiveMetadata(r),this.processPendingMessage(),this.processPendingStatus()})}onReceiveMessage(e){this.processingMessage=!0,this.listener.onReceiveMessage(e,r=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessage=r,this.hasPendingMessage=!0):(this.nextListener.onReceiveMessage(r),this.processPendingStatus())})}onReceiveStatus(e){this.listener.onReceiveStatus(e,r=>{this.processingMetadata||this.processingMessage?this.pendingStatus=r:this.nextListener.onReceiveStatus(r)})}};Eh.InterceptingListenerImpl=GN});var XN=m(Yn=>{"use strict";Object.defineProperty(Yn,"__esModule",{value:!0});Yn.getInterceptingCall=Yn.InterceptingCall=Yn.RequesterBuilder=Yn.ListenerBuilder=Yn.InterceptorConfigurationError=void 0;var Y2e=As(),D7=N7(),M7=ft(),$7=Zb(),Mc=class extends Error{constructor(e){super(e),this.name="InterceptorConfigurationError",Error.captureStackTrace(this,Mc)}};Yn.InterceptorConfigurationError=Mc;var QN=class{constructor(){this.metadata=void 0,this.message=void 0,this.status=void 0}withOnReceiveMetadata(e){return this.metadata=e,this}withOnReceiveMessage(e){return this.message=e,this}withOnReceiveStatus(e){return this.status=e,this}build(){return{onReceiveMetadata:this.metadata,onReceiveMessage:this.message,onReceiveStatus:this.status}}};Yn.ListenerBuilder=QN;var WN=class{constructor(){this.start=void 0,this.message=void 0,this.halfClose=void 0,this.cancel=void 0}withStart(e){return this.start=e,this}withSendMessage(e){return this.message=e,this}withHalfClose(e){return this.halfClose=e,this}withCancel(e){return this.cancel=e,this}build(){return{start:this.start,sendMessage:this.message,halfClose:this.halfClose,cancel:this.cancel}}};Yn.RequesterBuilder=WN;var KN={onReceiveMetadata:(t,e)=>{e(t)},onReceiveMessage:(t,e)=>{e(t)},onReceiveStatus:(t,e)=>{e(t)}},Xg={start:(t,e,r)=>{r(t,e)},sendMessage:(t,e)=>{e(t)},halfClose:t=>{t()},cancel:t=>{t()}},ZN=class{constructor(e,r){var s,n,i,o;this.nextCall=e,this.processingMetadata=!1,this.pendingMessageContext=null,this.processingMessage=!1,this.pendingHalfClose=!1,r?this.requester={start:(s=r.start)!==null&&s!==void 0?s:Xg.start,sendMessage:(n=r.sendMessage)!==null&&n!==void 0?n:Xg.sendMessage,halfClose:(i=r.halfClose)!==null&&i!==void 0?i:Xg.halfClose,cancel:(o=r.cancel)!==null&&o!==void 0?o:Xg.cancel}:this.requester=Xg}cancelWithStatus(e,r){this.requester.cancel(()=>{this.nextCall.cancelWithStatus(e,r)})}getPeer(){return this.nextCall.getPeer()}processPendingMessage(){this.pendingMessageContext&&(this.nextCall.sendMessageWithContext(this.pendingMessageContext,this.pendingMessage),this.pendingMessageContext=null,this.pendingMessage=null)}processPendingHalfClose(){this.pendingHalfClose&&this.nextCall.halfClose()}start(e,r){var s,n,i,o,a,l;let u={onReceiveMetadata:(n=(s=r?.onReceiveMetadata)===null||s===void 0?void 0:s.bind(r))!==null&&n!==void 0?n:c=>{},onReceiveMessage:(o=(i=r?.onReceiveMessage)===null||i===void 0?void 0:i.bind(r))!==null&&o!==void 0?o:c=>{},onReceiveStatus:(l=(a=r?.onReceiveStatus)===null||a===void 0?void 0:a.bind(r))!==null&&l!==void 0?l:c=>{}};this.processingMetadata=!0,this.requester.start(e,u,(c,d)=>{var f,h,p;this.processingMetadata=!1;let g;if((0,D7.isInterceptingListener)(d))g=d;else{let _={onReceiveMetadata:(f=d.onReceiveMetadata)!==null&&f!==void 0?f:KN.onReceiveMetadata,onReceiveMessage:(h=d.onReceiveMessage)!==null&&h!==void 0?h:KN.onReceiveMessage,onReceiveStatus:(p=d.onReceiveStatus)!==null&&p!==void 0?p:KN.onReceiveStatus};g=new D7.InterceptingListenerImpl(_,u)}this.nextCall.start(c,g),this.processPendingMessage(),this.processPendingHalfClose()})}sendMessageWithContext(e,r){this.processingMessage=!0,this.requester.sendMessage(r,s=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessageContext=e,this.pendingMessage=r):(this.nextCall.sendMessageWithContext(e,s),this.processPendingHalfClose())})}sendMessage(e){this.sendMessageWithContext({},e)}startRead(){this.nextCall.startRead()}halfClose(){this.requester.halfClose(()=>{this.processingMetadata||this.processingMessage?this.pendingHalfClose=!0:this.nextCall.halfClose()})}};Yn.InterceptingCall=ZN;function J2e(t,e,r){var s,n;let i=(s=r.deadline)!==null&&s!==void 0?s:1/0,o=r.host,a=(n=r.parent)!==null&&n!==void 0?n:null,l=r.propagate_flags,u=r.credentials,c=t.createCall(e,i,o,a,l);return u&&c.setCredentials(u),c}var hE=class{constructor(e,r){this.call=e,this.methodDefinition=r}cancelWithStatus(e,r){this.call.cancelWithStatus(e,r)}getPeer(){return this.call.getPeer()}sendMessageWithContext(e,r){let s;try{s=this.methodDefinition.requestSerialize(r)}catch(n){this.call.cancelWithStatus(M7.Status.INTERNAL,`Request message serialization failure: ${(0,$7.getErrorMessage)(n)}`);return}this.call.sendMessageWithContext(e,s)}sendMessage(e){this.sendMessageWithContext({},e)}start(e,r){let s=null;this.call.start(e,{onReceiveMetadata:n=>{var i;(i=r?.onReceiveMetadata)===null||i===void 0||i.call(r,n)},onReceiveMessage:n=>{var i;let o;try{o=this.methodDefinition.responseDeserialize(n)}catch(a){s={code:M7.Status.INTERNAL,details:`Response message parsing error: ${(0,$7.getErrorMessage)(a)}`,metadata:new Y2e.Metadata},this.call.cancelWithStatus(s.code,s.details);return}(i=r?.onReceiveMessage)===null||i===void 0||i.call(r,o)},onReceiveStatus:n=>{var i,o;s?(i=r?.onReceiveStatus)===null||i===void 0||i.call(r,s):(o=r?.onReceiveStatus)===null||o===void 0||o.call(r,n)}})}startRead(){this.call.startRead()}halfClose(){this.call.halfClose()}},YN=class extends hE{constructor(e,r){super(e,r)}start(e,r){var s,n;let i=!1,o={onReceiveMetadata:(n=(s=r?.onReceiveMetadata)===null||s===void 0?void 0:s.bind(r))!==null&&n!==void 0?n:a=>{},onReceiveMessage:a=>{var l;i=!0,(l=r?.onReceiveMessage)===null||l===void 0||l.call(r,a)},onReceiveStatus:a=>{var l,u;i||(l=r?.onReceiveMessage)===null||l===void 0||l.call(r,null),(u=r?.onReceiveStatus)===null||u===void 0||u.call(r,a)}};super.start(e,o),this.call.startRead()}},JN=class extends hE{};function X2e(t,e,r){let s=J2e(t,r.path,e);return r.responseStream?new JN(s,r):new YN(s,r)}function eFe(t,e,r,s){if(t.clientInterceptors.length>0&&t.clientInterceptorProviders.length>0)throw new Mc("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(t.callInterceptors.length>0&&t.callInterceptorProviders.length>0)throw new Mc("Both interceptors and interceptor_providers were passed as call options. Only one of these is allowed.");let n=[];t.callInterceptors.length>0||t.callInterceptorProviders.length>0?n=[].concat(t.callInterceptors,t.callInterceptorProviders.map(a=>a(e))).filter(a=>a):n=[].concat(t.clientInterceptors,t.clientInterceptorProviders.map(a=>a(e))).filter(a=>a);let i=Object.assign({},r,{method_definition:e});return n.reduceRight((a,l)=>u=>l(u,a),a=>X2e(s,a,e))(i)}Yn.getInterceptingCall=eFe});var rD=m(mE=>{"use strict";Object.defineProperty(mE,"__esModule",{value:!0});mE.Client=void 0;var wo=I7(),tFe=sD(),rFe=Qn(),Gl=ft(),wh=As(),pE=XN(),ki=Symbol(),Th=Symbol(),Ch=Symbol(),ba=Symbol();function eD(t){return typeof t=="function"}function Rh(t){var e;return((e=t.stack)===null||e===void 0?void 0:e.split(`
`).slice(1).join(`
`))||"no stack trace available"}var tD=class{constructor(e,r,s={}){var n,i;if(s=Object.assign({},s),this[Th]=(n=s.interceptors)!==null&&n!==void 0?n:[],delete s.interceptors,this[Ch]=(i=s.interceptor_providers)!==null&&i!==void 0?i:[],delete s.interceptor_providers,this[Th].length>0&&this[Ch].length>0)throw new Error("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(this[ba]=s.callInvocationTransformer,delete s.callInvocationTransformer,s.channelOverride)this[ki]=s.channelOverride;else if(s.channelFactoryOverride){let o=s.channelFactoryOverride;delete s.channelFactoryOverride,this[ki]=o(e,r,s)}else this[ki]=new tFe.ChannelImplementation(e,r,s)}close(){this[ki].close()}getChannel(){return this[ki]}waitForReady(e,r){let s=n=>{if(n){r(new Error("Failed to connect before the deadline"));return}let i;try{i=this[ki].getConnectivityState(!0)}catch{r(new Error("The channel has been closed"));return}if(i===rFe.ConnectivityState.READY)r();else try{this[ki].watchConnectivityState(i,e,s)}catch{r(new Error("The channel has been closed"))}};setImmediate(s)}checkOptionalUnaryResponseArguments(e,r,s){if(eD(e))return{metadata:new wh.Metadata,options:{},callback:e};if(eD(r))return e instanceof wh.Metadata?{metadata:e,options:{},callback:r}:{metadata:new wh.Metadata,options:e,callback:r};if(!(e instanceof wh.Metadata&&r instanceof Object&&eD(s)))throw new Error("Incorrect arguments passed");return{metadata:e,options:r,callback:s}}makeUnaryRequest(e,r,s,n,i,o,a){var l,u;let c=this.checkOptionalUnaryResponseArguments(i,o,a),d={path:e,requestStream:!1,responseStream:!1,requestSerialize:r,responseDeserialize:s},f={argument:n,metadata:c.metadata,call:new wo.ClientUnaryCallImpl,channel:this[ki],methodDefinition:d,callOptions:c.options,callback:c.callback};this[ba]&&(f=this[ba](f));let h=f.call,p={clientInterceptors:this[Th],clientInterceptorProviders:this[Ch],callInterceptors:(l=f.callOptions.interceptors)!==null&&l!==void 0?l:[],callInterceptorProviders:(u=f.callOptions.interceptor_providers)!==null&&u!==void 0?u:[]},g=(0,pE.getInterceptingCall)(p,f.methodDefinition,f.callOptions,f.channel);h.call=g;let _=null,S=!1,b=new Error;return g.start(f.metadata,{onReceiveMetadata:v=>{h.emit("metadata",v)},onReceiveMessage(v){_!==null&&g.cancelWithStatus(Gl.Status.UNIMPLEMENTED,"Too many responses received"),_=v},onReceiveStatus(v){if(!S){if(S=!0,v.code===Gl.Status.OK)if(_===null){let y=Rh(b);f.callback((0,wo.callErrorFromStatus)({code:Gl.Status.UNIMPLEMENTED,details:"No message received",metadata:v.metadata},y))}else f.callback(null,_);else{let y=Rh(b);f.callback((0,wo.callErrorFromStatus)(v,y))}b=null,h.emit("status",v)}}}),g.sendMessage(n),g.halfClose(),h}makeClientStreamRequest(e,r,s,n,i,o){var a,l;let u=this.checkOptionalUnaryResponseArguments(n,i,o),c={path:e,requestStream:!0,responseStream:!1,requestSerialize:r,responseDeserialize:s},d={metadata:u.metadata,call:new wo.ClientWritableStreamImpl(r),channel:this[ki],methodDefinition:c,callOptions:u.options,callback:u.callback};this[ba]&&(d=this[ba](d));let f=d.call,h={clientInterceptors:this[Th],clientInterceptorProviders:this[Ch],callInterceptors:(a=d.callOptions.interceptors)!==null&&a!==void 0?a:[],callInterceptorProviders:(l=d.callOptions.interceptor_providers)!==null&&l!==void 0?l:[]},p=(0,pE.getInterceptingCall)(h,d.methodDefinition,d.callOptions,d.channel);f.call=p;let g=null,_=!1,S=new Error;return p.start(d.metadata,{onReceiveMetadata:b=>{f.emit("metadata",b)},onReceiveMessage(b){g!==null&&p.cancelWithStatus(Gl.Status.UNIMPLEMENTED,"Too many responses received"),g=b,p.startRead()},onReceiveStatus(b){if(!_){if(_=!0,b.code===Gl.Status.OK)if(g===null){let v=Rh(S);d.callback((0,wo.callErrorFromStatus)({code:Gl.Status.UNIMPLEMENTED,details:"No message received",metadata:b.metadata},v))}else d.callback(null,g);else{let v=Rh(S);d.callback((0,wo.callErrorFromStatus)(b,v))}S=null,f.emit("status",b)}}}),f}checkMetadataAndOptions(e,r){let s,n;return e instanceof wh.Metadata?(s=e,r?n=r:n={}):(e?n=e:n={},s=new wh.Metadata),{metadata:s,options:n}}makeServerStreamRequest(e,r,s,n,i,o){var a,l;let u=this.checkMetadataAndOptions(i,o),c={path:e,requestStream:!1,responseStream:!0,requestSerialize:r,responseDeserialize:s},d={argument:n,metadata:u.metadata,call:new wo.ClientReadableStreamImpl(s),channel:this[ki],methodDefinition:c,callOptions:u.options};this[ba]&&(d=this[ba](d));let f=d.call,h={clientInterceptors:this[Th],clientInterceptorProviders:this[Ch],callInterceptors:(a=d.callOptions.interceptors)!==null&&a!==void 0?a:[],callInterceptorProviders:(l=d.callOptions.interceptor_providers)!==null&&l!==void 0?l:[]},p=(0,pE.getInterceptingCall)(h,d.methodDefinition,d.callOptions,d.channel);f.call=p;let g=!1,_=new Error;return p.start(d.metadata,{onReceiveMetadata(S){f.emit("metadata",S)},onReceiveMessage(S){f.push(S)},onReceiveStatus(S){if(!g){if(g=!0,f.push(null),S.code!==Gl.Status.OK){let b=Rh(_);f.emit("error",(0,wo.callErrorFromStatus)(S,b))}_=null,f.emit("status",S)}}}),p.sendMessage(n),p.halfClose(),f}makeBidiStreamRequest(e,r,s,n,i){var o,a;let l=this.checkMetadataAndOptions(n,i),u={path:e,requestStream:!0,responseStream:!0,requestSerialize:r,responseDeserialize:s},c={metadata:l.metadata,call:new wo.ClientDuplexStreamImpl(r,s),channel:this[ki],methodDefinition:u,callOptions:l.options};this[ba]&&(c=this[ba](c));let d=c.call,f={clientInterceptors:this[Th],clientInterceptorProviders:this[Ch],callInterceptors:(o=c.callOptions.interceptors)!==null&&o!==void 0?o:[],callInterceptorProviders:(a=c.callOptions.interceptor_providers)!==null&&a!==void 0?a:[]},h=(0,pE.getInterceptingCall)(f,c.methodDefinition,c.callOptions,c.channel);d.call=h;let p=!1,g=new Error;return h.start(c.metadata,{onReceiveMetadata(_){d.emit("metadata",_)},onReceiveMessage(_){d.push(_)},onReceiveStatus(_){if(!p){if(p=!0,d.push(null),_.code!==Gl.Status.OK){let S=Rh(g);d.emit("error",(0,wo.callErrorFromStatus)(_,S))}g=null,d.emit("status",_)}}}),d}};mE.Client=tD});var iD=m(Oh=>{"use strict";Object.defineProperty(Oh,"__esModule",{value:!0});Oh.loadPackageDefinition=Oh.makeClientConstructor=void 0;var ey=rD(),sFe={unary:ey.Client.prototype.makeUnaryRequest,server_stream:ey.Client.prototype.makeServerStreamRequest,client_stream:ey.Client.prototype.makeClientStreamRequest,bidi:ey.Client.prototype.makeBidiStreamRequest};function nD(t){return["__proto__","prototype","constructor"].includes(t)}function q7(t,e,r){r||(r={});class s extends ey.Client{}return Object.keys(t).forEach(n=>{if(nD(n))return;let i=t[n],o;if(typeof n=="string"&&n.charAt(0)==="$")throw new Error("Method names cannot start with $");i.requestStream?i.responseStream?o="bidi":o="client_stream":i.responseStream?o="server_stream":o="unary";let a=i.requestSerialize,l=i.responseDeserialize,u=nFe(sFe[o],i.path,a,l);s.prototype[n]=u,Object.assign(s.prototype[n],i),i.originalName&&!nD(i.originalName)&&(s.prototype[i.originalName]=s.prototype[n])}),s.service=t,s.serviceName=e,s}Oh.makeClientConstructor=q7;function nFe(t,e,r,s){return function(...n){return t.call(this,e,r,s,...n)}}function iFe(t){return"format"in t}function oFe(t){let e={};for(let r in t)if(Object.prototype.hasOwnProperty.call(t,r)){let s=t[r],n=r.split(".");if(n.some(a=>nD(a)))continue;let i=n[n.length-1],o=e;for(let a of n.slice(0,-1))o[a]||(o[a]={}),o=o[a];iFe(s)?o[i]=s:o[i]=q7(s,i,{})}return e}Oh.loadPackageDefinition=oFe});var lY=m((zet,aY)=>{var aFe=1/0,lFe="[object Symbol]",uFe=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,cFe=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,yE="\\ud800-\\udfff",H7="\\u0300-\\u036f\\ufe20-\\ufe23",G7="\\u20d0-\\u20f0",K7="\\u2700-\\u27bf",Q7="a-z\\xdf-\\xf6\\xf8-\\xff",dFe="\\xac\\xb1\\xd7\\xf7",fFe="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",hFe="\\u2000-\\u206f",pFe=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",W7="A-Z\\xc0-\\xd6\\xd8-\\xde",Z7="\\ufe0e\\ufe0f",Y7=dFe+fFe+hFe+pFe,aD="['\u2019]",mFe="["+yE+"]",L7="["+Y7+"]",gE="["+H7+G7+"]",J7="\\d+",gFe="["+K7+"]",X7="["+Q7+"]",eY="[^"+yE+Y7+J7+K7+Q7+W7+"]",oD="\\ud83c[\\udffb-\\udfff]",yFe="(?:"+gE+"|"+oD+")",tY="[^"+yE+"]",lD="(?:\\ud83c[\\udde6-\\uddff]){2}",uD="[\\ud800-\\udbff][\\udc00-\\udfff]",Ph="["+W7+"]",rY="\\u200d",j7="(?:"+X7+"|"+eY+")",vFe="(?:"+Ph+"|"+eY+")",F7="(?:"+aD+"(?:d|ll|m|re|s|t|ve))?",B7="(?:"+aD+"(?:D|LL|M|RE|S|T|VE))?",sY=yFe+"?",nY="["+Z7+"]?",_Fe="(?:"+rY+"(?:"+[tY,lD,uD].join("|")+")"+nY+sY+")*",iY=nY+sY+_Fe,SFe="(?:"+[gFe,lD,uD].join("|")+")"+iY,bFe="(?:"+[tY+gE+"?",gE,lD,uD,mFe].join("|")+")",EFe=RegExp(aD,"g"),wFe=RegExp(gE,"g"),TFe=RegExp(oD+"(?="+oD+")|"+bFe+iY,"g"),CFe=RegExp([Ph+"?"+X7+"+"+F7+"(?="+[L7,Ph,"$"].join("|")+")",vFe+"+"+B7+"(?="+[L7,Ph+j7,"$"].join("|")+")",Ph+"?"+j7+"+"+F7,Ph+"+"+B7,J7,SFe].join("|"),"g"),RFe=RegExp("["+rY+yE+H7+G7+Z7+"]"),OFe=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,PFe={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"ss"},AFe=typeof global=="object"&&global&&global.Object===Object&&global,kFe=typeof self=="object"&&self&&self.Object===Object&&self,xFe=AFe||kFe||Function("return this")();function IFe(t,e,r,s){var n=-1,i=t?t.length:0;for(s&&i&&(r=t[++n]);++n<i;)r=e(r,t[n],n,t);return r}function NFe(t){return t.split("")}function DFe(t){return t.match(uFe)||[]}function MFe(t){return function(e){return t?.[e]}}var $Fe=MFe(PFe);function oY(t){return RFe.test(t)}function qFe(t){return OFe.test(t)}function LFe(t){return oY(t)?jFe(t):NFe(t)}function jFe(t){return t.match(TFe)||[]}function FFe(t){return t.match(CFe)||[]}var BFe=Object.prototype,zFe=BFe.toString,z7=xFe.Symbol,U7=z7?z7.prototype:void 0,V7=U7?U7.toString:void 0;function UFe(t,e,r){var s=-1,n=t.length;e<0&&(e=-e>n?0:n+e),r=r>n?n:r,r<0&&(r+=n),n=e>r?0:r-e>>>0,e>>>=0;for(var i=Array(n);++s<n;)i[s]=t[s+e];return i}function VFe(t){if(typeof t=="string")return t;if(WFe(t))return V7?V7.call(t):"";var e=t+"";return e=="0"&&1/t==-aFe?"-0":e}function HFe(t,e,r){var s=t.length;return r=r===void 0?s:r,!e&&r>=s?t:UFe(t,e,r)}function GFe(t){return function(e){e=vE(e);var r=oY(e)?LFe(e):void 0,s=r?r[0]:e.charAt(0),n=r?HFe(r,1).join(""):e.slice(1);return s[t]()+n}}function KFe(t){return function(e){return IFe(eBe(JFe(e).replace(EFe,"")),t,"")}}function QFe(t){return!!t&&typeof t=="object"}function WFe(t){return typeof t=="symbol"||QFe(t)&&zFe.call(t)==lFe}function vE(t){return t==null?"":VFe(t)}var ZFe=KFe(function(t,e,r){return e=e.toLowerCase(),t+(r?YFe(e):e)});function YFe(t){return XFe(vE(t).toLowerCase())}function JFe(t){return t=vE(t),t&&t.replace(cFe,$Fe).replace(wFe,"")}var XFe=GFe("toUpperCase");function eBe(t,e,r){return t=vE(t),e=r?void 0:e,e===void 0?qFe(t)?FFe(t):DFe(t):t.match(e)||[]}aY.exports=ZFe});var cD=m((Uet,uY)=>{"use strict";uY.exports=tBe;function tBe(t,e){for(var r=new Array(arguments.length-1),s=0,n=2,i=!0;n<arguments.length;)r[s++]=arguments[n++];return new Promise(function(a,l){r[s]=function(c){if(i)if(i=!1,c)l(c);else{for(var d=new Array(arguments.length-1),f=0;f<d.length;)d[f++]=arguments[f];a.apply(null,d)}};try{t.apply(e||null,r)}catch(u){i&&(i=!1,l(u))}})}});var hY=m(fY=>{"use strict";var _E=fY;_E.length=function(e){var r=e.length;if(!r)return 0;for(var s=0;--r%4>1&&e.charAt(r)==="=";)++s;return Math.ceil(e.length*3)/4-s};var Ah=new Array(64),dY=new Array(123);for(xi=0;xi<64;)dY[Ah[xi]=xi<26?xi+65:xi<52?xi+71:xi<62?xi-4:xi-59|43]=xi++;var xi;_E.encode=function(e,r,s){for(var n=null,i=[],o=0,a=0,l;r<s;){var u=e[r++];switch(a){case 0:i[o++]=Ah[u>>2],l=(u&3)<<4,a=1;break;case 1:i[o++]=Ah[l|u>>4],l=(u&15)<<2,a=2;break;case 2:i[o++]=Ah[l|u>>6],i[o++]=Ah[u&63],a=0;break}o>8191&&((n||(n=[])).push(String.fromCharCode.apply(String,i)),o=0)}return a&&(i[o++]=Ah[l],i[o++]=61,a===1&&(i[o++]=61)),n?(o&&n.push(String.fromCharCode.apply(String,i.slice(0,o))),n.join("")):String.fromCharCode.apply(String,i.slice(0,o))};var cY="invalid encoding";_E.decode=function(e,r,s){for(var n=s,i=0,o,a=0;a<e.length;){var l=e.charCodeAt(a++);if(l===61&&i>1)break;if((l=dY[l])===void 0)throw Error(cY);switch(i){case 0:o=l,i=1;break;case 1:r[s++]=o<<2|(l&48)>>4,o=l,i=2;break;case 2:r[s++]=(o&15)<<4|(l&60)>>2,o=l,i=3;break;case 3:r[s++]=(o&3)<<6|l,i=0;break}}if(i===1)throw Error(cY);return s-n};_E.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var mY=m((Het,pY)=>{"use strict";pY.exports=SE;function SE(){this._listeners={}}SE.prototype.on=function(e,r,s){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:s||this}),this};SE.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var s=this._listeners[e],n=0;n<s.length;)s[n].fn===r?s.splice(n,1):++n;return this};SE.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var s=[],n=1;n<arguments.length;)s.push(arguments[n++]);for(n=0;n<r.length;)r[n].fn.apply(r[n++].ctx,s)}return this}});var EY=m((Get,bY)=>{"use strict";bY.exports=gY(gY);function gY(t){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),s=r[3]===128;function n(l,u,c){e[0]=l,u[c]=r[0],u[c+1]=r[1],u[c+2]=r[2],u[c+3]=r[3]}function i(l,u,c){e[0]=l,u[c]=r[3],u[c+1]=r[2],u[c+2]=r[1],u[c+3]=r[0]}t.writeFloatLE=s?n:i,t.writeFloatBE=s?i:n;function o(l,u){return r[0]=l[u],r[1]=l[u+1],r[2]=l[u+2],r[3]=l[u+3],e[0]}function a(l,u){return r[3]=l[u],r[2]=l[u+1],r[1]=l[u+2],r[0]=l[u+3],e[0]}t.readFloatLE=s?o:a,t.readFloatBE=s?a:o}():function(){function e(s,n,i,o){var a=n<0?1:0;if(a&&(n=-n),n===0)s(1/n>0?0:2147483648,i,o);else if(isNaN(n))s(2143289344,i,o);else if(n>34028234663852886e22)s((a<<31|2139095040)>>>0,i,o);else if(n<11754943508222875e-54)s((a<<31|Math.round(n/1401298464324817e-60))>>>0,i,o);else{var l=Math.floor(Math.log(n)/Math.LN2),u=Math.round(n*Math.pow(2,-l)*8388608)&8388607;s((a<<31|l+127<<23|u)>>>0,i,o)}}t.writeFloatLE=e.bind(null,yY),t.writeFloatBE=e.bind(null,vY);function r(s,n,i){var o=s(n,i),a=(o>>31)*2+1,l=o>>>23&255,u=o&8388607;return l===255?u?NaN:a*(1/0):l===0?a*1401298464324817e-60*u:a*Math.pow(2,l-150)*(u+8388608)}t.readFloatLE=r.bind(null,_Y),t.readFloatBE=r.bind(null,SY)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),s=r[7]===128;function n(l,u,c){e[0]=l,u[c]=r[0],u[c+1]=r[1],u[c+2]=r[2],u[c+3]=r[3],u[c+4]=r[4],u[c+5]=r[5],u[c+6]=r[6],u[c+7]=r[7]}function i(l,u,c){e[0]=l,u[c]=r[7],u[c+1]=r[6],u[c+2]=r[5],u[c+3]=r[4],u[c+4]=r[3],u[c+5]=r[2],u[c+6]=r[1],u[c+7]=r[0]}t.writeDoubleLE=s?n:i,t.writeDoubleBE=s?i:n;function o(l,u){return r[0]=l[u],r[1]=l[u+1],r[2]=l[u+2],r[3]=l[u+3],r[4]=l[u+4],r[5]=l[u+5],r[6]=l[u+6],r[7]=l[u+7],e[0]}function a(l,u){return r[7]=l[u],r[6]=l[u+1],r[5]=l[u+2],r[4]=l[u+3],r[3]=l[u+4],r[2]=l[u+5],r[1]=l[u+6],r[0]=l[u+7],e[0]}t.readDoubleLE=s?o:a,t.readDoubleBE=s?a:o}():function(){function e(s,n,i,o,a,l){var u=o<0?1:0;if(u&&(o=-o),o===0)s(0,a,l+n),s(1/o>0?0:2147483648,a,l+i);else if(isNaN(o))s(0,a,l+n),s(2146959360,a,l+i);else if(o>17976931348623157e292)s(0,a,l+n),s((u<<31|2146435072)>>>0,a,l+i);else{var c;if(o<22250738585072014e-324)c=o/5e-324,s(c>>>0,a,l+n),s((u<<31|c/4294967296)>>>0,a,l+i);else{var d=Math.floor(Math.log(o)/Math.LN2);d===1024&&(d=1023),c=o*Math.pow(2,-d),s(c*4503599627370496>>>0,a,l+n),s((u<<31|d+1023<<20|c*1048576&1048575)>>>0,a,l+i)}}}t.writeDoubleLE=e.bind(null,yY,0,4),t.writeDoubleBE=e.bind(null,vY,4,0);function r(s,n,i,o,a){var l=s(o,a+n),u=s(o,a+i),c=(u>>31)*2+1,d=u>>>20&2047,f=4294967296*(u&1048575)+l;return d===2047?f?NaN:c*(1/0):d===0?c*5e-324*f:c*Math.pow(2,d-1075)*(f+4503599627370496)}t.readDoubleLE=r.bind(null,_Y,0,4),t.readDoubleBE=r.bind(null,SY,4,0)}(),t}function yY(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function vY(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function _Y(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function SY(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var dD=m((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var TY=m(wY=>{"use strict";var fD=wY;fD.length=function(e){for(var r=0,s=0,n=0;n<e.length;++n)s=e.charCodeAt(n),s<128?r+=1:s<2048?r+=2:(s&64512)===55296&&(e.charCodeAt(n+1)&64512)===56320?(++n,r+=4):r+=3;return r};fD.read=function(e,r,s){var n=s-r;if(n<1)return"";for(var i=null,o=[],a=0,l;r<s;)l=e[r++],l<128?o[a++]=l:l>191&&l<224?o[a++]=(l&31)<<6|e[r++]&63:l>239&&l<365?(l=((l&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,o[a++]=55296+(l>>10),o[a++]=56320+(l&1023)):o[a++]=(l&15)<<12|(e[r++]&63)<<6|e[r++]&63,a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),a=0);return i?(a&&i.push(String.fromCharCode.apply(String,o.slice(0,a))),i.join("")):String.fromCharCode.apply(String,o.slice(0,a))};fD.write=function(e,r,s){for(var n=s,i,o,a=0;a<e.length;++a)i=e.charCodeAt(a),i<128?r[s++]=i:i<2048?(r[s++]=i>>6|192,r[s++]=i&63|128):(i&64512)===55296&&((o=e.charCodeAt(a+1))&64512)===56320?(i=65536+((i&1023)<<10)+(o&1023),++a,r[s++]=i>>18|240,r[s++]=i>>12&63|128,r[s++]=i>>6&63|128,r[s++]=i&63|128):(r[s++]=i>>12|224,r[s++]=i>>6&63|128,r[s++]=i&63|128);return s-n}});var RY=m((Qet,CY)=>{"use strict";CY.exports=rBe;function rBe(t,e,r){var s=r||8192,n=s>>>1,i=null,o=s;return function(l){if(l<1||l>n)return t(l);o+l>s&&(i=t(s),o=0);var u=e.call(i,o,o+=l);return o&7&&(o=(o|7)+1),u}}});var PY=m((Wet,OY)=>{"use strict";OY.exports=Fr;var ty=To();function Fr(t,e){this.lo=t>>>0,this.hi=e>>>0}var $c=Fr.zero=new Fr(0,0);$c.toNumber=function(){return 0};$c.zzEncode=$c.zzDecode=function(){return this};$c.length=function(){return 1};var sBe=Fr.zeroHash="\0\0\0\0\0\0\0\0";Fr.fromNumber=function(e){if(e===0)return $c;var r=e<0;r&&(e=-e);var s=e>>>0,n=(e-s)/4294967296>>>0;return r&&(n=~n>>>0,s=~s>>>0,++s>4294967295&&(s=0,++n>4294967295&&(n=0))),new Fr(s,n)};Fr.from=function(e){if(typeof e=="number")return Fr.fromNumber(e);if(ty.isString(e))if(ty.Long)e=ty.Long.fromString(e);else return Fr.fromNumber(parseInt(e,10));return e.low||e.high?new Fr(e.low>>>0,e.high>>>0):$c};Fr.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,s=~this.hi>>>0;return r||(s=s+1>>>0),-(r+s*4294967296)}return this.lo+this.hi*4294967296};Fr.prototype.toLong=function(e){return ty.Long?new ty.Long(this.lo|0,this.hi|0,!!e):{low:this.lo|0,high:this.hi|0,unsigned:!!e}};var Kl=String.prototype.charCodeAt;Fr.fromHash=function(e){return e===sBe?$c:new Fr((Kl.call(e,0)|Kl.call(e,1)<<8|Kl.call(e,2)<<16|Kl.call(e,3)<<24)>>>0,(Kl.call(e,4)|Kl.call(e,5)<<8|Kl.call(e,6)<<16|Kl.call(e,7)<<24)>>>0)};Fr.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Fr.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};Fr.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};Fr.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,s=this.hi>>>24;return s===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:s<128?9:10}});var To=m(hD=>{"use strict";var Ee=hD;Ee.asPromise=cD();Ee.base64=hY();Ee.EventEmitter=mY();Ee.float=EY();Ee.inquire=dD();Ee.utf8=TY();Ee.pool=RY();Ee.LongBits=PY();Ee.isNode=!!(typeof global<"u"&&global&&global.process&&global.process.versions&&global.process.versions.node);Ee.global=Ee.isNode&&global||typeof window<"u"&&window||typeof self<"u"&&self||hD;Ee.emptyArray=Object.freeze?Object.freeze([]):[];Ee.emptyObject=Object.freeze?Object.freeze({}):{};Ee.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};Ee.isString=function(e){return typeof e=="string"||e instanceof String};Ee.isObject=function(e){return e&&typeof e=="object"};Ee.isset=Ee.isSet=function(e,r){var s=e[r];return s!=null&&e.hasOwnProperty(r)?typeof s!="object"||(Array.isArray(s)?s.length:Object.keys(s).length)>0:!1};Ee.Buffer=function(){try{var t=Ee.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch{return null}}();Ee._Buffer_from=null;Ee._Buffer_allocUnsafe=null;Ee.newBuffer=function(e){return typeof e=="number"?Ee.Buffer?Ee._Buffer_allocUnsafe(e):new Ee.Array(e):Ee.Buffer?Ee._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};Ee.Array=typeof Uint8Array<"u"?Uint8Array:Array;Ee.Long=Ee.global.dcodeIO&&Ee.global.dcodeIO.Long||Ee.global.Long||Ee.inquire("long");Ee.key2Re=/^true|false|0|1$/;Ee.key32Re=/^-?(?:0|[1-9][0-9]*)$/;Ee.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;Ee.longToHash=function(e){return e?Ee.LongBits.from(e).toHash():Ee.LongBits.zeroHash};Ee.longFromHash=function(e,r){var s=Ee.LongBits.fromHash(e);return Ee.Long?Ee.Long.fromBits(s.lo,s.hi,r):s.toNumber(!!r)};function AY(t,e,r){for(var s=Object.keys(e),n=0;n<s.length;++n)(t[s[n]]===void 0||!r)&&(t[s[n]]=e[s[n]]);return t}Ee.merge=AY;Ee.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function kY(t){function e(r,s){if(!(this instanceof e))return new e(r,s);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),s&&AY(this,s)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return t},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}Ee.newError=kY;Ee.ProtocolError=kY("ProtocolError");Ee.oneOfGetter=function(e){for(var r={},s=0;s<e.length;++s)r[e[s]]=1;return function(){for(var n=Object.keys(this),i=n.length-1;i>-1;--i)if(r[n[i]]===1&&this[n[i]]!==void 0&&this[n[i]]!==null)return n[i]}};Ee.oneOfSetter=function(e){return function(r){for(var s=0;s<e.length;++s)e[s]!==r&&delete this[e[s]]}};Ee.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};Ee._configure=function(){var t=Ee.Buffer;if(!t){Ee._Buffer_from=Ee._Buffer_allocUnsafe=null;return}Ee._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,s){return new t(r,s)},Ee._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var EE=m((Yet,DY)=>{"use strict";DY.exports=ht;var Jn=To(),pD,bE=Jn.LongBits,xY=Jn.base64,IY=Jn.utf8;function ry(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function gD(){}function nBe(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function ht(){this.len=0,this.head=new ry(gD,0,0),this.tail=this.head,this.states=null}var NY=function(){return Jn.Buffer?function(){return(ht.create=function(){return new pD})()}:function(){return new ht}};ht.create=NY();ht.alloc=function(e){return new Jn.Array(e)};Jn.Array!==Array&&(ht.alloc=Jn.pool(ht.alloc,Jn.Array.prototype.subarray));ht.prototype._push=function(e,r,s){return this.tail=this.tail.next=new ry(e,r,s),this.len+=r,this};function yD(t,e,r){e[r]=t&255}function iBe(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function vD(t,e){this.len=t,this.next=void 0,this.val=e}vD.prototype=Object.create(ry.prototype);vD.prototype.fn=iBe;ht.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new vD((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};ht.prototype.int32=function(e){return e<0?this._push(_D,10,bE.fromNumber(e)):this.uint32(e)};ht.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function _D(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}ht.prototype.uint64=function(e){var r=bE.from(e);return this._push(_D,r.length(),r)};ht.prototype.int64=ht.prototype.uint64;ht.prototype.sint64=function(e){var r=bE.from(e).zzEncode();return this._push(_D,r.length(),r)};ht.prototype.bool=function(e){return this._push(yD,1,e?1:0)};function mD(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}ht.prototype.fixed32=function(e){return this._push(mD,4,e>>>0)};ht.prototype.sfixed32=ht.prototype.fixed32;ht.prototype.fixed64=function(e){var r=bE.from(e);return this._push(mD,4,r.lo)._push(mD,4,r.hi)};ht.prototype.sfixed64=ht.prototype.fixed64;ht.prototype.float=function(e){return this._push(Jn.float.writeFloatLE,4,e)};ht.prototype.double=function(e){return this._push(Jn.float.writeDoubleLE,8,e)};var oBe=Jn.Array.prototype.set?function(e,r,s){r.set(e,s)}:function(e,r,s){for(var n=0;n<e.length;++n)r[s+n]=e[n]};ht.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(yD,1,0);if(Jn.isString(e)){var s=ht.alloc(r=xY.length(e));xY.decode(e,s,0),e=s}return this.uint32(r)._push(oBe,r,e)};ht.prototype.string=function(e){var r=IY.length(e);return r?this.uint32(r)._push(IY.write,r,e):this._push(yD,1,0)};ht.prototype.fork=function(){return this.states=new nBe(this),this.head=this.tail=new ry(gD,0,0),this.len=0,this};ht.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new ry(gD,0,0),this.len=0),this};ht.prototype.ldelim=function(){var e=this.head,r=this.tail,s=this.len;return this.reset().uint32(s),s&&(this.tail.next=e.next,this.tail=r,this.len+=s),this};ht.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),s=0;e;)e.fn(e.val,r,s),s+=e.len,e=e.next;return r};ht._configure=function(t){pD=t,ht.create=NY(),pD._configure()}});var qY=m((Jet,$Y)=>{"use strict";$Y.exports=Co;var MY=EE();(Co.prototype=Object.create(MY.prototype)).constructor=Co;var Ql=To();function Co(){MY.call(this)}Co._configure=function(){Co.alloc=Ql._Buffer_allocUnsafe,Co.writeBytesBuffer=Ql.Buffer&&Ql.Buffer.prototype instanceof Uint8Array&&Ql.Buffer.prototype.set.name==="set"?function(e,r,s){r.set(e,s)}:function(e,r,s){if(e.copy)e.copy(r,s,0,e.length);else for(var n=0;n<e.length;)r[s++]=e[n++]}};Co.prototype.bytes=function(e){Ql.isString(e)&&(e=Ql._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(Co.writeBytesBuffer,r,e),this};function aBe(t,e,r){t.length<40?Ql.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}Co.prototype.string=function(e){var r=Ql.Buffer.byteLength(e);return this.uint32(r),r&&this._push(aBe,r,e),this};Co._configure()});var TE=m((Xet,zY)=>{"use strict";zY.exports=hr;var Ii=To(),bD,FY=Ii.LongBits,lBe=Ii.utf8;function Ni(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function hr(t){this.buf=t,this.pos=0,this.len=t.length}var LY=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new hr(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new hr(e);throw Error("illegal buffer")},BY=function(){return Ii.Buffer?function(r){return(hr.create=function(n){return Ii.Buffer.isBuffer(n)?new bD(n):LY(n)})(r)}:LY};hr.create=BY();hr.prototype._slice=Ii.Array.prototype.subarray||Ii.Array.prototype.slice;hr.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Ni(this,10);return e}}();hr.prototype.int32=function(){return this.uint32()|0};hr.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function SD(){var t=new FY(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw Ni(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw Ni(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}hr.prototype.bool=function(){return this.uint32()!==0};function wE(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}hr.prototype.fixed32=function(){if(this.pos+4>this.len)throw Ni(this,4);return wE(this.buf,this.pos+=4)};hr.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Ni(this,4);return wE(this.buf,this.pos+=4)|0};function jY(){if(this.pos+8>this.len)throw Ni(this,8);return new FY(wE(this.buf,this.pos+=4),wE(this.buf,this.pos+=4))}hr.prototype.float=function(){if(this.pos+4>this.len)throw Ni(this,4);var e=Ii.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};hr.prototype.double=function(){if(this.pos+8>this.len)throw Ni(this,4);var e=Ii.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};hr.prototype.bytes=function(){var e=this.uint32(),r=this.pos,s=this.pos+e;if(s>this.len)throw Ni(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(r,s);if(r===s){var n=Ii.Buffer;return n?n.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,r,s)};hr.prototype.string=function(){var e=this.bytes();return lBe.read(e,0,e.length)};hr.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw Ni(this,e);this.pos+=e}else do if(this.pos>=this.len)throw Ni(this);while(this.buf[this.pos++]&128);return this};hr.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};hr._configure=function(t){bD=t,hr.create=BY(),bD._configure();var e=Ii.Long?"toLong":"toNumber";Ii.merge(hr.prototype,{int64:function(){return SD.call(this)[e](!1)},uint64:function(){return SD.call(this)[e](!0)},sint64:function(){return SD.call(this).zzDecode()[e](!1)},fixed64:function(){return jY.call(this)[e](!0)},sfixed64:function(){return jY.call(this)[e](!1)}})}});var GY=m((ett,HY)=>{"use strict";HY.exports=qc;var VY=TE();(qc.prototype=Object.create(VY.prototype)).constructor=qc;var UY=To();function qc(t){VY.call(this,t)}qc._configure=function(){UY.Buffer&&(qc.prototype._slice=UY.Buffer.prototype.slice)};qc.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};qc._configure()});var QY=m((ttt,KY)=>{"use strict";KY.exports=sy;var ED=To();(sy.prototype=Object.create(ED.EventEmitter.prototype)).constructor=sy;function sy(t,e,r){if(typeof t!="function")throw TypeError("rpcImpl must be a function");ED.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=!!e,this.responseDelimited=!!r}sy.prototype.rpcCall=function t(e,r,s,n,i){if(!n)throw TypeError("request must be specified");var o=this;if(!i)return ED.asPromise(t,o,e,r,s,n);if(!o.rpcImpl){setTimeout(function(){i(Error("already ended"))},0);return}try{return o.rpcImpl(e,r[o.requestDelimited?"encodeDelimited":"encode"](n).finish(),function(l,u){if(l)return o.emit("error",l,e),i(l);if(u===null){o.end(!0);return}if(!(u instanceof s))try{u=s[o.responseDelimited?"decodeDelimited":"decode"](u)}catch(c){return o.emit("error",c,e),i(c)}return o.emit("data",u,e),i(null,u)})}catch(a){o.emit("error",a,e),setTimeout(function(){i(a)},0);return}};sy.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var wD=m(WY=>{"use strict";var uBe=WY;uBe.Service=QY()});var TD=m((stt,ZY)=>{"use strict";ZY.exports={}});var XY=m(JY=>{"use strict";var Gs=JY;Gs.build="minimal";Gs.Writer=EE();Gs.BufferWriter=qY();Gs.Reader=TE();Gs.BufferReader=GY();Gs.util=To();Gs.rpc=wD();Gs.roots=TD();Gs.configure=YY;function YY(){Gs.util._configure(),Gs.Writer._configure(Gs.BufferWriter),Gs.Reader._configure(Gs.BufferReader)}YY()});var tJ=m((itt,eJ)=>{"use strict";eJ.exports=CD;function CD(t,e){typeof t=="string"&&(e=t,t=void 0);var r=[];function s(i){if(typeof i!="string"){var o=n();if(CD.verbose&&console.log("codegen: "+o),o="return "+o,i){for(var a=Object.keys(i),l=new Array(a.length+1),u=new Array(a.length),c=0;c<a.length;)l[c]=a[c],u[c]=i[a[c++]];return l[c]=o,Function.apply(null,l).apply(null,u)}return Function(o)()}for(var d=new Array(arguments.length-1),f=0;f<d.length;)d[f]=arguments[++f];if(f=0,i=i.replace(/%([%dfijs])/g,function(p,g){var _=d[f++];switch(g){case"d":case"f":return String(Number(_));case"i":return String(Math.floor(_));case"j":return JSON.stringify(_);case"s":return String(_)}return"%"}),f!==d.length)throw Error("parameter count mismatch");return r.push(i),s}function n(i){return"function "+(i||e||"")+"("+(t&&t.join(",")||"")+`){
  `+r.join(`
  `)+`
}`}return s.toString=n,s}CD.verbose=!1});var sJ=m((ott,rJ)=>{"use strict";rJ.exports=ny;var cBe=cD(),dBe=dD(),RD=dBe("fs");function ny(t,e,r){return typeof e=="function"?(r=e,e={}):e||(e={}),r?!e.xhr&&RD&&RD.readFile?RD.readFile(t,function(n,i){return n&&typeof XMLHttpRequest<"u"?ny.xhr(t,e,r):n?r(n):r(null,e.binary?i:i.toString("utf8"))}):ny.xhr(t,e,r):cBe(ny,this,t,e)}ny.xhr=function(e,r,s){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(n.readyState===4){if(n.status!==0&&n.status!==200)return s(Error("status "+n.status));if(r.binary){var o=n.response;if(!o){o=[];for(var a=0;a<n.responseText.length;++a)o.push(n.responseText.charCodeAt(a)&255)}return s(null,typeof Uint8Array<"u"?new Uint8Array(o):o)}return s(null,n.responseText)}},r.binary&&("overrideMimeType"in n&&n.overrideMimeType("text/plain; charset=x-user-defined"),n.responseType="arraybuffer"),n.open("GET",e),n.send()}});var oJ=m(iJ=>{"use strict";var PD=iJ,nJ=PD.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},OD=PD.normalize=function(e){e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/");var r=e.split("/"),s=nJ(e),n="";s&&(n=r.shift()+"/");for(var i=0;i<r.length;)r[i]===".."?i>0&&r[i-1]!==".."?r.splice(--i,2):s?r.splice(i,1):++i:r[i]==="."?r.splice(i,1):++i;return n+r.join("/")};PD.resolve=function(e,r,s){return s||(r=OD(r)),nJ(r)?r:(s||(e=OD(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?OD(e+"/"+r):r)}});var Lc=m(aJ=>{"use strict";var iy=aJ,fBe=Br(),hBe=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function oy(t,e){var r=0,s={};for(e|=0;r<t.length;)s[hBe[r+e]]=t[r++];return s}iy.basic=oy([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]);iy.defaults=oy([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",fBe.emptyArray,null]);iy.long=oy([0,0,0,1,1],7);iy.mapKey=oy([0,0,0,5,5,0,0,0,1,1,0,2],2);iy.packed=oy([1,5,0,0,0,5,5,0,0,0,1,1,0])});var Wl=m((utt,cJ)=>{"use strict";cJ.exports=Xn;var CE=jc();((Xn.prototype=Object.create(CE.prototype)).constructor=Xn).className="Field";var lJ=Di(),uJ=Lc(),br=Br(),AD,pBe=/^required|optional|repeated$/;Xn.fromJSON=function(e,r){return new Xn(e,r.id,r.type,r.rule,r.extend,r.options,r.comment)};function Xn(t,e,r,s,n,i,o){if(br.isObject(s)?(o=n,i=s,s=n=void 0):br.isObject(n)&&(o=i,i=n,n=void 0),CE.call(this,t,i),!br.isInteger(e)||e<0)throw TypeError("id must be a non-negative integer");if(!br.isString(r))throw TypeError("type must be a string");if(s!==void 0&&!pBe.test(s=s.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(n!==void 0&&!br.isString(n))throw TypeError("extend must be a string");s==="proto3_optional"&&(s="optional"),this.rule=s&&s!=="optional"?s:void 0,this.type=r,this.id=e,this.extend=n||void 0,this.required=s==="required",this.optional=!this.required,this.repeated=s==="repeated",this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=br.Long?uJ.long[r]!==void 0:!1,this.bytes=r==="bytes",this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=o}Object.defineProperty(Xn.prototype,"packed",{get:function(){return this._packed===null&&(this._packed=this.getOption("packed")!==!1),this._packed}});Xn.prototype.setOption=function(e,r,s){return e==="packed"&&(this._packed=null),CE.prototype.setOption.call(this,e,r,s)};Xn.prototype.toJSON=function(e){var r=e?!!e.keepComments:!1;return br.toObject(["rule",this.rule!=="optional"&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",r?this.comment:void 0])};Xn.prototype.resolve=function(){if(this.resolved)return this;if((this.typeDefault=uJ.defaults[this.type])===void 0?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof AD?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&this.options.default!=null&&(this.typeDefault=this.options.default,this.resolvedType instanceof lJ&&typeof this.typeDefault=="string"&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&((this.options.packed===!0||this.options.packed!==void 0&&this.resolvedType&&!(this.resolvedType instanceof lJ))&&delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=br.Long.fromNumber(this.typeDefault,this.type.charAt(0)==="u"),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&typeof this.typeDefault=="string"){var e;br.base64.test(this.typeDefault)?br.base64.decode(this.typeDefault,e=br.newBuffer(br.base64.length(this.typeDefault)),0):br.utf8.write(this.typeDefault,e=br.newBuffer(br.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=br.emptyObject:this.repeated?this.defaultValue=br.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof AD&&(this.parent.ctor.prototype[this.name]=this.defaultValue),CE.prototype.resolve.call(this)};Xn.d=function(e,r,s,n){return typeof r=="function"?r=br.decorateType(r).name:r&&typeof r=="object"&&(r=br.decorateEnum(r).name),function(o,a){br.decorateType(o.constructor).add(new Xn(a,e,r,s,{default:n}))}};Xn._configure=function(e){AD=e}});var kh=m((ctt,hJ)=>{"use strict";hJ.exports=ei;var OE=jc();((ei.prototype=Object.create(OE.prototype)).constructor=ei).className="OneOf";var dJ=Wl(),RE=Br();function ei(t,e,r,s){if(Array.isArray(e)||(r=e,e=void 0),OE.call(this,t,r),!(e===void 0||Array.isArray(e)))throw TypeError("fieldNames must be an Array");this.oneof=e||[],this.fieldsArray=[],this.comment=s}ei.fromJSON=function(e,r){return new ei(e,r.oneof,r.options,r.comment)};ei.prototype.toJSON=function(e){var r=e?!!e.keepComments:!1;return RE.toObject(["options",this.options,"oneof",this.oneof,"comment",r?this.comment:void 0])};function fJ(t){if(t.parent)for(var e=0;e<t.fieldsArray.length;++e)t.fieldsArray[e].parent||t.parent.add(t.fieldsArray[e])}ei.prototype.add=function(e){if(!(e instanceof dJ))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,fJ(this),this};ei.prototype.remove=function(e){if(!(e instanceof dJ))throw TypeError("field must be a Field");var r=this.fieldsArray.indexOf(e);if(r<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(r,1),r=this.oneof.indexOf(e.name),r>-1&&this.oneof.splice(r,1),e.partOf=null,this};ei.prototype.onAdd=function(e){OE.prototype.onAdd.call(this,e);for(var r=this,s=0;s<this.oneof.length;++s){var n=e.get(this.oneof[s]);n&&!n.partOf&&(n.partOf=r,r.fieldsArray.push(n))}fJ(this)};ei.prototype.onRemove=function(e){for(var r=0,s;r<this.fieldsArray.length;++r)(s=this.fieldsArray[r]).parent&&s.parent.remove(s);OE.prototype.onRemove.call(this,e)};ei.d=function(){for(var e=new Array(arguments.length),r=0;r<arguments.length;)e[r]=arguments[r++];return function(n,i){RE.decorateType(n.constructor).add(new ei(i,e)),Object.defineProperty(n,i,{get:RE.oneOfGetter(e),set:RE.oneOfSetter(e)})}}});var Nh=m((dtt,yJ)=>{"use strict";yJ.exports=yt;var kD=jc();((yt.prototype=Object.create(kD.prototype)).constructor=yt).className="Namespace";var pJ=Wl(),PE=Br(),mBe=kh(),xh,ay,Ih;yt.fromJSON=function(e,r){return new yt(e,r.options).addJSON(r.nested)};function mJ(t,e){if(t&&t.length){for(var r={},s=0;s<t.length;++s)r[t[s].name]=t[s].toJSON(e);return r}}yt.arrayToJSON=mJ;yt.isReservedId=function(e,r){if(e){for(var s=0;s<e.length;++s)if(typeof e[s]!="string"&&e[s][0]<=r&&e[s][1]>r)return!0}return!1};yt.isReservedName=function(e,r){if(e){for(var s=0;s<e.length;++s)if(e[s]===r)return!0}return!1};function yt(t,e){kD.call(this,t,e),this.nested=void 0,this._nestedArray=null}function gJ(t){return t._nestedArray=null,t}Object.defineProperty(yt.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=PE.toArray(this.nested))}});yt.prototype.toJSON=function(e){return PE.toObject(["options",this.options,"nested",mJ(this.nestedArray,e)])};yt.prototype.addJSON=function(e){var r=this;if(e)for(var s=Object.keys(e),n=0,i;n<s.length;++n)i=e[s[n]],r.add((i.fields!==void 0?xh.fromJSON:i.values!==void 0?Ih.fromJSON:i.methods!==void 0?ay.fromJSON:i.id!==void 0?pJ.fromJSON:yt.fromJSON)(s[n],i));return this};yt.prototype.get=function(e){return this.nested&&this.nested[e]||null};yt.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof Ih)return this.nested[e].values;throw Error("no such enum: "+e)};yt.prototype.add=function(e){if(!(e instanceof pJ&&e.extend!==void 0||e instanceof xh||e instanceof mBe||e instanceof Ih||e instanceof ay||e instanceof yt))throw TypeError("object must be a valid nested object");if(!this.nested)this.nested={};else{var r=this.get(e.name);if(r)if(r instanceof yt&&e instanceof yt&&!(r instanceof xh||r instanceof ay)){for(var s=r.nestedArray,n=0;n<s.length;++n)e.add(s[n]);this.remove(r),this.nested||(this.nested={}),e.setOptions(r.options,!0)}else throw Error("duplicate name '"+e.name+"' in "+this)}return this.nested[e.name]=e,e.onAdd(this),gJ(this)};yt.prototype.remove=function(e){if(!(e instanceof kD))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),gJ(this)};yt.prototype.define=function(e,r){if(PE.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&e[0]==="")throw Error("path must be relative");for(var s=this;e.length>0;){var n=e.shift();if(s.nested&&s.nested[n]){if(s=s.nested[n],!(s instanceof yt))throw Error("path conflicts with non-namespace objects")}else s.add(s=new yt(n))}return r&&s.addJSON(r),s};yt.prototype.resolveAll=function(){for(var e=this.nestedArray,r=0;r<e.length;)e[r]instanceof yt?e[r++].resolveAll():e[r++].resolve();return this.resolve()};yt.prototype.lookup=function(e,r,s){if(typeof r=="boolean"?(s=r,r=void 0):r&&!Array.isArray(r)&&(r=[r]),PE.isString(e)&&e.length){if(e===".")return this.root;e=e.split(".")}else if(!e.length)return this;if(e[0]==="")return this.root.lookup(e.slice(1),r);var n=this.get(e[0]);if(n){if(e.length===1){if(!r||r.indexOf(n.constructor)>-1)return n}else if(n instanceof yt&&(n=n.lookup(e.slice(1),r,!0)))return n}else for(var i=0;i<this.nestedArray.length;++i)if(this._nestedArray[i]instanceof yt&&(n=this._nestedArray[i].lookup(e,r,!0)))return n;return this.parent===null||s?null:this.parent.lookup(e,r)};yt.prototype.lookupType=function(e){var r=this.lookup(e,[xh]);if(!r)throw Error("no such type: "+e);return r};yt.prototype.lookupEnum=function(e){var r=this.lookup(e,[Ih]);if(!r)throw Error("no such Enum '"+e+"' in "+this);return r};yt.prototype.lookupTypeOrEnum=function(e){var r=this.lookup(e,[xh,Ih]);if(!r)throw Error("no such Type or Enum '"+e+"' in "+this);return r};yt.prototype.lookupService=function(e){var r=this.lookup(e,[ay]);if(!r)throw Error("no such Service '"+e+"' in "+this);return r};yt._configure=function(t,e,r){xh=t,ay=e,Ih=r}});var AE=m((ftt,vJ)=>{"use strict";vJ.exports=Ea;var xD=Wl();((Ea.prototype=Object.create(xD.prototype)).constructor=Ea).className="MapField";var gBe=Lc(),ly=Br();function Ea(t,e,r,s,n,i){if(xD.call(this,t,e,s,void 0,void 0,n,i),!ly.isString(r))throw TypeError("keyType must be a string");this.keyType=r,this.resolvedKeyType=null,this.map=!0}Ea.fromJSON=function(e,r){return new Ea(e,r.id,r.keyType,r.type,r.options,r.comment)};Ea.prototype.toJSON=function(e){var r=e?!!e.keepComments:!1;return ly.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",r?this.comment:void 0])};Ea.prototype.resolve=function(){if(this.resolved)return this;if(gBe.mapKey[this.keyType]===void 0)throw Error("invalid key type: "+this.keyType);return xD.prototype.resolve.call(this)};Ea.d=function(e,r,s){return typeof s=="function"?s=ly.decorateType(s).name:s&&typeof s=="object"&&(s=ly.decorateEnum(s).name),function(i,o){ly.decorateType(i.constructor).add(new Ea(o,e,r,s))}}});var kE=m((htt,_J)=>{"use strict";_J.exports=Fc;var ID=jc();((Fc.prototype=Object.create(ID.prototype)).constructor=Fc).className="Method";var Dh=Br();function Fc(t,e,r,s,n,i,o,a,l){if(Dh.isObject(n)?(o=n,n=i=void 0):Dh.isObject(i)&&(o=i,i=void 0),!(e===void 0||Dh.isString(e)))throw TypeError("type must be a string");if(!Dh.isString(r))throw TypeError("requestType must be a string");if(!Dh.isString(s))throw TypeError("responseType must be a string");ID.call(this,t,o),this.type=e||"rpc",this.requestType=r,this.requestStream=n?!0:void 0,this.responseType=s,this.responseStream=i?!0:void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=a,this.parsedOptions=l}Fc.fromJSON=function(e,r){return new Fc(e,r.type,r.requestType,r.responseType,r.requestStream,r.responseStream,r.options,r.comment,r.parsedOptions)};Fc.prototype.toJSON=function(e){var r=e?!!e.keepComments:!1;return Dh.toObject(["type",this.type!=="rpc"&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",r?this.comment:void 0,"parsedOptions",this.parsedOptions])};Fc.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),ID.prototype.resolve.call(this))}});var xE=m((ptt,bJ)=>{"use strict";bJ.exports=ti;var Zl=Nh();((ti.prototype=Object.create(Zl.prototype)).constructor=ti).className="Service";var ND=kE(),uy=Br(),yBe=wD();function ti(t,e){Zl.call(this,t,e),this.methods={},this._methodsArray=null}ti.fromJSON=function(e,r){var s=new ti(e,r.options);if(r.methods)for(var n=Object.keys(r.methods),i=0;i<n.length;++i)s.add(ND.fromJSON(n[i],r.methods[n[i]]));return r.nested&&s.addJSON(r.nested),s.comment=r.comment,s};ti.prototype.toJSON=function(e){var r=Zl.prototype.toJSON.call(this,e),s=e?!!e.keepComments:!1;return uy.toObject(["options",r&&r.options||void 0,"methods",Zl.arrayToJSON(this.methodsArray,e)||{},"nested",r&&r.nested||void 0,"comment",s?this.comment:void 0])};Object.defineProperty(ti.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=uy.toArray(this.methods))}});function SJ(t){return t._methodsArray=null,t}ti.prototype.get=function(e){return this.methods[e]||Zl.prototype.get.call(this,e)};ti.prototype.resolveAll=function(){for(var e=this.methodsArray,r=0;r<e.length;++r)e[r].resolve();return Zl.prototype.resolve.call(this)};ti.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof ND?(this.methods[e.name]=e,e.parent=this,SJ(this)):Zl.prototype.add.call(this,e)};ti.prototype.remove=function(e){if(e instanceof ND){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,SJ(this)}return Zl.prototype.remove.call(this,e)};ti.prototype.create=function(e,r,s){for(var n=new yBe.Service(e,r,s),i=0,o;i<this.methodsArray.length;++i){var a=uy.lcFirst((o=this._methodsArray[i]).resolve().name).replace(/[^$\w_]/g,"");n[a]=uy.codegen(["r","c"],uy.isReserved(a)?a+"_":a)("return this.rpcCall(m,q,s,r,c)")({m:o,q:o.resolvedRequestType.ctor,s:o.resolvedResponseType.ctor})}return n}});var IE=m((mtt,EJ)=>{"use strict";EJ.exports=Ro;var vBe=To();function Ro(t){if(t)for(var e=Object.keys(t),r=0;r<e.length;++r)this[e[r]]=t[e[r]]}Ro.create=function(e){return this.$type.create(e)};Ro.encode=function(e,r){return this.$type.encode(e,r)};Ro.encodeDelimited=function(e,r){return this.$type.encodeDelimited(e,r)};Ro.decode=function(e){return this.$type.decode(e)};Ro.decodeDelimited=function(e){return this.$type.decodeDelimited(e)};Ro.verify=function(e){return this.$type.verify(e)};Ro.fromObject=function(e){return this.$type.fromObject(e)};Ro.toObject=function(e,r){return this.$type.toObject(e,r)};Ro.prototype.toJSON=function(){return this.$type.toObject(this,vBe.toJSONOptions)}});var DD=m((gtt,TJ)=>{"use strict";TJ.exports=bBe;var _Be=Di(),wa=Lc(),wJ=Br();function SBe(t){return"missing required '"+t.name+"'"}function bBe(t){var e=wJ.codegen(["r","l"],t.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(t.fieldsArray.filter(function(a){return a.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");t.group&&e("if((t&7)===4)")("break"),e("switch(t>>>3){");for(var r=0;r<t.fieldsArray.length;++r){var s=t._fieldsArray[r].resolve(),n=s.resolvedType instanceof _Be?"int32":s.type,i="m"+wJ.safeProp(s.name);e("case %i: {",s.id),s.map?(e("if(%s===util.emptyObject)",i)("%s={}",i)("var c2 = r.uint32()+r.pos"),wa.defaults[s.keyType]!==void 0?e("k=%j",wa.defaults[s.keyType]):e("k=null"),wa.defaults[n]!==void 0?e("value=%j",wa.defaults[n]):e("value=null"),e("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",s.keyType)("case 2:"),wa.basic[n]===void 0?e("value=types[%i].decode(r,r.uint32())",r):e("value=r.%s()",n),e("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),wa.long[s.keyType]!==void 0?e('%s[typeof k==="object"?util.longToHash(k):k]=value',i):e("%s[k]=value",i)):s.repeated?(e("if(!(%s&&%s.length))",i,i)("%s=[]",i),wa.packed[n]!==void 0&&e("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",i,n)("}else"),wa.basic[n]===void 0?e(s.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",i,r):e("%s.push(r.%s())",i,n)):wa.basic[n]===void 0?e(s.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",i,r):e("%s=r.%s()",i,n),e("break")("}")}for(e("default:")("r.skipType(t&7)")("break")("}")("}"),r=0;r<t._fieldsArray.length;++r){var o=t._fieldsArray[r];o.required&&e("if(!m.hasOwnProperty(%j))",o.name)("throw util.ProtocolError(%j,{instance:m})",SBe(o))}return e("return m")}});var qD=m((ytt,CJ)=>{"use strict";CJ.exports=TBe;var EBe=Di(),MD=Br();function ri(t,e){return t.name+": "+e+(t.repeated&&e!=="array"?"[]":t.map&&e!=="object"?"{k:"+t.keyType+"}":"")+" expected"}function $D(t,e,r,s){if(e.resolvedType)if(e.resolvedType instanceof EBe){t("switch(%s){",s)("default:")("return%j",ri(e,"enum value"));for(var n=Object.keys(e.resolvedType.values),i=0;i<n.length;++i)t("case %i:",e.resolvedType.values[n[i]]);t("break")("}")}else t("{")("var e=types[%i].verify(%s);",r,s)("if(e)")("return%j+e",e.name+".")("}");else switch(e.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":t("if(!util.isInteger(%s))",s)("return%j",ri(e,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":t("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",s,s,s,s)("return%j",ri(e,"integer|Long"));break;case"float":case"double":t('if(typeof %s!=="number")',s)("return%j",ri(e,"number"));break;case"bool":t('if(typeof %s!=="boolean")',s)("return%j",ri(e,"boolean"));break;case"string":t("if(!util.isString(%s))",s)("return%j",ri(e,"string"));break;case"bytes":t('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',s,s,s)("return%j",ri(e,"buffer"));break}return t}function wBe(t,e,r){switch(e.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":t("if(!util.key32Re.test(%s))",r)("return%j",ri(e,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":t("if(!util.key64Re.test(%s))",r)("return%j",ri(e,"integer|Long key"));break;case"bool":t("if(!util.key2Re.test(%s))",r)("return%j",ri(e,"boolean key"));break}return t}function TBe(t){var e=MD.codegen(["m"],t.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),r=t.oneofsArray,s={};r.length&&e("var p={}");for(var n=0;n<t.fieldsArray.length;++n){var i=t._fieldsArray[n].resolve(),o="m"+MD.safeProp(i.name);if(i.optional&&e("if(%s!=null&&m.hasOwnProperty(%j)){",o,i.name),i.map)e("if(!util.isObject(%s))",o)("return%j",ri(i,"object"))("var k=Object.keys(%s)",o)("for(var i=0;i<k.length;++i){"),wBe(e,i,"k[i]"),$D(e,i,n,o+"[k[i]]")("}");else if(i.repeated)e("if(!Array.isArray(%s))",o)("return%j",ri(i,"array"))("for(var i=0;i<%s.length;++i){",o),$D(e,i,n,o+"[i]")("}");else{if(i.partOf){var a=MD.safeProp(i.partOf.name);s[i.partOf.name]===1&&e("if(p%s===1)",a)("return%j",i.partOf.name+": multiple values"),s[i.partOf.name]=1,e("p%s=1",a)}$D(e,i,n,o)}i.optional&&e("}")}return e("return null")}});var FD=m(OJ=>{"use strict";var RJ=OJ,cy=Di(),Oo=Br();function LD(t,e,r,s){var n=!1;if(e.resolvedType)if(e.resolvedType instanceof cy){t("switch(d%s){",s);for(var i=e.resolvedType.values,o=Object.keys(i),a=0;a<o.length;++a)i[o[a]]===e.typeDefault&&!n&&(t("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',s,s,s),e.repeated||t("break"),n=!0),t("case%j:",o[a])("case %i:",i[o[a]])("m%s=%j",s,i[o[a]])("break");t("}")}else t('if(typeof d%s!=="object")',s)("throw TypeError(%j)",e.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",s,r,s);else{var l=!1;switch(e.type){case"double":case"float":t("m%s=Number(d%s)",s,s);break;case"uint32":case"fixed32":t("m%s=d%s>>>0",s,s);break;case"int32":case"sint32":case"sfixed32":t("m%s=d%s|0",s,s);break;case"uint64":l=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":t("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",s,s,l)('else if(typeof d%s==="string")',s)("m%s=parseInt(d%s,10)",s,s)('else if(typeof d%s==="number")',s)("m%s=d%s",s,s)('else if(typeof d%s==="object")',s)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",s,s,s,l?"true":"");break;case"bytes":t('if(typeof d%s==="string")',s)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",s,s,s)("else if(d%s.length >= 0)",s)("m%s=d%s",s,s);break;case"string":t("m%s=String(d%s)",s,s);break;case"bool":t("m%s=Boolean(d%s)",s,s);break}}return t}RJ.fromObject=function(e){var r=e.fieldsArray,s=Oo.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!r.length)return s("return new this.ctor");s("var m=new this.ctor");for(var n=0;n<r.length;++n){var i=r[n].resolve(),o=Oo.safeProp(i.name);i.map?(s("if(d%s){",o)('if(typeof d%s!=="object")',o)("throw TypeError(%j)",i.fullName+": object expected")("m%s={}",o)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",o),LD(s,i,n,o+"[ks[i]]")("}")("}")):i.repeated?(s("if(d%s){",o)("if(!Array.isArray(d%s))",o)("throw TypeError(%j)",i.fullName+": array expected")("m%s=[]",o)("for(var i=0;i<d%s.length;++i){",o),LD(s,i,n,o+"[i]")("}")("}")):(i.resolvedType instanceof cy||s("if(d%s!=null){",o),LD(s,i,n,o),i.resolvedType instanceof cy||s("}"))}return s("return m")};function jD(t,e,r,s){if(e.resolvedType)e.resolvedType instanceof cy?t("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",s,r,s,s,r,s,s):t("d%s=types[%i].toObject(m%s,o)",s,r,s);else{var n=!1;switch(e.type){case"double":case"float":t("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",s,s,s,s);break;case"uint64":n=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":t('if(typeof m%s==="number")',s)("d%s=o.longs===String?String(m%s):m%s",s,s,s)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",s,s,s,s,n?"true":"",s);break;case"bytes":t("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",s,s,s,s,s);break;default:t("d%s=m%s",s,s);break}}return t}RJ.toObject=function(e){var r=e.fieldsArray.slice().sort(Oo.compareFieldsById);if(!r.length)return Oo.codegen()("return {}");for(var s=Oo.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),n=[],i=[],o=[],a=0;a<r.length;++a)r[a].partOf||(r[a].resolve().repeated?n:r[a].map?i:o).push(r[a]);if(n.length){for(s("if(o.arrays||o.defaults){"),a=0;a<n.length;++a)s("d%s=[]",Oo.safeProp(n[a].name));s("}")}if(i.length){for(s("if(o.objects||o.defaults){"),a=0;a<i.length;++a)s("d%s={}",Oo.safeProp(i[a].name));s("}")}if(o.length){for(s("if(o.defaults){"),a=0;a<o.length;++a){var l=o[a],u=Oo.safeProp(l.name);if(l.resolvedType instanceof cy)s("d%s=o.enums===String?%j:%j",u,l.resolvedType.valuesById[l.typeDefault],l.typeDefault);else if(l.long)s("if(util.Long){")("var n=new util.Long(%i,%i,%j)",l.typeDefault.low,l.typeDefault.high,l.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",u)("}else")("d%s=o.longs===String?%j:%i",u,l.typeDefault.toString(),l.typeDefault.toNumber());else if(l.bytes){var c="["+Array.prototype.slice.call(l.typeDefault).join(",")+"]";s("if(o.bytes===String)d%s=%j",u,String.fromCharCode.apply(String,l.typeDefault))("else{")("d%s=%s",u,c)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",u,u)("}")}else s("d%s=%j",u,l.typeDefault)}s("}")}var d=!1;for(a=0;a<r.length;++a){var l=r[a],f=e._fieldsArray.indexOf(l),u=Oo.safeProp(l.name);l.map?(d||(d=!0,s("var ks2")),s("if(m%s&&(ks2=Object.keys(m%s)).length){",u,u)("d%s={}",u)("for(var j=0;j<ks2.length;++j){"),jD(s,l,f,u+"[ks2[j]]")("}")):l.repeated?(s("if(m%s&&m%s.length){",u,u)("d%s=[]",u)("for(var j=0;j<m%s.length;++j){",u),jD(s,l,f,u+"[j]")("}")):(s("if(m%s!=null&&m.hasOwnProperty(%j)){",u,l.name),jD(s,l,f,u),l.partOf&&s("if(o.oneofs)")("d%s=%j",Oo.safeProp(l.partOf.name),l.name)),s("}")}return s("return d")}});var BD=m(PJ=>{"use strict";var CBe=PJ,RBe=IE();CBe[".google.protobuf.Any"]={fromObject:function(t){if(t&&t["@type"]){var e=t["@type"].substring(t["@type"].lastIndexOf("/")+1),r=this.lookup(e);if(r){var s=t["@type"].charAt(0)==="."?t["@type"].slice(1):t["@type"];return s.indexOf("/")===-1&&(s="/"+s),this.create({type_url:s,value:r.encode(r.fromObject(t)).finish()})}}return this.fromObject(t)},toObject:function(t,e){var r="type.googleapis.com/",s="",n="";if(e&&e.json&&t.type_url&&t.value){n=t.type_url.substring(t.type_url.lastIndexOf("/")+1),s=t.type_url.substring(0,t.type_url.lastIndexOf("/")+1);var i=this.lookup(n);i&&(t=i.decode(t.value))}if(!(t instanceof this.ctor)&&t instanceof RBe){var o=t.$type.toObject(t,e),a=t.$type.fullName[0]==="."?t.$type.fullName.slice(1):t.$type.fullName;return s===""&&(s=r),n=s+a,o["@type"]=n,o}return this.toObject(t,e)}}});var ME=m((Stt,kJ)=>{"use strict";kJ.exports=Mt;var Mi=Nh();((Mt.prototype=Object.create(Mi.prototype)).constructor=Mt).className="Type";var OBe=Di(),VD=kh(),NE=Wl(),PBe=AE(),ABe=xE(),zD=IE(),UD=TE(),kBe=EE(),ys=Br(),xBe=HD(),IBe=DD(),NBe=qD(),AJ=FD(),DBe=BD();function Mt(t,e){Mi.call(this,t,e),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}Object.defineProperties(Mt.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var t=Object.keys(this.fields),e=0;e<t.length;++e){var r=this.fields[t[e]],s=r.id;if(this._fieldsById[s])throw Error("duplicate id "+s+" in "+this);this._fieldsById[s]=r}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=ys.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=ys.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=Mt.generateConstructor(this)())},set:function(t){var e=t.prototype;e instanceof zD||((t.prototype=new zD).constructor=t,ys.merge(t.prototype,e)),t.$type=t.prototype.$type=this,ys.merge(t,zD,!0),this._ctor=t;for(var r=0;r<this.fieldsArray.length;++r)this._fieldsArray[r].resolve();var s={};for(r=0;r<this.oneofsArray.length;++r)s[this._oneofsArray[r].resolve().name]={get:ys.oneOfGetter(this._oneofsArray[r].oneof),set:ys.oneOfSetter(this._oneofsArray[r].oneof)};r&&Object.defineProperties(t.prototype,s)}}});Mt.generateConstructor=function(e){for(var r=ys.codegen(["p"],e.name),s=0,n;s<e.fieldsArray.length;++s)(n=e._fieldsArray[s]).map?r("this%s={}",ys.safeProp(n.name)):n.repeated&&r("this%s=[]",ys.safeProp(n.name));return r("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")};function DE(t){return t._fieldsById=t._fieldsArray=t._oneofsArray=null,delete t.encode,delete t.decode,delete t.verify,t}Mt.fromJSON=function(e,r){var s=new Mt(e,r.options);s.extensions=r.extensions,s.reserved=r.reserved;for(var n=Object.keys(r.fields),i=0;i<n.length;++i)s.add((typeof r.fields[n[i]].keyType<"u"?PBe.fromJSON:NE.fromJSON)(n[i],r.fields[n[i]]));if(r.oneofs)for(n=Object.keys(r.oneofs),i=0;i<n.length;++i)s.add(VD.fromJSON(n[i],r.oneofs[n[i]]));if(r.nested)for(n=Object.keys(r.nested),i=0;i<n.length;++i){var o=r.nested[n[i]];s.add((o.id!==void 0?NE.fromJSON:o.fields!==void 0?Mt.fromJSON:o.values!==void 0?OBe.fromJSON:o.methods!==void 0?ABe.fromJSON:Mi.fromJSON)(n[i],o))}return r.extensions&&r.extensions.length&&(s.extensions=r.extensions),r.reserved&&r.reserved.length&&(s.reserved=r.reserved),r.group&&(s.group=!0),r.comment&&(s.comment=r.comment),s};Mt.prototype.toJSON=function(e){var r=Mi.prototype.toJSON.call(this,e),s=e?!!e.keepComments:!1;return ys.toObject(["options",r&&r.options||void 0,"oneofs",Mi.arrayToJSON(this.oneofsArray,e),"fields",Mi.arrayToJSON(this.fieldsArray.filter(function(n){return!n.declaringField}),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",r&&r.nested||void 0,"comment",s?this.comment:void 0])};Mt.prototype.resolveAll=function(){for(var e=this.fieldsArray,r=0;r<e.length;)e[r++].resolve();var s=this.oneofsArray;for(r=0;r<s.length;)s[r++].resolve();return Mi.prototype.resolveAll.call(this)};Mt.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null};Mt.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof NE&&e.extend===void 0){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),DE(this)}return e instanceof VD?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),DE(this)):Mi.prototype.add.call(this,e)};Mt.prototype.remove=function(e){if(e instanceof NE&&e.extend===void 0){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),DE(this)}if(e instanceof VD){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),DE(this)}return Mi.prototype.remove.call(this,e)};Mt.prototype.isReservedId=function(e){return Mi.isReservedId(this.reserved,e)};Mt.prototype.isReservedName=function(e){return Mi.isReservedName(this.reserved,e)};Mt.prototype.create=function(e){return new this.ctor(e)};Mt.prototype.setup=function(){for(var e=this.fullName,r=[],s=0;s<this.fieldsArray.length;++s)r.push(this._fieldsArray[s].resolve().resolvedType);this.encode=xBe(this)({Writer:kBe,types:r,util:ys}),this.decode=IBe(this)({Reader:UD,types:r,util:ys}),this.verify=NBe(this)({types:r,util:ys}),this.fromObject=AJ.fromObject(this)({types:r,util:ys}),this.toObject=AJ.toObject(this)({types:r,util:ys});var n=DBe[e];if(n){var i=Object.create(this);i.fromObject=this.fromObject,this.fromObject=n.fromObject.bind(i),i.toObject=this.toObject,this.toObject=n.toObject.bind(i)}return this};Mt.prototype.encode=function(e,r){return this.setup().encode(e,r)};Mt.prototype.encodeDelimited=function(e,r){return this.encode(e,r&&r.len?r.fork():r).ldelim()};Mt.prototype.decode=function(e,r){return this.setup().decode(e,r)};Mt.prototype.decodeDelimited=function(e){return e instanceof UD||(e=UD.create(e)),this.decode(e,e.uint32())};Mt.prototype.verify=function(e){return this.setup().verify(e)};Mt.prototype.fromObject=function(e){return this.setup().fromObject(e)};Mt.prototype.toObject=function(e,r){return this.setup().toObject(e,r)};Mt.d=function(e){return function(s){ys.decorateType(s,e)}}});var LE=m((btt,MJ)=>{"use strict";MJ.exports=mn;var qE=Nh();((mn.prototype=Object.create(qE.prototype)).constructor=mn).className="Root";var KD=Wl(),IJ=Di(),MBe=kh(),Yl=Br(),NJ,GD,dy;function mn(t){qE.call(this,"",t),this.deferred=[],this.files=[]}mn.fromJSON=function(e,r){return r||(r=new mn),e.options&&r.setOptions(e.options),r.addJSON(e.nested)};mn.prototype.resolvePath=Yl.path.resolve;mn.prototype.fetch=Yl.fetch;function DJ(){}mn.prototype.load=function t(e,r,s){typeof r=="function"&&(s=r,r=void 0);var n=this;if(!s)return Yl.asPromise(t,n,e,r);var i=s===DJ;function o(h,p){if(s){if(i)throw h;var g=s;s=null,g(h,p)}}function a(h){var p=h.lastIndexOf("google/protobuf/");if(p>-1){var g=h.substring(p);if(g in dy)return g}return null}function l(h,p){try{if(Yl.isString(p)&&p.charAt(0)==="{"&&(p=JSON.parse(p)),!Yl.isString(p))n.setOptions(p.options).addJSON(p.nested);else{GD.filename=h;var g=GD(p,n,r),_,S=0;if(g.imports)for(;S<g.imports.length;++S)(_=a(g.imports[S])||n.resolvePath(h,g.imports[S]))&&u(_);if(g.weakImports)for(S=0;S<g.weakImports.length;++S)(_=a(g.weakImports[S])||n.resolvePath(h,g.weakImports[S]))&&u(_,!0)}}catch(b){o(b)}!i&&!c&&o(null,n)}function u(h,p){if(h=a(h)||h,!(n.files.indexOf(h)>-1)){if(n.files.push(h),h in dy){i?l(h,dy[h]):(++c,setTimeout(function(){--c,l(h,dy[h])}));return}if(i){var g;try{g=Yl.fs.readFileSync(h).toString("utf8")}catch(_){p||o(_);return}l(h,g)}else++c,n.fetch(h,function(_,S){if(--c,!!s){if(_){p?c||o(null,n):o(_);return}l(h,S)}})}}var c=0;Yl.isString(e)&&(e=[e]);for(var d=0,f;d<e.length;++d)(f=n.resolvePath("",e[d]))&&u(f);if(i)return n;c||o(null,n)};mn.prototype.loadSync=function(e,r){if(!Yl.isNode)throw Error("not supported");return this.load(e,r,DJ)};mn.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(e){return"'extend "+e.extend+"' in "+e.parent.fullName}).join(", "));return qE.prototype.resolveAll.call(this)};var $E=/^[A-Z]/;function xJ(t,e){var r=e.parent.lookup(e.extend);if(r){var s=new KD(e.fullName,e.id,e.type,e.rule,void 0,e.options);return r.get(s.name)||(s.declaringField=e,e.extensionField=s,r.add(s)),!0}return!1}mn.prototype._handleAdd=function(e){if(e instanceof KD)e.extend!==void 0&&!e.extensionField&&(xJ(this,e)||this.deferred.push(e));else if(e instanceof IJ)$E.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof MBe)){if(e instanceof NJ)for(var r=0;r<this.deferred.length;)xJ(this,this.deferred[r])?this.deferred.splice(r,1):++r;for(var s=0;s<e.nestedArray.length;++s)this._handleAdd(e._nestedArray[s]);$E.test(e.name)&&(e.parent[e.name]=e)}};mn.prototype._handleRemove=function(e){if(e instanceof KD){if(e.extend!==void 0)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var r=this.deferred.indexOf(e);r>-1&&this.deferred.splice(r,1)}}else if(e instanceof IJ)$E.test(e.name)&&delete e.parent[e.name];else if(e instanceof qE){for(var s=0;s<e.nestedArray.length;++s)this._handleRemove(e._nestedArray[s]);$E.test(e.name)&&delete e.parent[e.name]}};mn._configure=function(t,e,r){NJ=t,GD=e,dy=r}});var Br=m((Ett,qJ)=>{"use strict";var pr=qJ.exports=To(),$J=TD(),QD,WD;pr.codegen=tJ();pr.fetch=sJ();pr.path=oJ();pr.fs=pr.inquire("fs");pr.toArray=function(e){if(e){for(var r=Object.keys(e),s=new Array(r.length),n=0;n<r.length;)s[n]=e[r[n++]];return s}return[]};pr.toObject=function(e){for(var r={},s=0;s<e.length;){var n=e[s++],i=e[s++];i!==void 0&&(r[n]=i)}return r};var $Be=/\\/g,qBe=/"/g;pr.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)};pr.safeProp=function(e){return!/^[$\w_]+$/.test(e)||pr.isReserved(e)?'["'+e.replace($Be,"\\\\").replace(qBe,'\\"')+'"]':"."+e};pr.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var LBe=/_([a-z])/g;pr.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(LBe,function(r,s){return s.toUpperCase()})};pr.compareFieldsById=function(e,r){return e.id-r.id};pr.decorateType=function(e,r){if(e.$type)return r&&e.$type.name!==r&&(pr.decorateRoot.remove(e.$type),e.$type.name=r,pr.decorateRoot.add(e.$type)),e.$type;QD||(QD=ME());var s=new QD(r||e.name);return pr.decorateRoot.add(s),s.ctor=e,Object.defineProperty(e,"$type",{value:s,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:s,enumerable:!1}),s};var jBe=0;pr.decorateEnum=function(e){if(e.$type)return e.$type;WD||(WD=Di());var r=new WD("Enum"+jBe++,e);return pr.decorateRoot.add(r),Object.defineProperty(e,"$type",{value:r,enumerable:!1}),r};pr.setProperty=function(e,r,s){function n(i,o,a){var l=o.shift();if(l==="__proto__"||l==="prototype")return i;if(o.length>0)i[l]=n(i[l]||{},o,a);else{var u=i[l];u&&(a=[].concat(u).concat(a)),i[l]=a}return i}if(typeof e!="object")throw TypeError("dst must be an object");if(!r)throw TypeError("path must be specified");return r=r.split("."),n(e,r,s)};Object.defineProperty(pr,"decorateRoot",{get:function(){return $J.decorated||($J.decorated=new(LE()))}})});var jc=m((wtt,LJ)=>{"use strict";LJ.exports=gn;gn.className="ReflectionObject";var jE=Br(),FE;function gn(t,e){if(!jE.isString(t))throw TypeError("name must be a string");if(e&&!jE.isObject(e))throw TypeError("options must be an object");this.options=e,this.parsedOptions=null,this.name=t,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(gn.prototype,{root:{get:function(){for(var t=this;t.parent!==null;)t=t.parent;return t}},fullName:{get:function(){for(var t=[this.name],e=this.parent;e;)t.unshift(e.name),e=e.parent;return t.join(".")}}});gn.prototype.toJSON=function(){throw Error()};gn.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var r=e.root;r instanceof FE&&r._handleAdd(this)};gn.prototype.onRemove=function(e){var r=e.root;r instanceof FE&&r._handleRemove(this),this.parent=null,this.resolved=!1};gn.prototype.resolve=function(){return this.resolved?this:(this.root instanceof FE&&(this.resolved=!0),this)};gn.prototype.getOption=function(e){if(this.options)return this.options[e]};gn.prototype.setOption=function(e,r,s){return(!s||!this.options||this.options[e]===void 0)&&((this.options||(this.options={}))[e]=r),this};gn.prototype.setParsedOption=function(e,r,s){this.parsedOptions||(this.parsedOptions=[]);var n=this.parsedOptions;if(s){var i=n.find(function(l){return Object.prototype.hasOwnProperty.call(l,e)});if(i){var o=i[e];jE.setProperty(o,s,r)}else i={},i[e]=jE.setProperty({},s,r),n.push(i)}else{var a={};a[e]=r,n.push(a)}return this};gn.prototype.setOptions=function(e,r){if(e)for(var s=Object.keys(e),n=0;n<s.length;++n)this.setOption(s[n],e[s[n]],r);return this};gn.prototype.toString=function(){var e=this.constructor.className,r=this.fullName;return r.length?e+" "+r:e};gn._configure=function(t){FE=t}});var Di=m((Ttt,BJ)=>{"use strict";BJ.exports=Po;var jJ=jc();((Po.prototype=Object.create(jJ.prototype)).constructor=Po).className="Enum";var FJ=Nh(),BE=Br();function Po(t,e,r,s,n,i){if(jJ.call(this,t,r),e&&typeof e!="object")throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=s,this.comments=n||{},this.valuesOptions=i,this.reserved=void 0,e)for(var o=Object.keys(e),a=0;a<o.length;++a)typeof e[o[a]]=="number"&&(this.valuesById[this.values[o[a]]=e[o[a]]]=o[a])}Po.fromJSON=function(e,r){var s=new Po(e,r.values,r.options,r.comment,r.comments);return s.reserved=r.reserved,s};Po.prototype.toJSON=function(e){var r=e?!!e.keepComments:!1;return BE.toObject(["options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",r?this.comment:void 0,"comments",r?this.comments:void 0])};Po.prototype.add=function(e,r,s,n){if(!BE.isString(e))throw TypeError("name must be a string");if(!BE.isInteger(r))throw TypeError("id must be an integer");if(this.values[e]!==void 0)throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(r))throw Error("id "+r+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(this.valuesById[r]!==void 0){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+r+" in "+this);this.values[e]=r}else this.valuesById[this.values[e]=r]=e;return n&&(this.valuesOptions===void 0&&(this.valuesOptions={}),this.valuesOptions[e]=n||null),this.comments[e]=s||null,this};Po.prototype.remove=function(e){if(!BE.isString(e))throw TypeError("name must be a string");var r=this.values[e];if(r==null)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[r],delete this.values[e],delete this.comments[e],this.valuesOptions&&delete this.valuesOptions[e],this};Po.prototype.isReservedId=function(e){return FJ.isReservedId(this.reserved,e)};Po.prototype.isReservedName=function(e){return FJ.isReservedName(this.reserved,e)}});var HD=m((Ctt,UJ)=>{"use strict";UJ.exports=BBe;var FBe=Di(),ZD=Lc(),YD=Br();function zJ(t,e,r,s){return e.resolvedType.group?t("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",r,s,(e.id<<3|3)>>>0,(e.id<<3|4)>>>0):t("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",r,s,(e.id<<3|2)>>>0)}function BBe(t){for(var e=YD.codegen(["m","w"],t.name+"$encode")("if(!w)")("w=Writer.create()"),r,s,n=t.fieldsArray.slice().sort(YD.compareFieldsById),r=0;r<n.length;++r){var i=n[r].resolve(),o=t._fieldsArray.indexOf(i),a=i.resolvedType instanceof FBe?"int32":i.type,l=ZD.basic[a];s="m"+YD.safeProp(i.name),i.map?(e("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",s,i.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",s)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(i.id<<3|2)>>>0,8|ZD.mapKey[i.keyType],i.keyType),l===void 0?e("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",o,s):e(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|l,a,s),e("}")("}")):i.repeated?(e("if(%s!=null&&%s.length){",s,s),i.packed&&ZD.packed[a]!==void 0?e("w.uint32(%i).fork()",(i.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",s)("w.%s(%s[i])",a,s)("w.ldelim()"):(e("for(var i=0;i<%s.length;++i)",s),l===void 0?zJ(e,i,o,s+"[i]"):e("w.uint32(%i).%s(%s[i])",(i.id<<3|l)>>>0,a,s)),e("}")):(i.optional&&e("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",s,i.name),l===void 0?zJ(e,i,o,s):e("w.uint32(%i).%s(%s)",(i.id<<3|l)>>>0,a,s))}return e("return w")}});var HJ=m((Rtt,VJ)=>{"use strict";var at=VJ.exports=XY();at.build="light";function zBe(t,e,r){return typeof e=="function"?(r=e,e=new at.Root):e||(e=new at.Root),e.load(t,r)}at.load=zBe;function UBe(t,e){return e||(e=new at.Root),e.loadSync(t)}at.loadSync=UBe;at.encoder=HD();at.decoder=DD();at.verifier=qD();at.converter=FD();at.ReflectionObject=jc();at.Namespace=Nh();at.Root=LE();at.Enum=Di();at.Type=ME();at.Field=Wl();at.OneOf=kh();at.MapField=AE();at.Service=xE();at.Method=kE();at.Message=IE();at.wrappers=BD();at.types=Lc();at.util=Br();at.ReflectionObject._configure(at.Root);at.Namespace._configure(at.Type,at.Service,at.Enum);at.Root._configure(at.Type);at.Field._configure(at.Type)});var XD=m((Ott,QJ)=>{"use strict";QJ.exports=KJ;var JD=/[\s{}=;:[\],'"()<>]/g,VBe=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,HBe=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,GBe=/^ *[*/]+ */,KBe=/^\s*\*?\/*/,QBe=/\n/g,WBe=/\s/,ZBe=/\\(.?)/g,YBe={0:"\0",r:"\r",n:`
`,t:"	"};function GJ(t){return t.replace(ZBe,function(e,r){switch(r){case"\\":case"":return r;default:return YBe[r]||""}})}KJ.unescape=GJ;function KJ(t,e){t=t.toString();var r=0,s=t.length,n=1,i=0,o={},a=[],l=null;function u(y){return Error("illegal "+y+" (line "+n+")")}function c(){var y=l==="'"?HBe:VBe;y.lastIndex=r-1;var R=y.exec(t);if(!R)throw u("string");return r=y.lastIndex,_(l),l=null,GJ(R[1])}function d(y){return t.charAt(y)}function f(y,R,P){var w={type:t.charAt(y++),lineEmpty:!1,leading:P},O;e?O=2:O=3;var $=y-O,C;do if(--$<0||(C=t.charAt($))===`
`){w.lineEmpty=!0;break}while(C===" "||C==="	");for(var k=t.substring(y,R).split(QBe),z=0;z<k.length;++z)k[z]=k[z].replace(e?KBe:GBe,"").trim();w.text=k.join(`
`).trim(),o[n]=w,i=n}function h(y){var R=p(y),P=t.substring(y,R),w=/^\s*\/\//.test(P);return w}function p(y){for(var R=y;R<s&&d(R)!==`
`;)R++;return R}function g(){if(a.length>0)return a.shift();if(l)return c();var y,R,P,w,O,$=r===0;do{if(r===s)return null;for(y=!1;WBe.test(P=d(r));)if(P===`
`&&($=!0,++n),++r===s)return null;if(d(r)==="/"){if(++r===s)throw u("comment");if(d(r)==="/")if(e){if(w=r,O=!1,h(r-1)){O=!0;do if(r=p(r),r===s||(r++,!$))break;while(h(r))}else r=Math.min(s,p(r)+1);O&&(f(w,r,$),$=!0),n++,y=!0}else{for(O=d(w=r+1)==="/";d(++r)!==`
`;)if(r===s)return null;++r,O&&(f(w,r-1,$),$=!0),++n,y=!0}else if((P=d(r))==="*"){w=r+1,O=e||d(w)==="*";do{if(P===`
`&&++n,++r===s)throw u("comment");R=P,P=d(r)}while(R!=="*"||P!=="/");++r,O&&(f(w,r-2,$),$=!0),y=!0}else return"/"}}while(y);var C=r;JD.lastIndex=0;var k=JD.test(d(C++));if(!k)for(;C<s&&!JD.test(d(C));)++C;var z=t.substring(r,r=C);return(z==='"'||z==="'")&&(l=z),z}function _(y){a.push(y)}function S(){if(!a.length){var y=g();if(y===null)return null;_(y)}return a[0]}function b(y,R){var P=S(),w=P===y;if(w)return g(),!0;if(!R)throw u("token '"+P+"', '"+y+"' expected");return!1}function v(y){var R=null,P;return y===void 0?(P=o[n-1],delete o[n-1],P&&(e||P.type==="*"||P.lineEmpty)&&(R=P.leading?P.text:null)):(i<y&&S(),P=o[y],delete o[y],P&&!P.lineEmpty&&(e||P.type==="/")&&(R=P.leading?null:P.text)),R}return Object.defineProperty({next:g,peek:S,push:_,skip:b,cmnt:v},"line",{get:function(){return n}})}});var eX=m((Ptt,XJ)=>{"use strict";XJ.exports=Ta;Ta.filename=null;Ta.defaults={keepCase:!1};var JBe=XD(),WJ=LE(),ZJ=ME(),YJ=Wl(),XBe=AE(),JJ=kh(),eze=Di(),tze=xE(),rze=kE(),eM=Lc(),tM=Br(),sze=/^[1-9][0-9]*$/,nze=/^-?[1-9][0-9]*$/,ize=/^0[x][0-9a-fA-F]+$/,oze=/^-?0[x][0-9a-fA-F]+$/,aze=/^0[0-7]+$/,lze=/^-?0[0-7]+$/,uze=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,Ao=/^[a-zA-Z_][a-zA-Z_0-9]*$/,ko=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,cze=/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/;function Ta(t,e,r){e instanceof WJ||(r=e,e=new WJ),r||(r=Ta.defaults);var s=r.preferTrailingComment||!1,n=JBe(t,r.alternateCommentMode||!1),i=n.next,o=n.push,a=n.peek,l=n.skip,u=n.cmnt,c=!0,d,f,h,p,g=!1,_=e,S=r.keepCase?function(W){return W}:tM.camelCase;function b(W,H,Q){var N=Ta.filename;return Q||(Ta.filename=null),Error("illegal "+(H||"token")+" '"+W+"' ("+(N?N+", ":"")+"line "+n.line+")")}function v(){var W=[],H;do{if((H=i())!=='"'&&H!=="'")throw b(H);W.push(i()),l(H),H=a()}while(H==='"'||H==="'");return W.join("")}function y(W){var H=i();switch(H){case"'":case'"':return o(H),v();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return P(H,!0)}catch{if(W&&ko.test(H))return H;throw b(H,"value")}}function R(W,H){var Q,N;do H&&((Q=a())==='"'||Q==="'")?W.push(v()):W.push([N=w(i()),l("to",!0)?w(i()):N]);while(l(",",!0));var q={options:void 0};q.setOption=function(K,se){this.options===void 0&&(this.options={}),this.options[K]=se},z(q,function(se){if(se==="option")ye(q,se),l(";");else throw b(se)},function(){Ze(q)})}function P(W,H){var Q=1;switch(W.charAt(0)==="-"&&(Q=-1,W=W.substring(1)),W){case"inf":case"INF":case"Inf":return Q*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(sze.test(W))return Q*parseInt(W,10);if(ize.test(W))return Q*parseInt(W,16);if(aze.test(W))return Q*parseInt(W,8);if(uze.test(W))return Q*parseFloat(W);throw b(W,"number",H)}function w(W,H){switch(W){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!H&&W.charAt(0)==="-")throw b(W,"id");if(nze.test(W))return parseInt(W,10);if(oze.test(W))return parseInt(W,16);if(lze.test(W))return parseInt(W,8);throw b(W,"id")}function O(){if(d!==void 0)throw b("package");if(d=i(),!ko.test(d))throw b(d,"name");_=_.define(d),l(";")}function $(){var W=a(),H;switch(W){case"weak":H=h||(h=[]),i();break;case"public":i();default:H=f||(f=[]);break}W=v(),l(";"),H.push(W)}function C(){if(l("="),p=v(),g=p==="proto3",!g&&p!=="proto2")throw b(p,"syntax");l(";")}function k(W,H){switch(H){case"option":return ye(W,H),l(";"),!0;case"message":return A(W,H),!0;case"enum":return pe(W,H),!0;case"service":return _e(W,H),!0;case"extend":return Re(W,H),!0}return!1}function z(W,H,Q){var N=n.line;if(W&&(typeof W.comment!="string"&&(W.comment=u()),W.filename=Ta.filename),l("{",!0)){for(var q;(q=i())!=="}";)H(q);l(";",!0)}else Q&&Q(),l(";"),W&&(typeof W.comment!="string"||s)&&(W.comment=u(N)||W.comment)}function A(W,H){if(!Ao.test(H=i()))throw b(H,"type name");var Q=new ZJ(H);z(Q,function(q){if(!k(Q,q))switch(q){case"map":G(Q,q);break;case"required":case"repeated":E(Q,q);break;case"optional":g?E(Q,"proto3_optional"):E(Q,"optional");break;case"oneof":X(Q,q);break;case"extensions":R(Q.extensions||(Q.extensions=[]));break;case"reserved":R(Q.reserved||(Q.reserved=[]),!0);break;default:if(!g||!ko.test(q))throw b(q);o(q),E(Q,"optional");break}}),W.add(Q)}function E(W,H,Q){var N=i();if(N==="group"){V(W,H);return}for(;N.endsWith(".")||a().startsWith(".");)N+=i();if(!ko.test(N))throw b(N,"type");var q=i();if(!Ao.test(q))throw b(q,"name");q=S(q),l("=");var K=new YJ(q,w(i()),N,H,Q);if(z(K,function(le){if(le==="option")ye(K,le),l(";");else throw b(le)},function(){Ze(K)}),H==="proto3_optional"){var se=new JJ("_"+q);K.setOption("proto3_optional",!0),se.add(K),W.add(se)}else W.add(K);!g&&K.repeated&&(eM.packed[N]!==void 0||eM.basic[N]===void 0)&&K.setOption("packed",!1,!0)}function V(W,H){var Q=i();if(!Ao.test(Q))throw b(Q,"name");var N=tM.lcFirst(Q);Q===N&&(Q=tM.ucFirst(Q)),l("=");var q=w(i()),K=new ZJ(Q);K.group=!0;var se=new YJ(N,q,Q,H);se.filename=Ta.filename,z(K,function(le){switch(le){case"option":ye(K,le),l(";");break;case"required":case"repeated":E(K,le);break;case"optional":g?E(K,"proto3_optional"):E(K,"optional");break;case"message":A(K,le);break;case"enum":pe(K,le);break;default:throw b(le)}}),W.add(K).add(se)}function G(W){l("<");var H=i();if(eM.mapKey[H]===void 0)throw b(H,"type");l(",");var Q=i();if(!ko.test(Q))throw b(Q,"type");l(">");var N=i();if(!Ao.test(N))throw b(N,"name");l("=");var q=new XBe(S(N),w(i()),H,Q);z(q,function(se){if(se==="option")ye(q,se),l(";");else throw b(se)},function(){Ze(q)}),W.add(q)}function X(W,H){if(!Ao.test(H=i()))throw b(H,"name");var Q=new JJ(S(H));z(Q,function(q){q==="option"?(ye(Q,q),l(";")):(o(q),E(Q,"optional"))}),W.add(Q)}function pe(W,H){if(!Ao.test(H=i()))throw b(H,"name");var Q=new eze(H);z(Q,function(q){switch(q){case"option":ye(Q,q),l(";");break;case"reserved":R(Q.reserved||(Q.reserved=[]),!0);break;default:J(Q,q)}}),W.add(Q)}function J(W,H){if(!Ao.test(H))throw b(H,"name");l("=");var Q=w(i(),!0),N={options:void 0};N.setOption=function(q,K){this.options===void 0&&(this.options={}),this.options[q]=K},z(N,function(K){if(K==="option")ye(N,K),l(";");else throw b(K)},function(){Ze(N)}),W.add(H,Q,N.comment,N.options)}function ye(W,H){var Q=l("(",!0);if(!ko.test(H=i()))throw b(H,"name");var N=H,q=N,K;Q&&(l(")"),N="("+N+")",q=N,H=a(),cze.test(H)&&(K=H.slice(1),N+=H,i())),l("=");var se=st(W,N);pt(W,q,se,K)}function st(W,H){if(l("{",!0)){for(var Q={};!l("}",!0);){if(!Ao.test(Pe=i()))throw b(Pe,"name");if(Pe===null)throw b(Pe,"end of input");var N,q=Pe;if(l(":",!0),a()==="{")N=st(W,H+"."+Pe);else if(a()==="["){N=[];var K;if(l("[",!0)){do K=y(!0),N.push(K);while(l(",",!0));l("]"),typeof K<"u"&&ve(W,H+"."+Pe,K)}}else N=y(!0),ve(W,H+"."+Pe,N);var se=Q[q];se&&(N=[].concat(se).concat(N)),Q[q]=N,l(",",!0),l(";",!0)}return Q}var ke=y(!0);return ve(W,H,ke),ke}function ve(W,H,Q){W.setOption&&W.setOption(H,Q)}function pt(W,H,Q,N){W.setParsedOption&&W.setParsedOption(H,Q,N)}function Ze(W){if(l("[",!0)){do ye(W,"option");while(l(",",!0));l("]")}return W}function _e(W,H){if(!Ao.test(H=i()))throw b(H,"service name");var Q=new tze(H);z(Q,function(q){if(!k(Q,q))if(q==="rpc")Ye(Q,q);else throw b(q)}),W.add(Q)}function Ye(W,H){var Q=u(),N=H;if(!Ao.test(H=i()))throw b(H,"name");var q=H,K,se,ke,le;if(l("("),l("stream",!0)&&(se=!0),!ko.test(H=i())||(K=H,l(")"),l("returns"),l("("),l("stream",!0)&&(le=!0),!ko.test(H=i())))throw b(H);ke=H,l(")");var lt=new rze(q,N,K,ke,se,le);lt.comment=Q,z(lt,function(mt){if(mt==="option")ye(lt,mt),l(";");else throw b(mt)}),W.add(lt)}function Re(W,H){if(!ko.test(H=i()))throw b(H,"reference");var Q=H;z(null,function(q){switch(q){case"required":case"repeated":E(W,q,Q);break;case"optional":g?E(W,"proto3_optional",Q):E(W,"optional",Q);break;default:if(!g||!ko.test(q))throw b(q);o(q),E(W,"optional",Q);break}})}for(var Pe;(Pe=i())!==null;)switch(Pe){case"package":if(!c)throw b(Pe);O();break;case"import":if(!c)throw b(Pe);$();break;case"syntax":if(!c)throw b(Pe);C();break;case"option":ye(_,Pe),l(";");break;default:if(k(_,Pe)){c=!1;continue}throw b(Pe)}return Ta.filename=null,{package:d,imports:f,weakImports:h,syntax:p,root:e}}});var sX=m((Att,rX)=>{"use strict";rX.exports=$i;var dze=/\/|\./;function $i(t,e){dze.test(t)||(t="google/protobuf/"+t+".proto",e={nested:{google:{nested:{protobuf:{nested:e}}}}}),$i[t]=e}$i("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}});var tX;$i("duration",{Duration:tX={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}});$i("timestamp",{Timestamp:tX});$i("empty",{Empty:{fields:{}}});$i("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}});$i("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}});$i("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}});$i.get=function(e){return $i[e]||null}});var iX=m((ktt,nX)=>{"use strict";var Jl=nX.exports=HJ();Jl.build="full";Jl.tokenize=XD();Jl.parse=eX();Jl.common=sX();Jl.Root._configure(Jl.Type,Jl.parse,Jl.common)});var zE=m((xtt,oX)=>{"use strict";oX.exports=iX()});var rM=m((Itt,fze)=>{fze.exports={nested:{google:{nested:{protobuf:{nested:{FileDescriptorSet:{fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}}},FileDescriptorProto:{fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10,options:{packed:!1}},weakDependency:{rule:"repeated",type:"int32",id:11,options:{packed:!1}},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12}}},DescriptorProto:{fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},FieldDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REQUIRED:2,LABEL_REPEATED:3}}}},OneofDescriptorProto:{fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3}}},EnumValueDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[38,38]],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[8,8]]},FieldOptions:{fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}}}},OneofOptions:{fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumOptions:{fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumValueOptions:{fields:{deprecated:{type:"bool",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},ServiceOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},MethodOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},UninterpretedOption:{fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},SourceCodeInfo:{fields:{location:{rule:"repeated",type:"Location",id:1}},nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1},span:{rule:"repeated",type:"int32",id:2},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4}}}}}}}}}}}});var dX=m((Qe,cX)=>{"use strict";var ks=zE();cX.exports=Qe=ks.descriptor=ks.Root.fromJSON(rM()).lookup(".google.protobuf");var aX=ks.Namespace,fy=ks.Root,Ca=ks.Enum,Xl=ks.Type,eu=ks.Field,hze=ks.MapField,UE=ks.OneOf,hy=ks.Service,VE=ks.Method;fy.fromDescriptor=function(e){typeof e.length=="number"&&(e=Qe.FileDescriptorSet.decode(e));var r=new fy;if(e.file)for(var s,n,i=0,o;i<e.file.length;++i){if(n=r,(s=e.file[i]).package&&s.package.length&&(n=r.define(s.package)),s.name&&s.name.length&&r.files.push(n.filename=s.name),s.messageType)for(o=0;o<s.messageType.length;++o)n.add(Xl.fromDescriptor(s.messageType[o],s.syntax));if(s.enumType)for(o=0;o<s.enumType.length;++o)n.add(Ca.fromDescriptor(s.enumType[o]));if(s.extension)for(o=0;o<s.extension.length;++o)n.add(eu.fromDescriptor(s.extension[o]));if(s.service)for(o=0;o<s.service.length;++o)n.add(hy.fromDescriptor(s.service[o]));var a=Mh(s.options,Qe.FileOptions);if(a){var l=Object.keys(a);for(o=0;o<l.length;++o)n.setOption(l[o],a[l[o]])}}return r};fy.prototype.toDescriptor=function(e){var r=Qe.FileDescriptorSet.create();return lX(this,r.file,e),r};function lX(t,e,r){var s=Qe.FileDescriptorProto.create({name:t.filename||(t.fullName.substring(1).replace(/\./g,"_")||"root")+".proto"});r&&(s.syntax=r),t instanceof fy||(s.package=t.fullName.substring(1));for(var n=0,i;n<t.nestedArray.length;++n)(i=t._nestedArray[n])instanceof Xl?s.messageType.push(i.toDescriptor(r)):i instanceof Ca?s.enumType.push(i.toDescriptor()):i instanceof eu?s.extension.push(i.toDescriptor(r)):i instanceof hy?s.service.push(i.toDescriptor()):i instanceof aX&&lX(i,e,r);s.options=$h(t.options,Qe.FileOptions),s.messageType.length+s.enumType.length+s.extension.length+s.service.length&&e.push(s)}var pze=0;Xl.fromDescriptor=function(e,r){typeof e.length=="number"&&(e=Qe.DescriptorProto.decode(e));var s=new Xl(e.name.length?e.name:"Type"+pze++,Mh(e.options,Qe.MessageOptions)),n;if(e.oneofDecl)for(n=0;n<e.oneofDecl.length;++n)s.add(UE.fromDescriptor(e.oneofDecl[n]));if(e.field)for(n=0;n<e.field.length;++n){var i=eu.fromDescriptor(e.field[n],r);s.add(i),e.field[n].hasOwnProperty("oneofIndex")&&s.oneofsArray[e.field[n].oneofIndex].add(i)}if(e.extension)for(n=0;n<e.extension.length;++n)s.add(eu.fromDescriptor(e.extension[n],r));if(e.nestedType)for(n=0;n<e.nestedType.length;++n)s.add(Xl.fromDescriptor(e.nestedType[n],r)),e.nestedType[n].options&&e.nestedType[n].options.mapEntry&&s.setOption("map_entry",!0);if(e.enumType)for(n=0;n<e.enumType.length;++n)s.add(Ca.fromDescriptor(e.enumType[n]));if(e.extensionRange&&e.extensionRange.length)for(s.extensions=[],n=0;n<e.extensionRange.length;++n)s.extensions.push([e.extensionRange[n].start,e.extensionRange[n].end]);if(e.reservedRange&&e.reservedRange.length||e.reservedName&&e.reservedName.length){if(s.reserved=[],e.reservedRange)for(n=0;n<e.reservedRange.length;++n)s.reserved.push([e.reservedRange[n].start,e.reservedRange[n].end]);if(e.reservedName)for(n=0;n<e.reservedName.length;++n)s.reserved.push(e.reservedName[n])}return s};Xl.prototype.toDescriptor=function(e){var r=Qe.DescriptorProto.create({name:this.name}),s;for(s=0;s<this.fieldsArray.length;++s){var n;if(r.field.push(n=this._fieldsArray[s].toDescriptor(e)),this._fieldsArray[s]instanceof hze){var i=sM(this._fieldsArray[s].keyType,this._fieldsArray[s].resolvedKeyType),o=sM(this._fieldsArray[s].type,this._fieldsArray[s].resolvedType),a=o===11||o===14?this._fieldsArray[s].resolvedType&&uX(this.parent,this._fieldsArray[s].resolvedType)||this._fieldsArray[s].type:void 0;r.nestedType.push(Qe.DescriptorProto.create({name:n.typeName,field:[Qe.FieldDescriptorProto.create({name:"key",number:1,label:1,type:i}),Qe.FieldDescriptorProto.create({name:"value",number:2,label:1,type:o,typeName:a})],options:Qe.MessageOptions.create({mapEntry:!0})}))}}for(s=0;s<this.oneofsArray.length;++s)r.oneofDecl.push(this._oneofsArray[s].toDescriptor());for(s=0;s<this.nestedArray.length;++s)this._nestedArray[s]instanceof eu?r.field.push(this._nestedArray[s].toDescriptor(e)):this._nestedArray[s]instanceof Xl?r.nestedType.push(this._nestedArray[s].toDescriptor(e)):this._nestedArray[s]instanceof Ca&&r.enumType.push(this._nestedArray[s].toDescriptor());if(this.extensions)for(s=0;s<this.extensions.length;++s)r.extensionRange.push(Qe.DescriptorProto.ExtensionRange.create({start:this.extensions[s][0],end:this.extensions[s][1]}));if(this.reserved)for(s=0;s<this.reserved.length;++s)typeof this.reserved[s]=="string"?r.reservedName.push(this.reserved[s]):r.reservedRange.push(Qe.DescriptorProto.ReservedRange.create({start:this.reserved[s][0],end:this.reserved[s][1]}));return r.options=$h(this.options,Qe.MessageOptions),r};var mze=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/;eu.fromDescriptor=function(e,r){if(typeof e.length=="number"&&(e=Qe.DescriptorProto.decode(e)),typeof e.number!="number")throw Error("missing field id");var s;e.typeName&&e.typeName.length?s=e.typeName:s=Sze(e.type);var n;switch(e.label){case 1:n=void 0;break;case 2:n="required";break;case 3:n="repeated";break;default:throw Error("illegal label: "+e.label)}var i=e.extendee;e.extendee!==void 0&&(i=i.length?i:void 0);var o=new eu(e.name.length?e.name:"field"+e.number,e.number,s,n,i);if(o.options=Mh(e.options,Qe.FieldOptions),e.defaultValue&&e.defaultValue.length){var a=e.defaultValue;switch(a){case"true":case"TRUE":a=!0;break;case"false":case"FALSE":a=!1;break;default:var l=mze.exec(a);l&&(a=parseInt(a));break}o.setOption("default",a)}return bze(e.type)&&(r==="proto3"?e.options&&!e.options.packed&&o.setOption("packed",!1):e.options&&e.options.packed||o.setOption("packed",!1)),o};eu.prototype.toDescriptor=function(e){var r=Qe.FieldDescriptorProto.create({name:this.name,number:this.id});if(this.map)r.type=11,r.typeName=ks.util.ucFirst(this.name),r.label=3;else{switch(r.type=sM(this.type,this.resolve().resolvedType)){case 10:case 11:case 14:r.typeName=this.resolvedType?uX(this.parent,this.resolvedType):this.type;break}switch(this.rule){case"repeated":r.label=3;break;case"required":r.label=2;break;default:r.label=1;break}}if(r.extendee=this.extensionField?this.extensionField.parent.fullName:this.extend,this.partOf&&(r.oneofIndex=this.parent.oneofsArray.indexOf(this.partOf))<0)throw Error("missing oneof");return this.options&&(r.options=$h(this.options,Qe.FieldOptions),this.options.default!=null&&(r.defaultValue=String(this.options.default))),e==="proto3"?this.packed||((r.options||(r.options=Qe.FieldOptions.create())).packed=!1):this.packed&&((r.options||(r.options=Qe.FieldOptions.create())).packed=!0),r};var gze=0;Ca.fromDescriptor=function(e){typeof e.length=="number"&&(e=Qe.EnumDescriptorProto.decode(e));var r={};if(e.value)for(var s=0;s<e.value.length;++s){var n=e.value[s].name,i=e.value[s].number||0;r[n&&n.length?n:"NAME"+i]=i}return new Ca(e.name&&e.name.length?e.name:"Enum"+gze++,r,Mh(e.options,Qe.EnumOptions))};Ca.prototype.toDescriptor=function(){for(var e=[],r=0,s=Object.keys(this.values);r<s.length;++r)e.push(Qe.EnumValueDescriptorProto.create({name:s[r],number:this.values[s[r]]}));return Qe.EnumDescriptorProto.create({name:this.name,value:e,options:$h(this.options,Qe.EnumOptions)})};var yze=0;UE.fromDescriptor=function(e){return typeof e.length=="number"&&(e=Qe.OneofDescriptorProto.decode(e)),new UE(e.name&&e.name.length?e.name:"oneof"+yze++)};UE.prototype.toDescriptor=function(){return Qe.OneofDescriptorProto.create({name:this.name})};var vze=0;hy.fromDescriptor=function(e){typeof e.length=="number"&&(e=Qe.ServiceDescriptorProto.decode(e));var r=new hy(e.name&&e.name.length?e.name:"Service"+vze++,Mh(e.options,Qe.ServiceOptions));if(e.method)for(var s=0;s<e.method.length;++s)r.add(VE.fromDescriptor(e.method[s]));return r};hy.prototype.toDescriptor=function(){for(var e=[],r=0;r<this.methodsArray.length;++r)e.push(this._methodsArray[r].toDescriptor());return Qe.ServiceDescriptorProto.create({name:this.name,method:e,options:$h(this.options,Qe.ServiceOptions)})};var _ze=0;VE.fromDescriptor=function(e){return typeof e.length=="number"&&(e=Qe.MethodDescriptorProto.decode(e)),new VE(e.name&&e.name.length?e.name:"Method"+_ze++,"rpc",e.inputType,e.outputType,!!e.clientStreaming,!!e.serverStreaming,Mh(e.options,Qe.MethodOptions))};VE.prototype.toDescriptor=function(){return Qe.MethodDescriptorProto.create({name:this.name,inputType:this.resolvedRequestType?this.resolvedRequestType.fullName:this.requestType,outputType:this.resolvedResponseType?this.resolvedResponseType.fullName:this.responseType,clientStreaming:this.requestStream,serverStreaming:this.responseStream,options:$h(this.options,Qe.MethodOptions)})};function Sze(t){switch(t){case 1:return"double";case 2:return"float";case 3:return"int64";case 4:return"uint64";case 5:return"int32";case 6:return"fixed64";case 7:return"fixed32";case 8:return"bool";case 9:return"string";case 12:return"bytes";case 13:return"uint32";case 15:return"sfixed32";case 16:return"sfixed64";case 17:return"sint32";case 18:return"sint64"}throw Error("illegal type: "+t)}function bze(t){switch(t){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 13:case 14:case 15:case 16:case 17:case 18:return!0}return!1}function sM(t,e){switch(t){case"double":return 1;case"float":return 2;case"int64":return 3;case"uint64":return 4;case"int32":return 5;case"fixed64":return 6;case"fixed32":return 7;case"bool":return 8;case"string":return 9;case"bytes":return 12;case"uint32":return 13;case"sfixed32":return 15;case"sfixed64":return 16;case"sint32":return 17;case"sint64":return 18}if(e instanceof Ca)return 14;if(e instanceof Xl)return e.group?10:11;throw Error("illegal type: "+t)}function Mh(t,e){if(t){for(var r=[],s=0,n,i,o;s<e.fieldsArray.length;++s)(i=(n=e._fieldsArray[s]).name)!=="uninterpretedOption"&&t.hasOwnProperty(i)&&(o=t[i],n.resolvedType instanceof Ca&&typeof o=="number"&&n.resolvedType.valuesById[o]!==void 0&&(o=n.resolvedType.valuesById[o]),r.push(Eze(i),o));return r.length?ks.util.toObject(r):void 0}}function $h(t,e){if(t){for(var r=[],s=0,n=Object.keys(t),i,o;s<n.length;++s)if(o=t[i=n[s]],i!=="default"){var a=e.fields[i];!a&&!(a=e.fields[i=ks.util.camelCase(i)])||r.push(i,o)}return r.length?e.fromObject(ks.util.toObject(r)):void 0}}function uX(t,e){var r=t.fullName.split("."),s=e.fullName.split("."),n=0,i=0,o=s.length-1;if(!(t instanceof fy)&&e instanceof aX)for(;n<r.length&&i<o&&r[n]===s[i];){var a=e.lookup(r[n++],!0);if(a!==null&&a!==e)break;++i}else for(;n<r.length&&i<o&&r[n]===s[i];++n,++i);return s.slice(i).join(".")}function Eze(t){return t.substring(0,1)+t.substring(1).replace(/([A-Z])(?=[a-z]|$)/g,function(e,r){return"_"+r.toLowerCase()})}});var fX=m((Ntt,wze)=>{wze.exports={nested:{google:{nested:{protobuf:{nested:{Api:{fields:{name:{type:"string",id:1},methods:{rule:"repeated",type:"Method",id:2},options:{rule:"repeated",type:"Option",id:3},version:{type:"string",id:4},sourceContext:{type:"SourceContext",id:5},mixins:{rule:"repeated",type:"Mixin",id:6},syntax:{type:"Syntax",id:7}}},Method:{fields:{name:{type:"string",id:1},requestTypeUrl:{type:"string",id:2},requestStreaming:{type:"bool",id:3},responseTypeUrl:{type:"string",id:4},responseStreaming:{type:"bool",id:5},options:{rule:"repeated",type:"Option",id:6},syntax:{type:"Syntax",id:7}}},Mixin:{fields:{name:{type:"string",id:1},root:{type:"string",id:2}}},SourceContext:{fields:{fileName:{type:"string",id:1}}},Option:{fields:{name:{type:"string",id:1},value:{type:"Any",id:2}}},Syntax:{values:{SYNTAX_PROTO2:0,SYNTAX_PROTO3:1}}}}}}}}});var hX=m((Dtt,Tze)=>{Tze.exports={nested:{google:{nested:{protobuf:{nested:{SourceContext:{fields:{fileName:{type:"string",id:1}}}}}}}}}});var pX=m((Mtt,Cze)=>{Cze.exports={nested:{google:{nested:{protobuf:{nested:{Type:{fields:{name:{type:"string",id:1},fields:{rule:"repeated",type:"Field",id:2},oneofs:{rule:"repeated",type:"string",id:3},options:{rule:"repeated",type:"Option",id:4},sourceContext:{type:"SourceContext",id:5},syntax:{type:"Syntax",id:6}}},Field:{fields:{kind:{type:"Kind",id:1},cardinality:{type:"Cardinality",id:2},number:{type:"int32",id:3},name:{type:"string",id:4},typeUrl:{type:"string",id:6},oneofIndex:{type:"int32",id:7},packed:{type:"bool",id:8},options:{rule:"repeated",type:"Option",id:9},jsonName:{type:"string",id:10},defaultValue:{type:"string",id:11}},nested:{Kind:{values:{TYPE_UNKNOWN:0,TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Cardinality:{values:{CARDINALITY_UNKNOWN:0,CARDINALITY_OPTIONAL:1,CARDINALITY_REQUIRED:2,CARDINALITY_REPEATED:3}}}},Enum:{fields:{name:{type:"string",id:1},enumvalue:{rule:"repeated",type:"EnumValue",id:2},options:{rule:"repeated",type:"Option",id:3},sourceContext:{type:"SourceContext",id:4},syntax:{type:"Syntax",id:5}}},EnumValue:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{rule:"repeated",type:"Option",id:3}}},Option:{fields:{name:{type:"string",id:1},value:{type:"Any",id:2}}},Syntax:{values:{SYNTAX_PROTO2:0,SYNTAX_PROTO3:1}},Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}},SourceContext:{fields:{fileName:{type:"string",id:1}}}}}}}}}});var vX=m(tu=>{"use strict";Object.defineProperty(tu,"__esModule",{value:!0});tu.addCommonProtos=tu.loadProtosWithOptionsSync=tu.loadProtosWithOptions=void 0;var mX=require("fs"),gX=require("path"),qh=zE();function yX(t,e){let r=t.resolvePath;t.resolvePath=(s,n)=>{if(gX.isAbsolute(n))return n;for(let i of e){let o=gX.join(i,n);try{return mX.accessSync(o,mX.constants.R_OK),o}catch{continue}}return process.emitWarning(`${n} not found in any of the include paths ${e}`),r(s,n)}}async function Rze(t,e){let r=new qh.Root;if(e=e||{},e.includeDirs){if(!Array.isArray(e.includeDirs))return Promise.reject(new Error("The includeDirs option must be an array"));yX(r,e.includeDirs)}let s=await r.load(t,e);return s.resolveAll(),s}tu.loadProtosWithOptions=Rze;function Oze(t,e){let r=new qh.Root;if(e=e||{},e.includeDirs){if(!Array.isArray(e.includeDirs))throw new Error("The includeDirs option must be an array");yX(r,e.includeDirs)}let s=r.loadSync(t,e);return s.resolveAll(),s}tu.loadProtosWithOptionsSync=Oze;function Pze(){let t=fX(),e=rM(),r=hX(),s=pX();qh.common("api",t.nested.google.nested.protobuf.nested),qh.common("descriptor",e.nested.google.nested.protobuf.nested),qh.common("source_context",r.nested.google.nested.protobuf.nested),qh.common("type",s.nested.google.nested.protobuf.nested)}tu.addCommonProtos=Pze});var bX=m((SX,nM)=>{var _X=function(t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e=null;try{e=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function r(A,E,V){this.low=A|0,this.high=E|0,this.unsigned=!!V}r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:!0});function s(A){return(A&&A.__isLong__)===!0}function n(A){var E=Math.clz32(A&-A);return A?31-E:E}r.isLong=s;var i={},o={};function a(A,E){var V,G,X;return E?(A>>>=0,(X=0<=A&&A<256)&&(G=o[A],G)?G:(V=u(A,0,!0),X&&(o[A]=V),V)):(A|=0,(X=-128<=A&&A<128)&&(G=i[A],G)?G:(V=u(A,A<0?-1:0,!1),X&&(i[A]=V),V))}r.fromInt=a;function l(A,E){if(isNaN(A))return E?y:v;if(E){if(A<0)return y;if(A>=_)return $}else{if(A<=-S)return C;if(A+1>=S)return O}return A<0?l(-A,E).neg():u(A%g|0,A/g|0,E)}r.fromNumber=l;function u(A,E,V){return new r(A,E,V)}r.fromBits=u;var c=Math.pow;function d(A,E,V){if(A.length===0)throw Error("empty string");if(typeof E=="number"?(V=E,E=!1):E=!!E,A==="NaN"||A==="Infinity"||A==="+Infinity"||A==="-Infinity")return E?y:v;if(V=V||10,V<2||36<V)throw RangeError("radix");var G;if((G=A.indexOf("-"))>0)throw Error("interior hyphen");if(G===0)return d(A.substring(1),E,V).neg();for(var X=l(c(V,8)),pe=v,J=0;J<A.length;J+=8){var ye=Math.min(8,A.length-J),st=parseInt(A.substring(J,J+ye),V);if(ye<8){var ve=l(c(V,ye));pe=pe.mul(ve).add(l(st))}else pe=pe.mul(X),pe=pe.add(l(st))}return pe.unsigned=E,pe}r.fromString=d;function f(A,E){return typeof A=="number"?l(A,E):typeof A=="string"?d(A,E):u(A.low,A.high,typeof E=="boolean"?E:A.unsigned)}r.fromValue=f;var h=1<<16,p=1<<24,g=h*h,_=g*g,S=_/2,b=a(p),v=a(0);r.ZERO=v;var y=a(0,!0);r.UZERO=y;var R=a(1);r.ONE=R;var P=a(1,!0);r.UONE=P;var w=a(-1);r.NEG_ONE=w;var O=u(-1,2147483647,!1);r.MAX_VALUE=O;var $=u(-1,-1,!0);r.MAX_UNSIGNED_VALUE=$;var C=u(0,-2147483648,!1);r.MIN_VALUE=C;var k=r.prototype;k.toInt=function(){return this.unsigned?this.low>>>0:this.low},k.toNumber=function(){return this.unsigned?(this.high>>>0)*g+(this.low>>>0):this.high*g+(this.low>>>0)},k.toString=function(E){if(E=E||10,E<2||36<E)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(C)){var V=l(E),G=this.div(V),X=G.mul(V).sub(this);return G.toString(E)+X.toInt().toString(E)}else return"-"+this.neg().toString(E);for(var pe=l(c(E,6),this.unsigned),J=this,ye="";;){var st=J.div(pe),ve=J.sub(st.mul(pe)).toInt()>>>0,pt=ve.toString(E);if(J=st,J.isZero())return pt+ye;for(;pt.length<6;)pt="0"+pt;ye=""+pt+ye}},k.getHighBits=function(){return this.high},k.getHighBitsUnsigned=function(){return this.high>>>0},k.getLowBits=function(){return this.low},k.getLowBitsUnsigned=function(){return this.low>>>0},k.getNumBitsAbs=function(){if(this.isNegative())return this.eq(C)?64:this.neg().getNumBitsAbs();for(var E=this.high!=0?this.high:this.low,V=31;V>0&&!(E&1<<V);V--);return this.high!=0?V+33:V+1},k.isZero=function(){return this.high===0&&this.low===0},k.eqz=k.isZero,k.isNegative=function(){return!this.unsigned&&this.high<0},k.isPositive=function(){return this.unsigned||this.high>=0},k.isOdd=function(){return(this.low&1)===1},k.isEven=function(){return(this.low&1)===0},k.equals=function(E){return s(E)||(E=f(E)),this.unsigned!==E.unsigned&&this.high>>>31===1&&E.high>>>31===1?!1:this.high===E.high&&this.low===E.low},k.eq=k.equals,k.notEquals=function(E){return!this.eq(E)},k.neq=k.notEquals,k.ne=k.notEquals,k.lessThan=function(E){return this.comp(E)<0},k.lt=k.lessThan,k.lessThanOrEqual=function(E){return this.comp(E)<=0},k.lte=k.lessThanOrEqual,k.le=k.lessThanOrEqual,k.greaterThan=function(E){return this.comp(E)>0},k.gt=k.greaterThan,k.greaterThanOrEqual=function(E){return this.comp(E)>=0},k.gte=k.greaterThanOrEqual,k.ge=k.greaterThanOrEqual,k.compare=function(E){if(s(E)||(E=f(E)),this.eq(E))return 0;var V=this.isNegative(),G=E.isNegative();return V&&!G?-1:!V&&G?1:this.unsigned?E.high>>>0>this.high>>>0||E.high===this.high&&E.low>>>0>this.low>>>0?-1:1:this.sub(E).isNegative()?-1:1},k.comp=k.compare,k.negate=function(){return!this.unsigned&&this.eq(C)?C:this.not().add(R)},k.neg=k.negate,k.add=function(E){s(E)||(E=f(E));var V=this.high>>>16,G=this.high&65535,X=this.low>>>16,pe=this.low&65535,J=E.high>>>16,ye=E.high&65535,st=E.low>>>16,ve=E.low&65535,pt=0,Ze=0,_e=0,Ye=0;return Ye+=pe+ve,_e+=Ye>>>16,Ye&=65535,_e+=X+st,Ze+=_e>>>16,_e&=65535,Ze+=G+ye,pt+=Ze>>>16,Ze&=65535,pt+=V+J,pt&=65535,u(_e<<16|Ye,pt<<16|Ze,this.unsigned)},k.subtract=function(E){return s(E)||(E=f(E)),this.add(E.neg())},k.sub=k.subtract,k.multiply=function(E){if(this.isZero())return this;if(s(E)||(E=f(E)),e){var V=e.mul(this.low,this.high,E.low,E.high);return u(V,e.get_high(),this.unsigned)}if(E.isZero())return this.unsigned?y:v;if(this.eq(C))return E.isOdd()?C:v;if(E.eq(C))return this.isOdd()?C:v;if(this.isNegative())return E.isNegative()?this.neg().mul(E.neg()):this.neg().mul(E).neg();if(E.isNegative())return this.mul(E.neg()).neg();if(this.lt(b)&&E.lt(b))return l(this.toNumber()*E.toNumber(),this.unsigned);var G=this.high>>>16,X=this.high&65535,pe=this.low>>>16,J=this.low&65535,ye=E.high>>>16,st=E.high&65535,ve=E.low>>>16,pt=E.low&65535,Ze=0,_e=0,Ye=0,Re=0;return Re+=J*pt,Ye+=Re>>>16,Re&=65535,Ye+=pe*pt,_e+=Ye>>>16,Ye&=65535,Ye+=J*ve,_e+=Ye>>>16,Ye&=65535,_e+=X*pt,Ze+=_e>>>16,_e&=65535,_e+=pe*ve,Ze+=_e>>>16,_e&=65535,_e+=J*st,Ze+=_e>>>16,_e&=65535,Ze+=G*pt+X*ve+pe*st+J*ye,Ze&=65535,u(Ye<<16|Re,Ze<<16|_e,this.unsigned)},k.mul=k.multiply,k.divide=function(E){if(s(E)||(E=f(E)),E.isZero())throw Error("division by zero");if(e){if(!this.unsigned&&this.high===-2147483648&&E.low===-1&&E.high===-1)return this;var V=(this.unsigned?e.div_u:e.div_s)(this.low,this.high,E.low,E.high);return u(V,e.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?y:v;var G,X,pe;if(this.unsigned){if(E.unsigned||(E=E.toUnsigned()),E.gt(this))return y;if(E.gt(this.shru(1)))return P;pe=y}else{if(this.eq(C)){if(E.eq(R)||E.eq(w))return C;if(E.eq(C))return R;var J=this.shr(1);return G=J.div(E).shl(1),G.eq(v)?E.isNegative()?R:w:(X=this.sub(E.mul(G)),pe=G.add(X.div(E)),pe)}else if(E.eq(C))return this.unsigned?y:v;if(this.isNegative())return E.isNegative()?this.neg().div(E.neg()):this.neg().div(E).neg();if(E.isNegative())return this.div(E.neg()).neg();pe=v}for(X=this;X.gte(E);){G=Math.max(1,Math.floor(X.toNumber()/E.toNumber()));for(var ye=Math.ceil(Math.log(G)/Math.LN2),st=ye<=48?1:c(2,ye-48),ve=l(G),pt=ve.mul(E);pt.isNegative()||pt.gt(X);)G-=st,ve=l(G,this.unsigned),pt=ve.mul(E);ve.isZero()&&(ve=R),pe=pe.add(ve),X=X.sub(pt)}return pe},k.div=k.divide,k.modulo=function(E){if(s(E)||(E=f(E)),e){var V=(this.unsigned?e.rem_u:e.rem_s)(this.low,this.high,E.low,E.high);return u(V,e.get_high(),this.unsigned)}return this.sub(this.div(E).mul(E))},k.mod=k.modulo,k.rem=k.modulo,k.not=function(){return u(~this.low,~this.high,this.unsigned)},k.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},k.clz=k.countLeadingZeros,k.countTrailingZeros=function(){return this.low?n(this.low):n(this.high)+32},k.ctz=k.countTrailingZeros,k.and=function(E){return s(E)||(E=f(E)),u(this.low&E.low,this.high&E.high,this.unsigned)},k.or=function(E){return s(E)||(E=f(E)),u(this.low|E.low,this.high|E.high,this.unsigned)},k.xor=function(E){return s(E)||(E=f(E)),u(this.low^E.low,this.high^E.high,this.unsigned)},k.shiftLeft=function(E){return s(E)&&(E=E.toInt()),(E&=63)===0?this:E<32?u(this.low<<E,this.high<<E|this.low>>>32-E,this.unsigned):u(0,this.low<<E-32,this.unsigned)},k.shl=k.shiftLeft,k.shiftRight=function(E){return s(E)&&(E=E.toInt()),(E&=63)===0?this:E<32?u(this.low>>>E|this.high<<32-E,this.high>>E,this.unsigned):u(this.high>>E-32,this.high>=0?0:-1,this.unsigned)},k.shr=k.shiftRight,k.shiftRightUnsigned=function(E){return s(E)&&(E=E.toInt()),(E&=63)===0?this:E<32?u(this.low>>>E|this.high<<32-E,this.high>>>E,this.unsigned):E===32?u(this.high,0,this.unsigned):u(this.high>>>E-32,0,this.unsigned)},k.shru=k.shiftRightUnsigned,k.shr_u=k.shiftRightUnsigned,k.rotateLeft=function(E){var V;return s(E)&&(E=E.toInt()),(E&=63)===0?this:E===32?u(this.high,this.low,this.unsigned):E<32?(V=32-E,u(this.low<<E|this.high>>>V,this.high<<E|this.low>>>V,this.unsigned)):(E-=32,V=32-E,u(this.high<<E|this.low>>>V,this.low<<E|this.high>>>V,this.unsigned))},k.rotl=k.rotateLeft,k.rotateRight=function(E){var V;return s(E)&&(E=E.toInt()),(E&=63)===0?this:E===32?u(this.high,this.low,this.unsigned):E<32?(V=32-E,u(this.high<<V|this.low>>>E,this.low<<V|this.high>>>E,this.unsigned)):(E-=32,V=32-E,u(this.low<<V|this.high>>>E,this.high<<V|this.low>>>E,this.unsigned))},k.rotr=k.rotateRight,k.toSigned=function(){return this.unsigned?u(this.low,this.high,!1):this},k.toUnsigned=function(){return this.unsigned?this:u(this.low,this.high,!0)},k.toBytes=function(E){return E?this.toBytesLE():this.toBytesBE()},k.toBytesLE=function(){var E=this.high,V=this.low;return[V&255,V>>>8&255,V>>>16&255,V>>>24,E&255,E>>>8&255,E>>>16&255,E>>>24]},k.toBytesBE=function(){var E=this.high,V=this.low;return[E>>>24,E>>>16&255,E>>>8&255,E&255,V>>>24,V>>>16&255,V>>>8&255,V&255]},r.fromBytes=function(E,V,G){return G?r.fromBytesLE(E,V):r.fromBytesBE(E,V)},r.fromBytesLE=function(E,V){return new r(E[0]|E[1]<<8|E[2]<<16|E[3]<<24,E[4]|E[5]<<8|E[6]<<16|E[7]<<24,V)},r.fromBytesBE=function(E,V){return new r(E[4]<<24|E[5]<<16|E[6]<<8|E[7],E[0]<<24|E[1]<<16|E[2]<<8|E[3],V)};var z=r;return t.default=z,"default"in t?t.default:t}({});typeof define=="function"&&define.amd?define([],function(){return _X}):typeof nM=="object"&&typeof SX=="object"&&(nM.exports=_X)});var lM=m(Rr=>{"use strict";Object.defineProperty(Rr,"__esModule",{value:!0});Rr.loadFileDescriptorSetFromObject=Rr.loadFileDescriptorSetFromBuffer=Rr.fromJSON=Rr.loadSync=Rr.load=Rr.IdempotencyLevel=Rr.isAnyExtension=Rr.Long=void 0;var Aze=lY(),xo=zE(),oM=dX(),aM=vX(),kze=bX();Rr.Long=kze;function xze(t){return"@type"in t&&typeof t["@type"]=="string"}Rr.isAnyExtension=xze;var TX;(function(t){t.IDEMPOTENCY_UNKNOWN="IDEMPOTENCY_UNKNOWN",t.NO_SIDE_EFFECTS="NO_SIDE_EFFECTS",t.IDEMPOTENT="IDEMPOTENT"})(TX=Rr.IdempotencyLevel||(Rr.IdempotencyLevel={}));var CX={longs:String,enums:String,bytes:String,defaults:!0,oneofs:!0,json:!0};function Ize(t,e){return t===""?e:t+"."+e}function Nze(t){return t instanceof xo.Service||t instanceof xo.Type||t instanceof xo.Enum}function Dze(t){return t instanceof xo.Namespace||t instanceof xo.Root}function RX(t,e){let r=Ize(e,t.name);return Nze(t)?[[r,t]]:Dze(t)&&typeof t.nested<"u"?Object.keys(t.nested).map(s=>RX(t.nested[s],r)).reduce((s,n)=>s.concat(n),[]):[]}function EX(t,e){return function(s){return t.toObject(t.decode(s),e)}}function wX(t){return function(r){if(Array.isArray(r))throw new Error(`Failed to serialize message: expected object with ${t.name} structure, got array instead`);let s=t.fromObject(r);return t.encode(s).finish()}}function Mze(t){return(t||[]).reduce((e,r)=>{for(let[s,n]of Object.entries(r))switch(s){case"uninterpreted_option":e.uninterpreted_option.push(r.uninterpreted_option);break;default:e[s]=n}return e},{deprecated:!1,idempotency_level:TX.IDEMPOTENCY_UNKNOWN,uninterpreted_option:[]})}function $ze(t,e,r,s){let n=t.resolvedRequestType,i=t.resolvedResponseType;return{path:"/"+e+"/"+t.name,requestStream:!!t.requestStream,responseStream:!!t.responseStream,requestSerialize:wX(n),requestDeserialize:EX(n,r),responseSerialize:wX(i),responseDeserialize:EX(i,r),originalName:Aze(t.name),requestType:iM(n,s),responseType:iM(i,s),options:Mze(t.parsedOptions)}}function qze(t,e,r,s){let n={};for(let i of t.methodsArray)n[i.name]=$ze(i,e,r,s);return n}function iM(t,e){let r=t.toDescriptor("proto3");return{format:"Protocol Buffer 3 DescriptorProto",type:r.$type.toObject(r,CX),fileDescriptorProtos:e}}function Lze(t,e){let r=t.toDescriptor("proto3");return{format:"Protocol Buffer 3 EnumDescriptorProto",type:r.$type.toObject(r,CX),fileDescriptorProtos:e}}function jze(t,e,r,s){if(t instanceof xo.Service)return qze(t,e,r,s);if(t instanceof xo.Type)return iM(t,s);if(t instanceof xo.Enum)return Lze(t,s);throw new Error("Type mismatch in reflection object handling")}function HE(t,e){let r={};t.resolveAll();let n=t.toDescriptor("proto3").file.map(i=>Buffer.from(oM.FileDescriptorProto.encode(i).finish()));for(let[i,o]of RX(t,""))r[i]=jze(o,i,e,n);return r}function OX(t,e){e=e||{};let r=xo.Root.fromDescriptor(t);return r.resolveAll(),HE(r,e)}function Fze(t,e){return(0,aM.loadProtosWithOptions)(t,e).then(r=>HE(r,e))}Rr.load=Fze;function Bze(t,e){let r=(0,aM.loadProtosWithOptionsSync)(t,e);return HE(r,e)}Rr.loadSync=Bze;function zze(t,e){e=e||{};let r=xo.Root.fromJSON(t);return r.resolveAll(),HE(r,e)}Rr.fromJSON=zze;function Uze(t,e){let r=oM.FileDescriptorSet.decode(t);return OX(r,e)}Rr.loadFileDescriptorSetFromBuffer=Uze;function Vze(t,e){let r=oM.FileDescriptorSet.fromObject(t);return OX(r,e)}Rr.loadFileDescriptorSetFromObject=Vze;(0,aM.addCommonProtos)()});var zc=m(bt=>{"use strict";Object.defineProperty(bt,"__esModule",{value:!0});bt.setup=bt.getChannelzServiceDefinition=bt.getChannelzHandlers=bt.unregisterChannelzRef=bt.registerChannelzSocket=bt.registerChannelzServer=bt.registerChannelzSubchannel=bt.registerChannelzChannel=bt.ChannelzCallTrackerStub=bt.ChannelzCallTracker=bt.ChannelzChildrenTrackerStub=bt.ChannelzChildrenTracker=bt.ChannelzTrace=bt.ChannelzTraceStub=void 0;var PX=require("net"),Bc=k7(),py=Qn(),my=ft(),Hze=Ai(),Gze=fE(),Kze=iD();function uM(t){return{channel_id:t.id,name:t.name}}function pM(t){return{subchannel_id:t.id,name:t.name}}function Qze(t){return{server_id:t.id}}function WE(t){return{socket_id:t.id,name:t.name}}var AX=32,mM=100,cM=class{constructor(){this.events=[],this.creationTimestamp=new Date,this.eventsLogged=0}addTrace(){}getTraceMessage(){return{creation_timestamp:Io(this.creationTimestamp),num_events_logged:this.eventsLogged,events:[]}}};bt.ChannelzTraceStub=cM;var dM=class{constructor(){this.events=[],this.eventsLogged=0,this.creationTimestamp=new Date}addTrace(e,r,s){let n=new Date;this.events.push({description:r,severity:e,timestamp:n,childChannel:s?.kind==="channel"?s:void 0,childSubchannel:s?.kind==="subchannel"?s:void 0}),this.events.length>=AX*2&&(this.events=this.events.slice(AX)),this.eventsLogged+=1}getTraceMessage(){return{creation_timestamp:Io(this.creationTimestamp),num_events_logged:this.eventsLogged,events:this.events.map(e=>({description:e.description,severity:e.severity,timestamp:Io(e.timestamp),channel_ref:e.childChannel?uM(e.childChannel):null,subchannel_ref:e.childSubchannel?pM(e.childSubchannel):null}))}}};bt.ChannelzTrace=dM;var KE=class{constructor(){this.channelChildren=new Bc.OrderedMap,this.subchannelChildren=new Bc.OrderedMap,this.socketChildren=new Bc.OrderedMap,this.trackerMap={channel:this.channelChildren,subchannel:this.subchannelChildren,socket:this.socketChildren}}refChild(e){let r=this.trackerMap[e.kind],s=r.find(e.id);s.equals(r.end())?r.setElement(e.id,{ref:e,count:1},s):s.pointer[1].count+=1}unrefChild(e){let r=this.trackerMap[e.kind],s=r.getElementByKey(e.id);s!==void 0&&(s.count-=1,s.count===0&&r.eraseElementByKey(e.id))}getChildLists(){return{channels:this.channelChildren,subchannels:this.subchannelChildren,sockets:this.socketChildren}}};bt.ChannelzChildrenTracker=KE;var fM=class extends KE{refChild(){}unrefChild(){}};bt.ChannelzChildrenTrackerStub=fM;var QE=class{constructor(){this.callsStarted=0,this.callsSucceeded=0,this.callsFailed=0,this.lastCallStartedTimestamp=null}addCallStarted(){this.callsStarted+=1,this.lastCallStartedTimestamp=new Date}addCallSucceeded(){this.callsSucceeded+=1}addCallFailed(){this.callsFailed+=1}};bt.ChannelzCallTracker=QE;var hM=class extends QE{addCallStarted(){}addCallSucceeded(){}addCallFailed(){}};bt.ChannelzCallTrackerStub=hM;var Ra={channel:new Bc.OrderedMap,subchannel:new Bc.OrderedMap,server:new Bc.OrderedMap,socket:new Bc.OrderedMap},ZE=t=>{let e=1;function r(){return e++}let s=Ra[t];return(n,i,o)=>{let a=r(),l={id:a,name:n,kind:t};return o&&s.setElement(a,{ref:l,getInfo:i}),l}};bt.registerChannelzChannel=ZE("channel");bt.registerChannelzSubchannel=ZE("subchannel");bt.registerChannelzServer=ZE("server");bt.registerChannelzSocket=ZE("socket");function Wze(t){Ra[t.kind].eraseElementByKey(t.id)}bt.unregisterChannelzRef=Wze;function Zze(t){let e=Number.parseInt(t,16);return[e/256|0,e%256]}function kX(t){if(t==="")return[];let e=t.split(":").map(s=>Zze(s));return[].concat(...e)}function Yze(t){if((0,PX.isIPv4)(t))return Buffer.from(Uint8Array.from(t.split(".").map(e=>Number.parseInt(e))));if((0,PX.isIPv6)(t)){let e,r,s=t.indexOf("::");s===-1?(e=t,r=""):(e=t.substring(0,s),r=t.substring(s+2));let n=Buffer.from(kX(e)),i=Buffer.from(kX(r)),o=Buffer.alloc(16-n.length-i.length,0);return Buffer.concat([n,o,i])}else return null}function IX(t){switch(t){case py.ConnectivityState.CONNECTING:return{state:"CONNECTING"};case py.ConnectivityState.IDLE:return{state:"IDLE"};case py.ConnectivityState.READY:return{state:"READY"};case py.ConnectivityState.SHUTDOWN:return{state:"SHUTDOWN"};case py.ConnectivityState.TRANSIENT_FAILURE:return{state:"TRANSIENT_FAILURE"};default:return{state:"UNKNOWN"}}}function Io(t){if(!t)return null;let e=t.getTime();return{seconds:e/1e3|0,nanos:e%1e3*1e6}}function NX(t){let e=t.getInfo(),r=[],s=[];return e.children.channels.forEach(n=>{r.push(uM(n[1].ref))}),e.children.subchannels.forEach(n=>{s.push(pM(n[1].ref))}),{ref:uM(t.ref),data:{target:e.target,state:IX(e.state),calls_started:e.callTracker.callsStarted,calls_succeeded:e.callTracker.callsSucceeded,calls_failed:e.callTracker.callsFailed,last_call_started_timestamp:Io(e.callTracker.lastCallStartedTimestamp),trace:e.trace.getTraceMessage()},channel_ref:r,subchannel_ref:s}}function Jze(t,e){let r=parseInt(t.request.channel_id,10),s=Ra.channel.getElementByKey(r);if(s===void 0){e({code:my.Status.NOT_FOUND,details:"No channel data found for id "+r});return}e(null,{channel:NX(s)})}function Xze(t,e){let r=parseInt(t.request.max_results,10)||mM,s=[],n=parseInt(t.request.start_channel_id,10),i=Ra.channel,o;for(o=i.lowerBound(n);!o.equals(i.end())&&s.length<r;o=o.next())s.push(NX(o.pointer[1]));e(null,{channel:s,end:o.equals(i.end())})}function DX(t){let e=t.getInfo(),r=[];return e.listenerChildren.sockets.forEach(s=>{r.push(WE(s[1].ref))}),{ref:Qze(t.ref),data:{calls_started:e.callTracker.callsStarted,calls_succeeded:e.callTracker.callsSucceeded,calls_failed:e.callTracker.callsFailed,last_call_started_timestamp:Io(e.callTracker.lastCallStartedTimestamp),trace:e.trace.getTraceMessage()},listen_socket:r}}function eUe(t,e){let r=parseInt(t.request.server_id,10),n=Ra.server.getElementByKey(r);if(n===void 0){e({code:my.Status.NOT_FOUND,details:"No server data found for id "+r});return}e(null,{server:DX(n)})}function tUe(t,e){let r=parseInt(t.request.max_results,10)||mM,s=parseInt(t.request.start_server_id,10),n=Ra.server,i=[],o;for(o=n.lowerBound(s);!o.equals(n.end())&&i.length<r;o=o.next())i.push(DX(o.pointer[1]));e(null,{server:i,end:o.equals(n.end())})}function rUe(t,e){let r=parseInt(t.request.subchannel_id,10),s=Ra.subchannel.getElementByKey(r);if(s===void 0){e({code:my.Status.NOT_FOUND,details:"No subchannel data found for id "+r});return}let n=s.getInfo(),i=[];n.children.sockets.forEach(a=>{i.push(WE(a[1].ref))});let o={ref:pM(s.ref),data:{target:n.target,state:IX(n.state),calls_started:n.callTracker.callsStarted,calls_succeeded:n.callTracker.callsSucceeded,calls_failed:n.callTracker.callsFailed,last_call_started_timestamp:Io(n.callTracker.lastCallStartedTimestamp),trace:n.trace.getTraceMessage()},socket_ref:i};e(null,{subchannel:o})}function xX(t){var e;return(0,Hze.isTcpSubchannelAddress)(t)?{address:"tcpip_address",tcpip_address:{ip_address:(e=Yze(t.host))!==null&&e!==void 0?e:void 0,port:t.port}}:{address:"uds_address",uds_address:{filename:t.path}}}function sUe(t,e){var r,s,n,i,o;let a=parseInt(t.request.socket_id,10),l=Ra.socket.getElementByKey(a);if(l===void 0){e({code:my.Status.NOT_FOUND,details:"No socket data found for id "+a});return}let u=l.getInfo(),c=u.security?{model:"tls",tls:{cipher_suite:u.security.cipherSuiteStandardName?"standard_name":"other_name",standard_name:(r=u.security.cipherSuiteStandardName)!==null&&r!==void 0?r:void 0,other_name:(s=u.security.cipherSuiteOtherName)!==null&&s!==void 0?s:void 0,local_certificate:(n=u.security.localCertificate)!==null&&n!==void 0?n:void 0,remote_certificate:(i=u.security.remoteCertificate)!==null&&i!==void 0?i:void 0}}:null,d={ref:WE(l.ref),local:u.localAddress?xX(u.localAddress):null,remote:u.remoteAddress?xX(u.remoteAddress):null,remote_name:(o=u.remoteName)!==null&&o!==void 0?o:void 0,security:c,data:{keep_alives_sent:u.keepAlivesSent,streams_started:u.streamsStarted,streams_succeeded:u.streamsSucceeded,streams_failed:u.streamsFailed,last_local_stream_created_timestamp:Io(u.lastLocalStreamCreatedTimestamp),last_remote_stream_created_timestamp:Io(u.lastRemoteStreamCreatedTimestamp),messages_received:u.messagesReceived,messages_sent:u.messagesSent,last_message_received_timestamp:Io(u.lastMessageReceivedTimestamp),last_message_sent_timestamp:Io(u.lastMessageSentTimestamp),local_flow_control_window:u.localFlowControlWindow?{value:u.localFlowControlWindow}:null,remote_flow_control_window:u.remoteFlowControlWindow?{value:u.remoteFlowControlWindow}:null}};e(null,{socket:d})}function nUe(t,e){let r=parseInt(t.request.server_id,10),s=Ra.server.getElementByKey(r);if(s===void 0){e({code:my.Status.NOT_FOUND,details:"No server data found for id "+r});return}let n=parseInt(t.request.start_socket_id,10),i=parseInt(t.request.max_results,10)||mM,a=s.getInfo().sessionChildren.sockets,l=[],u;for(u=a.lowerBound(n);!u.equals(a.end())&&l.length<i;u=u.next())l.push(WE(u.pointer[1].ref));e(null,{socket_ref:l,end:u.equals(a.end())})}function MX(){return{GetChannel:Jze,GetTopChannels:Xze,GetServer:eUe,GetServers:tUe,GetSubchannel:rUe,GetSocket:sUe,GetServerSockets:nUe}}bt.getChannelzHandlers=MX;var GE=null;function $X(){if(GE)return GE;let t=lM().loadSync,e=t("channelz.proto",{keepCase:!0,longs:String,enums:String,defaults:!0,oneofs:!0,includeDirs:[`${__dirname}/../../proto`]});return GE=(0,Kze.loadPackageDefinition)(e).grpc.channelz.v1.Channelz.service,GE}bt.getChannelzServiceDefinition=$X;function iUe(){(0,Gze.registerAdminService)($X,MX)}bt.setup=iUe});var qX=m(JE=>{"use strict";Object.defineProperty(JE,"__esModule",{value:!0});JE.Subchannel=void 0;var $t=Qn(),oUe=Qg(),gM=er(),YE=ft(),aUe=hn(),lUe=Ai(),No=zc(),uUe="subchannel",cUe=~(1<<31),yM=class{constructor(e,r,s,n,i){var o;this.channelTarget=e,this.subchannelAddress=r,this.options=s,this.credentials=n,this.connector=i,this.connectivityState=$t.ConnectivityState.IDLE,this.transport=null,this.continueConnecting=!1,this.stateListeners=new Set,this.refcount=0,this.channelzEnabled=!0;let a={initialDelay:s["grpc.initial_reconnect_backoff_ms"],maxDelay:s["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new oUe.BackoffTimeout(()=>{this.handleBackoffTimer()},a),this.backoffTimeout.unref(),this.subchannelAddressString=(0,lUe.subchannelAddressToString)(r),this.keepaliveTime=(o=s["grpc.keepalive_time_ms"])!==null&&o!==void 0?o:-1,s["grpc.enable_channelz"]===0?(this.channelzEnabled=!1,this.channelzTrace=new No.ChannelzTraceStub,this.callTracker=new No.ChannelzCallTrackerStub,this.childrenTracker=new No.ChannelzChildrenTrackerStub,this.streamTracker=new No.ChannelzCallTrackerStub):(this.channelzTrace=new No.ChannelzTrace,this.callTracker=new No.ChannelzCallTracker,this.childrenTracker=new No.ChannelzChildrenTracker,this.streamTracker=new No.ChannelzCallTracker),this.channelzRef=(0,No.registerChannelzSubchannel)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzTrace.addTrace("CT_INFO","Subchannel created"),this.trace("Subchannel constructed with options "+JSON.stringify(s,void 0,2))}getChannelzInfo(){return{state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists(),target:this.subchannelAddressString}}trace(e){gM.trace(YE.LogVerbosity.DEBUG,uUe,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}refTrace(e){gM.trace(YE.LogVerbosity.DEBUG,"subchannel_refcount","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}handleBackoffTimer(){this.continueConnecting?this.transitionToState([$t.ConnectivityState.TRANSIENT_FAILURE],$t.ConnectivityState.CONNECTING):this.transitionToState([$t.ConnectivityState.TRANSIENT_FAILURE],$t.ConnectivityState.IDLE)}startBackoff(){this.backoffTimeout.runOnce()}stopBackoff(){this.backoffTimeout.stop(),this.backoffTimeout.reset()}startConnectingInternal(){let e=this.options;if(e["grpc.keepalive_time_ms"]){let r=Math.min(this.keepaliveTime,cUe);e=Object.assign(Object.assign({},e),{"grpc.keepalive_time_ms":r})}this.connector.connect(this.subchannelAddress,this.credentials,e).then(r=>{this.transitionToState([$t.ConnectivityState.CONNECTING],$t.ConnectivityState.READY)?(this.transport=r,this.channelzEnabled&&this.childrenTracker.refChild(r.getChannelzRef()),r.addDisconnectListener(s=>{this.transitionToState([$t.ConnectivityState.READY],$t.ConnectivityState.IDLE),s&&this.keepaliveTime>0&&(this.keepaliveTime*=2,gM.log(YE.LogVerbosity.ERROR,`Connection to ${(0,aUe.uriToString)(this.channelTarget)} at ${this.subchannelAddressString} rejected by server because of excess pings. Increasing ping interval to ${this.keepaliveTime} ms`))})):r.shutdown()},r=>{this.transitionToState([$t.ConnectivityState.CONNECTING],$t.ConnectivityState.TRANSIENT_FAILURE,`${r}`)})}transitionToState(e,r,s){var n,i;if(e.indexOf(this.connectivityState)===-1)return!1;this.trace($t.ConnectivityState[this.connectivityState]+" -> "+$t.ConnectivityState[r]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+$t.ConnectivityState[r]);let o=this.connectivityState;switch(this.connectivityState=r,r){case $t.ConnectivityState.READY:this.stopBackoff();break;case $t.ConnectivityState.CONNECTING:this.startBackoff(),this.startConnectingInternal(),this.continueConnecting=!1;break;case $t.ConnectivityState.TRANSIENT_FAILURE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),(n=this.transport)===null||n===void 0||n.shutdown(),this.transport=null,this.backoffTimeout.isRunning()||process.nextTick(()=>{this.handleBackoffTimer()});break;case $t.ConnectivityState.IDLE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),(i=this.transport)===null||i===void 0||i.shutdown(),this.transport=null;break;default:throw new Error(`Invalid state: unknown ConnectivityState ${r}`)}for(let a of this.stateListeners)a(this,o,r,this.keepaliveTime,s);return!0}ref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount+1)),this.refcount+=1}unref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount-1)),this.refcount-=1,this.refcount===0&&(this.channelzTrace.addTrace("CT_INFO","Shutting down"),(0,No.unregisterChannelzRef)(this.channelzRef),process.nextTick(()=>{this.transitionToState([$t.ConnectivityState.CONNECTING,$t.ConnectivityState.READY],$t.ConnectivityState.IDLE)}))}unrefIfOneRef(){return this.refcount===1?(this.unref(),!0):!1}createCall(e,r,s,n){if(!this.transport)throw new Error("Cannot create call, subchannel not READY");let i;return this.channelzEnabled?(this.callTracker.addCallStarted(),this.streamTracker.addCallStarted(),i={onCallEnd:o=>{o.code===YE.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}}):i={},this.transport.createCall(e,r,s,n,i)}startConnecting(){process.nextTick(()=>{this.transitionToState([$t.ConnectivityState.IDLE],$t.ConnectivityState.CONNECTING)||this.connectivityState===$t.ConnectivityState.TRANSIENT_FAILURE&&(this.continueConnecting=!0)})}getConnectivityState(){return this.connectivityState}addConnectivityStateListener(e){this.stateListeners.add(e)}removeConnectivityStateListener(e){this.stateListeners.delete(e)}resetBackoff(){process.nextTick(()=>{this.backoffTimeout.reset(),this.transitionToState([$t.ConnectivityState.TRANSIENT_FAILURE],$t.ConnectivityState.CONNECTING)})}getAddress(){return this.subchannelAddressString}getChannelzRef(){return this.channelzRef}isHealthy(){return!0}addHealthStateWatcher(e){}removeHealthStateWatcher(e){}getRealSubchannel(){return this}realSubchannelEquals(e){return e.getRealSubchannel()===this}throttleKeepalive(e){e>this.keepaliveTime&&(this.keepaliveTime=e)}};JE.Subchannel=yM});var bM=m(nu=>{"use strict";Object.defineProperty(nu,"__esModule",{value:!0});nu.setup=nu.DEFAULT_PORT=void 0;var LX=Eo(),FX=require("dns"),BX=require("util"),dUe=wN(),vM=ft(),_M=As(),fUe=er(),hUe=ft(),ru=hn(),jX=require("net"),pUe=Qg(),mUe="dns_resolver";function su(t){fUe.trace(hUe.LogVerbosity.DEBUG,mUe,t)}nu.DEFAULT_PORT=443;var gUe=3e4,yUe=BX.promisify(FX.resolveTxt),vUe=BX.promisify(FX.lookup),SM=class{constructor(e,r,s){var n,i,o;this.target=e,this.listener=r,this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.continueResolving=!1,this.isNextResolutionTimerRunning=!1,this.isServiceConfigEnabled=!0,this.returnedIpResult=!1,su("Resolver constructed for target "+(0,ru.uriToString)(e));let a=(0,ru.splitHostPort)(e.path);a===null?(this.ipResult=null,this.dnsHostname=null,this.port=null):(0,jX.isIPv4)(a.host)||(0,jX.isIPv6)(a.host)?(this.ipResult=[{addresses:[{host:a.host,port:(n=a.port)!==null&&n!==void 0?n:nu.DEFAULT_PORT}]}],this.dnsHostname=null,this.port=null):(this.ipResult=null,this.dnsHostname=a.host,this.port=(i=a.port)!==null&&i!==void 0?i:nu.DEFAULT_PORT),this.percentage=Math.random()*100,s["grpc.service_config_disable_resolution"]===1&&(this.isServiceConfigEnabled=!1),this.defaultResolutionError={code:vM.Status.UNAVAILABLE,details:`Name resolution failed for target ${(0,ru.uriToString)(this.target)}`,metadata:new _M.Metadata};let l={initialDelay:s["grpc.initial_reconnect_backoff_ms"],maxDelay:s["grpc.max_reconnect_backoff_ms"]};this.backoff=new pUe.BackoffTimeout(()=>{this.continueResolving&&this.startResolutionWithBackoff()},l),this.backoff.unref(),this.minTimeBetweenResolutionsMs=(o=s["grpc.dns_min_time_between_resolutions_ms"])!==null&&o!==void 0?o:gUe,this.nextResolutionTimer=setTimeout(()=>{},0),clearTimeout(this.nextResolutionTimer)}startResolution(){if(this.ipResult!==null){this.returnedIpResult||(su("Returning IP address for target "+(0,ru.uriToString)(this.target)),setImmediate(()=>{this.listener.onSuccessfulResolution(this.ipResult,null,null,null,{})}),this.returnedIpResult=!0),this.backoff.stop(),this.backoff.reset(),this.stopNextResolutionTimer();return}if(this.dnsHostname===null)su("Failed to parse DNS address "+(0,ru.uriToString)(this.target)),setImmediate(()=>{this.listener.onError({code:vM.Status.UNAVAILABLE,details:`Failed to parse DNS address ${(0,ru.uriToString)(this.target)}`,metadata:new _M.Metadata})}),this.stopNextResolutionTimer();else{if(this.pendingLookupPromise!==null)return;su("Looking up DNS hostname "+this.dnsHostname),this.latestLookupResult=null;let e=this.dnsHostname;this.pendingLookupPromise=vUe(e,{all:!0}),this.pendingLookupPromise.then(r=>{if(this.pendingLookupPromise===null)return;this.pendingLookupPromise=null,this.backoff.reset(),this.backoff.stop();let s=r.map(i=>({host:i.address,port:+this.port}));this.latestLookupResult=s.map(i=>({addresses:[i]}));let n="["+s.map(i=>i.host+":"+i.port).join(",")+"]";if(su("Resolved addresses for target "+(0,ru.uriToString)(this.target)+": "+n),this.latestLookupResult.length===0){this.listener.onError(this.defaultResolutionError);return}this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})},r=>{this.pendingLookupPromise!==null&&(su("Resolution error for target "+(0,ru.uriToString)(this.target)+": "+r.message),this.pendingLookupPromise=null,this.stopNextResolutionTimer(),this.listener.onError(this.defaultResolutionError))}),this.isServiceConfigEnabled&&this.pendingTxtPromise===null&&(this.pendingTxtPromise=yUe(e),this.pendingTxtPromise.then(r=>{if(this.pendingTxtPromise!==null){this.pendingTxtPromise=null;try{this.latestServiceConfig=(0,dUe.extractAndSelectServiceConfig)(r,this.percentage)}catch(s){this.latestServiceConfigError={code:vM.Status.UNAVAILABLE,details:`Parsing service config failed with error ${s.message}`,metadata:new _M.Metadata}}this.latestLookupResult!==null&&this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})}},r=>{}))}}startNextResolutionTimer(){var e,r;clearTimeout(this.nextResolutionTimer),this.nextResolutionTimer=setTimeout(()=>{this.stopNextResolutionTimer(),this.continueResolving&&this.startResolutionWithBackoff()},this.minTimeBetweenResolutionsMs),(r=(e=this.nextResolutionTimer).unref)===null||r===void 0||r.call(e),this.isNextResolutionTimerRunning=!0}stopNextResolutionTimer(){clearTimeout(this.nextResolutionTimer),this.isNextResolutionTimerRunning=!1}startResolutionWithBackoff(){this.pendingLookupPromise===null&&(this.continueResolving=!1,this.backoff.runOnce(),this.startNextResolutionTimer(),this.startResolution())}updateResolution(){this.pendingLookupPromise===null&&(this.isNextResolutionTimerRunning||this.backoff.isRunning()?(this.isNextResolutionTimerRunning?su('resolution update delayed by "min time between resolutions" rate limit'):su("resolution update delayed by backoff timer until "+this.backoff.getEndTime().toISOString()),this.continueResolving=!0):this.startResolutionWithBackoff())}destroy(){this.continueResolving=!1,this.backoff.reset(),this.backoff.stop(),this.stopNextResolutionTimer(),this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.returnedIpResult=!1}static getDefaultAuthority(e){return e.path}};function _Ue(){(0,LX.registerResolver)("dns",SM),(0,LX.registerDefaultScheme)("dns")}nu.setup=_Ue});var EM=m(Fh=>{"use strict";Object.defineProperty(Fh,"__esModule",{value:!0});Fh.getProxiedConnection=Fh.mapProxyName=void 0;var gy=er(),Lh=ft(),SUe=Eo(),bUe=require("http"),EUe=require("tls"),wUe=er(),zX=Ai(),jh=hn(),TUe=require("url"),CUe=bM(),RUe="proxy";function iu(t){wUe.trace(Lh.LogVerbosity.DEBUG,RUe,t)}function OUe(){let t="",e="";if(process.env.grpc_proxy)e="grpc_proxy",t=process.env.grpc_proxy;else if(process.env.https_proxy)e="https_proxy",t=process.env.https_proxy;else if(process.env.http_proxy)e="http_proxy",t=process.env.http_proxy;else return{};let r;try{r=new TUe.URL(t)}catch{return(0,gy.log)(Lh.LogVerbosity.ERROR,`cannot parse value of "${e}" env var`),{}}if(r.protocol!=="http:")return(0,gy.log)(Lh.LogVerbosity.ERROR,`"${r.protocol}" scheme not supported in proxy URI`),{};let s=null;r.username&&(r.password?((0,gy.log)(Lh.LogVerbosity.INFO,"userinfo found in proxy URI"),s=decodeURIComponent(`${r.username}:${r.password}`)):s=r.username);let n=r.hostname,i=r.port;i===""&&(i="80");let o={address:`${n}:${i}`};return s&&(o.creds=s),iu("Proxy server "+o.address+" set by environment variable "+e),o}function PUe(){let t=process.env.no_grpc_proxy,e="no_grpc_proxy";return t||(t=process.env.no_proxy,e="no_proxy"),t?(iu("No proxy server list set by environment variable "+e),t.split(",")):[]}function AUe(t,e){var r;let s={target:t,extraOptions:{}};if(((r=e["grpc.enable_http_proxy"])!==null&&r!==void 0?r:1)===0||t.scheme==="unix")return s;let n=OUe();if(!n.address)return s;let i=(0,jh.splitHostPort)(t.path);if(!i)return s;let o=i.host;for(let l of PUe())if(l===o)return iu("Not using proxy for target in no_proxy list: "+(0,jh.uriToString)(t)),s;let a={"grpc.http_connect_target":(0,jh.uriToString)(t)};return n.creds&&(a["grpc.http_connect_creds"]=n.creds),{target:{scheme:"dns",path:n.address},extraOptions:a}}Fh.mapProxyName=AUe;function kUe(t,e,r){var s;if(!("grpc.http_connect_target"in e))return Promise.resolve({});let n=e["grpc.http_connect_target"],i=(0,jh.parseUri)(n);if(i===null)return Promise.resolve({});let o=(0,jh.splitHostPort)(i.path);if(o===null)return Promise.resolve({});let a=`${o.host}:${(s=o.port)!==null&&s!==void 0?s:CUe.DEFAULT_PORT}`,l={method:"CONNECT",path:a},u={Host:a};(0,zX.isTcpSubchannelAddress)(t)?(l.host=t.host,l.port=t.port):l.socketPath=t.path,"grpc.http_connect_creds"in e&&(u["Proxy-Authorization"]="Basic "+Buffer.from(e["grpc.http_connect_creds"]).toString("base64")),l.headers=u;let c=(0,zX.subchannelAddressToString)(t);return iu("Using proxy "+c+" to connect to "+l.path),new Promise((d,f)=>{let h=bUe.request(l);h.once("connect",(p,g,_)=>{var S;if(h.removeAllListeners(),g.removeAllListeners(),p.statusCode===200)if(iu("Successfully connected to "+l.path+" through proxy "+c),_.length>0&&g.unshift(_),"secureContext"in r){let b=(0,SUe.getDefaultAuthority)(i),v=(0,jh.splitHostPort)(b),y=(S=v?.host)!==null&&S!==void 0?S:b,R=EUe.connect(Object.assign({host:y,servername:y,socket:g},r),()=>{iu("Successfully established a TLS connection to "+l.path+" through proxy "+c),d({socket:R,realTarget:i})});R.on("error",P=>{iu("Failed to establish a TLS connection to "+l.path+" through proxy "+c+" with error "+P.message),f()})}else iu("Successfully established a plaintext connection to "+l.path+" through proxy "+c),d({socket:g,realTarget:i});else(0,gy.log)(Lh.LogVerbosity.ERROR,"Failed to connect to "+l.path+" through proxy "+c+" with status "+p.statusCode),f()}),h.once("error",p=>{h.removeAllListeners(),(0,gy.log)(Lh.LogVerbosity.ERROR,"Failed to connect to proxy "+c+" with error "+p.message),f()}),h.end()})}Fh.getProxiedConnection=kUe});var TM=m(XE=>{"use strict";Object.defineProperty(XE,"__esModule",{value:!0});XE.StreamDecoder=void 0;var Do;(function(t){t[t.NO_DATA=0]="NO_DATA",t[t.READING_SIZE=1]="READING_SIZE",t[t.READING_MESSAGE=2]="READING_MESSAGE"})(Do||(Do={}));var wM=class{constructor(e){this.maxReadMessageLength=e,this.readState=Do.NO_DATA,this.readCompressFlag=Buffer.alloc(1),this.readPartialSize=Buffer.alloc(4),this.readSizeRemaining=4,this.readMessageSize=0,this.readPartialMessage=[],this.readMessageRemaining=0}write(e){let r=0,s,n=[];for(;r<e.length;)switch(this.readState){case Do.NO_DATA:this.readCompressFlag=e.slice(r,r+1),r+=1,this.readState=Do.READING_SIZE,this.readPartialSize.fill(0),this.readSizeRemaining=4,this.readMessageSize=0,this.readMessageRemaining=0,this.readPartialMessage=[];break;case Do.READING_SIZE:if(s=Math.min(e.length-r,this.readSizeRemaining),e.copy(this.readPartialSize,4-this.readSizeRemaining,r,r+s),this.readSizeRemaining-=s,r+=s,this.readSizeRemaining===0){if(this.readMessageSize=this.readPartialSize.readUInt32BE(0),this.maxReadMessageLength!==-1&&this.readMessageSize>this.maxReadMessageLength)throw new Error(`Received message larger than max (${this.readMessageSize} vs ${this.maxReadMessageLength})`);if(this.readMessageRemaining=this.readMessageSize,this.readMessageRemaining>0)this.readState=Do.READING_MESSAGE;else{let i=Buffer.concat([this.readCompressFlag,this.readPartialSize],5);this.readState=Do.NO_DATA,n.push(i)}}break;case Do.READING_MESSAGE:if(s=Math.min(e.length-r,this.readMessageRemaining),this.readPartialMessage.push(e.slice(r,r+s)),this.readMessageRemaining-=s,r+=s,this.readMessageRemaining===0){let i=[this.readCompressFlag,this.readPartialSize].concat(this.readPartialMessage),o=Buffer.concat(i,this.readMessageSize+5);this.readState=Do.NO_DATA,n.push(o)}break;default:throw new Error("Unexpected read state")}return n}};XE.StreamDecoder=wM});var VX=m(ew=>{"use strict";Object.defineProperty(ew,"__esModule",{value:!0});ew.Http2SubchannelCall=void 0;var Oa=require("http2"),xUe=require("os"),xt=ft(),Pa=As(),IUe=TM(),NUe=er(),DUe=ft(),MUe="subchannel_call";function $Ue(t){for(let[e,r]of Object.entries(xUe.constants.errno))if(r===t)return e;return"Unknown system error "+t}function UX(t){let e=`Received HTTP status code ${t}`,r;switch(t){case 400:r=xt.Status.INTERNAL;break;case 401:r=xt.Status.UNAUTHENTICATED;break;case 403:r=xt.Status.PERMISSION_DENIED;break;case 404:r=xt.Status.UNIMPLEMENTED;break;case 429:case 502:case 503:case 504:r=xt.Status.UNAVAILABLE;break;default:r=xt.Status.UNKNOWN}return{code:r,details:e,metadata:new Pa.Metadata}}var CM=class{constructor(e,r,s,n,i){var o;this.http2Stream=e,this.callEventTracker=r,this.listener=s,this.transport=n,this.callId=i,this.isReadFilterPending=!1,this.isPushPending=!1,this.canPush=!1,this.readsClosed=!1,this.statusOutput=!1,this.unpushedReadMessages=[],this.finalStatus=null,this.internalError=null,this.serverEndedCall=!1;let a=(o=n.getOptions()["grpc.max_receive_message_length"])!==null&&o!==void 0?o:xt.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH;this.decoder=new IUe.StreamDecoder(a),e.on("response",(l,u)=>{let c="";for(let d of Object.keys(l))c+="		"+d+": "+l[d]+`
`;if(this.trace(`Received server headers:
`+c),this.httpStatusCode=l[":status"],u&Oa.constants.NGHTTP2_FLAG_END_STREAM)this.handleTrailers(l);else{let d;try{d=Pa.Metadata.fromHttp2Headers(l)}catch(f){this.endCall({code:xt.Status.UNKNOWN,details:f.message,metadata:new Pa.Metadata});return}this.listener.onReceiveMetadata(d)}}),e.on("trailers",l=>{this.handleTrailers(l)}),e.on("data",l=>{if(this.statusOutput)return;this.trace("receive HTTP/2 data frame of length "+l.length);let u;try{u=this.decoder.write(l)}catch(c){this.cancelWithStatus(xt.Status.RESOURCE_EXHAUSTED,c.message);return}for(let c of u)this.trace("parsed message of length "+c.length),this.callEventTracker.addMessageReceived(),this.tryPush(c)}),e.on("end",()=>{this.readsClosed=!0,this.maybeOutputStatus()}),e.on("close",()=>{this.serverEndedCall=!0,process.nextTick(()=>{var l;if(this.trace("HTTP/2 stream closed with code "+e.rstCode),((l=this.finalStatus)===null||l===void 0?void 0:l.code)===xt.Status.OK)return;let u,c="";switch(e.rstCode){case Oa.constants.NGHTTP2_NO_ERROR:if(this.finalStatus!==null)return;if(this.httpStatusCode&&this.httpStatusCode!==200){let d=UX(this.httpStatusCode);u=d.code,c=d.details}else u=xt.Status.INTERNAL,c=`Received RST_STREAM with code ${e.rstCode} (Call ended without gRPC status)`;break;case Oa.constants.NGHTTP2_REFUSED_STREAM:u=xt.Status.UNAVAILABLE,c="Stream refused by server";break;case Oa.constants.NGHTTP2_CANCEL:u=xt.Status.CANCELLED,c="Call cancelled";break;case Oa.constants.NGHTTP2_ENHANCE_YOUR_CALM:u=xt.Status.RESOURCE_EXHAUSTED,c="Bandwidth exhausted or memory limit exceeded";break;case Oa.constants.NGHTTP2_INADEQUATE_SECURITY:u=xt.Status.PERMISSION_DENIED,c="Protocol not secure enough";break;case Oa.constants.NGHTTP2_INTERNAL_ERROR:u=xt.Status.INTERNAL,this.internalError===null?c=`Received RST_STREAM with code ${e.rstCode} (Internal server error)`:this.internalError.code==="ECONNRESET"||this.internalError.code==="ETIMEDOUT"?(u=xt.Status.UNAVAILABLE,c=this.internalError.message):c=`Received RST_STREAM with code ${e.rstCode} triggered by internal client error: ${this.internalError.message}`;break;default:u=xt.Status.INTERNAL,c=`Received RST_STREAM with code ${e.rstCode}`}this.endCall({code:u,details:c,metadata:new Pa.Metadata,rstCode:e.rstCode})})}),e.on("error",l=>{l.code!=="ERR_HTTP2_STREAM_ERROR"&&(this.trace("Node error event: message="+l.message+" code="+l.code+" errno="+$Ue(l.errno)+" syscall="+l.syscall),this.internalError=l),this.callEventTracker.onStreamEnd(!1)})}getDeadlineInfo(){return[`remote_addr=${this.getPeer()}`]}onDisconnect(){this.endCall({code:xt.Status.UNAVAILABLE,details:"Connection dropped",metadata:new Pa.Metadata})}outputStatus(){this.statusOutput||(this.statusOutput=!0,this.trace("ended with status: code="+this.finalStatus.code+' details="'+this.finalStatus.details+'"'),this.callEventTracker.onCallEnd(this.finalStatus),process.nextTick(()=>{this.listener.onReceiveStatus(this.finalStatus)}),this.http2Stream.resume())}trace(e){NUe.trace(DUe.LogVerbosity.DEBUG,MUe,"["+this.callId+"] "+e)}endCall(e){(this.finalStatus===null||this.finalStatus.code===xt.Status.OK)&&(this.finalStatus=e,this.maybeOutputStatus()),this.destroyHttp2Stream()}maybeOutputStatus(){this.finalStatus!==null&&(this.finalStatus.code!==xt.Status.OK||this.readsClosed&&this.unpushedReadMessages.length===0&&!this.isReadFilterPending&&!this.isPushPending)&&this.outputStatus()}push(e){this.trace("pushing to reader message of length "+(e instanceof Buffer?e.length:null)),this.canPush=!1,this.isPushPending=!0,process.nextTick(()=>{this.isPushPending=!1,!this.statusOutput&&(this.listener.onReceiveMessage(e),this.maybeOutputStatus())})}tryPush(e){this.canPush?(this.http2Stream.pause(),this.push(e)):(this.trace("unpushedReadMessages.push message of length "+e.length),this.unpushedReadMessages.push(e))}handleTrailers(e){this.serverEndedCall=!0,this.callEventTracker.onStreamEnd(!0);let r="";for(let o of Object.keys(e))r+="		"+o+": "+e[o]+`
`;this.trace(`Received server trailers:
`+r);let s;try{s=Pa.Metadata.fromHttp2Headers(e)}catch{s=new Pa.Metadata}let n=s.getMap(),i;if(typeof n["grpc-status"]=="string"){let o=Number(n["grpc-status"]);this.trace("received status code "+o+" from server"),s.remove("grpc-status");let a="";if(typeof n["grpc-message"]=="string"){try{a=decodeURI(n["grpc-message"])}catch{a=n["grpc-message"]}s.remove("grpc-message"),this.trace('received status details string "'+a+'" from server')}i={code:o,details:a,metadata:s}}else this.httpStatusCode?(i=UX(this.httpStatusCode),i.metadata=s):i={code:xt.Status.UNKNOWN,details:"No status information received",metadata:s};this.endCall(i)}destroyHttp2Stream(){var e;if(!this.http2Stream.destroyed)if(this.serverEndedCall)this.http2Stream.end();else{let r;((e=this.finalStatus)===null||e===void 0?void 0:e.code)===xt.Status.OK?r=Oa.constants.NGHTTP2_NO_ERROR:r=Oa.constants.NGHTTP2_CANCEL,this.trace("close http2 stream with code "+r),this.http2Stream.close(r)}}cancelWithStatus(e,r){this.trace("cancelWithStatus code: "+e+' details: "'+r+'"'),this.endCall({code:e,details:r,metadata:new Pa.Metadata})}getStatus(){return this.finalStatus}getPeer(){return this.transport.getPeerName()}getCallNumber(){return this.callId}startRead(){if(this.finalStatus!==null&&this.finalStatus.code!==xt.Status.OK){this.readsClosed=!0,this.maybeOutputStatus();return}if(this.canPush=!0,this.unpushedReadMessages.length>0){let e=this.unpushedReadMessages.shift();this.push(e);return}this.http2Stream.resume()}sendMessageWithContext(e,r){this.trace("write() called with message of length "+r.length);let s=n=>{process.nextTick(()=>{var i;let o=xt.Status.UNAVAILABLE;n?.code==="ERR_STREAM_WRITE_AFTER_END"&&(o=xt.Status.INTERNAL),n&&this.cancelWithStatus(o,`Write error: ${n.message}`),(i=e.callback)===null||i===void 0||i.call(e)})};this.trace("sending data chunk of length "+r.length),this.callEventTracker.addMessageSent();try{this.http2Stream.write(r,s)}catch(n){this.endCall({code:xt.Status.UNAVAILABLE,details:`Write failed with error ${n.message}`,metadata:new Pa.Metadata})}}halfClose(){this.trace("end() called"),this.trace("calling end() on HTTP/2 stream"),this.http2Stream.end()}};ew.Http2SubchannelCall=CM});var RM=m(tw=>{"use strict";Object.defineProperty(tw,"__esModule",{value:!0});tw.getNextCallNumber=void 0;var qUe=0;function LUe(){return qUe++}tw.getNextCallNumber=LUe});var KX=m(nw=>{"use strict";Object.defineProperty(nw,"__esModule",{value:!0});nw.Http2SubchannelConnector=void 0;var kM=require("http2"),HX=require("tls"),rw=zc(),yy=ft(),jUe=EM(),zh=er(),GX=Eo(),sw=Ai(),Bh=hn(),FUe=require("net"),BUe=VX(),zUe=RM(),OM="transport",UUe="transport_flowctrl",VUe=fN().version,{HTTP2_HEADER_AUTHORITY:HUe,HTTP2_HEADER_CONTENT_TYPE:GUe,HTTP2_HEADER_METHOD:KUe,HTTP2_HEADER_PATH:QUe,HTTP2_HEADER_TE:WUe,HTTP2_HEADER_USER_AGENT:ZUe}=kM.constants,YUe=2e4,JUe=Buffer.from("too_many_pings","ascii"),PM=class{constructor(e,r,s,n){this.session=e,this.options=s,this.remoteName=n,this.keepaliveTimer=null,this.pendingSendKeepalivePing=!1,this.activeCalls=new Set,this.disconnectListeners=[],this.disconnectHandled=!1,this.channelzEnabled=!0,this.keepalivesSent=0,this.messagesSent=0,this.messagesReceived=0,this.lastMessageSentTimestamp=null,this.lastMessageReceivedTimestamp=null,this.subchannelAddressString=(0,sw.subchannelAddressToString)(r),s["grpc.enable_channelz"]===0?(this.channelzEnabled=!1,this.streamTracker=new rw.ChannelzCallTrackerStub):this.streamTracker=new rw.ChannelzCallTracker,this.channelzRef=(0,rw.registerChannelzSocket)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.userAgent=[s["grpc.primary_user_agent"],`grpc-node-js/${VUe}`,s["grpc.secondary_user_agent"]].filter(i=>i).join(" "),"grpc.keepalive_time_ms"in s?this.keepaliveTimeMs=s["grpc.keepalive_time_ms"]:this.keepaliveTimeMs=-1,"grpc.keepalive_timeout_ms"in s?this.keepaliveTimeoutMs=s["grpc.keepalive_timeout_ms"]:this.keepaliveTimeoutMs=YUe,"grpc.keepalive_permit_without_calls"in s?this.keepaliveWithoutCalls=s["grpc.keepalive_permit_without_calls"]===1:this.keepaliveWithoutCalls=!1,e.once("close",()=>{this.trace("session closed"),this.handleDisconnect()}),e.once("goaway",(i,o,a)=>{let l=!1;i===kM.constants.NGHTTP2_ENHANCE_YOUR_CALM&&a&&a.equals(JUe)&&(l=!0),this.trace("connection closed by GOAWAY with code "+i+" and data "+a?.toString()),this.reportDisconnectToOwner(l)}),e.once("error",i=>{this.trace("connection closed with error "+i.message)}),zh.isTracerEnabled(OM)&&(e.on("remoteSettings",i=>{this.trace("new settings received"+(this.session!==e?" on the old connection":"")+": "+JSON.stringify(i))}),e.on("localSettings",i=>{this.trace("local settings acknowledged by remote"+(this.session!==e?" on the old connection":"")+": "+JSON.stringify(i))})),this.keepaliveWithoutCalls&&this.maybeStartKeepalivePingTimer()}getChannelzInfo(){var e,r,s;let n=this.session.socket,i=n.remoteAddress?(0,sw.stringToSubchannelAddress)(n.remoteAddress,n.remotePort):null,o=n.localAddress?(0,sw.stringToSubchannelAddress)(n.localAddress,n.localPort):null,a;if(this.session.encrypted){let u=n,c=u.getCipher(),d=u.getCertificate(),f=u.getPeerCertificate();a={cipherSuiteStandardName:(e=c.standardName)!==null&&e!==void 0?e:null,cipherSuiteOtherName:c.standardName?null:c.name,localCertificate:d&&"raw"in d?d.raw:null,remoteCertificate:f&&"raw"in f?f.raw:null}}else a=null;return{remoteAddress:i,localAddress:o,security:a,remoteName:this.remoteName,streamsStarted:this.streamTracker.callsStarted,streamsSucceeded:this.streamTracker.callsSucceeded,streamsFailed:this.streamTracker.callsFailed,messagesSent:this.messagesSent,messagesReceived:this.messagesReceived,keepAlivesSent:this.keepalivesSent,lastLocalStreamCreatedTimestamp:this.streamTracker.lastCallStartedTimestamp,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:this.lastMessageSentTimestamp,lastMessageReceivedTimestamp:this.lastMessageReceivedTimestamp,localFlowControlWindow:(r=this.session.state.localWindowSize)!==null&&r!==void 0?r:null,remoteFlowControlWindow:(s=this.session.state.remoteWindowSize)!==null&&s!==void 0?s:null}}trace(e){zh.trace(yy.LogVerbosity.DEBUG,OM,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}keepaliveTrace(e){zh.trace(yy.LogVerbosity.DEBUG,"keepalive","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}flowControlTrace(e){zh.trace(yy.LogVerbosity.DEBUG,UUe,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}internalsTrace(e){zh.trace(yy.LogVerbosity.DEBUG,"transport_internals","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}reportDisconnectToOwner(e){this.disconnectHandled||(this.disconnectHandled=!0,this.disconnectListeners.forEach(r=>r(e)))}handleDisconnect(){this.clearKeepaliveTimeout(),this.reportDisconnectToOwner(!1),setImmediate(()=>{for(let e of this.activeCalls)e.onDisconnect();this.session.destroy()})}addDisconnectListener(e){this.disconnectListeners.push(e)}canSendPing(){return!this.session.destroyed&&this.keepaliveTimeMs>0&&(this.keepaliveWithoutCalls||this.activeCalls.size>0)}maybeSendPing(){var e,r;if(!this.canSendPing()){this.pendingSendKeepalivePing=!0;return}if(this.keepaliveTimer){console.error("keepaliveTimeout is not null");return}this.channelzEnabled&&(this.keepalivesSent+=1),this.keepaliveTrace("Sending ping with timeout "+this.keepaliveTimeoutMs+"ms"),this.keepaliveTimer=setTimeout(()=>{this.keepaliveTimer=null,this.keepaliveTrace("Ping timeout passed without response"),this.handleDisconnect()},this.keepaliveTimeoutMs),(r=(e=this.keepaliveTimer).unref)===null||r===void 0||r.call(e);let s="";try{this.session.ping((i,o,a)=>{this.clearKeepaliveTimeout(),i?(this.keepaliveTrace("Ping failed with error "+i.message),this.handleDisconnect()):(this.keepaliveTrace("Received ping response"),this.maybeStartKeepalivePingTimer())})||(s="Ping returned false")}catch(n){s=(n instanceof Error?n.message:"")||"Unknown error"}s&&(this.keepaliveTrace("Ping send failed: "+s),this.handleDisconnect())}maybeStartKeepalivePingTimer(){var e,r;this.canSendPing()&&(this.pendingSendKeepalivePing?(this.pendingSendKeepalivePing=!1,this.maybeSendPing()):this.keepaliveTimer||(this.keepaliveTrace("Starting keepalive timer for "+this.keepaliveTimeMs+"ms"),this.keepaliveTimer=setTimeout(()=>{this.keepaliveTimer=null,this.maybeSendPing()},this.keepaliveTimeMs),(r=(e=this.keepaliveTimer).unref)===null||r===void 0||r.call(e)))}clearKeepaliveTimeout(){this.keepaliveTimer&&(clearTimeout(this.keepaliveTimer),this.keepaliveTimer=null)}removeActiveCall(e){this.activeCalls.delete(e),this.activeCalls.size===0&&this.session.unref()}addActiveCall(e){this.activeCalls.add(e),this.activeCalls.size===1&&(this.session.ref(),this.keepaliveWithoutCalls||this.maybeStartKeepalivePingTimer())}createCall(e,r,s,n,i){let o=e.toHttp2Headers();o[HUe]=r,o[ZUe]=this.userAgent,o[GUe]="application/grpc",o[KUe]="POST",o[QUe]=s,o[WUe]="trailers";let a;try{a=this.session.request(o)}catch(c){throw this.handleDisconnect(),c}this.flowControlTrace("local window size: "+this.session.state.localWindowSize+" remote window size: "+this.session.state.remoteWindowSize),this.internalsTrace("session.closed="+this.session.closed+" session.destroyed="+this.session.destroyed+" session.socket.destroyed="+this.session.socket.destroyed);let l,u;return this.channelzEnabled?(this.streamTracker.addCallStarted(),l={addMessageSent:()=>{var c;this.messagesSent+=1,this.lastMessageSentTimestamp=new Date,(c=i.addMessageSent)===null||c===void 0||c.call(i)},addMessageReceived:()=>{var c;this.messagesReceived+=1,this.lastMessageReceivedTimestamp=new Date,(c=i.addMessageReceived)===null||c===void 0||c.call(i)},onCallEnd:c=>{var d;(d=i.onCallEnd)===null||d===void 0||d.call(i,c),this.removeActiveCall(u)},onStreamEnd:c=>{var d;c?this.streamTracker.addCallSucceeded():this.streamTracker.addCallFailed(),(d=i.onStreamEnd)===null||d===void 0||d.call(i,c)}}):l={addMessageSent:()=>{var c;(c=i.addMessageSent)===null||c===void 0||c.call(i)},addMessageReceived:()=>{var c;(c=i.addMessageReceived)===null||c===void 0||c.call(i)},onCallEnd:c=>{var d;(d=i.onCallEnd)===null||d===void 0||d.call(i,c),this.removeActiveCall(u)},onStreamEnd:c=>{var d;(d=i.onStreamEnd)===null||d===void 0||d.call(i,c)}},u=new BUe.Http2SubchannelCall(a,l,n,this,(0,zUe.getNextCallNumber)()),this.addActiveCall(u),u}getChannelzRef(){return this.channelzRef}getPeerName(){return this.subchannelAddressString}getOptions(){return this.options}shutdown(){this.session.close(),(0,rw.unregisterChannelzRef)(this.channelzRef)}},AM=class{constructor(e){this.channelTarget=e,this.session=null,this.isShutdown=!1}trace(e){zh.trace(yy.LogVerbosity.DEBUG,OM,(0,Bh.uriToString)(this.channelTarget)+" "+e)}createSession(e,r,s,n){return this.isShutdown?Promise.reject():new Promise((i,o)=>{var a,l,u,c;let d;n.realTarget?(d=(0,Bh.uriToString)(n.realTarget),this.trace("creating HTTP/2 session through proxy to "+(0,Bh.uriToString)(n.realTarget))):(d=null,this.trace("creating HTTP/2 session to "+(0,sw.subchannelAddressToString)(e)));let f=(0,GX.getDefaultAuthority)((a=n.realTarget)!==null&&a!==void 0?a:this.channelTarget),h=r._getConnectionOptions()||{};h.maxSendHeaderBlockLength=Number.MAX_SAFE_INTEGER,"grpc-node.max_session_memory"in s?h.maxSessionMemory=s["grpc-node.max_session_memory"]:h.maxSessionMemory=Number.MAX_SAFE_INTEGER;let p="http://";if("secureContext"in h){if(p="https://",s["grpc.ssl_target_name_override"]){let S=s["grpc.ssl_target_name_override"],b=(l=h.checkServerIdentity)!==null&&l!==void 0?l:HX.checkServerIdentity;h.checkServerIdentity=(v,y)=>b(S,y),h.servername=S}else{let S=(c=(u=(0,Bh.splitHostPort)(f))===null||u===void 0?void 0:u.host)!==null&&c!==void 0?c:"localhost";h.servername=S}n.socket&&(h.createConnection=(S,b)=>n.socket)}else h.createConnection=(S,b)=>n.socket?n.socket:FUe.connect(e);h=Object.assign(Object.assign(Object.assign({},h),e),{enableTrace:s["grpc-node.tls_enable_trace"]===1});let g=kM.connect(p+f,h);this.session=g;let _="Failed to connect";g.unref(),g.once("connect",()=>{g.removeAllListeners(),i(new PM(g,e,s,d)),this.session=null}),g.once("close",()=>{this.session=null,setImmediate(()=>{o(`${_} (${new Date().toISOString()})`)})}),g.once("error",S=>{_=S.message,this.trace("connection failed with error "+_)})})}connect(e,r,s){var n,i,o;if(this.isShutdown)return Promise.reject();let a=r._getConnectionOptions()||{};if("secureContext"in a){if(a.ALPNProtocols=["h2"],s["grpc.ssl_target_name_override"]){let l=s["grpc.ssl_target_name_override"],u=(n=a.checkServerIdentity)!==null&&n!==void 0?n:HX.checkServerIdentity;a.checkServerIdentity=(c,d)=>u(l,d),a.servername=l}else if("grpc.http_connect_target"in s){let l=(0,GX.getDefaultAuthority)((i=(0,Bh.parseUri)(s["grpc.http_connect_target"]))!==null&&i!==void 0?i:{path:"localhost"}),u=(0,Bh.splitHostPort)(l);a.servername=(o=u?.host)!==null&&o!==void 0?o:l}s["grpc-node.tls_enable_trace"]&&(a.enableTrace=!0)}return(0,jUe.getProxiedConnection)(e,s,a).then(l=>this.createSession(e,r,s,l))}shutdown(){var e;this.isShutdown=!0,(e=this.session)===null||e===void 0||e.close(),this.session=null}};nw.Http2SubchannelConnector=AM});var QX=m(Uh=>{"use strict";Object.defineProperty(Uh,"__esModule",{value:!0});Uh.getSubchannelPool=Uh.SubchannelPool=void 0;var XUe=R7(),e3e=qX(),t3e=Ai(),r3e=hn(),s3e=KX(),n3e=1e4,vy=class{constructor(){this.pool=Object.create(null),this.cleanupTimer=null}unrefUnusedSubchannels(){let e=!0;for(let r in this.pool){let n=this.pool[r].filter(i=>!i.subchannel.unrefIfOneRef());n.length>0&&(e=!1),this.pool[r]=n}e&&this.cleanupTimer!==null&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null)}ensureCleanupTask(){var e,r;this.cleanupTimer===null&&(this.cleanupTimer=setInterval(()=>{this.unrefUnusedSubchannels()},n3e),(r=(e=this.cleanupTimer).unref)===null||r===void 0||r.call(e))}getOrCreateSubchannel(e,r,s,n){this.ensureCleanupTask();let i=(0,r3e.uriToString)(e);if(i in this.pool){let a=this.pool[i];for(let l of a)if((0,t3e.subchannelAddressEqual)(r,l.subchannelAddress)&&(0,XUe.channelOptionsEqual)(s,l.channelArguments)&&n._equals(l.channelCredentials))return l.subchannel}let o=new e3e.Subchannel(e,r,s,n,new s3e.Http2SubchannelConnector(e));return i in this.pool||(this.pool[i]=[]),this.pool[i].push({subchannelAddress:r,channelArguments:s,channelCredentials:n,subchannel:o}),o.ref(),o}};Uh.SubchannelPool=vy;var i3e=new vy;function o3e(t){return t?i3e:new vy}Uh.getSubchannelPool=o3e});var xM=m(Vh=>{"use strict";Object.defineProperty(Vh,"__esModule",{value:!0});Vh.FilterStackFactory=Vh.FilterStack=void 0;var iw=class{constructor(e){this.filters=e}sendMetadata(e){let r=e;for(let s=0;s<this.filters.length;s++)r=this.filters[s].sendMetadata(r);return r}receiveMetadata(e){let r=e;for(let s=this.filters.length-1;s>=0;s--)r=this.filters[s].receiveMetadata(r);return r}sendMessage(e){let r=e;for(let s=0;s<this.filters.length;s++)r=this.filters[s].sendMessage(r);return r}receiveMessage(e){let r=e;for(let s=this.filters.length-1;s>=0;s--)r=this.filters[s].receiveMessage(r);return r}receiveTrailers(e){let r=e;for(let s=this.filters.length-1;s>=0;s--)r=this.filters[s].receiveTrailers(r);return r}push(e){this.filters.unshift(...e)}getFilters(){return this.filters}};Vh.FilterStack=iw;var _y=class{constructor(e){this.factories=e}push(e){this.factories.unshift(...e)}clone(){return new _y([...this.factories])}createFilter(){return new iw(this.factories.map(e=>e.createFilter()))}};Vh.FilterStackFactory=_y});var IM=m(ow=>{"use strict";Object.defineProperty(ow,"__esModule",{value:!0});ow.CompressionAlgorithms=void 0;var WX;(function(t){t[t.identity=0]="identity",t[t.deflate=1]="deflate",t[t.gzip=2]="gzip"})(WX||(ow.CompressionAlgorithms=WX={}))});var DM=m(aw=>{"use strict";Object.defineProperty(aw,"__esModule",{value:!0});aw.BaseFilter=void 0;var NM=class{async sendMetadata(e){return e}receiveMetadata(e){return e}async sendMessage(e){return e}async receiveMessage(e){return e}receiveTrailers(e){return e}};aw.BaseFilter=NM});var JX=m(Kh=>{"use strict";Object.defineProperty(Kh,"__esModule",{value:!0});Kh.CompressionFilterFactory=Kh.CompressionFilter=void 0;var lw=require("zlib"),YX=IM(),Hh=ft(),a3e=DM(),l3e=er(),u3e=t=>typeof t=="number"&&typeof YX.CompressionAlgorithms[t]=="string",Gh=class{async writeMessage(e,r){let s=e;r&&(s=await this.compressMessage(s));let n=Buffer.allocUnsafe(s.length+5);return n.writeUInt8(r?1:0,0),n.writeUInt32BE(s.length,1),s.copy(n,5),n}async readMessage(e){let r=e.readUInt8(0)===1,s=e.slice(5);return r&&(s=await this.decompressMessage(s)),s}},Uc=class extends Gh{async compressMessage(e){return e}async writeMessage(e,r){let s=Buffer.allocUnsafe(e.length+5);return s.writeUInt8(0,0),s.writeUInt32BE(e.length,1),e.copy(s,5),s}decompressMessage(e){return Promise.reject(new Error('Received compressed message but "grpc-encoding" header was identity'))}},MM=class extends Gh{constructor(e){super(),this.maxRecvMessageLength=e}compressMessage(e){return new Promise((r,s)=>{lw.deflate(e,(n,i)=>{n?s(n):r(i)})})}decompressMessage(e){return new Promise((r,s)=>{let n=0,i=[],o=lw.createInflate();o.on("data",a=>{i.push(a),n+=a.byteLength,this.maxRecvMessageLength!==-1&&n>this.maxRecvMessageLength&&(o.destroy(),s({code:Hh.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),o.on("end",()=>{r(Buffer.concat(i))}),o.write(e),o.end()})}},$M=class extends Gh{constructor(e){super(),this.maxRecvMessageLength=e}compressMessage(e){return new Promise((r,s)=>{lw.gzip(e,(n,i)=>{n?s(n):r(i)})})}decompressMessage(e){return new Promise((r,s)=>{let n=0,i=[],o=lw.createGunzip();o.on("data",a=>{i.push(a),n+=a.byteLength,this.maxRecvMessageLength!==-1&&n>this.maxRecvMessageLength&&(o.destroy(),s({code:Hh.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),o.on("end",()=>{r(Buffer.concat(i))}),o.write(e),o.end()})}},qM=class extends Gh{constructor(e){super(),this.compressionName=e}compressMessage(e){return Promise.reject(new Error(`Received message compressed with unsupported compression method ${this.compressionName}`))}decompressMessage(e){return Promise.reject(new Error(`Compression method not supported: ${this.compressionName}`))}};function ZX(t,e){switch(t){case"identity":return new Uc;case"deflate":return new MM(e);case"gzip":return new $M(e);default:return new qM(t)}}var uw=class extends a3e.BaseFilter{constructor(e,r){var s,n,i;super(),this.sharedFilterConfig=r,this.sendCompression=new Uc,this.receiveCompression=new Uc,this.currentCompressionAlgorithm="identity";let o=e["grpc.default_compression_algorithm"];if(this.maxReceiveMessageLength=(s=e["grpc.max_receive_message_length"])!==null&&s!==void 0?s:Hh.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,this.maxSendMessageLength=(n=e["grpc.max_send_message_length"])!==null&&n!==void 0?n:Hh.DEFAULT_MAX_SEND_MESSAGE_LENGTH,o!==void 0)if(u3e(o)){let a=YX.CompressionAlgorithms[o],l=(i=r.serverSupportedEncodingHeader)===null||i===void 0?void 0:i.split(",");(!l||l.includes(a))&&(this.currentCompressionAlgorithm=a,this.sendCompression=ZX(this.currentCompressionAlgorithm,-1))}else l3e.log(Hh.LogVerbosity.ERROR,`Invalid value provided for grpc.default_compression_algorithm option: ${o}`)}async sendMetadata(e){let r=await e;return r.set("grpc-accept-encoding","identity,deflate,gzip"),r.set("accept-encoding","identity"),this.currentCompressionAlgorithm==="identity"?r.remove("grpc-encoding"):r.set("grpc-encoding",this.currentCompressionAlgorithm),r}receiveMetadata(e){let r=e.get("grpc-encoding");if(r.length>0){let n=r[0];typeof n=="string"&&(this.receiveCompression=ZX(n,this.maxReceiveMessageLength))}e.remove("grpc-encoding");let s=e.get("grpc-accept-encoding")[0];return s&&(this.sharedFilterConfig.serverSupportedEncodingHeader=s,s.split(",").includes(this.currentCompressionAlgorithm)||(this.sendCompression=new Uc,this.currentCompressionAlgorithm="identity")),e.remove("grpc-accept-encoding"),e}async sendMessage(e){var r;let s=await e;if(this.maxSendMessageLength!==-1&&s.message.length>this.maxSendMessageLength)throw{code:Hh.Status.RESOURCE_EXHAUSTED,details:`Attempted to send message with a size larger than ${this.maxSendMessageLength}`};let n;return this.sendCompression instanceof Uc?n=!1:n=(((r=s.flags)!==null&&r!==void 0?r:0)&2)===0,{message:await this.sendCompression.writeMessage(s.message,n),flags:s.flags}}async receiveMessage(e){return this.receiveCompression.readMessage(await e)}};Kh.CompressionFilter=uw;var LM=class{constructor(e,r){this.options=r,this.sharedFilterConfig={}}createFilter(){return new uw(this.options,this.sharedFilterConfig)}};Kh.CompressionFilterFactory=LM});var Sy=m(si=>{"use strict";Object.defineProperty(si,"__esModule",{value:!0});si.formatDateDifference=si.deadlineToString=si.getRelativeTimeout=si.getDeadlineTimeoutString=si.minDeadline=void 0;function c3e(...t){let e=1/0;for(let r of t){let s=r instanceof Date?r.getTime():r;s<e&&(e=s)}return e}si.minDeadline=c3e;var d3e=[["m",1],["S",1e3],["M",60*1e3],["H",60*60*1e3]];function f3e(t){let e=new Date().getTime();t instanceof Date&&(t=t.getTime());let r=Math.max(t-e,0);for(let[s,n]of d3e){let i=r/n;if(i<1e8)return String(Math.ceil(i))+s}throw new Error("Deadline is too far in the future")}si.getDeadlineTimeoutString=f3e;var h3e=2147483647;function p3e(t){let e=t instanceof Date?t.getTime():t,r=new Date().getTime(),s=e-r;return s<0?0:s>h3e?1/0:s}si.getRelativeTimeout=p3e;function m3e(t){if(t instanceof Date)return t.toISOString();{let e=new Date(t);return Number.isNaN(e.getTime())?""+t:e.toISOString()}}si.deadlineToString=m3e;function g3e(t,e){return((e.getTime()-t.getTime())/1e3).toFixed(3)+"s"}si.formatDateDifference=g3e});var dw=m(cw=>{"use strict";Object.defineProperty(cw,"__esModule",{value:!0});cw.restrictControlPlaneStatusCode=void 0;var Mo=ft(),y3e=[Mo.Status.OK,Mo.Status.INVALID_ARGUMENT,Mo.Status.NOT_FOUND,Mo.Status.ALREADY_EXISTS,Mo.Status.FAILED_PRECONDITION,Mo.Status.ABORTED,Mo.Status.OUT_OF_RANGE,Mo.Status.DATA_LOSS];function v3e(t,e){return y3e.includes(t)?{code:Mo.Status.INTERNAL,details:`Invalid status from control plane: ${t} ${Mo.Status[t]} ${e}`}:{code:t,details:e}}cw.restrictControlPlaneStatusCode=v3e});var tee=m(pw=>{"use strict";Object.defineProperty(pw,"__esModule",{value:!0});pw.LoadBalancingCall=void 0;var XX=Qn(),fw=ft(),eee=Sy(),hw=As(),by=Hl(),_3e=hn(),S3e=er(),jM=dw(),b3e=require("http2"),E3e="load_balancing_call",FM=class{constructor(e,r,s,n,i,o,a){var l,u;this.channel=e,this.callConfig=r,this.methodName=s,this.host=n,this.credentials=i,this.deadline=o,this.callNumber=a,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.metadata=null,this.listener=null,this.onCallEnded=null,this.childStartTime=null;let c=this.methodName.split("/"),d="";c.length>=2&&(d=c[1]);let f=(u=(l=(0,_3e.splitHostPort)(this.host))===null||l===void 0?void 0:l.host)!==null&&u!==void 0?u:"localhost";this.serviceUrl=`https://${f}/${d}`,this.startTime=new Date}getDeadlineInfo(){var e,r;let s=[];return this.childStartTime?(this.childStartTime>this.startTime&&(!((e=this.metadata)===null||e===void 0)&&e.getOptions().waitForReady&&s.push("wait_for_ready"),s.push(`LB pick: ${(0,eee.formatDateDifference)(this.startTime,this.childStartTime)}`)),s.push(...this.child.getDeadlineInfo()),s):(!((r=this.metadata)===null||r===void 0)&&r.getOptions().waitForReady&&s.push("wait_for_ready"),s.push("Waiting for LB pick"),s)}trace(e){S3e.trace(fw.LogVerbosity.DEBUG,E3e,"["+this.callNumber+"] "+e)}outputStatus(e,r){var s,n;if(!this.ended){this.ended=!0,this.trace("ended with status: code="+e.code+' details="'+e.details+'" start time='+this.startTime.toISOString());let i=Object.assign(Object.assign({},e),{progress:r});(s=this.listener)===null||s===void 0||s.onReceiveStatus(i),(n=this.onCallEnded)===null||n===void 0||n.call(this,i.code)}}doPick(){var e,r;if(this.ended)return;if(!this.metadata)throw new Error("doPick called before start");this.trace("Pick called");let s=this.metadata.clone(),n=this.channel.doPick(s,this.callConfig.pickInformation),i=n.subchannel?"("+n.subchannel.getChannelzRef().id+") "+n.subchannel.getAddress():""+n.subchannel;switch(this.trace("Pick result: "+by.PickResultType[n.pickResultType]+" subchannel: "+i+" status: "+((e=n.status)===null||e===void 0?void 0:e.code)+" "+((r=n.status)===null||r===void 0?void 0:r.details)),n.pickResultType){case by.PickResultType.COMPLETE:this.credentials.generateMetadata({service_url:this.serviceUrl}).then(l=>{var u,c,d;if(this.ended){this.trace("Credentials metadata generation finished after call ended");return}if(s.merge(l),s.get("authorization").length>1&&this.outputStatus({code:fw.Status.INTERNAL,details:'"authorization" metadata cannot have multiple values',metadata:new hw.Metadata},"PROCESSED"),n.subchannel.getConnectivityState()!==XX.ConnectivityState.READY){this.trace("Picked subchannel "+i+" has state "+XX.ConnectivityState[n.subchannel.getConnectivityState()]+" after getting credentials metadata. Retrying pick"),this.doPick();return}this.deadline!==1/0&&s.set("grpc-timeout",(0,eee.getDeadlineTimeoutString)(this.deadline));try{this.child=n.subchannel.getRealSubchannel().createCall(s,this.host,this.methodName,{onReceiveMetadata:f=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(f)},onReceiveMessage:f=>{this.trace("Received message"),this.listener.onReceiveMessage(f)},onReceiveStatus:f=>{this.trace("Received status"),f.rstCode===b3e.constants.NGHTTP2_REFUSED_STREAM?this.outputStatus(f,"REFUSED"):this.outputStatus(f,"PROCESSED")}}),this.childStartTime=new Date}catch(f){this.trace("Failed to start call on picked subchannel "+i+" with error "+f.message),this.outputStatus({code:fw.Status.INTERNAL,details:"Failed to start HTTP/2 stream with error "+f.message,metadata:new hw.Metadata},"NOT_STARTED");return}(c=(u=this.callConfig).onCommitted)===null||c===void 0||c.call(u),(d=n.onCallStarted)===null||d===void 0||d.call(n),this.onCallEnded=n.onCallEnded,this.trace("Created child call ["+this.child.getCallNumber()+"]"),this.readPending&&this.child.startRead(),this.pendingMessage&&this.child.sendMessageWithContext(this.pendingMessage.context,this.pendingMessage.message),this.pendingHalfClose&&this.child.halfClose()},l=>{let{code:u,details:c}=(0,jM.restrictControlPlaneStatusCode)(typeof l.code=="number"?l.code:fw.Status.UNKNOWN,`Getting metadata from plugin failed with error: ${l.message}`);this.outputStatus({code:u,details:c,metadata:new hw.Metadata},"PROCESSED")});break;case by.PickResultType.DROP:let{code:o,details:a}=(0,jM.restrictControlPlaneStatusCode)(n.status.code,n.status.details);setImmediate(()=>{this.outputStatus({code:o,details:a,metadata:n.status.metadata},"DROP")});break;case by.PickResultType.TRANSIENT_FAILURE:if(this.metadata.getOptions().waitForReady)this.channel.queueCallForPick(this);else{let{code:l,details:u}=(0,jM.restrictControlPlaneStatusCode)(n.status.code,n.status.details);setImmediate(()=>{this.outputStatus({code:l,details:u,metadata:n.status.metadata},"PROCESSED")})}break;case by.PickResultType.QUEUE:this.channel.queueCallForPick(this)}}cancelWithStatus(e,r){var s;this.trace("cancelWithStatus code: "+e+' details: "'+r+'"'),(s=this.child)===null||s===void 0||s.cancelWithStatus(e,r),this.outputStatus({code:e,details:r,metadata:new hw.Metadata},"PROCESSED")}getPeer(){var e,r;return(r=(e=this.child)===null||e===void 0?void 0:e.getPeer())!==null&&r!==void 0?r:this.channel.getTarget()}start(e,r){this.trace("start called"),this.listener=r,this.metadata=e,this.doPick()}sendMessageWithContext(e,r){this.trace("write() called with message of length "+r.length),this.child?this.child.sendMessageWithContext(e,r):this.pendingMessage={context:e,message:r}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(e){throw new Error("Method not implemented.")}getCallNumber(){return this.callNumber}};pw.LoadBalancingCall=FM});var see=m(mw=>{"use strict";Object.defineProperty(mw,"__esModule",{value:!0});mw.ResolvingCall=void 0;var Vc=ft(),Hc=Sy(),ree=As(),w3e=er(),T3e=dw(),C3e="resolving_call",BM=class{constructor(e,r,s,n,i,o){this.channel=e,this.method=r,this.filterStackFactory=n,this.credentials=i,this.callNumber=o,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.readFilterPending=!1,this.writeFilterPending=!1,this.pendingChildStatus=null,this.metadata=null,this.listener=null,this.statusWatchers=[],this.deadlineTimer=setTimeout(()=>{},0),this.filterStack=null,this.deadlineStartTime=null,this.configReceivedTime=null,this.childStartTime=null,this.deadline=s.deadline,this.host=s.host,s.parentCall&&(s.flags&Vc.Propagate.CANCELLATION&&s.parentCall.on("cancelled",()=>{this.cancelWithStatus(Vc.Status.CANCELLED,"Cancelled by parent call")}),s.flags&Vc.Propagate.DEADLINE&&(this.trace("Propagating deadline from parent: "+s.parentCall.getDeadline()),this.deadline=(0,Hc.minDeadline)(this.deadline,s.parentCall.getDeadline()))),this.trace("Created"),this.runDeadlineTimer()}trace(e){w3e.trace(Vc.LogVerbosity.DEBUG,C3e,"["+this.callNumber+"] "+e)}runDeadlineTimer(){clearTimeout(this.deadlineTimer),this.deadlineStartTime=new Date,this.trace("Deadline: "+(0,Hc.deadlineToString)(this.deadline));let e=(0,Hc.getRelativeTimeout)(this.deadline);if(e!==1/0){this.trace("Deadline will be reached in "+e+"ms");let r=()=>{if(!this.deadlineStartTime){this.cancelWithStatus(Vc.Status.DEADLINE_EXCEEDED,"Deadline exceeded");return}let s=[],n=new Date;s.push(`Deadline exceeded after ${(0,Hc.formatDateDifference)(this.deadlineStartTime,n)}`),this.configReceivedTime?(this.configReceivedTime>this.deadlineStartTime&&s.push(`name resolution: ${(0,Hc.formatDateDifference)(this.deadlineStartTime,this.configReceivedTime)}`),this.childStartTime?this.childStartTime>this.configReceivedTime&&s.push(`metadata filters: ${(0,Hc.formatDateDifference)(this.configReceivedTime,this.childStartTime)}`):s.push("waiting for metadata filters")):s.push("waiting for name resolution"),this.child&&s.push(...this.child.getDeadlineInfo()),this.cancelWithStatus(Vc.Status.DEADLINE_EXCEEDED,s.join(","))};e<=0?process.nextTick(r):this.deadlineTimer=setTimeout(r,e)}}outputStatus(e){if(!this.ended){this.ended=!0,this.filterStack||(this.filterStack=this.filterStackFactory.createFilter()),clearTimeout(this.deadlineTimer);let r=this.filterStack.receiveTrailers(e);this.trace("ended with status: code="+r.code+' details="'+r.details+'"'),this.statusWatchers.forEach(s=>s(r)),process.nextTick(()=>{var s;(s=this.listener)===null||s===void 0||s.onReceiveStatus(r)})}}sendMessageOnChild(e,r){if(!this.child)throw new Error("sendMessageonChild called with child not populated");let s=this.child;this.writeFilterPending=!0,this.filterStack.sendMessage(Promise.resolve({message:r,flags:e.flags})).then(n=>{this.writeFilterPending=!1,s.sendMessageWithContext(e,n.message),this.pendingHalfClose&&s.halfClose()},n=>{this.cancelWithStatus(n.code,n.details)})}getConfig(){if(this.ended)return;if(!this.metadata||!this.listener)throw new Error("getConfig called before start");let e=this.channel.getConfig(this.method,this.metadata);if(e.type==="NONE"){this.channel.queueCallForConfig(this);return}else if(e.type==="ERROR"){this.metadata.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(e.error);return}this.configReceivedTime=new Date;let r=e.config;if(r.status!==Vc.Status.OK){let{code:s,details:n}=(0,T3e.restrictControlPlaneStatusCode)(r.status,"Failed to route call to method "+this.method);this.outputStatus({code:s,details:n,metadata:new ree.Metadata});return}if(r.methodConfig.timeout){let s=new Date;s.setSeconds(s.getSeconds()+r.methodConfig.timeout.seconds),s.setMilliseconds(s.getMilliseconds()+r.methodConfig.timeout.nanos/1e6),this.deadline=(0,Hc.minDeadline)(this.deadline,s),this.runDeadlineTimer()}this.filterStackFactory.push(r.dynamicFilterFactories),this.filterStack=this.filterStackFactory.createFilter(),this.filterStack.sendMetadata(Promise.resolve(this.metadata)).then(s=>{this.child=this.channel.createInnerCall(r,this.method,this.host,this.credentials,this.deadline),this.trace("Created child ["+this.child.getCallNumber()+"]"),this.childStartTime=new Date,this.child.start(s,{onReceiveMetadata:n=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(this.filterStack.receiveMetadata(n))},onReceiveMessage:n=>{this.trace("Received message"),this.readFilterPending=!0,this.filterStack.receiveMessage(n).then(i=>{this.trace("Finished filtering received message"),this.readFilterPending=!1,this.listener.onReceiveMessage(i),this.pendingChildStatus&&this.outputStatus(this.pendingChildStatus)},i=>{this.cancelWithStatus(i.code,i.details)})},onReceiveStatus:n=>{this.trace("Received status"),this.readFilterPending?this.pendingChildStatus=n:this.outputStatus(n)}}),this.readPending&&this.child.startRead(),this.pendingMessage?this.sendMessageOnChild(this.pendingMessage.context,this.pendingMessage.message):this.pendingHalfClose&&this.child.halfClose()},s=>{this.outputStatus(s)})}reportResolverError(e){var r;!((r=this.metadata)===null||r===void 0)&&r.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(e)}cancelWithStatus(e,r){var s;this.trace("cancelWithStatus code: "+e+' details: "'+r+'"'),(s=this.child)===null||s===void 0||s.cancelWithStatus(e,r),this.outputStatus({code:e,details:r,metadata:new ree.Metadata})}getPeer(){var e,r;return(r=(e=this.child)===null||e===void 0?void 0:e.getPeer())!==null&&r!==void 0?r:this.channel.getTarget()}start(e,r){this.trace("start called"),this.metadata=e.clone(),this.listener=r,this.getConfig()}sendMessageWithContext(e,r){this.trace("write() called with message of length "+r.length),this.child?this.sendMessageOnChild(e,r):this.pendingMessage={context:e,message:r}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child&&!this.writeFilterPending?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(e){this.credentials=this.credentials.compose(e)}addStatusWatcher(e){this.statusWatchers.push(e)}getCallNumber(){return this.callNumber}};mw.ResolvingCall=BM});var nee=m(ou=>{"use strict";Object.defineProperty(ou,"__esModule",{value:!0});ou.RetryingCall=ou.MessageBufferTracker=ou.RetryThrottler=void 0;var gw=ft(),R3e=Sy(),O3e=As(),P3e=er(),A3e="retrying_call",UM=class{constructor(e,r,s){this.maxTokens=e,this.tokenRatio=r,s?this.tokens=s.tokens*(e/s.maxTokens):this.tokens=e}addCallSucceeded(){this.tokens=Math.max(this.tokens+this.tokenRatio,this.maxTokens)}addCallFailed(){this.tokens=Math.min(this.tokens-1,0)}canRetryCall(){return this.tokens>this.maxTokens/2}};ou.RetryThrottler=UM;var VM=class{constructor(e,r){this.totalLimit=e,this.limitPerCall=r,this.totalAllocated=0,this.allocatedPerCall=new Map}allocate(e,r){var s;let n=(s=this.allocatedPerCall.get(r))!==null&&s!==void 0?s:0;return this.limitPerCall-n<e||this.totalLimit-this.totalAllocated<e?!1:(this.allocatedPerCall.set(r,n+e),this.totalAllocated+=e,!0)}free(e,r){var s;if(this.totalAllocated<e)throw new Error(`Invalid buffer allocation state: call ${r} freed ${e} > total allocated ${this.totalAllocated}`);this.totalAllocated-=e;let n=(s=this.allocatedPerCall.get(r))!==null&&s!==void 0?s:0;if(n<e)throw new Error(`Invalid buffer allocation state: call ${r} freed ${e} > allocated for call ${n}`);this.allocatedPerCall.set(r,n-e)}freeAll(e){var r;let s=(r=this.allocatedPerCall.get(e))!==null&&r!==void 0?r:0;if(this.totalAllocated<s)throw new Error(`Invalid buffer allocation state: call ${e} allocated ${s} > total allocated ${this.totalAllocated}`);this.totalAllocated-=s,this.allocatedPerCall.delete(e)}};ou.MessageBufferTracker=VM;var zM="grpc-previous-rpc-attempts",HM=class{constructor(e,r,s,n,i,o,a,l,u){if(this.channel=e,this.callConfig=r,this.methodName=s,this.host=n,this.credentials=i,this.deadline=o,this.callNumber=a,this.bufferTracker=l,this.retryThrottler=u,this.listener=null,this.initialMetadata=null,this.underlyingCalls=[],this.writeBuffer=[],this.writeBufferOffset=0,this.readStarted=!1,this.transparentRetryUsed=!1,this.attempts=0,this.hedgingTimer=null,this.committedCallIndex=null,this.initialRetryBackoffSec=0,this.nextRetryBackoffSec=0,r.methodConfig.retryPolicy){this.state="RETRY";let c=r.methodConfig.retryPolicy;this.nextRetryBackoffSec=this.initialRetryBackoffSec=Number(c.initialBackoff.substring(0,c.initialBackoff.length-1))}else r.methodConfig.hedgingPolicy?this.state="HEDGING":this.state="TRANSPARENT_ONLY";this.startTime=new Date}getDeadlineInfo(){if(this.underlyingCalls.length===0)return[];let e=[],r=this.underlyingCalls[this.underlyingCalls.length-1];return this.underlyingCalls.length>1&&e.push(`previous attempts: ${this.underlyingCalls.length-1}`),r.startTime>this.startTime&&e.push(`time to current attempt start: ${(0,R3e.formatDateDifference)(this.startTime,r.startTime)}`),e.push(...r.call.getDeadlineInfo()),e}getCallNumber(){return this.callNumber}trace(e){P3e.trace(gw.LogVerbosity.DEBUG,A3e,"["+this.callNumber+"] "+e)}reportStatus(e){this.trace("ended with status: code="+e.code+' details="'+e.details+'" start time='+this.startTime.toISOString()),this.bufferTracker.freeAll(this.callNumber),this.writeBufferOffset=this.writeBufferOffset+this.writeBuffer.length,this.writeBuffer=[],process.nextTick(()=>{var r;(r=this.listener)===null||r===void 0||r.onReceiveStatus({code:e.code,details:e.details,metadata:e.metadata})})}cancelWithStatus(e,r){this.trace("cancelWithStatus code: "+e+' details: "'+r+'"'),this.reportStatus({code:e,details:r,metadata:new O3e.Metadata});for(let{call:s}of this.underlyingCalls)s.cancelWithStatus(e,r)}getPeer(){return this.committedCallIndex!==null?this.underlyingCalls[this.committedCallIndex].call.getPeer():"unknown"}getBufferEntry(e){var r;return(r=this.writeBuffer[e-this.writeBufferOffset])!==null&&r!==void 0?r:{entryType:"FREED",allocated:!1}}getNextBufferIndex(){return this.writeBufferOffset+this.writeBuffer.length}clearSentMessages(){if(this.state!=="COMMITTED")return;let e=this.underlyingCalls[this.committedCallIndex].nextMessageToSend;for(let r=this.writeBufferOffset;r<e;r++){let s=this.getBufferEntry(r);s.allocated&&this.bufferTracker.free(s.message.message.length,this.callNumber)}this.writeBuffer=this.writeBuffer.slice(e-this.writeBufferOffset),this.writeBufferOffset=e}commitCall(e){if(this.state!=="COMMITTED"&&this.underlyingCalls[e].state!=="COMPLETED"){this.trace("Committing call ["+this.underlyingCalls[e].call.getCallNumber()+"] at index "+e),this.state="COMMITTED",this.committedCallIndex=e;for(let r=0;r<this.underlyingCalls.length;r++)r!==e&&this.underlyingCalls[r].state!=="COMPLETED"&&(this.underlyingCalls[r].state="COMPLETED",this.underlyingCalls[r].call.cancelWithStatus(gw.Status.CANCELLED,"Discarded in favor of other hedged attempt"));this.clearSentMessages()}}commitCallWithMostMessages(){if(this.state==="COMMITTED")return;let e=-1,r=-1;for(let[s,n]of this.underlyingCalls.entries())n.state==="ACTIVE"&&n.nextMessageToSend>e&&(e=n.nextMessageToSend,r=s);r===-1?this.state="TRANSPARENT_ONLY":this.commitCall(r)}isStatusCodeInList(e,r){return e.some(s=>s===r||s.toString().toLowerCase()===gw.Status[r].toLowerCase())}getNextRetryBackoffMs(){var e;let r=(e=this.callConfig)===null||e===void 0?void 0:e.methodConfig.retryPolicy;if(!r)return 0;let s=Math.random()*this.nextRetryBackoffSec*1e3,n=Number(r.maxBackoff.substring(0,r.maxBackoff.length-1));return this.nextRetryBackoffSec=Math.min(this.nextRetryBackoffSec*r.backoffMultiplier,n),s}maybeRetryCall(e,r){if(this.state!=="RETRY"){r(!1);return}let s=this.callConfig.methodConfig.retryPolicy;if(this.attempts>=Math.min(s.maxAttempts,5)){r(!1);return}let n;if(e===null)n=this.getNextRetryBackoffMs();else if(e<0){this.state="TRANSPARENT_ONLY",r(!1);return}else n=e,this.nextRetryBackoffSec=this.initialRetryBackoffSec;setTimeout(()=>{var i,o;if(this.state!=="RETRY"){r(!1);return}(!((o=(i=this.retryThrottler)===null||i===void 0?void 0:i.canRetryCall())!==null&&o!==void 0)||o)&&(r(!0),this.attempts+=1,this.startNewAttempt())},n)}countActiveCalls(){let e=0;for(let r of this.underlyingCalls)r?.state==="ACTIVE"&&(e+=1);return e}handleProcessedStatus(e,r,s){var n,i,o;switch(this.state){case"COMMITTED":case"TRANSPARENT_ONLY":this.commitCall(r),this.reportStatus(e);break;case"HEDGING":if(this.isStatusCodeInList((n=this.callConfig.methodConfig.hedgingPolicy.nonFatalStatusCodes)!==null&&n!==void 0?n:[],e.code)){(i=this.retryThrottler)===null||i===void 0||i.addCallFailed();let a;if(s===null)a=0;else if(s<0){this.state="TRANSPARENT_ONLY",this.commitCall(r),this.reportStatus(e);return}else a=s;setTimeout(()=>{this.maybeStartHedgingAttempt(),this.countActiveCalls()===0&&(this.commitCall(r),this.reportStatus(e))},a)}else this.commitCall(r),this.reportStatus(e);break;case"RETRY":this.isStatusCodeInList(this.callConfig.methodConfig.retryPolicy.retryableStatusCodes,e.code)?((o=this.retryThrottler)===null||o===void 0||o.addCallFailed(),this.maybeRetryCall(s,a=>{a||(this.commitCall(r),this.reportStatus(e))})):(this.commitCall(r),this.reportStatus(e));break}}getPushback(e){let r=e.get("grpc-retry-pushback-ms");if(r.length===0)return null;try{return parseInt(r[0])}catch{return-1}}handleChildStatus(e,r){var s;if(this.underlyingCalls[r].state==="COMPLETED")return;if(this.trace("state="+this.state+" handling status with progress "+e.progress+" from child ["+this.underlyingCalls[r].call.getCallNumber()+"] in state "+this.underlyingCalls[r].state),this.underlyingCalls[r].state="COMPLETED",e.code===gw.Status.OK){(s=this.retryThrottler)===null||s===void 0||s.addCallSucceeded(),this.commitCall(r),this.reportStatus(e);return}if(this.state==="COMMITTED"){this.reportStatus(e);return}let n=this.getPushback(e.metadata);switch(e.progress){case"NOT_STARTED":this.startNewAttempt();break;case"REFUSED":this.transparentRetryUsed?this.handleProcessedStatus(e,r,n):(this.transparentRetryUsed=!0,this.startNewAttempt());break;case"DROP":this.commitCall(r),this.reportStatus(e);break;case"PROCESSED":this.handleProcessedStatus(e,r,n);break}}maybeStartHedgingAttempt(){if(this.state!=="HEDGING"||!this.callConfig.methodConfig.hedgingPolicy)return;let e=this.callConfig.methodConfig.hedgingPolicy;this.attempts>=Math.min(e.maxAttempts,5)||(this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer())}maybeStartHedgingTimer(){var e,r,s;if(this.hedgingTimer&&clearTimeout(this.hedgingTimer),this.state!=="HEDGING"||!this.callConfig.methodConfig.hedgingPolicy)return;let n=this.callConfig.methodConfig.hedgingPolicy;if(this.attempts>=Math.min(n.maxAttempts,5))return;let i=(e=n.hedgingDelay)!==null&&e!==void 0?e:"0s",o=Number(i.substring(0,i.length-1));this.hedgingTimer=setTimeout(()=>{this.maybeStartHedgingAttempt()},o*1e3),(s=(r=this.hedgingTimer).unref)===null||s===void 0||s.call(r)}startNewAttempt(){let e=this.channel.createLoadBalancingCall(this.callConfig,this.methodName,this.host,this.credentials,this.deadline);this.trace("Created child call ["+e.getCallNumber()+"] for attempt "+this.attempts);let r=this.underlyingCalls.length;this.underlyingCalls.push({state:"ACTIVE",call:e,nextMessageToSend:0,startTime:new Date});let s=this.attempts-1,n=this.initialMetadata.clone();s>0&&n.set(zM,`${s}`);let i=!1;e.start(n,{onReceiveMetadata:o=>{this.trace("Received metadata from child ["+e.getCallNumber()+"]"),this.commitCall(r),i=!0,s>0&&o.set(zM,`${s}`),this.underlyingCalls[r].state==="ACTIVE"&&this.listener.onReceiveMetadata(o)},onReceiveMessage:o=>{this.trace("Received message from child ["+e.getCallNumber()+"]"),this.commitCall(r),this.underlyingCalls[r].state==="ACTIVE"&&this.listener.onReceiveMessage(o)},onReceiveStatus:o=>{this.trace("Received status from child ["+e.getCallNumber()+"]"),!i&&s>0&&o.metadata.set(zM,`${s}`),this.handleChildStatus(o,r)}}),this.sendNextChildMessage(r),this.readStarted&&e.startRead()}start(e,r){this.trace("start called"),this.listener=r,this.initialMetadata=e,this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer()}handleChildWriteCompleted(e){var r,s;let n=this.underlyingCalls[e],i=n.nextMessageToSend;(s=(r=this.getBufferEntry(i)).callback)===null||s===void 0||s.call(r),this.clearSentMessages(),n.nextMessageToSend+=1,this.sendNextChildMessage(e)}sendNextChildMessage(e){let r=this.underlyingCalls[e];if(r.state!=="COMPLETED"&&this.getBufferEntry(r.nextMessageToSend)){let s=this.getBufferEntry(r.nextMessageToSend);switch(s.entryType){case"MESSAGE":r.call.sendMessageWithContext({callback:n=>{this.handleChildWriteCompleted(e)}},s.message.message);break;case"HALF_CLOSE":r.nextMessageToSend+=1,r.call.halfClose();break;case"FREED":break}}}sendMessageWithContext(e,r){var s;this.trace("write() called with message of length "+r.length);let n={message:r,flags:e.flags},i=this.getNextBufferIndex(),o={entryType:"MESSAGE",message:n,allocated:this.bufferTracker.allocate(r.length,this.callNumber)};if(this.writeBuffer.push(o),o.allocated){(s=e.callback)===null||s===void 0||s.call(e);for(let[a,l]of this.underlyingCalls.entries())l.state==="ACTIVE"&&l.nextMessageToSend===i&&l.call.sendMessageWithContext({callback:u=>{this.handleChildWriteCompleted(a)}},r)}else{if(this.commitCallWithMostMessages(),this.committedCallIndex===null)return;let a=this.underlyingCalls[this.committedCallIndex];o.callback=e.callback,a.state==="ACTIVE"&&a.nextMessageToSend===i&&a.call.sendMessageWithContext({callback:l=>{this.handleChildWriteCompleted(this.committedCallIndex)}},r)}}startRead(){this.trace("startRead called"),this.readStarted=!0;for(let e of this.underlyingCalls)e?.state==="ACTIVE"&&e.call.startRead()}halfClose(){this.trace("halfClose called");let e=this.getNextBufferIndex();this.writeBuffer.push({entryType:"HALF_CLOSE",allocated:!1});for(let r of this.underlyingCalls)r?.state==="ACTIVE"&&r.nextMessageToSend===e&&(r.nextMessageToSend+=1,r.call.halfClose())}setCredentials(e){throw new Error("Method not implemented.")}getMethod(){return this.methodName}getHost(){return this.host}};ou.RetryingCall=HM});var vw=m(yw=>{"use strict";Object.defineProperty(yw,"__esModule",{value:!0});yw.BaseSubchannelWrapper=void 0;var GM=class{constructor(e){this.child=e,this.healthy=!0,this.healthListeners=new Set,e.addHealthStateWatcher(r=>{this.healthy&&this.updateHealthListeners()})}updateHealthListeners(){for(let e of this.healthListeners)e(this.isHealthy())}getConnectivityState(){return this.child.getConnectivityState()}addConnectivityStateListener(e){this.child.addConnectivityStateListener(e)}removeConnectivityStateListener(e){this.child.removeConnectivityStateListener(e)}startConnecting(){this.child.startConnecting()}getAddress(){return this.child.getAddress()}throttleKeepalive(e){this.child.throttleKeepalive(e)}ref(){this.child.ref()}unref(){this.child.unref()}getChannelzRef(){return this.child.getChannelzRef()}isHealthy(){return this.healthy&&this.child.isHealthy()}addHealthStateWatcher(e){this.healthListeners.add(e)}removeHealthStateWatcher(e){this.healthListeners.delete(e)}setHealthy(e){e!==this.healthy&&(this.healthy=e,this.child.isHealthy()&&this.updateHealthListeners())}getRealSubchannel(){return this.child.getRealSubchannel()}realSubchannelEquals(e){return this.getRealSubchannel()===e.getRealSubchannel()}};yw.BaseSubchannelWrapper=GM});var aee=m(bw=>{"use strict";Object.defineProperty(bw,"__esModule",{value:!0});bw.InternalChannel=void 0;var k3e=tE(),x3e=C7(),I3e=QX(),iee=Hl(),Ey=ft(),N3e=xM(),D3e=JX(),oee=Eo(),KM=er(),M3e=EM(),_w=hn(),$o=Qn(),wy=zc(),$3e=tee(),q3e=Sy(),L3e=see(),QM=RM(),j3e=dw(),WM=nee(),F3e=vw(),B3e=2147483647,z3e=1e3,U3e=30*60*1e3,Sw=new Map,V3e=1<<24,H3e=1<<20,ZM=class extends F3e.BaseSubchannelWrapper{constructor(e,r){super(e),this.channel=r,this.refCount=0,this.subchannelStateListener=(s,n,i,o)=>{r.throttleKeepalive(o)},e.addConnectivityStateListener(this.subchannelStateListener)}ref(){this.child.ref(),this.refCount+=1}unref(){this.child.unref(),this.refCount-=1,this.refCount<=0&&(this.child.removeConnectivityStateListener(this.subchannelStateListener),this.channel.removeWrappedSubchannel(this))}},YM=class{constructor(e,r,s){var n,i,o,a,l,u,c,d;if(this.credentials=r,this.options=s,this.connectivityState=$o.ConnectivityState.IDLE,this.currentPicker=new iee.UnavailablePicker,this.configSelectionQueue=[],this.pickQueue=[],this.connectivityStateWatchers=[],this.configSelector=null,this.currentResolutionError=null,this.wrappedSubchannels=new Set,this.callCount=0,this.idleTimer=null,this.channelzEnabled=!0,this.callTracker=new wy.ChannelzCallTracker,this.childrenTracker=new wy.ChannelzChildrenTracker,this.randomChannelId=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER),typeof e!="string")throw new TypeError("Channel target must be a string");if(!(r instanceof k3e.ChannelCredentials))throw new TypeError("Channel credentials must be a ChannelCredentials object");if(s&&typeof s!="object")throw new TypeError("Channel options must be an object");this.originalTarget=e;let f=(0,_w.parseUri)(e);if(f===null)throw new Error(`Could not parse target name "${e}"`);let h=(0,oee.mapUriDefaultScheme)(f);if(h===null)throw new Error(`Could not find a default scheme for target name "${e}"`);this.callRefTimer=setInterval(()=>{},B3e),(i=(n=this.callRefTimer).unref)===null||i===void 0||i.call(n),this.options["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzTrace=new wy.ChannelzTrace,this.channelzRef=(0,wy.registerChannelzChannel)(e,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Channel created"),this.options["grpc.default_authority"]?this.defaultAuthority=this.options["grpc.default_authority"]:this.defaultAuthority=(0,oee.getDefaultAuthority)(h);let p=(0,M3e.mapProxyName)(h,s);this.target=p.target,this.options=Object.assign({},this.options,p.extraOptions),this.subchannelPool=(0,I3e.getSubchannelPool)(((o=s["grpc.use_local_subchannel_pool"])!==null&&o!==void 0?o:0)===0),this.retryBufferTracker=new WM.MessageBufferTracker((a=s["grpc.retry_buffer_size"])!==null&&a!==void 0?a:V3e,(l=s["grpc.per_rpc_retry_buffer_size"])!==null&&l!==void 0?l:H3e),this.keepaliveTime=(u=s["grpc.keepalive_time_ms"])!==null&&u!==void 0?u:-1,this.idleTimeoutMs=Math.max((c=s["grpc.client_idle_timeout_ms"])!==null&&c!==void 0?c:U3e,z3e);let g={createSubchannel:(S,b)=>{let v=this.subchannelPool.getOrCreateSubchannel(this.target,S,Object.assign({},this.options,b),this.credentials);v.throttleKeepalive(this.keepaliveTime),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Created subchannel or used existing subchannel",v.getChannelzRef());let y=new ZM(v,this);return this.wrappedSubchannels.add(y),y},updateState:(S,b)=>{this.currentPicker=b;let v=this.pickQueue.slice();this.pickQueue=[],v.length>0&&this.callRefTimerUnref();for(let y of v)y.doPick();this.updateState(S)},requestReresolution:()=>{throw new Error("Resolving load balancer should never call requestReresolution")},addChannelzChild:S=>{this.channelzEnabled&&this.childrenTracker.refChild(S)},removeChannelzChild:S=>{this.channelzEnabled&&this.childrenTracker.unrefChild(S)}};this.resolvingLoadBalancer=new x3e.ResolvingLoadBalancer(this.target,g,s,(S,b)=>{S.retryThrottling?Sw.set(this.getTarget(),new WM.RetryThrottler(S.retryThrottling.maxTokens,S.retryThrottling.tokenRatio,Sw.get(this.getTarget()))):Sw.delete(this.getTarget()),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Address resolution succeeded"),this.configSelector=b,this.currentResolutionError=null,process.nextTick(()=>{let v=this.configSelectionQueue;this.configSelectionQueue=[],v.length>0&&this.callRefTimerUnref();for(let y of v)y.getConfig()})},S=>{this.channelzEnabled&&this.channelzTrace.addTrace("CT_WARNING","Address resolution failed with code "+S.code+' and details "'+S.details+'"'),this.configSelectionQueue.length>0&&this.trace("Name resolution failed with calls queued for config selection"),this.configSelector===null&&(this.currentResolutionError=Object.assign(Object.assign({},(0,j3e.restrictControlPlaneStatusCode)(S.code,S.details)),{metadata:S.metadata}));let b=this.configSelectionQueue;this.configSelectionQueue=[],b.length>0&&this.callRefTimerUnref();for(let v of b)v.reportResolverError(S)}),this.filterStackFactory=new N3e.FilterStackFactory([new D3e.CompressionFilterFactory(this,this.options)]),this.trace("Channel constructed with options "+JSON.stringify(s,void 0,2));let _=new Error;(0,KM.trace)(Ey.LogVerbosity.DEBUG,"channel_stacktrace","("+this.channelzRef.id+`) Channel constructed 
`+((d=_.stack)===null||d===void 0?void 0:d.substring(_.stack.indexOf(`
`)+1))),this.lastActivityTimestamp=new Date}getChannelzInfo(){return{target:this.originalTarget,state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists()}}trace(e,r){(0,KM.trace)(r??Ey.LogVerbosity.DEBUG,"channel","("+this.channelzRef.id+") "+(0,_w.uriToString)(this.target)+" "+e)}callRefTimerRef(){var e,r,s,n;!((r=(e=this.callRefTimer).hasRef)===null||r===void 0)&&r.call(e)||(this.trace("callRefTimer.ref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),(n=(s=this.callRefTimer).ref)===null||n===void 0||n.call(s))}callRefTimerUnref(){var e,r;(!this.callRefTimer.hasRef||this.callRefTimer.hasRef())&&(this.trace("callRefTimer.unref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),(r=(e=this.callRefTimer).unref)===null||r===void 0||r.call(e))}removeConnectivityStateWatcher(e){let r=this.connectivityStateWatchers.findIndex(s=>s===e);r>=0&&this.connectivityStateWatchers.splice(r,1)}updateState(e){(0,KM.trace)(Ey.LogVerbosity.DEBUG,"connectivity_state","("+this.channelzRef.id+") "+(0,_w.uriToString)(this.target)+" "+$o.ConnectivityState[this.connectivityState]+" -> "+$o.ConnectivityState[e]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+$o.ConnectivityState[e]),this.connectivityState=e;let r=this.connectivityStateWatchers.slice();for(let s of r)e!==s.currentState&&(s.timer&&clearTimeout(s.timer),this.removeConnectivityStateWatcher(s),s.callback());e!==$o.ConnectivityState.TRANSIENT_FAILURE&&(this.currentResolutionError=null)}throttleKeepalive(e){if(e>this.keepaliveTime){this.keepaliveTime=e;for(let r of this.wrappedSubchannels)r.throttleKeepalive(e)}}removeWrappedSubchannel(e){this.wrappedSubchannels.delete(e)}doPick(e,r){return this.currentPicker.pick({metadata:e,extraPickInfo:r})}queueCallForPick(e){this.pickQueue.push(e),this.callRefTimerRef()}getConfig(e,r){return this.resolvingLoadBalancer.exitIdle(),this.configSelector?{type:"SUCCESS",config:this.configSelector(e,r,this.randomChannelId)}:this.currentResolutionError?{type:"ERROR",error:this.currentResolutionError}:{type:"NONE"}}queueCallForConfig(e){this.configSelectionQueue.push(e),this.callRefTimerRef()}enterIdle(){this.resolvingLoadBalancer.destroy(),this.updateState($o.ConnectivityState.IDLE),this.currentPicker=new iee.QueuePicker(this.resolvingLoadBalancer),this.idleTimer&&(clearTimeout(this.idleTimer),this.idleTimer=null)}startIdleTimeout(e){var r,s;this.idleTimer=setTimeout(()=>{if(this.callCount>0){this.startIdleTimeout(this.idleTimeoutMs);return}let i=new Date().valueOf()-this.lastActivityTimestamp.valueOf();i>=this.idleTimeoutMs?(this.trace("Idle timer triggered after "+this.idleTimeoutMs+"ms of inactivity"),this.enterIdle()):this.startIdleTimeout(this.idleTimeoutMs-i)},e),(s=(r=this.idleTimer).unref)===null||s===void 0||s.call(r)}maybeStartIdleTimer(){this.connectivityState!==$o.ConnectivityState.SHUTDOWN&&!this.idleTimer&&this.startIdleTimeout(this.idleTimeoutMs)}onCallStart(){this.channelzEnabled&&this.callTracker.addCallStarted(),this.callCount+=1}onCallEnd(e){this.channelzEnabled&&(e.code===Ey.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()),this.callCount-=1,this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()}createLoadBalancingCall(e,r,s,n,i){let o=(0,QM.getNextCallNumber)();return this.trace("createLoadBalancingCall ["+o+'] method="'+r+'"'),new $3e.LoadBalancingCall(this,e,r,s,n,i,o)}createRetryingCall(e,r,s,n,i){let o=(0,QM.getNextCallNumber)();return this.trace("createRetryingCall ["+o+'] method="'+r+'"'),new WM.RetryingCall(this,e,r,s,n,i,o,this.retryBufferTracker,Sw.get(this.getTarget()))}createInnerCall(e,r,s,n,i){return this.options["grpc.enable_retries"]===0?this.createLoadBalancingCall(e,r,s,n,i):this.createRetryingCall(e,r,s,n,i)}createResolvingCall(e,r,s,n,i){let o=(0,QM.getNextCallNumber)();this.trace("createResolvingCall ["+o+'] method="'+e+'", deadline='+(0,q3e.deadlineToString)(r));let a={deadline:r,flags:i??Ey.Propagate.DEFAULTS,host:s??this.defaultAuthority,parentCall:n},l=new L3e.ResolvingCall(this,e,a,this.filterStackFactory.clone(),this.credentials._getCallCredentials(),o);return this.onCallStart(),l.addStatusWatcher(u=>{this.onCallEnd(u)}),l}close(){this.resolvingLoadBalancer.destroy(),this.updateState($o.ConnectivityState.SHUTDOWN),clearInterval(this.callRefTimer),this.idleTimer&&clearTimeout(this.idleTimer),this.channelzEnabled&&(0,wy.unregisterChannelzRef)(this.channelzRef),this.subchannelPool.unrefUnusedSubchannels()}getTarget(){return(0,_w.uriToString)(this.target)}getConnectivityState(e){let r=this.connectivityState;return e&&(this.resolvingLoadBalancer.exitIdle(),this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()),r}watchConnectivityState(e,r,s){if(this.connectivityState===$o.ConnectivityState.SHUTDOWN)throw new Error("Channel has been shut down");let n=null;if(r!==1/0){let o=r instanceof Date?r:new Date(r),a=new Date;if(r===-1/0||o<=a){process.nextTick(s,new Error("Deadline passed without connectivity state change"));return}n=setTimeout(()=>{this.removeConnectivityStateWatcher(i),s(new Error("Deadline passed without connectivity state change"))},o.getTime()-a.getTime())}let i={currentState:e,callback:s,timer:n};this.connectivityStateWatchers.push(i)}getChannelzRef(){return this.channelzRef}createCall(e,r,s,n,i){if(typeof e!="string")throw new TypeError("Channel#createCall: method must be a string");if(!(typeof r=="number"||r instanceof Date))throw new TypeError("Channel#createCall: deadline must be a number or Date");if(this.connectivityState===$o.ConnectivityState.SHUTDOWN)throw new Error("Channel has been shut down");return this.createResolvingCall(e,r,s,n,i)}};bw.InternalChannel=YM});var sD=m(Ew=>{"use strict";Object.defineProperty(Ew,"__esModule",{value:!0});Ew.ChannelImplementation=void 0;var G3e=tE(),K3e=aee(),JM=class{constructor(e,r,s){if(typeof e!="string")throw new TypeError("Channel target must be a string");if(!(r instanceof G3e.ChannelCredentials))throw new TypeError("Channel credentials must be a ChannelCredentials object");if(s&&typeof s!="object")throw new TypeError("Channel options must be an object");this.internalChannel=new K3e.InternalChannel(e,r,s)}close(){this.internalChannel.close()}getTarget(){return this.internalChannel.getTarget()}getConnectivityState(e){return this.internalChannel.getConnectivityState(e)}watchConnectivityState(e,r,s){this.internalChannel.watchConnectivityState(e,r,s)}getChannelzRef(){return this.internalChannel.getChannelzRef()}createCall(e,r,s,n,i){if(typeof e!="string")throw new TypeError("Channel#createCall: method must be a string");if(!(typeof r=="number"||r instanceof Date))throw new TypeError("Channel#createCall: deadline must be a number or Date");return this.internalChannel.createCall(e,r,s,n,i)}};Ew.ChannelImplementation=JM});var uee=m(ni=>{"use strict";Object.defineProperty(ni,"__esModule",{value:!0});ni.ServerDuplexStreamImpl=ni.ServerWritableStreamImpl=ni.ServerReadableStreamImpl=ni.ServerUnaryCallImpl=ni.serverErrorToStatus=void 0;var Q3e=require("events"),s$=require("stream"),n$=ft(),lee=As();function i$(t,e){var r;let s={code:n$.Status.UNKNOWN,details:"message"in t?t.message:"Unknown Error",metadata:(r=e??t.metadata)!==null&&r!==void 0?r:null};return"code"in t&&typeof t.code=="number"&&Number.isInteger(t.code)&&(s.code=t.code,"details"in t&&typeof t.details=="string"&&(s.details=t.details)),s}ni.serverErrorToStatus=i$;var XM=class extends Q3e.EventEmitter{constructor(e,r,s,n){super(),this.path=e,this.call=r,this.metadata=s,this.request=n,this.cancelled=!1}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.path}};ni.ServerUnaryCallImpl=XM;var e$=class extends s$.Readable{constructor(e,r,s){super({objectMode:!0}),this.path=e,this.call=r,this.metadata=s,this.cancelled=!1}_read(e){this.call.startRead()}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.path}};ni.ServerReadableStreamImpl=e$;var t$=class extends s$.Writable{constructor(e,r,s,n){super({objectMode:!0}),this.path=e,this.call=r,this.metadata=s,this.request=n,this.pendingStatus={code:n$.Status.OK,details:"OK"},this.cancelled=!1,this.trailingMetadata=new lee.Metadata,this.on("error",i=>{this.pendingStatus=i$(i),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.path}_write(e,r,s){this.call.sendMessage(e,s)}_final(e){var r;e(null),this.call.sendStatus(Object.assign(Object.assign({},this.pendingStatus),{metadata:(r=this.pendingStatus.metadata)!==null&&r!==void 0?r:this.trailingMetadata}))}end(e){return e&&(this.trailingMetadata=e),super.end()}};ni.ServerWritableStreamImpl=t$;var r$=class extends s$.Duplex{constructor(e,r,s){super({objectMode:!0}),this.path=e,this.call=r,this.metadata=s,this.pendingStatus={code:n$.Status.OK,details:"OK"},this.cancelled=!1,this.trailingMetadata=new lee.Metadata,this.on("error",n=>{this.pendingStatus=i$(n),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.path}_read(e){this.call.startRead()}_write(e,r,s){this.call.sendMessage(e,s)}_final(e){var r;e(null),this.call.sendStatus(Object.assign(Object.assign({},this.pendingStatus),{metadata:(r=this.pendingStatus.metadata)!==null&&r!==void 0?r:this.trailingMetadata}))}end(e){return e&&(this.trailingMetadata=e),super.end()}};ni.ServerDuplexStreamImpl=r$});var o$=m(ww=>{"use strict";Object.defineProperty(ww,"__esModule",{value:!0});ww.ServerCredentials=void 0;var cee=bN(),Ty=class{static createInsecure(){return new Cy}static createSsl(e,r,s=!1){var n;if(e!==null&&!Buffer.isBuffer(e))throw new TypeError("rootCerts must be null or a Buffer");if(!Array.isArray(r))throw new TypeError("keyCertPairs must be an array");if(typeof s!="boolean")throw new TypeError("checkClientCertificate must be a boolean");let i=[],o=[];for(let a=0;a<r.length;a++){let l=r[a];if(l===null||typeof l!="object")throw new TypeError(`keyCertPair[${a}] must be an object`);if(!Buffer.isBuffer(l.private_key))throw new TypeError(`keyCertPair[${a}].private_key must be a Buffer`);if(!Buffer.isBuffer(l.cert_chain))throw new TypeError(`keyCertPair[${a}].cert_chain must be a Buffer`);i.push(l.cert_chain),o.push(l.private_key)}return new Ry({ca:(n=e??(0,cee.getDefaultRootsData)())!==null&&n!==void 0?n:void 0,cert:i,key:o,requestCert:s,ciphers:cee.CIPHER_SUITES})}};ww.ServerCredentials=Ty;var Cy=class extends Ty{_isSecure(){return!1}_getSettings(){return null}_equals(e){return e instanceof Cy}},Ry=class extends Ty{constructor(e){super(),this.options=e}_isSecure(){return!0}_getSettings(){return this.options}_equals(e){if(this===e)return!0;if(!(e instanceof Ry))return!1;if(Buffer.isBuffer(this.options.ca)&&Buffer.isBuffer(e.options.ca)){if(!this.options.ca.equals(e.options.ca))return!1}else if(this.options.ca!==e.options.ca)return!1;if(Array.isArray(this.options.cert)&&Array.isArray(e.options.cert)){if(this.options.cert.length!==e.options.cert.length)return!1;for(let r=0;r<this.options.cert.length;r++){let s=this.options.cert[r],n=e.options.cert[r];if(Buffer.isBuffer(s)&&Buffer.isBuffer(n)){if(!s.equals(n))return!1}else if(s!==n)return!1}}else if(this.options.cert!==e.options.cert)return!1;if(Array.isArray(this.options.key)&&Array.isArray(e.options.key)){if(this.options.key.length!==e.options.key.length)return!1;for(let r=0;r<this.options.key.length;r++){let s=this.options.key[r],n=e.options.key[r];if(Buffer.isBuffer(s)&&Buffer.isBuffer(n)){if(!s.equals(n))return!1}else if(s!==n)return!1}}else if(this.options.key!==e.options.key)return!1;return this.options.requestCert===e.options.requestCert}}});var h$=m(Qs=>{"use strict";Object.defineProperty(Qs,"__esModule",{value:!0});Qs.getServerInterceptingCall=Qs.BaseServerInterceptingCall=Qs.ServerInterceptingCall=Qs.ResponderBuilder=Qs.isInterceptingServerListener=Qs.ServerListenerBuilder=void 0;var dee=As(),Ks=ft(),Qh=require("http2"),fee=Zb(),hee=require("zlib"),W3e=TM(),yee=er(),vee="server_call";function Gc(t){yee.trace(Ks.LogVerbosity.DEBUG,vee,t)}var l$=class{constructor(){this.metadata=void 0,this.message=void 0,this.halfClose=void 0,this.cancel=void 0}withOnReceiveMetadata(e){return this.metadata=e,this}withOnReceiveMessage(e){return this.message=e,this}withOnReceiveHalfClose(e){return this.halfClose=e,this}withOnCancel(e){return this.cancel=e,this}build(){return{onReceiveMetadata:this.metadata,onReceiveMessage:this.message,onReceiveHalfClose:this.halfClose,onCancel:this.cancel}}};Qs.ServerListenerBuilder=l$;function Z3e(t){return t.onReceiveMetadata!==void 0&&t.onReceiveMetadata.length===1}Qs.isInterceptingServerListener=Z3e;var u$=class{constructor(e,r){this.listener=e,this.nextListener=r,this.cancelled=!1,this.processingMetadata=!1,this.hasPendingMessage=!1,this.pendingMessage=null,this.processingMessage=!1,this.hasPendingHalfClose=!1}processPendingMessage(){this.hasPendingMessage&&(this.nextListener.onReceiveMessage(this.pendingMessage),this.pendingMessage=null,this.hasPendingMessage=!1)}processPendingHalfClose(){this.hasPendingHalfClose&&(this.nextListener.onReceiveHalfClose(),this.hasPendingHalfClose=!1)}onReceiveMetadata(e){this.cancelled||(this.processingMetadata=!0,this.listener.onReceiveMetadata(e,r=>{this.processingMetadata=!1,!this.cancelled&&(this.nextListener.onReceiveMetadata(r),this.processPendingMessage(),this.processPendingHalfClose())}))}onReceiveMessage(e){this.cancelled||(this.processingMessage=!0,this.listener.onReceiveMessage(e,r=>{this.processingMessage=!1,!this.cancelled&&(this.processingMetadata?(this.pendingMessage=r,this.hasPendingMessage=!0):(this.nextListener.onReceiveMessage(r),this.processPendingHalfClose()))}))}onReceiveHalfClose(){this.cancelled||this.listener.onReceiveHalfClose(()=>{this.cancelled||(this.processingMetadata||this.processingMessage?this.hasPendingHalfClose=!0:this.nextListener.onReceiveHalfClose())})}onCancel(){this.cancelled=!0,this.listener.onCancel(),this.nextListener.onCancel()}},c$=class{constructor(){this.start=void 0,this.metadata=void 0,this.message=void 0,this.status=void 0}withStart(e){return this.start=e,this}withSendMetadata(e){return this.metadata=e,this}withSendMessage(e){return this.message=e,this}withSendStatus(e){return this.status=e,this}build(){return{start:this.start,sendMetadata:this.metadata,sendMessage:this.message,sendStatus:this.status}}};Qs.ResponderBuilder=c$;var Tw={onReceiveMetadata:(t,e)=>{e(t)},onReceiveMessage:(t,e)=>{e(t)},onReceiveHalfClose:t=>{t()},onCancel:()=>{}},Cw={start:t=>{t()},sendMetadata:(t,e)=>{e(t)},sendMessage:(t,e)=>{e(t)},sendStatus:(t,e)=>{e(t)}},d$=class{constructor(e,r){var s,n,i,o;this.nextCall=e,this.processingMetadata=!1,this.processingMessage=!1,this.pendingMessage=null,this.pendingMessageCallback=null,this.pendingStatus=null,this.responder={start:(s=r?.start)!==null&&s!==void 0?s:Cw.start,sendMetadata:(n=r?.sendMetadata)!==null&&n!==void 0?n:Cw.sendMetadata,sendMessage:(i=r?.sendMessage)!==null&&i!==void 0?i:Cw.sendMessage,sendStatus:(o=r?.sendStatus)!==null&&o!==void 0?o:Cw.sendStatus}}processPendingMessage(){this.pendingMessageCallback&&(this.nextCall.sendMessage(this.pendingMessage,this.pendingMessageCallback),this.pendingMessage=null,this.pendingMessageCallback=null)}processPendingStatus(){this.pendingStatus&&(this.nextCall.sendStatus(this.pendingStatus),this.pendingStatus=null)}start(e){this.responder.start(r=>{var s,n,i,o;let a={onReceiveMetadata:(s=r?.onReceiveMetadata)!==null&&s!==void 0?s:Tw.onReceiveMetadata,onReceiveMessage:(n=r?.onReceiveMessage)!==null&&n!==void 0?n:Tw.onReceiveMessage,onReceiveHalfClose:(i=r?.onReceiveHalfClose)!==null&&i!==void 0?i:Tw.onReceiveHalfClose,onCancel:(o=r?.onCancel)!==null&&o!==void 0?o:Tw.onCancel},l=new u$(a,e);this.nextCall.start(l)})}sendMetadata(e){this.processingMetadata=!0,this.responder.sendMetadata(e,r=>{this.processingMetadata=!1,this.nextCall.sendMetadata(r),this.processPendingMessage(),this.processPendingStatus()})}sendMessage(e,r){this.processingMessage=!0,this.responder.sendMessage(e,s=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessage=s,this.pendingMessageCallback=r):this.nextCall.sendMessage(s,r)})}sendStatus(e){this.responder.sendStatus(e,r=>{this.processingMetadata||this.processingMessage?this.pendingStatus=r:this.nextCall.sendStatus(r)})}startRead(){this.nextCall.startRead()}getPeer(){return this.nextCall.getPeer()}getDeadline(){return this.nextCall.getDeadline()}};Qs.ServerInterceptingCall=d$;var _ee="grpc-accept-encoding",f$="grpc-encoding",pee="grpc-message",mee="grpc-status",a$="grpc-timeout",Y3e=/(\d{1,8})\s*([HMSmun])/,J3e={H:36e5,M:6e4,S:1e3,m:1,u:.001,n:1e-6},X3e={[_ee]:"identity,deflate,gzip",[f$]:"identity"},gee={[Qh.constants.HTTP2_HEADER_STATUS]:Qh.constants.HTTP_STATUS_OK,[Qh.constants.HTTP2_HEADER_CONTENT_TYPE]:"application/grpc+proto"},e4e={waitForTrailers:!0},Rw=class{constructor(e,r,s,n,i){this.stream=e,this.callEventTracker=s,this.handler=n,this.listener=null,this.deadlineTimer=null,this.deadline=1/0,this.maxSendMessageSize=Ks.DEFAULT_MAX_SEND_MESSAGE_LENGTH,this.maxReceiveMessageSize=Ks.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,this.cancelled=!1,this.metadataSent=!1,this.wantTrailers=!1,this.cancelNotified=!1,this.incomingEncoding="identity",this.readQueue=[],this.isReadPending=!1,this.receivedHalfClose=!1,this.streamEnded=!1,this.stream.once("error",u=>{}),this.stream.once("close",()=>{var u;Gc("Request to method "+((u=this.handler)===null||u===void 0?void 0:u.path)+" stream closed with rstCode "+this.stream.rstCode),this.callEventTracker&&!this.streamEnded&&(this.streamEnded=!0,this.callEventTracker.onStreamEnd(!1),this.callEventTracker.onCallEnd({code:Ks.Status.CANCELLED,details:"Stream closed before sending status",metadata:null})),this.notifyOnCancel()}),this.stream.on("data",u=>{this.handleDataFrame(u)}),this.stream.pause(),this.stream.on("end",()=>{this.handleEndEvent()}),"grpc.max_send_message_length"in i&&(this.maxSendMessageSize=i["grpc.max_send_message_length"]),"grpc.max_receive_message_length"in i&&(this.maxReceiveMessageSize=i["grpc.max_receive_message_length"]),this.decoder=new W3e.StreamDecoder(this.maxReceiveMessageSize);let o=dee.Metadata.fromHttp2Headers(r);yee.isTracerEnabled(vee)&&Gc("Request to "+this.handler.path+" received headers "+JSON.stringify(o.toJSON()));let a=o.get(a$);a.length>0&&this.handleTimeoutHeader(a[0]);let l=o.get(f$);l.length>0&&(this.incomingEncoding=l[0]),o.remove(a$),o.remove(f$),o.remove(_ee),o.remove(Qh.constants.HTTP2_HEADER_ACCEPT_ENCODING),o.remove(Qh.constants.HTTP2_HEADER_TE),o.remove(Qh.constants.HTTP2_HEADER_CONTENT_TYPE),this.metadata=o}handleTimeoutHeader(e){let r=e.toString().match(Y3e);if(r===null){let i={code:Ks.Status.INTERNAL,details:`Invalid ${a$} value "${e}"`,metadata:null};process.nextTick(()=>{this.sendStatus(i)});return}let s=+r[1]*J3e[r[2]]|0,n=new Date;this.deadline=n.setMilliseconds(n.getMilliseconds()+s),this.deadlineTimer=setTimeout(()=>{let i={code:Ks.Status.DEADLINE_EXCEEDED,details:"Deadline exceeded",metadata:null};this.sendStatus(i)},s)}checkCancelled(){return!this.cancelled&&(this.stream.destroyed||this.stream.closed)&&(this.notifyOnCancel(),this.cancelled=!0),this.cancelled}notifyOnCancel(){this.cancelNotified||(this.cancelNotified=!0,this.cancelled=!0,process.nextTick(()=>{var e;(e=this.listener)===null||e===void 0||e.onCancel()}),this.deadlineTimer&&clearTimeout(this.deadlineTimer),this.stream.resume())}maybeSendMetadata(){this.metadataSent||this.sendMetadata(new dee.Metadata)}serializeMessage(e){let r=this.handler.serialize(e),s=r.byteLength,n=Buffer.allocUnsafe(s+5);return n.writeUInt8(0,0),n.writeUInt32BE(s,1),r.copy(n,5),n}decompressMessage(e,r){let s=e.subarray(5);if(r==="identity")return s;if(r==="deflate"||r==="gzip"){let n;return r==="deflate"?n=hee.createInflate():n=hee.createGunzip(),new Promise((i,o)=>{let a=0,l=[];n.on("data",u=>{l.push(u),a+=u.byteLength,this.maxReceiveMessageSize!==-1&&a>this.maxReceiveMessageSize&&(n.destroy(),o({code:Ks.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxReceiveMessageSize}`}))}),n.on("end",()=>{i(Buffer.concat(l))}),n.write(s),n.end()})}else return Promise.reject({code:Ks.Status.UNIMPLEMENTED,details:`Received message compressed with unsupported encoding "${r}"`})}async decompressAndMaybePush(e){if(e.type!=="COMPRESSED")throw new Error(`Invalid queue entry type: ${e.type}`);let s=e.compressedMessage.readUInt8(0)===1?this.incomingEncoding:"identity",n;try{n=await this.decompressMessage(e.compressedMessage,s)}catch(i){this.sendStatus(i);return}try{e.parsedMessage=this.handler.deserialize(n)}catch(i){this.sendStatus({code:Ks.Status.INTERNAL,details:`Error deserializing request: ${i.message}`});return}e.type="READABLE",this.maybePushNextMessage()}maybePushNextMessage(){if(this.listener&&this.isReadPending&&this.readQueue.length>0&&this.readQueue[0].type!=="COMPRESSED"){this.isReadPending=!1;let e=this.readQueue.shift();e.type==="READABLE"?this.listener.onReceiveMessage(e.parsedMessage):this.listener.onReceiveHalfClose()}}handleDataFrame(e){var r;if(this.checkCancelled())return;Gc("Request to "+this.handler.path+" received data frame of size "+e.length);let s;try{s=this.decoder.write(e)}catch(n){this.sendStatus({code:Ks.Status.RESOURCE_EXHAUSTED,details:n.message});return}for(let n of s){this.stream.pause();let i={type:"COMPRESSED",compressedMessage:n,parsedMessage:null};this.readQueue.push(i),this.decompressAndMaybePush(i),(r=this.callEventTracker)===null||r===void 0||r.addMessageReceived()}}handleEndEvent(){this.readQueue.push({type:"HALF_CLOSE",compressedMessage:null,parsedMessage:null}),this.receivedHalfClose=!0,this.maybePushNextMessage()}start(e){Gc("Request to "+this.handler.path+" start called"),!this.checkCancelled()&&(this.listener=e,e.onReceiveMetadata(this.metadata))}sendMetadata(e){if(this.checkCancelled()||this.metadataSent)return;this.metadataSent=!0;let r=e?e.toHttp2Headers():null,s=Object.assign(Object.assign(Object.assign({},gee),X3e),r);this.stream.respond(s,e4e)}sendMessage(e,r){if(this.checkCancelled())return;let s;try{s=this.serializeMessage(e)}catch(n){this.sendStatus({code:Ks.Status.INTERNAL,details:`Error serializing response: ${(0,fee.getErrorMessage)(n)}`,metadata:null});return}if(this.maxSendMessageSize!==-1&&s.length-5>this.maxSendMessageSize){this.sendStatus({code:Ks.Status.RESOURCE_EXHAUSTED,details:`Sent message larger than max (${s.length} vs. ${this.maxSendMessageSize})`,metadata:null});return}this.maybeSendMetadata(),Gc("Request to "+this.handler.path+" sent data frame of size "+s.length),this.stream.write(s,n=>{var i;if(n){this.sendStatus({code:Ks.Status.INTERNAL,details:`Error writing message: ${(0,fee.getErrorMessage)(n)}`,metadata:null});return}(i=this.callEventTracker)===null||i===void 0||i.addMessageSent(),r()})}sendStatus(e){var r,s;if(!this.checkCancelled())if(Gc("Request to method "+((r=this.handler)===null||r===void 0?void 0:r.path)+" ended with status code: "+Ks.Status[e.code]+" details: "+e.details),this.metadataSent)this.wantTrailers?this.notifyOnCancel():(this.wantTrailers=!0,this.stream.once("wantTrailers",()=>{var n;this.callEventTracker&&!this.streamEnded&&(this.streamEnded=!0,this.callEventTracker.onStreamEnd(!0),this.callEventTracker.onCallEnd(e));let i=Object.assign({[mee]:e.code,[pee]:encodeURI(e.details)},(n=e.metadata)===null||n===void 0?void 0:n.toHttp2Headers());this.stream.sendTrailers(i),this.notifyOnCancel()}),this.stream.end());else{this.callEventTracker&&!this.streamEnded&&(this.streamEnded=!0,this.callEventTracker.onStreamEnd(!0),this.callEventTracker.onCallEnd(e));let n=Object.assign(Object.assign({[mee]:e.code,[pee]:encodeURI(e.details)},gee),(s=e.metadata)===null||s===void 0?void 0:s.toHttp2Headers());this.stream.respond(n,{endStream:!0}),this.notifyOnCancel()}}startRead(){Gc("Request to "+this.handler.path+" startRead called"),!this.checkCancelled()&&(this.isReadPending=!0,this.readQueue.length===0?this.receivedHalfClose||this.stream.resume():this.maybePushNextMessage())}getPeer(){var e;let r=(e=this.stream.session)===null||e===void 0?void 0:e.socket;return r?.remoteAddress?r.remotePort?`${r.remoteAddress}:${r.remotePort}`:r.remoteAddress:"unknown"}getDeadline(){return this.deadline}};Qs.BaseServerInterceptingCall=Rw;function t4e(t,e,r,s,n,i){let o={path:n.path,requestStream:n.type==="clientStream"||n.type==="bidi",responseStream:n.type==="serverStream"||n.type==="bidi",requestDeserialize:n.deserialize,responseSerialize:n.serialize},a=new Rw(e,r,s,n,i);return t.reduce((l,u)=>u(o,l),a)}Qs.getServerInterceptingCall=t4e});var Cee=m(lu=>{"use strict";var r4e=lu&&lu.__runInitializers||function(t,e,r){for(var s=arguments.length>2,n=0;n<e.length;n++)r=s?e[n].call(t,r):e[n].call(t);return s?r:void 0},s4e=lu&&lu.__esDecorate||function(t,e,r,s,n,i){function o(S){if(S!==void 0&&typeof S!="function")throw new TypeError("Function expected");return S}for(var a=s.kind,l=a==="getter"?"get":a==="setter"?"set":"value",u=!e&&t?s.static?t:t.prototype:null,c=e||(u?Object.getOwnPropertyDescriptor(u,s.name):{}),d,f=!1,h=r.length-1;h>=0;h--){var p={};for(var g in s)p[g]=g==="access"?{}:s[g];for(var g in s.access)p.access[g]=s.access[g];p.addInitializer=function(S){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(o(S||null))};var _=(0,r[h])(a==="accessor"?{get:c.get,set:c.set}:c[l],p);if(a==="accessor"){if(_===void 0)continue;if(_===null||typeof _!="object")throw new TypeError("Object expected");(d=o(_.get))&&(c.get=d),(d=o(_.set))&&(c.set=d),(d=o(_.init))&&n.unshift(d)}else(d=o(_))&&(a==="field"?n.unshift(d):c[l]=d)}u&&Object.defineProperty(u,s.name,c),f=!0};Object.defineProperty(lu,"__esModule",{value:!0});lu.Server=void 0;var yn=require("http2"),n4e=require("util"),Or=ft(),Zh=uee(),i4e=o$(),See=Eo(),Ow=er(),au=Ai(),qi=hn(),Jr=zc(),bee=h$(),Wh=~(1<<31),p$=~(1<<31),o4e=2e4,Eee=~(1<<31),{HTTP2_HEADER_PATH:wee}=yn.constants,a4e="server",Tee=Buffer.from("max_age");function l4e(){}function u4e(t){return function(e,r){return n4e.deprecate(e,t)}}function m$(t){return{code:Or.Status.UNIMPLEMENTED,details:`The server does not implement the method ${t}`}}function c4e(t,e){let r=m$(e);switch(t){case"unary":return(s,n)=>{n(r,null)};case"clientStream":return(s,n)=>{n(r,null)};case"serverStream":return s=>{s.emit("error",r)};case"bidi":return s=>{s.emit("error",r)};default:throw new Error(`Invalid handlerType ${t}`)}}var d4e=(()=>{var t;let e=[],r;return t=class{constructor(n){var i,o,a,l,u,c;this.boundPorts=(r4e(this,e),new Map),this.http2Servers=new Map,this.sessionIdleTimeouts=new Map,this.handlers=new Map,this.sessions=new Map,this.started=!1,this.shutdown=!1,this.serverAddressString="null",this.channelzEnabled=!0,this.options=n??{},this.options["grpc.enable_channelz"]===0?(this.channelzEnabled=!1,this.channelzTrace=new Jr.ChannelzTraceStub,this.callTracker=new Jr.ChannelzCallTrackerStub,this.listenerChildrenTracker=new Jr.ChannelzChildrenTrackerStub,this.sessionChildrenTracker=new Jr.ChannelzChildrenTrackerStub):(this.channelzTrace=new Jr.ChannelzTrace,this.callTracker=new Jr.ChannelzCallTracker,this.listenerChildrenTracker=new Jr.ChannelzChildrenTracker,this.sessionChildrenTracker=new Jr.ChannelzChildrenTracker),this.channelzRef=(0,Jr.registerChannelzServer)("server",()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzTrace.addTrace("CT_INFO","Server created"),this.maxConnectionAgeMs=(i=this.options["grpc.max_connection_age_ms"])!==null&&i!==void 0?i:Wh,this.maxConnectionAgeGraceMs=(o=this.options["grpc.max_connection_age_grace_ms"])!==null&&o!==void 0?o:Wh,this.keepaliveTimeMs=(a=this.options["grpc.keepalive_time_ms"])!==null&&a!==void 0?a:p$,this.keepaliveTimeoutMs=(l=this.options["grpc.keepalive_timeout_ms"])!==null&&l!==void 0?l:o4e,this.sessionIdleTimeout=(u=this.options["grpc.max_connection_idle_ms"])!==null&&u!==void 0?u:Eee,this.commonServerOptions={maxSendHeaderBlockLength:Number.MAX_SAFE_INTEGER},"grpc-node.max_session_memory"in this.options?this.commonServerOptions.maxSessionMemory=this.options["grpc-node.max_session_memory"]:this.commonServerOptions.maxSessionMemory=Number.MAX_SAFE_INTEGER,"grpc.max_concurrent_streams"in this.options&&(this.commonServerOptions.settings={maxConcurrentStreams:this.options["grpc.max_concurrent_streams"]}),this.interceptors=(c=this.options.interceptors)!==null&&c!==void 0?c:[],this.trace("Server constructed")}getChannelzInfo(){return{trace:this.channelzTrace,callTracker:this.callTracker,listenerChildren:this.listenerChildrenTracker.getChildLists(),sessionChildren:this.sessionChildrenTracker.getChildLists()}}getChannelzSessionInfo(n){var i,o,a;let l=this.sessions.get(n),u=n.socket,c=u.remoteAddress?(0,au.stringToSubchannelAddress)(u.remoteAddress,u.remotePort):null,d=u.localAddress?(0,au.stringToSubchannelAddress)(u.localAddress,u.localPort):null,f;if(n.encrypted){let p=u,g=p.getCipher(),_=p.getCertificate(),S=p.getPeerCertificate();f={cipherSuiteStandardName:(i=g.standardName)!==null&&i!==void 0?i:null,cipherSuiteOtherName:g.standardName?null:g.name,localCertificate:_&&"raw"in _?_.raw:null,remoteCertificate:S&&"raw"in S?S.raw:null}}else f=null;return{remoteAddress:c,localAddress:d,security:f,remoteName:null,streamsStarted:l.streamTracker.callsStarted,streamsSucceeded:l.streamTracker.callsSucceeded,streamsFailed:l.streamTracker.callsFailed,messagesSent:l.messagesSent,messagesReceived:l.messagesReceived,keepAlivesSent:l.keepAlivesSent,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:l.streamTracker.lastCallStartedTimestamp,lastMessageSentTimestamp:l.lastMessageSentTimestamp,lastMessageReceivedTimestamp:l.lastMessageReceivedTimestamp,localFlowControlWindow:(o=n.state.localWindowSize)!==null&&o!==void 0?o:null,remoteFlowControlWindow:(a=n.state.remoteWindowSize)!==null&&a!==void 0?a:null}}trace(n){Ow.trace(Or.LogVerbosity.DEBUG,a4e,"("+this.channelzRef.id+") "+n)}keepaliveTrace(n){Ow.trace(Or.LogVerbosity.DEBUG,"keepalive","("+this.channelzRef.id+") "+n)}addProtoService(){throw new Error("Not implemented. Use addService() instead")}addService(n,i){if(n===null||typeof n!="object"||i===null||typeof i!="object")throw new Error("addService() requires two objects as arguments");let o=Object.keys(n);if(o.length===0)throw new Error("Cannot add an empty service to a server");o.forEach(a=>{let l=n[a],u;l.requestStream?l.responseStream?u="bidi":u="clientStream":l.responseStream?u="serverStream":u="unary";let c=i[a],d;if(c===void 0&&typeof l.originalName=="string"&&(c=i[l.originalName]),c!==void 0?d=c.bind(i):d=c4e(u,a),this.register(l.path,d,l.responseSerialize,l.requestDeserialize,u)===!1)throw new Error(`Method handler for ${l.path} already provided.`)})}removeService(n){if(n===null||typeof n!="object")throw new Error("removeService() requires object as argument");Object.keys(n).forEach(o=>{let a=n[o];this.unregister(a.path)})}bind(n,i){throw new Error("Not implemented. Use bindAsync() instead")}registerListenerToChannelz(n){return(0,Jr.registerChannelzSocket)((0,au.subchannelAddressToString)(n),()=>({localAddress:n,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled)}createHttp2Server(n){let i;if(n._isSecure()){let o=Object.assign(this.commonServerOptions,n._getSettings());o.enableTrace=this.options["grpc-node.tls_enable_trace"]===1,i=yn.createSecureServer(o),i.on("secureConnection",a=>{a.on("error",l=>{this.trace("An incoming TLS connection closed with error: "+l.message)})})}else i=yn.createServer(this.commonServerOptions);return i.setTimeout(0,l4e),this._setupHandlers(i),i}bindOneAddress(n,i){this.trace("Attempting to bind "+(0,au.subchannelAddressToString)(n));let o=this.createHttp2Server(i.credentials);return new Promise((a,l)=>{let u=c=>{this.trace("Failed to bind "+(0,au.subchannelAddressToString)(n)+" with error "+c.message),a({port:"port"in n?n.port:1,error:c.message})};o.once("error",u),o.listen(n,()=>{let c=o.address(),d;typeof c=="string"?d={path:c}:d={host:c.address,port:c.port};let f=this.registerListenerToChannelz(d);this.listenerChildrenTracker.refChild(f),this.http2Servers.set(o,{channelzRef:f,sessions:new Set}),i.listeningServers.add(o),this.trace("Successfully bound "+(0,au.subchannelAddressToString)(d)),a({port:"port"in d?d.port:1}),o.removeListener("error",u)})})}async bindManyPorts(n,i){if(n.length===0)return{count:0,port:0,errors:[]};if((0,au.isTcpSubchannelAddress)(n[0])&&n[0].port===0){let o=await this.bindOneAddress(n[0],i);if(o.error){let a=await this.bindManyPorts(n.slice(1),i);return Object.assign(Object.assign({},a),{errors:[o.error,...a.errors]})}else{let a=n.slice(1).map(c=>(0,au.isTcpSubchannelAddress)(c)?{host:c.host,port:o.port}:c),l=await Promise.all(a.map(c=>this.bindOneAddress(c,i))),u=[o,...l];return{count:u.filter(c=>c.error===void 0).length,port:o.port,errors:u.filter(c=>c.error).map(c=>c.error)}}}else{let o=await Promise.all(n.map(a=>this.bindOneAddress(a,i)));return{count:o.filter(a=>a.error===void 0).length,port:o[0].port,errors:o.filter(a=>a.error).map(a=>a.error)}}}async bindAddressList(n,i){let o=await this.bindManyPorts(n,i);if(o.count>0)return o.count<n.length&&Ow.log(Or.LogVerbosity.INFO,`WARNING Only ${o.count} addresses added out of total ${n.length} resolved`),o.port;{let a=`No address added out of total ${n.length} resolved`;throw Ow.log(Or.LogVerbosity.ERROR,a),new Error(`${a} errors: [${o.errors.join(",")}]`)}}resolvePort(n){return new Promise((i,o)=>{let a={onSuccessfulResolution:(u,c,d)=>{a.onSuccessfulResolution=()=>{};let f=[].concat(...u.map(h=>h.addresses));if(f.length===0){o(new Error(`No addresses resolved for port ${n}`));return}i(f)},onError:u=>{o(new Error(u.details))}};(0,See.createResolver)(n,a,this.options).updateResolution()})}async bindPort(n,i){let o=await this.resolvePort(n);if(i.cancelled)throw this.completeUnbind(i),new Error("bindAsync operation cancelled by unbind call");let a=await this.bindAddressList(o,i);if(i.cancelled)throw this.completeUnbind(i),new Error("bindAsync operation cancelled by unbind call");return a}normalizePort(n){let i=(0,qi.parseUri)(n);if(i===null)throw new Error(`Could not parse port "${n}"`);let o=(0,See.mapUriDefaultScheme)(i);if(o===null)throw new Error(`Could not get a default scheme for port "${n}"`);return o}bindAsync(n,i,o){if(this.shutdown)throw new Error("bindAsync called after shutdown");if(typeof n!="string")throw new TypeError("port must be a string");if(i===null||!(i instanceof i4e.ServerCredentials))throw new TypeError("creds must be a ServerCredentials object");if(typeof o!="function")throw new TypeError("callback must be a function");this.trace("bindAsync port="+n);let a=this.normalizePort(n),l=(f,h)=>{process.nextTick(()=>o(f,h))},u=this.boundPorts.get((0,qi.uriToString)(a));if(u){if(!i._equals(u.credentials)){l(new Error(`${n} already bound with incompatible credentials`),0);return}u.cancelled=!1,u.completionPromise?u.completionPromise.then(f=>o(null,f),f=>o(f,0)):l(null,u.portNumber);return}u={mapKey:(0,qi.uriToString)(a),originalUri:a,completionPromise:null,cancelled:!1,portNumber:0,credentials:i,listeningServers:new Set};let c=(0,qi.splitHostPort)(a.path),d=this.bindPort(a,u);u.completionPromise=d,c?.port===0?d.then(f=>{let h={scheme:a.scheme,authority:a.authority,path:(0,qi.combineHostPort)({host:c.host,port:f})};u.mapKey=(0,qi.uriToString)(h),u.completionPromise=null,u.portNumber=f,this.boundPorts.set(u.mapKey,u),o(null,f)},f=>{o(f,0)}):(this.boundPorts.set(u.mapKey,u),d.then(f=>{u.completionPromise=null,u.portNumber=f,o(null,f)},f=>{o(f,0)}))}closeServer(n,i){this.trace("Closing server with address "+JSON.stringify(n.address()));let o=this.http2Servers.get(n);n.close(()=>{o&&(this.listenerChildrenTracker.unrefChild(o.channelzRef),(0,Jr.unregisterChannelzRef)(o.channelzRef)),this.http2Servers.delete(n),i?.()})}closeSession(n,i){var o;this.trace("Closing session initiated by "+((o=n.socket)===null||o===void 0?void 0:o.remoteAddress));let a=this.sessions.get(n),l=()=>{a&&(this.sessionChildrenTracker.unrefChild(a.ref),(0,Jr.unregisterChannelzRef)(a.ref)),i?.()};n.closed?queueMicrotask(l):n.close(l)}completeUnbind(n){for(let i of n.listeningServers){let o=this.http2Servers.get(i);if(this.closeServer(i,()=>{n.listeningServers.delete(i)}),o)for(let a of o.sessions)this.closeSession(a)}this.boundPorts.delete(n.mapKey)}unbind(n){this.trace("unbind port="+n);let i=this.normalizePort(n),o=(0,qi.splitHostPort)(i.path);if(o?.port===0)throw new Error("Cannot unbind port 0");let a=this.boundPorts.get((0,qi.uriToString)(i));a&&(this.trace("unbinding "+a.mapKey+" originally bound as "+(0,qi.uriToString)(a.originalUri)),a.completionPromise?a.cancelled=!0:this.completeUnbind(a))}drain(n,i){var o,a;this.trace("drain port="+n+" graceTimeMs="+i);let l=this.normalizePort(n),u=(0,qi.splitHostPort)(l.path);if(u?.port===0)throw new Error("Cannot drain port 0");let c=this.boundPorts.get((0,qi.uriToString)(l));if(!c)return;let d=new Set;for(let f of c.listeningServers){let h=this.http2Servers.get(f);if(h)for(let p of h.sessions)d.add(p),this.closeSession(p,()=>{d.delete(p)})}(a=(o=setTimeout(()=>{for(let f of d)f.destroy(yn.constants.NGHTTP2_CANCEL)},i)).unref)===null||a===void 0||a.call(o)}forceShutdown(){for(let n of this.boundPorts.values())n.cancelled=!0;this.boundPorts.clear();for(let n of this.http2Servers.keys())this.closeServer(n);this.sessions.forEach((n,i)=>{this.closeSession(i),i.destroy(yn.constants.NGHTTP2_CANCEL)}),this.sessions.clear(),(0,Jr.unregisterChannelzRef)(this.channelzRef),this.shutdown=!0}register(n,i,o,a,l){return this.handlers.has(n)?!1:(this.handlers.set(n,{func:i,serialize:o,deserialize:a,type:l,path:n}),!0)}unregister(n){return this.handlers.delete(n)}start(){if(this.http2Servers.size===0||[...this.http2Servers.keys()].every(n=>!n.listening))throw new Error("server must be bound in order to start");if(this.started===!0)throw new Error("server is already started");this.started=!0}tryShutdown(n){var i;let o=u=>{(0,Jr.unregisterChannelzRef)(this.channelzRef),n(u)},a=0;function l(){a--,a===0&&o()}this.shutdown=!0;for(let[u,c]of this.http2Servers.entries()){a++;let d=c.channelzRef.name;this.trace("Waiting for server "+d+" to close"),this.closeServer(u,()=>{this.trace("Server "+d+" finished closing"),l()});for(let f of c.sessions.keys()){a++;let h=(i=f.socket)===null||i===void 0?void 0:i.remoteAddress;this.trace("Waiting for session "+h+" to close"),this.closeSession(f,()=>{this.trace("Session "+h+" finished closing"),l()})}}a===0&&o()}addHttp2Port(){throw new Error("Not yet implemented")}getChannelzRef(){return this.channelzRef}_verifyContentType(n,i){let o=i[yn.constants.HTTP2_HEADER_CONTENT_TYPE];return typeof o!="string"||!o.startsWith("application/grpc")?(n.respond({[yn.constants.HTTP2_HEADER_STATUS]:yn.constants.HTTP_STATUS_UNSUPPORTED_MEDIA_TYPE},{endStream:!0}),!1):!0}_retrieveHandler(n){this.trace("Received call to method "+n+" at address "+this.serverAddressString);let i=this.handlers.get(n);return i===void 0?(this.trace("No handler registered for method "+n+". Sending UNIMPLEMENTED status."),null):i}_respondWithError(n,i,o=null){var a,l;let u=Object.assign({"grpc-status":(a=n.code)!==null&&a!==void 0?a:Or.Status.INTERNAL,"grpc-message":n.details,[yn.constants.HTTP2_HEADER_STATUS]:yn.constants.HTTP_STATUS_OK,[yn.constants.HTTP2_HEADER_CONTENT_TYPE]:"application/grpc+proto"},(l=n.metadata)===null||l===void 0?void 0:l.toHttp2Headers());i.respond(u,{endStream:!0}),this.callTracker.addCallFailed(),o?.streamTracker.addCallFailed()}_channelzHandler(n,i){this.onStreamOpened(n);let o=this.sessions.get(n.session);if(this.callTracker.addCallStarted(),o?.streamTracker.addCallStarted(),!this._verifyContentType(n,i)){this.callTracker.addCallFailed(),o?.streamTracker.addCallFailed();return}let a=i[wee],l=this._retrieveHandler(a);if(!l){this._respondWithError(m$(a),n,o);return}let u={addMessageSent:()=>{o&&(o.messagesSent+=1,o.lastMessageSentTimestamp=new Date)},addMessageReceived:()=>{o&&(o.messagesReceived+=1,o.lastMessageReceivedTimestamp=new Date)},onCallEnd:d=>{d.code===Or.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()},onStreamEnd:d=>{o&&(d?o.streamTracker.addCallSucceeded():o.streamTracker.addCallFailed())}},c=(0,bee.getServerInterceptingCall)(this.interceptors,n,i,u,l,this.options);this._runHandlerForCall(c,l)||(this.callTracker.addCallFailed(),o?.streamTracker.addCallFailed(),c.sendStatus({code:Or.Status.INTERNAL,details:`Unknown handler type: ${l.type}`}))}_streamHandler(n,i){if(this.onStreamOpened(n),this._verifyContentType(n,i)!==!0)return;let o=i[wee],a=this._retrieveHandler(o);if(!a){this._respondWithError(m$(o),n,null);return}let l=(0,bee.getServerInterceptingCall)(this.interceptors,n,i,null,a,this.options);this._runHandlerForCall(l,a)||l.sendStatus({code:Or.Status.INTERNAL,details:`Unknown handler type: ${a.type}`})}_runHandlerForCall(n,i){let{type:o}=i;if(o==="unary")f4e(n,i);else if(o==="clientStream")h4e(n,i);else if(o==="serverStream")p4e(n,i);else if(o==="bidi")m4e(n,i);else return!1;return!0}_setupHandlers(n){if(n===null)return;let i=n.address(),o="null";i&&(typeof i=="string"?o=i:o=i.address+":"+i.port),this.serverAddressString=o;let a=this.channelzEnabled?this._channelzHandler:this._streamHandler,l=this.channelzEnabled?this._channelzSessionHandler(n):this._sessionHandler(n);n.on("stream",a.bind(this)),n.on("session",l)}_sessionHandler(n){return i=>{var o,a;(o=this.http2Servers.get(n))===null||o===void 0||o.sessions.add(i);let l=null,u=null,c=null,d=!1,f=this.enableIdleTimeout(i);if(this.maxConnectionAgeMs!==Wh){let S=this.maxConnectionAgeMs/10,b=Math.random()*S*2-S;l=setTimeout(()=>{var v,y;d=!0,this.trace("Connection dropped by max connection age: "+((v=i.socket)===null||v===void 0?void 0:v.remoteAddress));try{i.goaway(yn.constants.NGHTTP2_NO_ERROR,~(1<<31),Tee)}catch{i.destroy();return}i.close(),this.maxConnectionAgeGraceMs!==Wh&&(u=setTimeout(()=>{i.destroy()},this.maxConnectionAgeGraceMs),(y=u.unref)===null||y===void 0||y.call(u))},this.maxConnectionAgeMs+b),(a=l.unref)===null||a===void 0||a.call(l)}let h=()=>{c&&(clearTimeout(c),c=null)},p=()=>!i.destroyed&&this.keepaliveTimeMs<p$&&this.keepaliveTimeMs>0,g,_=()=>{var S;p()&&(this.keepaliveTrace("Starting keepalive timer for "+this.keepaliveTimeMs+"ms"),c=setTimeout(()=>{h(),g()},this.keepaliveTimeMs),(S=c.unref)===null||S===void 0||S.call(c))};g=()=>{var S;if(!p())return;this.keepaliveTrace("Sending ping with timeout "+this.keepaliveTimeoutMs+"ms");let b="";try{i.ping((y,R,P)=>{h(),y?(this.keepaliveTrace("Ping failed with error: "+y.message),d=!0,i.close()):(this.keepaliveTrace("Received ping response"),_())})||(b="Ping returned false")}catch(v){b=(v instanceof Error?v.message:"")||"Unknown error"}if(b){this.keepaliveTrace("Ping send failed: "+b),this.trace("Connection dropped due to ping send error: "+b),d=!0,i.close();return}c=setTimeout(()=>{h(),this.keepaliveTrace("Ping timeout passed without response"),this.trace("Connection dropped by keepalive timeout"),d=!0,i.close()},this.keepaliveTimeoutMs),(S=c.unref)===null||S===void 0||S.call(c)},_(),i.on("close",()=>{var S,b;d||this.trace(`Connection dropped by client ${(S=i.socket)===null||S===void 0?void 0:S.remoteAddress}`),l&&clearTimeout(l),u&&clearTimeout(u),h(),f!==null&&(clearTimeout(f.timeout),this.sessionIdleTimeouts.delete(i)),(b=this.http2Servers.get(n))===null||b===void 0||b.sessions.delete(i)})}}_channelzSessionHandler(n){return i=>{var o,a,l,u;let c=(0,Jr.registerChannelzSocket)((a=(o=i.socket)===null||o===void 0?void 0:o.remoteAddress)!==null&&a!==void 0?a:"unknown",this.getChannelzSessionInfo.bind(this,i),this.channelzEnabled),d={ref:c,streamTracker:new Jr.ChannelzCallTracker,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null};(l=this.http2Servers.get(n))===null||l===void 0||l.sessions.add(i),this.sessions.set(i,d);let f=`${i.socket.remoteAddress}:${i.socket.remotePort}`;this.channelzTrace.addTrace("CT_INFO","Connection established by client "+f),this.trace("Connection established by client "+f),this.sessionChildrenTracker.refChild(c);let h=null,p=null,g=null,_=!1,S=this.enableIdleTimeout(i);if(this.maxConnectionAgeMs!==Wh){let P=this.maxConnectionAgeMs/10,w=Math.random()*P*2-P;h=setTimeout(()=>{var O;_=!0,this.channelzTrace.addTrace("CT_INFO","Connection dropped by max connection age from "+f);try{i.goaway(yn.constants.NGHTTP2_NO_ERROR,~(1<<31),Tee)}catch{i.destroy();return}i.close(),this.maxConnectionAgeGraceMs!==Wh&&(p=setTimeout(()=>{i.destroy()},this.maxConnectionAgeGraceMs),(O=p.unref)===null||O===void 0||O.call(p))},this.maxConnectionAgeMs+w),(u=h.unref)===null||u===void 0||u.call(h)}let b=()=>{g&&(clearTimeout(g),g=null)},v=()=>!i.destroyed&&this.keepaliveTimeMs<p$&&this.keepaliveTimeMs>0,y,R=()=>{var P;v()&&(this.keepaliveTrace("Starting keepalive timer for "+this.keepaliveTimeMs+"ms"),g=setTimeout(()=>{b(),y()},this.keepaliveTimeMs),(P=g.unref)===null||P===void 0||P.call(g))};y=()=>{var P;if(!v())return;this.keepaliveTrace("Sending ping with timeout "+this.keepaliveTimeoutMs+"ms");let w="";try{i.ping(($,C,k)=>{b(),$?(this.keepaliveTrace("Ping failed with error: "+$.message),this.channelzTrace.addTrace("CT_INFO","Connection dropped due to error of a ping frame "+$.message+" return in "+C),_=!0,i.close()):(this.keepaliveTrace("Received ping response"),R())})||(w="Ping returned false")}catch(O){w=(O instanceof Error?O.message:"")||"Unknown error"}if(w){this.keepaliveTrace("Ping send failed: "+w),this.channelzTrace.addTrace("CT_INFO","Connection dropped due to ping send error: "+w),_=!0,i.close();return}d.keepAlivesSent+=1,g=setTimeout(()=>{b(),this.keepaliveTrace("Ping timeout passed without response"),this.channelzTrace.addTrace("CT_INFO","Connection dropped by keepalive timeout from "+f),_=!0,i.close()},this.keepaliveTimeoutMs),(P=g.unref)===null||P===void 0||P.call(g)},R(),i.on("close",()=>{var P;_||this.channelzTrace.addTrace("CT_INFO","Connection dropped by client "+f),this.sessionChildrenTracker.unrefChild(c),(0,Jr.unregisterChannelzRef)(c),h&&clearTimeout(h),p&&clearTimeout(p),b(),S!==null&&(clearTimeout(S.timeout),this.sessionIdleTimeouts.delete(i)),(P=this.http2Servers.get(n))===null||P===void 0||P.sessions.delete(i),this.sessions.delete(i)})}}enableIdleTimeout(n){var i,o;if(this.sessionIdleTimeout>=Eee)return null;let a={activeStreams:0,lastIdle:Date.now(),onClose:this.onStreamClose.bind(this,n),timeout:setTimeout(this.onIdleTimeout,this.sessionIdleTimeout,this,n)};(o=(i=a.timeout).unref)===null||o===void 0||o.call(i),this.sessionIdleTimeouts.set(n,a);let{socket:l}=n;return this.trace("Enable idle timeout for "+l.remoteAddress+":"+l.remotePort),a}onIdleTimeout(n,i){let{socket:o}=i,a=n.sessionIdleTimeouts.get(i);a!==void 0&&a.activeStreams===0&&Date.now()-a.lastIdle>=n.sessionIdleTimeout&&(n.trace("Session idle timeout triggered for "+o?.remoteAddress+":"+o?.remotePort+" last idle at "+a.lastIdle),n.closeSession(i))}onStreamOpened(n){let i=n.session,o=this.sessionIdleTimeouts.get(i);o&&(o.activeStreams+=1,n.once("close",o.onClose))}onStreamClose(n){var i,o;let a=this.sessionIdleTimeouts.get(n);a&&(a.activeStreams-=1,a.activeStreams===0&&(a.lastIdle=Date.now(),a.timeout.refresh(),this.trace("Session onStreamClose"+((i=n.socket)===null||i===void 0?void 0:i.remoteAddress)+":"+((o=n.socket)===null||o===void 0?void 0:o.remotePort)+" at "+a.lastIdle)))}},(()=>{let s=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;r=[u4e("Calling start() is no longer necessary. It can be safely omitted.")],s4e(t,null,r,{kind:"method",name:"start",static:!1,private:!1,access:{has:n=>"start"in n,get:n=>n.start},metadata:s},null,e),s&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s})})(),t})();lu.Server=d4e;async function f4e(t,e){let r;function s(o,a,l,u){if(o){t.sendStatus((0,Zh.serverErrorToStatus)(o,l));return}t.sendMessage(a,()=>{t.sendStatus({code:Or.Status.OK,details:"OK",metadata:l??null})})}let n,i=null;t.start({onReceiveMetadata(o){n=o,t.startRead()},onReceiveMessage(o){if(i){t.sendStatus({code:Or.Status.UNIMPLEMENTED,details:`Received a second request message for server streaming method ${e.path}`,metadata:null});return}i=o,t.startRead()},onReceiveHalfClose(){if(!i){t.sendStatus({code:Or.Status.UNIMPLEMENTED,details:`Received no request message for server streaming method ${e.path}`,metadata:null});return}r=new Zh.ServerWritableStreamImpl(e.path,t,n,i);try{e.func(r,s)}catch(o){t.sendStatus({code:Or.Status.UNKNOWN,details:`Server method handler threw error ${o.message}`,metadata:null})}},onCancel(){r&&(r.cancelled=!0,r.emit("cancelled","cancelled"))}})}function h4e(t,e){let r;function s(n,i,o,a){if(n){t.sendStatus((0,Zh.serverErrorToStatus)(n,o));return}t.sendMessage(i,()=>{t.sendStatus({code:Or.Status.OK,details:"OK",metadata:o??null})})}t.start({onReceiveMetadata(n){r=new Zh.ServerDuplexStreamImpl(e.path,t,n);try{e.func(r,s)}catch(i){t.sendStatus({code:Or.Status.UNKNOWN,details:`Server method handler threw error ${i.message}`,metadata:null})}},onReceiveMessage(n){r.push(n)},onReceiveHalfClose(){r.push(null)},onCancel(){r&&(r.cancelled=!0,r.emit("cancelled","cancelled"),r.destroy())}})}function p4e(t,e){let r,s,n=null;t.start({onReceiveMetadata(i){s=i,t.startRead()},onReceiveMessage(i){if(n){t.sendStatus({code:Or.Status.UNIMPLEMENTED,details:`Received a second request message for server streaming method ${e.path}`,metadata:null});return}n=i,t.startRead()},onReceiveHalfClose(){if(!n){t.sendStatus({code:Or.Status.UNIMPLEMENTED,details:`Received no request message for server streaming method ${e.path}`,metadata:null});return}r=new Zh.ServerWritableStreamImpl(e.path,t,s,n);try{e.func(r)}catch(i){t.sendStatus({code:Or.Status.UNKNOWN,details:`Server method handler threw error ${i.message}`,metadata:null})}},onCancel(){r&&(r.cancelled=!0,r.emit("cancelled","cancelled"),r.destroy())}})}function m4e(t,e){let r;t.start({onReceiveMetadata(s){r=new Zh.ServerDuplexStreamImpl(e.path,t,s);try{e.func(r)}catch(n){t.sendStatus({code:Or.Status.UNKNOWN,details:`Server method handler threw error ${n.message}`,metadata:null})}},onReceiveMessage(s){r.push(s)},onReceiveHalfClose(){r.push(null)},onCancel(){r&&(r.cancelled=!0,r.emit("cancelled","cancelled"),r.destroy())}})}});var Ree=m(Pw=>{"use strict";Object.defineProperty(Pw,"__esModule",{value:!0});Pw.StatusBuilder=void 0;var g$=class{constructor(){this.code=null,this.details=null,this.metadata=null}withCode(e){return this.code=e,this}withDetails(e){return this.details=e,this}withMetadata(e){return this.metadata=e,this}build(){let e={};return this.code!==null&&(e.code=this.code),this.details!==null&&(e.details=this.details),this.metadata!==null&&(e.metadata=this.metadata),e}};Pw.StatusBuilder=g$});var y$=m(uu=>{"use strict";Object.defineProperty(uu,"__esModule",{value:!0});uu.isDuration=uu.durationToMs=uu.msToDuration=void 0;function g4e(t){return{seconds:t/1e3|0,nanos:t%1e3*1e6|0}}uu.msToDuration=g4e;function y4e(t){return t.seconds*1e3+t.nanos/1e6|0}uu.durationToMs=y4e;function v4e(t){return typeof t.seconds=="number"&&typeof t.nanos=="number"}uu.isDuration=v4e});var Aw=m(ii=>{"use strict";Object.defineProperty(ii,"__esModule",{value:!0});ii.setup=ii.LeafLoadBalancer=ii.PickFirstLoadBalancer=ii.shuffled=ii.PickFirstLoadBalancingConfig=void 0;var _$=Nc(),Pr=Qn(),Yh=Hl(),_4e=er(),S4e=ft(),Oee=Ai(),Pee=require("net"),b4e="pick_first";function v$(t){_4e.trace(S4e.LogVerbosity.DEBUG,b4e,t)}var Oy="pick_first",E4e=250,cu=class{constructor(e){this.shuffleAddressList=e}getLoadBalancerName(){return Oy}toJsonObject(){return{[Oy]:{shuffleAddressList:this.shuffleAddressList}}}getShuffleAddressList(){return this.shuffleAddressList}static createFromJson(e){if("shuffleAddressList"in e&&typeof e.shuffleAddressList!="boolean")throw new Error("pick_first config field shuffleAddressList must be a boolean if provided");return new cu(e.shuffleAddressList===!0)}};ii.PickFirstLoadBalancingConfig=cu;var S$=class{constructor(e){this.subchannel=e}pick(e){return{pickResultType:Yh.PickResultType.COMPLETE,subchannel:this.subchannel,status:null,onCallStarted:null,onCallEnded:null}}};function Aee(t){let e=t.slice();for(let r=e.length-1;r>1;r--){let s=Math.floor(Math.random()*(r+1)),n=e[r];e[r]=e[s],e[s]=n}return e}ii.shuffled=Aee;function w4e(t){let e=[],r=[],s=[],n=(0,Oee.isTcpSubchannelAddress)(t[0])&&(0,Pee.isIPv6)(t[0].host);for(let a of t)(0,Oee.isTcpSubchannelAddress)(a)&&(0,Pee.isIPv6)(a.host)?r.push(a):s.push(a);let i=n?r:s,o=n?s:r;for(let a=0;a<Math.max(i.length,o.length);a++)a<i.length&&e.push(i[a]),a<o.length&&e.push(o[a]);return e}var kee="grpc-node.internal.pick-first.report_health_status",Py=class{constructor(e,r){this.channelControlHelper=e,this.children=[],this.currentState=Pr.ConnectivityState.IDLE,this.currentSubchannelIndex=0,this.currentPick=null,this.subchannelStateListener=(s,n,i,o,a)=>{this.onSubchannelStateUpdate(s,n,i,a)},this.pickedSubchannelHealthListener=()=>this.calculateAndReportNewState(),this.triedAllSubchannels=!1,this.stickyTransientFailureMode=!1,this.requestedResolutionSinceLastUpdate=!1,this.lastError=null,this.latestAddressList=null,this.connectionDelayTimeout=setTimeout(()=>{},0),clearTimeout(this.connectionDelayTimeout),this.reportHealthStatus=r[kee]}allChildrenHaveReportedTF(){return this.children.every(e=>e.hasReportedTransientFailure)}calculateAndReportNewState(){this.currentPick?this.reportHealthStatus&&!this.currentPick.isHealthy()?this.updateState(Pr.ConnectivityState.TRANSIENT_FAILURE,new Yh.UnavailablePicker({details:`Picked subchannel ${this.currentPick.getAddress()} is unhealthy`})):this.updateState(Pr.ConnectivityState.READY,new S$(this.currentPick)):this.children.length===0?this.updateState(Pr.ConnectivityState.IDLE,new Yh.QueuePicker(this)):this.stickyTransientFailureMode?this.updateState(Pr.ConnectivityState.TRANSIENT_FAILURE,new Yh.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(Pr.ConnectivityState.CONNECTING,new Yh.QueuePicker(this))}requestReresolution(){this.requestedResolutionSinceLastUpdate=!0,this.channelControlHelper.requestReresolution()}maybeEnterStickyTransientFailureMode(){if(this.allChildrenHaveReportedTF()&&(this.requestedResolutionSinceLastUpdate||this.requestReresolution(),!this.stickyTransientFailureMode)){this.stickyTransientFailureMode=!0;for(let{subchannel:e}of this.children)e.startConnecting();this.calculateAndReportNewState()}}removeCurrentPick(){if(this.currentPick!==null){let e=this.currentPick;this.currentPick=null,e.unref(),e.removeConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.removeChannelzChild(e.getChannelzRef()),this.reportHealthStatus&&e.removeHealthStateWatcher(this.pickedSubchannelHealthListener)}}onSubchannelStateUpdate(e,r,s,n){var i;if(!((i=this.currentPick)===null||i===void 0)&&i.realSubchannelEquals(e)){s!==Pr.ConnectivityState.READY&&(this.removeCurrentPick(),this.calculateAndReportNewState(),this.requestReresolution());return}for(let[o,a]of this.children.entries())if(e.realSubchannelEquals(a.subchannel)){s===Pr.ConnectivityState.READY&&this.pickSubchannel(a.subchannel),s===Pr.ConnectivityState.TRANSIENT_FAILURE&&(a.hasReportedTransientFailure=!0,n&&(this.lastError=n),this.maybeEnterStickyTransientFailureMode(),o===this.currentSubchannelIndex&&this.startNextSubchannelConnecting(o+1)),a.subchannel.startConnecting();return}}startNextSubchannelConnecting(e){if(clearTimeout(this.connectionDelayTimeout),!this.triedAllSubchannels){for(let[r,s]of this.children.entries())if(r>=e){let n=s.subchannel.getConnectivityState();if(n===Pr.ConnectivityState.IDLE||n===Pr.ConnectivityState.CONNECTING){this.startConnecting(r);return}}this.triedAllSubchannels=!0,this.maybeEnterStickyTransientFailureMode()}}startConnecting(e){var r,s;clearTimeout(this.connectionDelayTimeout),this.currentSubchannelIndex=e,this.children[e].subchannel.getConnectivityState()===Pr.ConnectivityState.IDLE&&(v$("Start connecting to subchannel with address "+this.children[e].subchannel.getAddress()),process.nextTick(()=>{var n;(n=this.children[e])===null||n===void 0||n.subchannel.startConnecting()})),this.connectionDelayTimeout=setTimeout(()=>{this.startNextSubchannelConnecting(e+1)},E4e),(s=(r=this.connectionDelayTimeout).unref)===null||s===void 0||s.call(r)}pickSubchannel(e){this.currentPick&&e.realSubchannelEquals(this.currentPick)||(v$("Pick subchannel with address "+e.getAddress()),this.stickyTransientFailureMode=!1,this.removeCurrentPick(),this.currentPick=e,e.ref(),this.reportHealthStatus&&e.addHealthStateWatcher(this.pickedSubchannelHealthListener),this.channelControlHelper.addChannelzChild(e.getChannelzRef()),this.resetSubchannelList(),clearTimeout(this.connectionDelayTimeout),this.calculateAndReportNewState())}updateState(e,r){v$(Pr.ConnectivityState[this.currentState]+" -> "+Pr.ConnectivityState[e]),this.currentState=e,this.channelControlHelper.updateState(e,r)}resetSubchannelList(){for(let e of this.children)this.currentPick&&e.subchannel.realSubchannelEquals(this.currentPick)||e.subchannel.removeConnectivityStateListener(this.subchannelStateListener),e.subchannel.unref(),this.channelControlHelper.removeChannelzChild(e.subchannel.getChannelzRef());this.currentSubchannelIndex=0,this.children=[],this.triedAllSubchannels=!1,this.requestedResolutionSinceLastUpdate=!1}connectToAddressList(e){let r=e.map(s=>({subchannel:this.channelControlHelper.createSubchannel(s,{}),hasReportedTransientFailure:!1}));for(let{subchannel:s}of r)s.ref(),this.channelControlHelper.addChannelzChild(s.getChannelzRef());this.resetSubchannelList(),this.children=r;for(let{subchannel:s}of this.children)if(s.addConnectivityStateListener(this.subchannelStateListener),s.getConnectivityState()===Pr.ConnectivityState.READY){this.pickSubchannel(s);return}for(let s of this.children)s.subchannel.getConnectivityState()===Pr.ConnectivityState.TRANSIENT_FAILURE&&(s.hasReportedTransientFailure=!0);this.startNextSubchannelConnecting(0),this.calculateAndReportNewState()}updateAddressList(e,r){if(!(r instanceof cu))return;r.getShuffleAddressList()&&(e=Aee(e));let s=[].concat(...e.map(i=>i.addresses));if(s.length===0)throw new Error("No addresses in endpoint list passed to pick_first");let n=w4e(s);this.latestAddressList=n,this.connectToAddressList(n)}exitIdle(){this.currentState===Pr.ConnectivityState.IDLE&&this.latestAddressList&&this.connectToAddressList(this.latestAddressList)}resetBackoff(){}destroy(){this.resetSubchannelList(),this.removeCurrentPick()}getTypeName(){return Oy}};ii.PickFirstLoadBalancer=Py;var T4e=new cu(!1),b$=class{constructor(e,r,s){this.endpoint=e,this.latestState=Pr.ConnectivityState.IDLE;let n=(0,_$.createChildChannelControlHelper)(r,{updateState:(i,o)=>{this.latestState=i,this.latestPicker=o,r.updateState(i,o)}});this.pickFirstBalancer=new Py(n,Object.assign(Object.assign({},s),{[kee]:!0})),this.latestPicker=new Yh.QueuePicker(this.pickFirstBalancer)}startConnecting(){this.pickFirstBalancer.updateAddressList([this.endpoint],T4e)}updateEndpoint(e){this.endpoint=e,this.latestState!==Pr.ConnectivityState.IDLE&&this.startConnecting()}getConnectivityState(){return this.latestState}getPicker(){return this.latestPicker}getEndpoint(){return this.endpoint}exitIdle(){this.pickFirstBalancer.exitIdle()}destroy(){this.pickFirstBalancer.destroy()}};ii.LeafLoadBalancer=b$;function C4e(){(0,_$.registerLoadBalancerType)(Oy,Py,cu),(0,_$.registerDefaultLoadBalancerType)(Oy)}ii.setup=C4e});var w$=m(Ce=>{"use strict";Object.defineProperty(Ce,"__esModule",{value:!0});Ce.BaseSubchannelWrapper=Ce.registerAdminService=Ce.FilterStackFactory=Ce.BaseFilter=Ce.PickResultType=Ce.QueuePicker=Ce.UnavailablePicker=Ce.ChildLoadBalancerHandler=Ce.EndpointMap=Ce.endpointHasAddress=Ce.endpointToString=Ce.subchannelAddressToString=Ce.LeafLoadBalancer=Ce.isLoadBalancerNameRegistered=Ce.parseLoadBalancingConfig=Ce.selectLbConfigFromList=Ce.registerLoadBalancerType=Ce.createChildChannelControlHelper=Ce.BackoffTimeout=Ce.durationToMs=Ce.uriToString=Ce.createResolver=Ce.registerResolver=Ce.log=Ce.trace=void 0;var xee=er();Object.defineProperty(Ce,"trace",{enumerable:!0,get:function(){return xee.trace}});Object.defineProperty(Ce,"log",{enumerable:!0,get:function(){return xee.log}});var Iee=Eo();Object.defineProperty(Ce,"registerResolver",{enumerable:!0,get:function(){return Iee.registerResolver}});Object.defineProperty(Ce,"createResolver",{enumerable:!0,get:function(){return Iee.createResolver}});var R4e=hn();Object.defineProperty(Ce,"uriToString",{enumerable:!0,get:function(){return R4e.uriToString}});var O4e=y$();Object.defineProperty(Ce,"durationToMs",{enumerable:!0,get:function(){return O4e.durationToMs}});var P4e=Qg();Object.defineProperty(Ce,"BackoffTimeout",{enumerable:!0,get:function(){return P4e.BackoffTimeout}});var Ay=Nc();Object.defineProperty(Ce,"createChildChannelControlHelper",{enumerable:!0,get:function(){return Ay.createChildChannelControlHelper}});Object.defineProperty(Ce,"registerLoadBalancerType",{enumerable:!0,get:function(){return Ay.registerLoadBalancerType}});Object.defineProperty(Ce,"selectLbConfigFromList",{enumerable:!0,get:function(){return Ay.selectLbConfigFromList}});Object.defineProperty(Ce,"parseLoadBalancingConfig",{enumerable:!0,get:function(){return Ay.parseLoadBalancingConfig}});Object.defineProperty(Ce,"isLoadBalancerNameRegistered",{enumerable:!0,get:function(){return Ay.isLoadBalancerNameRegistered}});var A4e=Aw();Object.defineProperty(Ce,"LeafLoadBalancer",{enumerable:!0,get:function(){return A4e.LeafLoadBalancer}});var kw=Ai();Object.defineProperty(Ce,"subchannelAddressToString",{enumerable:!0,get:function(){return kw.subchannelAddressToString}});Object.defineProperty(Ce,"endpointToString",{enumerable:!0,get:function(){return kw.endpointToString}});Object.defineProperty(Ce,"endpointHasAddress",{enumerable:!0,get:function(){return kw.endpointHasAddress}});Object.defineProperty(Ce,"EndpointMap",{enumerable:!0,get:function(){return kw.EndpointMap}});var k4e=lE();Object.defineProperty(Ce,"ChildLoadBalancerHandler",{enumerable:!0,get:function(){return k4e.ChildLoadBalancerHandler}});var E$=Hl();Object.defineProperty(Ce,"UnavailablePicker",{enumerable:!0,get:function(){return E$.UnavailablePicker}});Object.defineProperty(Ce,"QueuePicker",{enumerable:!0,get:function(){return E$.QueuePicker}});Object.defineProperty(Ce,"PickResultType",{enumerable:!0,get:function(){return E$.PickResultType}});var x4e=DM();Object.defineProperty(Ce,"BaseFilter",{enumerable:!0,get:function(){return x4e.BaseFilter}});var I4e=xM();Object.defineProperty(Ce,"FilterStackFactory",{enumerable:!0,get:function(){return I4e.FilterStackFactory}});var N4e=fE();Object.defineProperty(Ce,"registerAdminService",{enumerable:!0,get:function(){return N4e.registerAdminService}});var D4e=vw();Object.defineProperty(Ce,"BaseSubchannelWrapper",{enumerable:!0,get:function(){return D4e.BaseSubchannelWrapper}})});var Nee=m(xw=>{"use strict";Object.defineProperty(xw,"__esModule",{value:!0});xw.setup=void 0;var M4e=Eo(),T$=class{constructor(e,r,s){this.listener=r,this.hasReturnedResult=!1,this.endpoints=[];let n;e.authority===""?n="/"+e.path:n=e.path,this.endpoints=[{addresses:[{path:n}]}]}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(this.listener.onSuccessfulResolution,this.endpoints,null,null,null,{}))}destroy(){this.hasReturnedResult=!1}static getDefaultAuthority(e){return"localhost"}};function $4e(){(0,M4e.registerResolver)("unix",T$)}xw.setup=$4e});var Lee=m(Dw=>{"use strict";Object.defineProperty(Dw,"__esModule",{value:!0});Dw.setup=void 0;var Dee=require("net"),Iw=ft(),C$=As(),Mee=Eo(),$ee=hn(),q4e=er(),L4e="ip_resolver";function qee(t){q4e.trace(Iw.LogVerbosity.DEBUG,L4e,t)}var R$="ipv4",O$="ipv6",j4e=443,Nw=class{constructor(e,r,s){var n;this.listener=r,this.endpoints=[],this.error=null,this.hasReturnedResult=!1,qee("Resolver constructed for target "+(0,$ee.uriToString)(e));let i=[];if(!(e.scheme===R$||e.scheme===O$)){this.error={code:Iw.Status.UNAVAILABLE,details:`Unrecognized scheme ${e.scheme} in IP resolver`,metadata:new C$.Metadata};return}let o=e.path.split(",");for(let a of o){let l=(0,$ee.splitHostPort)(a);if(l===null){this.error={code:Iw.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${a}`,metadata:new C$.Metadata};return}if(e.scheme===R$&&!(0,Dee.isIPv4)(l.host)||e.scheme===O$&&!(0,Dee.isIPv6)(l.host)){this.error={code:Iw.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${a}`,metadata:new C$.Metadata};return}i.push({host:l.host,port:(n=l.port)!==null&&n!==void 0?n:j4e})}this.endpoints=i.map(a=>({addresses:[a]})),qee("Parsed "+e.scheme+" address list "+i)}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(()=>{this.error?this.listener.onError(this.error):this.listener.onSuccessfulResolution(this.endpoints,null,null,null,{})}))}destroy(){this.hasReturnedResult=!1}static getDefaultAuthority(e){return e.path.split(",")[0]}};function F4e(){(0,Mee.registerResolver)(R$,Nw),(0,Mee.registerResolver)(O$,Nw)}Dw.setup=F4e});var zee=m(Jh=>{"use strict";Object.defineProperty(Jh,"__esModule",{value:!0});Jh.setup=Jh.RoundRobinLoadBalancer=void 0;var Bee=Nc(),vn=Qn(),P$=Hl(),B4e=er(),z4e=ft(),jee=Ai(),U4e=Aw(),V4e="round_robin";function Fee(t){B4e.trace(z4e.LogVerbosity.DEBUG,V4e,t)}var Mw="round_robin",ky=class{getLoadBalancerName(){return Mw}constructor(){}toJsonObject(){return{[Mw]:{}}}static createFromJson(e){return new ky}},A$=class{constructor(e,r=0){this.children=e,this.nextIndex=r}pick(e){let r=this.children[this.nextIndex].picker;return this.nextIndex=(this.nextIndex+1)%this.children.length,r.pick(e)}peekNextEndpoint(){return this.children[this.nextIndex].endpoint}},$w=class{constructor(e,r){this.channelControlHelper=e,this.options=r,this.children=[],this.currentState=vn.ConnectivityState.IDLE,this.currentReadyPicker=null,this.updatesPaused=!1,this.lastError=null,this.childChannelControlHelper=(0,Bee.createChildChannelControlHelper)(e,{updateState:(s,n)=>{this.calculateAndUpdateState()}})}countChildrenWithState(e){return this.children.filter(r=>r.getConnectivityState()===e).length}calculateAndUpdateState(){if(!this.updatesPaused){if(this.countChildrenWithState(vn.ConnectivityState.READY)>0){let e=this.children.filter(s=>s.getConnectivityState()===vn.ConnectivityState.READY),r=0;if(this.currentReadyPicker!==null){let s=this.currentReadyPicker.peekNextEndpoint();r=e.findIndex(n=>(0,jee.endpointEqual)(n.getEndpoint(),s)),r<0&&(r=0)}this.updateState(vn.ConnectivityState.READY,new A$(e.map(s=>({endpoint:s.getEndpoint(),picker:s.getPicker()})),r))}else this.countChildrenWithState(vn.ConnectivityState.CONNECTING)>0?this.updateState(vn.ConnectivityState.CONNECTING,new P$.QueuePicker(this)):this.countChildrenWithState(vn.ConnectivityState.TRANSIENT_FAILURE)>0?this.updateState(vn.ConnectivityState.TRANSIENT_FAILURE,new P$.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(vn.ConnectivityState.IDLE,new P$.QueuePicker(this));for(let e of this.children)e.getConnectivityState()===vn.ConnectivityState.IDLE&&e.exitIdle()}}updateState(e,r){Fee(vn.ConnectivityState[this.currentState]+" -> "+vn.ConnectivityState[e]),e===vn.ConnectivityState.READY?this.currentReadyPicker=r:this.currentReadyPicker=null,this.currentState=e,this.channelControlHelper.updateState(e,r)}resetSubchannelList(){for(let e of this.children)e.destroy()}updateAddressList(e,r){this.resetSubchannelList(),Fee("Connect to endpoint list "+e.map(jee.endpointToString)),this.updatesPaused=!0,this.children=e.map(s=>new U4e.LeafLoadBalancer(s,this.childChannelControlHelper,this.options));for(let s of this.children)s.startConnecting();this.updatesPaused=!1,this.calculateAndUpdateState()}exitIdle(){}resetBackoff(){}destroy(){this.resetSubchannelList()}getTypeName(){return Mw}};Jh.RoundRobinLoadBalancer=$w;function H4e(){(0,Bee.registerLoadBalancerType)(Mw,$w,ky)}Jh.setup=H4e});var Hee=m(du=>{"use strict";var k$;Object.defineProperty(du,"__esModule",{value:!0});du.setup=du.OutlierDetectionLoadBalancer=du.OutlierDetectionLoadBalancingConfig=void 0;var G4e=Qn(),Uee=ft(),Kc=y$(),Vee=w$(),K4e=Nc(),Q4e=lE(),W4e=Hl(),x$=Ai(),Z4e=vw(),Y4e=er(),J4e="outlier_detection";function Xr(t){Y4e.trace(Uee.LogVerbosity.DEBUG,J4e,t)}var q$="outlier_detection",X4e=((k$=process.env.GRPC_EXPERIMENTAL_ENABLE_OUTLIER_DETECTION)!==null&&k$!==void 0?k$:"true")==="true",eVe={stdev_factor:1900,enforcement_percentage:100,minimum_hosts:5,request_volume:100},tVe={threshold:85,enforcement_percentage:100,minimum_hosts:5,request_volume:50};function Xh(t,e,r,s){if(e in t&&t[e]!==void 0&&typeof t[e]!==r){let n=s?`${s}.${e}`:e;throw new Error(`outlier detection config ${n} parse error: expected ${r}, got ${typeof t[e]}`)}}function I$(t,e,r){let s=r?`${r}.${e}`:e;if(e in t&&t[e]!==void 0){if(!(0,Kc.isDuration)(t[e]))throw new Error(`outlier detection config ${s} parse error: expected Duration, got ${typeof t[e]}`);if(!(t[e].seconds>=0&&t[e].seconds<=315576e6&&t[e].nanos>=0&&t[e].nanos<=999999999))throw new Error(`outlier detection config ${s} parse error: values out of range for non-negative Duaration`)}}function qw(t,e,r){let s=r?`${r}.${e}`:e;if(Xh(t,e,"number",r),e in t&&t[e]!==void 0&&!(t[e]>=0&&t[e]<=100))throw new Error(`outlier detection config ${s} parse error: value out of range for percentage (0-100)`)}var Qc=class{constructor(e,r,s,n,i,o,a){if(this.childPolicy=a,a.getLoadBalancerName()==="pick_first")throw new Error("outlier_detection LB policy cannot have a pick_first child policy");this.intervalMs=e??1e4,this.baseEjectionTimeMs=r??3e4,this.maxEjectionTimeMs=s??3e5,this.maxEjectionPercent=n??10,this.successRateEjection=i?Object.assign(Object.assign({},eVe),i):null,this.failurePercentageEjection=o?Object.assign(Object.assign({},tVe),o):null}getLoadBalancerName(){return q$}toJsonObject(){var e,r;return{outlier_detection:{interval:(0,Kc.msToDuration)(this.intervalMs),base_ejection_time:(0,Kc.msToDuration)(this.baseEjectionTimeMs),max_ejection_time:(0,Kc.msToDuration)(this.maxEjectionTimeMs),max_ejection_percent:this.maxEjectionPercent,success_rate_ejection:(e=this.successRateEjection)!==null&&e!==void 0?e:void 0,failure_percentage_ejection:(r=this.failurePercentageEjection)!==null&&r!==void 0?r:void 0,child_policy:[this.childPolicy.toJsonObject()]}}}getIntervalMs(){return this.intervalMs}getBaseEjectionTimeMs(){return this.baseEjectionTimeMs}getMaxEjectionTimeMs(){return this.maxEjectionTimeMs}getMaxEjectionPercent(){return this.maxEjectionPercent}getSuccessRateEjectionConfig(){return this.successRateEjection}getFailurePercentageEjectionConfig(){return this.failurePercentageEjection}getChildPolicy(){return this.childPolicy}static createFromJson(e){var r;if(I$(e,"interval"),I$(e,"base_ejection_time"),I$(e,"max_ejection_time"),qw(e,"max_ejection_percent"),"success_rate_ejection"in e&&e.success_rate_ejection!==void 0){if(typeof e.success_rate_ejection!="object")throw new Error("outlier detection config success_rate_ejection must be an object");Xh(e.success_rate_ejection,"stdev_factor","number","success_rate_ejection"),qw(e.success_rate_ejection,"enforcement_percentage","success_rate_ejection"),Xh(e.success_rate_ejection,"minimum_hosts","number","success_rate_ejection"),Xh(e.success_rate_ejection,"request_volume","number","success_rate_ejection")}if("failure_percentage_ejection"in e&&e.failure_percentage_ejection!==void 0){if(typeof e.failure_percentage_ejection!="object")throw new Error("outlier detection config failure_percentage_ejection must be an object");qw(e.failure_percentage_ejection,"threshold","failure_percentage_ejection"),qw(e.failure_percentage_ejection,"enforcement_percentage","failure_percentage_ejection"),Xh(e.failure_percentage_ejection,"minimum_hosts","number","failure_percentage_ejection"),Xh(e.failure_percentage_ejection,"request_volume","number","failure_percentage_ejection")}if(!("child_policy"in e)||!Array.isArray(e.child_policy))throw new Error("outlier detection config child_policy must be an array");let s=(0,K4e.selectLbConfigFromList)(e.child_policy);if(!s)throw new Error("outlier detection config child_policy: no valid recognized policy found");return new Qc(e.interval?(0,Kc.durationToMs)(e.interval):null,e.base_ejection_time?(0,Kc.durationToMs)(e.base_ejection_time):null,e.max_ejection_time?(0,Kc.durationToMs)(e.max_ejection_time):null,(r=e.max_ejection_percent)!==null&&r!==void 0?r:null,e.success_rate_ejection,e.failure_percentage_ejection,s)}};du.OutlierDetectionLoadBalancingConfig=Qc;var D$=class extends Z4e.BaseSubchannelWrapper{constructor(e,r){super(e),this.mapEntry=r,this.refCount=0}ref(){this.child.ref(),this.refCount+=1}unref(){if(this.child.unref(),this.refCount-=1,this.refCount<=0&&this.mapEntry){let e=this.mapEntry.subchannelWrappers.indexOf(this);e>=0&&this.mapEntry.subchannelWrappers.splice(e,1)}}eject(){this.setHealthy(!1)}uneject(){this.setHealthy(!0)}getMapEntry(){return this.mapEntry}getWrappedSubchannel(){return this.child}};function N$(){return{success:0,failure:0}}var M$=class{constructor(){this.activeBucket=N$(),this.inactiveBucket=N$()}addSuccess(){this.activeBucket.success+=1}addFailure(){this.activeBucket.failure+=1}switchBuckets(){this.inactiveBucket=this.activeBucket,this.activeBucket=N$()}getLastSuccesses(){return this.inactiveBucket.success}getLastFailures(){return this.inactiveBucket.failure}},$$=class{constructor(e,r){this.wrappedPicker=e,this.countCalls=r}pick(e){let r=this.wrappedPicker.pick(e);if(r.pickResultType===W4e.PickResultType.COMPLETE){let s=r.subchannel,n=s.getMapEntry();if(n){let i=r.onCallEnded;return this.countCalls&&(i=o=>{var a;o===Uee.Status.OK?n.counter.addSuccess():n.counter.addFailure(),(a=r.onCallEnded)===null||a===void 0||a.call(r,o)}),Object.assign(Object.assign({},r),{subchannel:s.getWrappedSubchannel(),onCallEnded:i})}else return Object.assign(Object.assign({},r),{subchannel:s.getWrappedSubchannel()})}else return r}},Lw=class{constructor(e,r){this.entryMap=new x$.EndpointMap,this.latestConfig=null,this.timerStartTime=null,this.childBalancer=new Q4e.ChildLoadBalancerHandler((0,Vee.createChildChannelControlHelper)(e,{createSubchannel:(s,n)=>{let i=e.createSubchannel(s,n),o=this.entryMap.getForSubchannelAddress(s),a=new D$(i,o);return o?.currentEjectionTimestamp!==null&&a.eject(),o?.subchannelWrappers.push(a),a},updateState:(s,n)=>{s===G4e.ConnectivityState.READY?e.updateState(s,new $$(n,this.isCountingEnabled())):e.updateState(s,n)}}),r),this.ejectionTimer=setInterval(()=>{},0),clearInterval(this.ejectionTimer)}isCountingEnabled(){return this.latestConfig!==null&&(this.latestConfig.getSuccessRateEjectionConfig()!==null||this.latestConfig.getFailurePercentageEjectionConfig()!==null)}getCurrentEjectionPercent(){let e=0;for(let r of this.entryMap.values())r.currentEjectionTimestamp!==null&&(e+=1);return e*100/this.entryMap.size}runSuccessRateCheck(e){if(!this.latestConfig)return;let r=this.latestConfig.getSuccessRateEjectionConfig();if(!r)return;Xr("Running success rate check");let s=r.request_volume,n=0,i=[];for(let[d,f]of this.entryMap.entries()){let h=f.counter.getLastSuccesses(),p=f.counter.getLastFailures();Xr("Stats for "+(0,x$.endpointToString)(d)+": successes="+h+" failures="+p+" targetRequestVolume="+s),h+p>=s&&(n+=1,i.push(h/(h+p)))}if(Xr("Found "+n+" success rate candidates; currentEjectionPercent="+this.getCurrentEjectionPercent()+" successRates=["+i+"]"),n<r.minimum_hosts)return;let o=i.reduce((d,f)=>d+f)/i.length,a=0;for(let d of i){let f=d-o;a+=f*f}let l=a/i.length,u=Math.sqrt(l),c=o-u*(r.stdev_factor/1e3);Xr("stdev="+u+" ejectionThreshold="+c);for(let[d,f]of this.entryMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let h=f.counter.getLastSuccesses(),p=f.counter.getLastFailures();if(h+p<s)continue;let g=h/(h+p);if(Xr("Checking candidate "+d+" successRate="+g),g<c){let _=Math.random()*100;Xr("Candidate "+d+" randomNumber="+_+" enforcement_percentage="+r.enforcement_percentage),_<r.enforcement_percentage&&(Xr("Ejecting candidate "+d),this.eject(f,e))}}}runFailurePercentageCheck(e){if(!this.latestConfig)return;let r=this.latestConfig.getFailurePercentageEjectionConfig();if(!r)return;Xr("Running failure percentage check. threshold="+r.threshold+" request volume threshold="+r.request_volume);let s=0;for(let n of this.entryMap.values()){let i=n.counter.getLastSuccesses(),o=n.counter.getLastFailures();i+o>=r.request_volume&&(s+=1)}if(!(s<r.minimum_hosts))for(let[n,i]of this.entryMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let o=i.counter.getLastSuccesses(),a=i.counter.getLastFailures();if(Xr("Candidate successes="+o+" failures="+a),o+a<r.request_volume)continue;if(a*100/(a+o)>r.threshold){let u=Math.random()*100;Xr("Candidate "+n+" randomNumber="+u+" enforcement_percentage="+r.enforcement_percentage),u<r.enforcement_percentage&&(Xr("Ejecting candidate "+n),this.eject(i,e))}}}eject(e,r){e.currentEjectionTimestamp=new Date,e.ejectionTimeMultiplier+=1;for(let s of e.subchannelWrappers)s.eject()}uneject(e){e.currentEjectionTimestamp=null;for(let r of e.subchannelWrappers)r.uneject()}switchAllBuckets(){for(let e of this.entryMap.values())e.counter.switchBuckets()}startTimer(e){var r,s;this.ejectionTimer=setTimeout(()=>this.runChecks(),e),(s=(r=this.ejectionTimer).unref)===null||s===void 0||s.call(r)}runChecks(){let e=new Date;if(Xr("Ejection timer running"),this.switchAllBuckets(),!!this.latestConfig){this.timerStartTime=e,this.startTimer(this.latestConfig.getIntervalMs()),this.runSuccessRateCheck(e),this.runFailurePercentageCheck(e);for(let[r,s]of this.entryMap.entries())if(s.currentEjectionTimestamp===null)s.ejectionTimeMultiplier>0&&(s.ejectionTimeMultiplier-=1);else{let n=this.latestConfig.getBaseEjectionTimeMs(),i=this.latestConfig.getMaxEjectionTimeMs(),o=new Date(s.currentEjectionTimestamp.getTime());o.setMilliseconds(o.getMilliseconds()+Math.min(n*s.ejectionTimeMultiplier,Math.max(n,i))),o<new Date&&(Xr("Unejecting "+r),this.uneject(s))}}}updateAddressList(e,r,s){if(!(r instanceof Qc))return;for(let i of e)this.entryMap.has(i)||(Xr("Adding map entry for "+(0,x$.endpointToString)(i)),this.entryMap.set(i,{counter:new M$,currentEjectionTimestamp:null,ejectionTimeMultiplier:0,subchannelWrappers:[]}));this.entryMap.deleteMissing(e);let n=r.getChildPolicy();if(this.childBalancer.updateAddressList(e,n,s),r.getSuccessRateEjectionConfig()||r.getFailurePercentageEjectionConfig())if(this.timerStartTime){Xr("Previous timer existed. Replacing timer"),clearTimeout(this.ejectionTimer);let i=r.getIntervalMs()-(new Date().getTime()-this.timerStartTime.getTime());this.startTimer(i)}else Xr("Starting new timer"),this.timerStartTime=new Date,this.startTimer(r.getIntervalMs()),this.switchAllBuckets();else{Xr("Counting disabled. Cancelling timer."),this.timerStartTime=null,clearTimeout(this.ejectionTimer);for(let i of this.entryMap.values())this.uneject(i),i.ejectionTimeMultiplier=0}this.latestConfig=r}exitIdle(){this.childBalancer.exitIdle()}resetBackoff(){this.childBalancer.resetBackoff()}destroy(){clearTimeout(this.ejectionTimer),this.childBalancer.destroy()}getTypeName(){return q$}};du.OutlierDetectionLoadBalancer=Lw;function rVe(){X4e&&(0,Vee.registerLoadBalancerType)(q$,Lw,Qc)}du.setup=rVe});var Wee=m(ae=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0});ae.experimental=ae.ServerInterceptingCall=ae.ResponderBuilder=ae.ServerListenerBuilder=ae.addAdminServicesToServer=ae.getChannelzHandlers=ae.getChannelzServiceDefinition=ae.InterceptorConfigurationError=ae.InterceptingCall=ae.RequesterBuilder=ae.ListenerBuilder=ae.StatusBuilder=ae.getClientChannel=ae.ServerCredentials=ae.Server=ae.setLogVerbosity=ae.setLogger=ae.load=ae.loadObject=ae.CallCredentials=ae.ChannelCredentials=ae.waitForClientReady=ae.closeClient=ae.Channel=ae.makeGenericClientConstructor=ae.makeClientConstructor=ae.loadPackageDefinition=ae.Client=ae.compressionAlgorithms=ae.propagate=ae.connectivityState=ae.status=ae.logVerbosity=ae.Metadata=ae.credentials=void 0;var jw=_N();Object.defineProperty(ae,"CallCredentials",{enumerable:!0,get:function(){return jw.CallCredentials}});var sVe=sD();Object.defineProperty(ae,"Channel",{enumerable:!0,get:function(){return sVe.ChannelImplementation}});var nVe=IM();Object.defineProperty(ae,"compressionAlgorithms",{enumerable:!0,get:function(){return nVe.CompressionAlgorithms}});var iVe=Qn();Object.defineProperty(ae,"connectivityState",{enumerable:!0,get:function(){return iVe.ConnectivityState}});var Fw=tE();Object.defineProperty(ae,"ChannelCredentials",{enumerable:!0,get:function(){return Fw.ChannelCredentials}});var Gee=rD();Object.defineProperty(ae,"Client",{enumerable:!0,get:function(){return Gee.Client}});var L$=ft();Object.defineProperty(ae,"logVerbosity",{enumerable:!0,get:function(){return L$.LogVerbosity}});Object.defineProperty(ae,"status",{enumerable:!0,get:function(){return L$.Status}});Object.defineProperty(ae,"propagate",{enumerable:!0,get:function(){return L$.Propagate}});var Kee=er(),j$=iD();Object.defineProperty(ae,"loadPackageDefinition",{enumerable:!0,get:function(){return j$.loadPackageDefinition}});Object.defineProperty(ae,"makeClientConstructor",{enumerable:!0,get:function(){return j$.makeClientConstructor}});Object.defineProperty(ae,"makeGenericClientConstructor",{enumerable:!0,get:function(){return j$.makeClientConstructor}});var oVe=As();Object.defineProperty(ae,"Metadata",{enumerable:!0,get:function(){return oVe.Metadata}});var aVe=Cee();Object.defineProperty(ae,"Server",{enumerable:!0,get:function(){return aVe.Server}});var lVe=o$();Object.defineProperty(ae,"ServerCredentials",{enumerable:!0,get:function(){return lVe.ServerCredentials}});var uVe=Ree();Object.defineProperty(ae,"StatusBuilder",{enumerable:!0,get:function(){return uVe.StatusBuilder}});ae.credentials={combineChannelCredentials:(t,...e)=>e.reduce((r,s)=>r.compose(s),t),combineCallCredentials:(t,...e)=>e.reduce((r,s)=>r.compose(s),t),createInsecure:Fw.ChannelCredentials.createInsecure,createSsl:Fw.ChannelCredentials.createSsl,createFromSecureContext:Fw.ChannelCredentials.createFromSecureContext,createFromMetadataGenerator:jw.CallCredentials.createFromMetadataGenerator,createFromGoogleCredential:jw.CallCredentials.createFromGoogleCredential,createEmpty:jw.CallCredentials.createEmpty};var cVe=t=>t.close();ae.closeClient=cVe;var dVe=(t,e,r)=>t.waitForReady(e,r);ae.waitForClientReady=dVe;var fVe=(t,e)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};ae.loadObject=fVe;var hVe=(t,e,r)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};ae.load=hVe;var pVe=t=>{Kee.setLogger(t)};ae.setLogger=pVe;var mVe=t=>{Kee.setLoggerVerbosity(t)};ae.setLogVerbosity=mVe;var gVe=t=>Gee.Client.prototype.getChannel.call(t);ae.getClientChannel=gVe;var Bw=XN();Object.defineProperty(ae,"ListenerBuilder",{enumerable:!0,get:function(){return Bw.ListenerBuilder}});Object.defineProperty(ae,"RequesterBuilder",{enumerable:!0,get:function(){return Bw.RequesterBuilder}});Object.defineProperty(ae,"InterceptingCall",{enumerable:!0,get:function(){return Bw.InterceptingCall}});Object.defineProperty(ae,"InterceptorConfigurationError",{enumerable:!0,get:function(){return Bw.InterceptorConfigurationError}});var Qee=zc();Object.defineProperty(ae,"getChannelzServiceDefinition",{enumerable:!0,get:function(){return Qee.getChannelzServiceDefinition}});Object.defineProperty(ae,"getChannelzHandlers",{enumerable:!0,get:function(){return Qee.getChannelzHandlers}});var yVe=fE();Object.defineProperty(ae,"addAdminServicesToServer",{enumerable:!0,get:function(){return yVe.addAdminServicesToServer}});var F$=h$();Object.defineProperty(ae,"ServerListenerBuilder",{enumerable:!0,get:function(){return F$.ServerListenerBuilder}});Object.defineProperty(ae,"ResponderBuilder",{enumerable:!0,get:function(){return F$.ResponderBuilder}});Object.defineProperty(ae,"ServerInterceptingCall",{enumerable:!0,get:function(){return F$.ServerInterceptingCall}});var vVe=w$();ae.experimental=vVe;var _Ve=bM(),SVe=Nee(),bVe=Lee(),EVe=Aw(),wVe=zee(),TVe=Hee(),CVe=zc();_Ve.setup(),SVe.setup(),bVe.setup(),EVe.setup(),wVe.setup(),TVe.setup(),CVe.setup()});var rte=kr(h5()),ste=kr(sA()),nte=kr(A5()),ite=kr(G5()),ote=kr(tG()),B$=kr(gC()),ate=kr(vG());var ws=Object.freeze({BAD_REQUEST:"Bad request",SUCCESS:"Success",SERVER_INTERNAL:"Server internal",NOT_FOUND:"Server not found",ACCESS_DENIED:"Access denied"});var nl=class extends Error{constructor(e){super(ws.BAD_REQUEST),this.stack=e,Object.setPrototypeOf(this,nl.prototype)}},il=class extends Error{constructor(){super(ws.NOT_FOUND),Object.setPrototypeOf(this,il.prototype)}},af=class extends Error{constructor(e){super(e??ws.SERVER_INTERNAL),Object.setPrototypeOf(this,af.prototype)}},ol=class extends Error{constructor(e){super(e??ws.BAD_REQUEST),Object.setPrototypeOf(this,ol.prototype)}},al=class extends Error{constructor(){super(ws.ACCESS_DENIED),Object.setPrototypeOf(this,al.prototype)}};var _G=async t=>{t.route({method:"GET",url:"/",handler:function(){return{data:"head check null"}}}),t.route({method:"GET",url:"/error-bad-request",handler:function(){throw new ol("id not found")}}),t.route({method:"GET",url:"/error-access",handler:function(){throw new al}}),t.route({method:"GET",url:"/error-server-internal",handler:function(){throw new af}}),t.route({method:"GET",url:"/error-not-found",handler:function(){throw new il}})};var SG={type:"object",required:["PORT","JWT_SECRET","COOKIE_SECRET","NODE_ENV","PORT_POSTGRES","USER_POSTGRES","PASSWORD_POSTGRES","DATABASE_POSTGRES","SCHEMA_POSTGRES","HOST_POSTGRES","SYNCHRONIZE_POSTGRES","REDIS_CLIENT","REDIS_PORT","REDIS_USER","REDIS_PASSWORD"],properties:{PORT:{type:"number"},GRPC_SERVER:{type:"string"},GRPC_CLIENT_USER:{type:"string"},JWT_SECRET:{type:"string"},COOKIE_SECRET:{type:"string"},NODE_ENV:{type:"string"},PORT_POSTGRES:{type:"number"},USER_POSTGRES:{type:"string"},PASSWORD_POSTGRES:{type:"string"},DATABASE_POSTGRES:{type:"string"},SCHEMA_POSTGRES:{type:"string"},HOST_POSTGRES:{type:"string"},SYNCHRONIZE_POSTGRES:{type:"number"},REDIS_CLIENT:{type:"string"},REDIS_PORT:{type:"number"},REDIS_USER:{type:"string"},REDIS_PASSWORD:{type:"string"}}};var Kw=kr(u8());var ot;(function(t){t.assertEqual=n=>n;function e(n){}t.assertIs=e;function r(n){throw new Error}t.assertNever=r,t.arrayToEnum=n=>{let i={};for(let o of n)i[o]=o;return i},t.getValidEnumValues=n=>{let i=t.objectKeys(n).filter(a=>typeof n[n[a]]!="number"),o={};for(let a of i)o[a]=n[a];return t.objectValues(o)},t.objectValues=n=>t.objectKeys(n).map(function(i){return n[i]}),t.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{let i=[];for(let o in n)Object.prototype.hasOwnProperty.call(n,o)&&i.push(o);return i},t.find=(n,i)=>{for(let o of n)if(i(o))return o},t.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&isFinite(n)&&Math.floor(n)===n;function s(n,i=" | "){return n.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}t.joinValues=s,t.jsonStringifyReplacer=(n,i)=>typeof i=="bigint"?i.toString():i})(ot||(ot={}));var ck;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(ck||(ck={}));var de=ot.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ml=t=>{switch(typeof t){case"undefined":return de.undefined;case"string":return de.string;case"number":return isNaN(t)?de.nan:de.number;case"boolean":return de.boolean;case"function":return de.function;case"bigint":return de.bigint;case"symbol":return de.symbol;case"object":return Array.isArray(t)?de.array:t===null?de.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?de.promise:typeof Map<"u"&&t instanceof Map?de.map:typeof Set<"u"&&t instanceof Set?de.set:typeof Date<"u"&&t instanceof Date?de.date:de.object;default:return de.unknown}},ee=ot.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),RAe=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),Wr=class extends Error{constructor(e){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){let r=e||function(i){return i.message},s={_errors:[]},n=i=>{for(let o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(n);else if(o.code==="invalid_return_type")n(o.returnTypeError);else if(o.code==="invalid_arguments")n(o.argumentsError);else if(o.path.length===0)s._errors.push(r(o));else{let a=s,l=0;for(;l<o.path.length;){let u=o.path[l];l===o.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(r(o))):a[u]=a[u]||{_errors:[]},a=a[u],l++}}};return n(this),s}static assert(e){if(!(e instanceof Wr))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,ot.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},s=[];for(let n of this.issues)n.path.length>0?(r[n.path[0]]=r[n.path[0]]||[],r[n.path[0]].push(e(n))):s.push(e(n));return{formErrors:s,fieldErrors:r}}get formErrors(){return this.flatten()}};Wr.create=t=>new Wr(t);var _f=(t,e)=>{let r;switch(t.code){case ee.invalid_type:t.received===de.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case ee.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,ot.jsonStringifyReplacer)}`;break;case ee.unrecognized_keys:r=`Unrecognized key(s) in object: ${ot.joinValues(t.keys,", ")}`;break;case ee.invalid_union:r="Invalid input";break;case ee.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${ot.joinValues(t.options)}`;break;case ee.invalid_enum_value:r=`Invalid enum value. Expected ${ot.joinValues(t.options)}, received '${t.received}'`;break;case ee.invalid_arguments:r="Invalid function arguments";break;case ee.invalid_return_type:r="Invalid function return type";break;case ee.invalid_date:r="Invalid date";break;case ee.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:ot.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case ee.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case ee.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case ee.custom:r="Invalid input";break;case ee.invalid_intersection_types:r="Intersection results could not be merged";break;case ee.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case ee.not_finite:r="Number must be finite";break;default:r=e.defaultError,ot.assertNever(t)}return{message:r}},f8=_f;function OAe(t){f8=t}function SS(){return f8}var bS=t=>{let{data:e,path:r,errorMaps:s,issueData:n}=t,i=[...r,...n.path||[]],o={...n,path:i};if(n.message!==void 0)return{...n,path:i,message:n.message};let a="",l=s.filter(u=>!!u).slice().reverse();for(let u of l)a=u(o,{data:e,defaultError:a}).message;return{...n,path:i,message:a}},PAe=[];function oe(t,e){let r=SS(),s=bS({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===_f?void 0:_f].filter(n=>!!n)});t.common.issues.push(s)}var Nr=class{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){let s=[];for(let n of r){if(n.status==="aborted")return Ae;n.status==="dirty"&&e.dirty(),s.push(n.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,r){let s=[];for(let n of r){let i=await n.key,o=await n.value;s.push({key:i,value:o})}return Nr.mergeObjectSync(e,s)}static mergeObjectSync(e,r){let s={};for(let n of r){let{key:i,value:o}=n;if(i.status==="aborted"||o.status==="aborted")return Ae;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||n.alwaysSet)&&(s[i.value]=o.value)}return{status:e.value,value:s}}},Ae=Object.freeze({status:"aborted"}),vf=t=>({status:"dirty",value:t}),Ts=t=>({status:"valid",value:t}),dk=t=>t.status==="aborted",fk=t=>t.status==="dirty",Jm=t=>t.status==="valid",Xm=t=>typeof Promise<"u"&&t instanceof Promise;function ES(t,e,r,s){if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?s:r==="a"?s.call(t):s?s.value:e.get(t)}function h8(t,e,r,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(t,r):n?n.value=r:e.set(t,r),r}var be;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(be||(be={}));var Zm,Ym,jn=class{constructor(e,r,s,n){this._cachedPath=[],this.parent=e,this.data=r,this._path=s,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},c8=(t,e)=>{if(Jm(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let r=new Wr(t.common.issues);return this._error=r,this._error}}};function Le(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:s,description:n}=t;if(e&&(r||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:n}:{errorMap:(o,a)=>{var l,u;let{message:c}=t;return o.code==="invalid_enum_value"?{message:c??a.defaultError}:typeof a.data>"u"?{message:(l=c??s)!==null&&l!==void 0?l:a.defaultError}:o.code!=="invalid_type"?{message:a.defaultError}:{message:(u=c??r)!==null&&u!==void 0?u:a.defaultError}},description:n}}var je=class{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return ml(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:ml(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Nr,ctx:{common:e.parent.common,data:e.data,parsedType:ml(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(Xm(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let s=this.safeParse(e,r);if(s.success)return s.data;throw s.error}safeParse(e,r){var s;let n={common:{issues:[],async:(s=r?.async)!==null&&s!==void 0?s:!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ml(e)},i=this._parseSync({data:e,path:n.path,parent:n});return c8(n,i)}async parseAsync(e,r){let s=await this.safeParseAsync(e,r);if(s.success)return s.data;throw s.error}async safeParseAsync(e,r){let s={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ml(e)},n=this._parse({data:e,path:s.path,parent:s}),i=await(Xm(n)?n:Promise.resolve(n));return c8(s,i)}refine(e,r){let s=n=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(n):r;return this._refinement((n,i)=>{let o=e(n),a=()=>i.addIssue({code:ee.custom,...s(n)});return typeof Promise<"u"&&o instanceof Promise?o.then(l=>l?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,r){return this._refinement((s,n)=>e(s)?!0:(n.addIssue(typeof r=="function"?r(s,n):r),!1))}_refinement(e){return new un({schema:this,typeName:Oe.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Ln.create(this,this._def)}nullable(){return mo.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ln.create(this,this._def)}promise(){return vl.create(this,this._def)}or(e){return dc.create([this,e],this._def)}and(e){return fc.create(this,e,this._def)}transform(e){return new un({...Le(this._def),schema:this,typeName:Oe.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let r=typeof e=="function"?e:()=>e;return new yc({...Le(this._def),innerType:this,defaultValue:r,typeName:Oe.ZodDefault})}brand(){return new eg({typeName:Oe.ZodBranded,type:this,...Le(this._def)})}catch(e){let r=typeof e=="function"?e:()=>e;return new vc({...Le(this._def),innerType:this,catchValue:r,typeName:Oe.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return _c.create(this,e)}readonly(){return Sc.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},AAe=/^c[^\s-]{8,}$/i,kAe=/^[0-9a-z]+$/,xAe=/^[0-9A-HJKMNP-TV-Z]{26}$/,IAe=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,NAe=/^[a-z0-9_-]{21}$/i,DAe=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,MAe=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,$Ae="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",uk,qAe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,LAe=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,jAe=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,p8="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",FAe=new RegExp(`^${p8}$`);function m8(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function BAe(t){return new RegExp(`^${m8(t)}$`)}function g8(t){let e=`${p8}T${m8(t)}`,r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function zAe(t,e){return!!((e==="v4"||!e)&&qAe.test(t)||(e==="v6"||!e)&&LAe.test(t))}var an=class extends je{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==de.string){let i=this._getOrReturnCtx(e);return oe(i,{code:ee.invalid_type,expected:de.string,received:i.parsedType}),Ae}let s=new Nr,n;for(let i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(n=this._getOrReturnCtx(e,n),oe(n,{code:ee.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),s.dirty());else if(i.kind==="max")e.data.length>i.value&&(n=this._getOrReturnCtx(e,n),oe(n,{code:ee.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),s.dirty());else if(i.kind==="length"){let o=e.data.length>i.value,a=e.data.length<i.value;(o||a)&&(n=this._getOrReturnCtx(e,n),o?oe(n,{code:ee.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):a&&oe(n,{code:ee.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),s.dirty())}else if(i.kind==="email")MAe.test(e.data)||(n=this._getOrReturnCtx(e,n),oe(n,{validation:"email",code:ee.invalid_string,message:i.message}),s.dirty());else if(i.kind==="emoji")uk||(uk=new RegExp($Ae,"u")),uk.test(e.data)||(n=this._getOrReturnCtx(e,n),oe(n,{validation:"emoji",code:ee.invalid_string,message:i.message}),s.dirty());else if(i.kind==="uuid")IAe.test(e.data)||(n=this._getOrReturnCtx(e,n),oe(n,{validation:"uuid",code:ee.invalid_string,message:i.message}),s.dirty());else if(i.kind==="nanoid")NAe.test(e.data)||(n=this._getOrReturnCtx(e,n),oe(n,{validation:"nanoid",code:ee.invalid_string,message:i.message}),s.dirty());else if(i.kind==="cuid")AAe.test(e.data)||(n=this._getOrReturnCtx(e,n),oe(n,{validation:"cuid",code:ee.invalid_string,message:i.message}),s.dirty());else if(i.kind==="cuid2")kAe.test(e.data)||(n=this._getOrReturnCtx(e,n),oe(n,{validation:"cuid2",code:ee.invalid_string,message:i.message}),s.dirty());else if(i.kind==="ulid")xAe.test(e.data)||(n=this._getOrReturnCtx(e,n),oe(n,{validation:"ulid",code:ee.invalid_string,message:i.message}),s.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{n=this._getOrReturnCtx(e,n),oe(n,{validation:"url",code:ee.invalid_string,message:i.message}),s.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(n=this._getOrReturnCtx(e,n),oe(n,{validation:"regex",code:ee.invalid_string,message:i.message}),s.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(n=this._getOrReturnCtx(e,n),oe(n,{code:ee.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),s.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(n=this._getOrReturnCtx(e,n),oe(n,{code:ee.invalid_string,validation:{startsWith:i.value},message:i.message}),s.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(n=this._getOrReturnCtx(e,n),oe(n,{code:ee.invalid_string,validation:{endsWith:i.value},message:i.message}),s.dirty()):i.kind==="datetime"?g8(i).test(e.data)||(n=this._getOrReturnCtx(e,n),oe(n,{code:ee.invalid_string,validation:"datetime",message:i.message}),s.dirty()):i.kind==="date"?FAe.test(e.data)||(n=this._getOrReturnCtx(e,n),oe(n,{code:ee.invalid_string,validation:"date",message:i.message}),s.dirty()):i.kind==="time"?BAe(i).test(e.data)||(n=this._getOrReturnCtx(e,n),oe(n,{code:ee.invalid_string,validation:"time",message:i.message}),s.dirty()):i.kind==="duration"?DAe.test(e.data)||(n=this._getOrReturnCtx(e,n),oe(n,{validation:"duration",code:ee.invalid_string,message:i.message}),s.dirty()):i.kind==="ip"?zAe(e.data,i.version)||(n=this._getOrReturnCtx(e,n),oe(n,{validation:"ip",code:ee.invalid_string,message:i.message}),s.dirty()):i.kind==="base64"?jAe.test(e.data)||(n=this._getOrReturnCtx(e,n),oe(n,{validation:"base64",code:ee.invalid_string,message:i.message}),s.dirty()):ot.assertNever(i);return{status:s.value,value:e.data}}_regex(e,r,s){return this.refinement(n=>e.test(n),{validation:r,code:ee.invalid_string,...be.errToObj(s)})}_addCheck(e){return new an({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...be.errToObj(e)})}url(e){return this._addCheck({kind:"url",...be.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...be.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...be.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...be.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...be.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...be.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...be.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...be.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...be.errToObj(e)})}datetime(e){var r,s;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(r=e?.offset)!==null&&r!==void 0?r:!1,local:(s=e?.local)!==null&&s!==void 0?s:!1,...be.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...be.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...be.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...be.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...be.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...be.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...be.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...be.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...be.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...be.errToObj(r)})}nonempty(e){return this.min(1,be.errToObj(e))}trim(){return new an({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new an({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new an({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get minLength(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};an.create=t=>{var e;return new an({checks:[],typeName:Oe.ZodString,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...Le(t)})};function UAe(t,e){let r=(t.toString().split(".")[1]||"").length,s=(e.toString().split(".")[1]||"").length,n=r>s?r:s,i=parseInt(t.toFixed(n).replace(".","")),o=parseInt(e.toFixed(n).replace(".",""));return i%o/Math.pow(10,n)}var fo=class extends je{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==de.number){let i=this._getOrReturnCtx(e);return oe(i,{code:ee.invalid_type,expected:de.number,received:i.parsedType}),Ae}let s,n=new Nr;for(let i of this._def.checks)i.kind==="int"?ot.isInteger(e.data)||(s=this._getOrReturnCtx(e,s),oe(s,{code:ee.invalid_type,expected:"integer",received:"float",message:i.message}),n.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(s=this._getOrReturnCtx(e,s),oe(s,{code:ee.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(s=this._getOrReturnCtx(e,s),oe(s,{code:ee.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty()):i.kind==="multipleOf"?UAe(e.data,i.value)!==0&&(s=this._getOrReturnCtx(e,s),oe(s,{code:ee.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(s=this._getOrReturnCtx(e,s),oe(s,{code:ee.not_finite,message:i.message}),n.dirty()):ot.assertNever(i);return{status:n.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,be.toString(r))}gt(e,r){return this.setLimit("min",e,!1,be.toString(r))}lte(e,r){return this.setLimit("max",e,!0,be.toString(r))}lt(e,r){return this.setLimit("max",e,!1,be.toString(r))}setLimit(e,r,s,n){return new fo({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:s,message:be.toString(n)}]})}_addCheck(e){return new fo({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:be.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:be.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:be.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:be.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:be.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:be.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:be.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:be.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:be.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&ot.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(r===null||s.value>r)&&(r=s.value):s.kind==="max"&&(e===null||s.value<e)&&(e=s.value)}return Number.isFinite(r)&&Number.isFinite(e)}};fo.create=t=>new fo({checks:[],typeName:Oe.ZodNumber,coerce:t?.coerce||!1,...Le(t)});var ho=class extends je{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==de.bigint){let i=this._getOrReturnCtx(e);return oe(i,{code:ee.invalid_type,expected:de.bigint,received:i.parsedType}),Ae}let s,n=new Nr;for(let i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(s=this._getOrReturnCtx(e,s),oe(s,{code:ee.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(s=this._getOrReturnCtx(e,s),oe(s,{code:ee.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(s=this._getOrReturnCtx(e,s),oe(s,{code:ee.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):ot.assertNever(i);return{status:n.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,be.toString(r))}gt(e,r){return this.setLimit("min",e,!1,be.toString(r))}lte(e,r){return this.setLimit("max",e,!0,be.toString(r))}lt(e,r){return this.setLimit("max",e,!1,be.toString(r))}setLimit(e,r,s,n){return new ho({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:s,message:be.toString(n)}]})}_addCheck(e){return new ho({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:be.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:be.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:be.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:be.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:be.toString(r)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};ho.create=t=>{var e;return new ho({checks:[],typeName:Oe.ZodBigInt,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...Le(t)})};var lc=class extends je{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==de.boolean){let s=this._getOrReturnCtx(e);return oe(s,{code:ee.invalid_type,expected:de.boolean,received:s.parsedType}),Ae}return Ts(e.data)}};lc.create=t=>new lc({typeName:Oe.ZodBoolean,coerce:t?.coerce||!1,...Le(t)});var pa=class extends je{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==de.date){let i=this._getOrReturnCtx(e);return oe(i,{code:ee.invalid_type,expected:de.date,received:i.parsedType}),Ae}if(isNaN(e.data.getTime())){let i=this._getOrReturnCtx(e);return oe(i,{code:ee.invalid_date}),Ae}let s=new Nr,n;for(let i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(n=this._getOrReturnCtx(e,n),oe(n,{code:ee.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),s.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(n=this._getOrReturnCtx(e,n),oe(n,{code:ee.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),s.dirty()):ot.assertNever(i);return{status:s.value,value:new Date(e.data.getTime())}}_addCheck(e){return new pa({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:be.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:be.toString(r)})}get minDate(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}};pa.create=t=>new pa({checks:[],coerce:t?.coerce||!1,typeName:Oe.ZodDate,...Le(t)});var Sf=class extends je{_parse(e){if(this._getType(e)!==de.symbol){let s=this._getOrReturnCtx(e);return oe(s,{code:ee.invalid_type,expected:de.symbol,received:s.parsedType}),Ae}return Ts(e.data)}};Sf.create=t=>new Sf({typeName:Oe.ZodSymbol,...Le(t)});var uc=class extends je{_parse(e){if(this._getType(e)!==de.undefined){let s=this._getOrReturnCtx(e);return oe(s,{code:ee.invalid_type,expected:de.undefined,received:s.parsedType}),Ae}return Ts(e.data)}};uc.create=t=>new uc({typeName:Oe.ZodUndefined,...Le(t)});var cc=class extends je{_parse(e){if(this._getType(e)!==de.null){let s=this._getOrReturnCtx(e);return oe(s,{code:ee.invalid_type,expected:de.null,received:s.parsedType}),Ae}return Ts(e.data)}};cc.create=t=>new cc({typeName:Oe.ZodNull,...Le(t)});var yl=class extends je{constructor(){super(...arguments),this._any=!0}_parse(e){return Ts(e.data)}};yl.create=t=>new yl({typeName:Oe.ZodAny,...Le(t)});var ha=class extends je{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Ts(e.data)}};ha.create=t=>new ha({typeName:Oe.ZodUnknown,...Le(t)});var Ci=class extends je{_parse(e){let r=this._getOrReturnCtx(e);return oe(r,{code:ee.invalid_type,expected:de.never,received:r.parsedType}),Ae}};Ci.create=t=>new Ci({typeName:Oe.ZodNever,...Le(t)});var bf=class extends je{_parse(e){if(this._getType(e)!==de.undefined){let s=this._getOrReturnCtx(e);return oe(s,{code:ee.invalid_type,expected:de.void,received:s.parsedType}),Ae}return Ts(e.data)}};bf.create=t=>new bf({typeName:Oe.ZodVoid,...Le(t)});var ln=class extends je{_parse(e){let{ctx:r,status:s}=this._processInputParams(e),n=this._def;if(r.parsedType!==de.array)return oe(r,{code:ee.invalid_type,expected:de.array,received:r.parsedType}),Ae;if(n.exactLength!==null){let o=r.data.length>n.exactLength.value,a=r.data.length<n.exactLength.value;(o||a)&&(oe(r,{code:o?ee.too_big:ee.too_small,minimum:a?n.exactLength.value:void 0,maximum:o?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),s.dirty())}if(n.minLength!==null&&r.data.length<n.minLength.value&&(oe(r,{code:ee.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),s.dirty()),n.maxLength!==null&&r.data.length>n.maxLength.value&&(oe(r,{code:ee.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),s.dirty()),r.common.async)return Promise.all([...r.data].map((o,a)=>n.type._parseAsync(new jn(r,o,r.path,a)))).then(o=>Nr.mergeArray(s,o));let i=[...r.data].map((o,a)=>n.type._parseSync(new jn(r,o,r.path,a)));return Nr.mergeArray(s,i)}get element(){return this._def.type}min(e,r){return new ln({...this._def,minLength:{value:e,message:be.toString(r)}})}max(e,r){return new ln({...this._def,maxLength:{value:e,message:be.toString(r)}})}length(e,r){return new ln({...this._def,exactLength:{value:e,message:be.toString(r)}})}nonempty(e){return this.min(1,e)}};ln.create=(t,e)=>new ln({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Oe.ZodArray,...Le(e)});function yf(t){if(t instanceof Ut){let e={};for(let r in t.shape){let s=t.shape[r];e[r]=Ln.create(yf(s))}return new Ut({...t._def,shape:()=>e})}else return t instanceof ln?new ln({...t._def,type:yf(t.element)}):t instanceof Ln?Ln.create(yf(t.unwrap())):t instanceof mo?mo.create(yf(t.unwrap())):t instanceof Fn?Fn.create(t.items.map(e=>yf(e))):t}var Ut=class extends je{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),r=ot.objectKeys(e);return this._cached={shape:e,keys:r}}_parse(e){if(this._getType(e)!==de.object){let u=this._getOrReturnCtx(e);return oe(u,{code:ee.invalid_type,expected:de.object,received:u.parsedType}),Ae}let{status:s,ctx:n}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof Ci&&this._def.unknownKeys==="strip"))for(let u in n.data)o.includes(u)||a.push(u);let l=[];for(let u of o){let c=i[u],d=n.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new jn(n,d,n.path,u)),alwaysSet:u in n.data})}if(this._def.catchall instanceof Ci){let u=this._def.unknownKeys;if(u==="passthrough")for(let c of a)l.push({key:{status:"valid",value:c},value:{status:"valid",value:n.data[c]}});else if(u==="strict")a.length>0&&(oe(n,{code:ee.unrecognized_keys,keys:a}),s.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let c of a){let d=n.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new jn(n,d,n.path,c)),alwaysSet:c in n.data})}}return n.common.async?Promise.resolve().then(async()=>{let u=[];for(let c of l){let d=await c.key,f=await c.value;u.push({key:d,value:f,alwaysSet:c.alwaysSet})}return u}).then(u=>Nr.mergeObjectSync(s,u)):Nr.mergeObjectSync(s,l)}get shape(){return this._def.shape()}strict(e){return be.errToObj,new Ut({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,s)=>{var n,i,o,a;let l=(o=(i=(n=this._def).errorMap)===null||i===void 0?void 0:i.call(n,r,s).message)!==null&&o!==void 0?o:s.defaultError;return r.code==="unrecognized_keys"?{message:(a=be.errToObj(e).message)!==null&&a!==void 0?a:l}:{message:l}}}:{}})}strip(){return new Ut({...this._def,unknownKeys:"strip"})}passthrough(){return new Ut({...this._def,unknownKeys:"passthrough"})}extend(e){return new Ut({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Ut({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Oe.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new Ut({...this._def,catchall:e})}pick(e){let r={};return ot.objectKeys(e).forEach(s=>{e[s]&&this.shape[s]&&(r[s]=this.shape[s])}),new Ut({...this._def,shape:()=>r})}omit(e){let r={};return ot.objectKeys(this.shape).forEach(s=>{e[s]||(r[s]=this.shape[s])}),new Ut({...this._def,shape:()=>r})}deepPartial(){return yf(this)}partial(e){let r={};return ot.objectKeys(this.shape).forEach(s=>{let n=this.shape[s];e&&!e[s]?r[s]=n:r[s]=n.optional()}),new Ut({...this._def,shape:()=>r})}required(e){let r={};return ot.objectKeys(this.shape).forEach(s=>{if(e&&!e[s])r[s]=this.shape[s];else{let i=this.shape[s];for(;i instanceof Ln;)i=i._def.innerType;r[s]=i}}),new Ut({...this._def,shape:()=>r})}keyof(){return y8(ot.objectKeys(this.shape))}};Ut.create=(t,e)=>new Ut({shape:()=>t,unknownKeys:"strip",catchall:Ci.create(),typeName:Oe.ZodObject,...Le(e)});Ut.strictCreate=(t,e)=>new Ut({shape:()=>t,unknownKeys:"strict",catchall:Ci.create(),typeName:Oe.ZodObject,...Le(e)});Ut.lazycreate=(t,e)=>new Ut({shape:t,unknownKeys:"strip",catchall:Ci.create(),typeName:Oe.ZodObject,...Le(e)});var dc=class extends je{_parse(e){let{ctx:r}=this._processInputParams(e),s=this._def.options;function n(i){for(let a of i)if(a.result.status==="valid")return a.result;for(let a of i)if(a.result.status==="dirty")return r.common.issues.push(...a.ctx.common.issues),a.result;let o=i.map(a=>new Wr(a.ctx.common.issues));return oe(r,{code:ee.invalid_union,unionErrors:o}),Ae}if(r.common.async)return Promise.all(s.map(async i=>{let o={...r,common:{...r.common,issues:[]},parent:null};return{result:await i._parseAsync({data:r.data,path:r.path,parent:o}),ctx:o}})).then(n);{let i,o=[];for(let l of s){let u={...r,common:{...r.common,issues:[]},parent:null},c=l._parseSync({data:r.data,path:r.path,parent:u});if(c.status==="valid")return c;c.status==="dirty"&&!i&&(i={result:c,ctx:u}),u.common.issues.length&&o.push(u.common.issues)}if(i)return r.common.issues.push(...i.ctx.common.issues),i.result;let a=o.map(l=>new Wr(l));return oe(r,{code:ee.invalid_union,unionErrors:a}),Ae}}get options(){return this._def.options}};dc.create=(t,e)=>new dc({options:t,typeName:Oe.ZodUnion,...Le(e)});var fa=t=>t instanceof pc?fa(t.schema):t instanceof un?fa(t.innerType()):t instanceof mc?[t.value]:t instanceof po?t.options:t instanceof gc?ot.objectValues(t.enum):t instanceof yc?fa(t._def.innerType):t instanceof uc?[void 0]:t instanceof cc?[null]:t instanceof Ln?[void 0,...fa(t.unwrap())]:t instanceof mo?[null,...fa(t.unwrap())]:t instanceof eg||t instanceof Sc?fa(t.unwrap()):t instanceof vc?fa(t._def.innerType):[],Ef=class extends je{_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==de.object)return oe(r,{code:ee.invalid_type,expected:de.object,received:r.parsedType}),Ae;let s=this.discriminator,n=r.data[s],i=this.optionsMap.get(n);return i?r.common.async?i._parseAsync({data:r.data,path:r.path,parent:r}):i._parseSync({data:r.data,path:r.path,parent:r}):(oe(r,{code:ee.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[s]}),Ae)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,s){let n=new Map;for(let i of r){let o=fa(i.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let a of o){if(n.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);n.set(a,i)}}return new Ef({typeName:Oe.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:n,...Le(s)})}};function hk(t,e){let r=ml(t),s=ml(e);if(t===e)return{valid:!0,data:t};if(r===de.object&&s===de.object){let n=ot.objectKeys(e),i=ot.objectKeys(t).filter(a=>n.indexOf(a)!==-1),o={...t,...e};for(let a of i){let l=hk(t[a],e[a]);if(!l.valid)return{valid:!1};o[a]=l.data}return{valid:!0,data:o}}else if(r===de.array&&s===de.array){if(t.length!==e.length)return{valid:!1};let n=[];for(let i=0;i<t.length;i++){let o=t[i],a=e[i],l=hk(o,a);if(!l.valid)return{valid:!1};n.push(l.data)}return{valid:!0,data:n}}else return r===de.date&&s===de.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}var fc=class extends je{_parse(e){let{status:r,ctx:s}=this._processInputParams(e),n=(i,o)=>{if(dk(i)||dk(o))return Ae;let a=hk(i.value,o.value);return a.valid?((fk(i)||fk(o))&&r.dirty(),{status:r.value,value:a.data}):(oe(s,{code:ee.invalid_intersection_types}),Ae)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([i,o])=>n(i,o)):n(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}};fc.create=(t,e,r)=>new fc({left:t,right:e,typeName:Oe.ZodIntersection,...Le(r)});var Fn=class extends je{_parse(e){let{status:r,ctx:s}=this._processInputParams(e);if(s.parsedType!==de.array)return oe(s,{code:ee.invalid_type,expected:de.array,received:s.parsedType}),Ae;if(s.data.length<this._def.items.length)return oe(s,{code:ee.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Ae;!this._def.rest&&s.data.length>this._def.items.length&&(oe(s,{code:ee.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());let i=[...s.data].map((o,a)=>{let l=this._def.items[a]||this._def.rest;return l?l._parse(new jn(s,o,s.path,a)):null}).filter(o=>!!o);return s.common.async?Promise.all(i).then(o=>Nr.mergeArray(r,o)):Nr.mergeArray(r,i)}get items(){return this._def.items}rest(e){return new Fn({...this._def,rest:e})}};Fn.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Fn({items:t,typeName:Oe.ZodTuple,rest:null,...Le(e)})};var hc=class extends je{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:s}=this._processInputParams(e);if(s.parsedType!==de.object)return oe(s,{code:ee.invalid_type,expected:de.object,received:s.parsedType}),Ae;let n=[],i=this._def.keyType,o=this._def.valueType;for(let a in s.data)n.push({key:i._parse(new jn(s,a,s.path,a)),value:o._parse(new jn(s,s.data[a],s.path,a)),alwaysSet:a in s.data});return s.common.async?Nr.mergeObjectAsync(r,n):Nr.mergeObjectSync(r,n)}get element(){return this._def.valueType}static create(e,r,s){return r instanceof je?new hc({keyType:e,valueType:r,typeName:Oe.ZodRecord,...Le(s)}):new hc({keyType:an.create(),valueType:e,typeName:Oe.ZodRecord,...Le(r)})}},wf=class extends je{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:s}=this._processInputParams(e);if(s.parsedType!==de.map)return oe(s,{code:ee.invalid_type,expected:de.map,received:s.parsedType}),Ae;let n=this._def.keyType,i=this._def.valueType,o=[...s.data.entries()].map(([a,l],u)=>({key:n._parse(new jn(s,a,s.path,[u,"key"])),value:i._parse(new jn(s,l,s.path,[u,"value"]))}));if(s.common.async){let a=new Map;return Promise.resolve().then(async()=>{for(let l of o){let u=await l.key,c=await l.value;if(u.status==="aborted"||c.status==="aborted")return Ae;(u.status==="dirty"||c.status==="dirty")&&r.dirty(),a.set(u.value,c.value)}return{status:r.value,value:a}})}else{let a=new Map;for(let l of o){let u=l.key,c=l.value;if(u.status==="aborted"||c.status==="aborted")return Ae;(u.status==="dirty"||c.status==="dirty")&&r.dirty(),a.set(u.value,c.value)}return{status:r.value,value:a}}}};wf.create=(t,e,r)=>new wf({valueType:e,keyType:t,typeName:Oe.ZodMap,...Le(r)});var ma=class extends je{_parse(e){let{status:r,ctx:s}=this._processInputParams(e);if(s.parsedType!==de.set)return oe(s,{code:ee.invalid_type,expected:de.set,received:s.parsedType}),Ae;let n=this._def;n.minSize!==null&&s.data.size<n.minSize.value&&(oe(s,{code:ee.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),r.dirty()),n.maxSize!==null&&s.data.size>n.maxSize.value&&(oe(s,{code:ee.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),r.dirty());let i=this._def.valueType;function o(l){let u=new Set;for(let c of l){if(c.status==="aborted")return Ae;c.status==="dirty"&&r.dirty(),u.add(c.value)}return{status:r.value,value:u}}let a=[...s.data.values()].map((l,u)=>i._parse(new jn(s,l,s.path,u)));return s.common.async?Promise.all(a).then(l=>o(l)):o(a)}min(e,r){return new ma({...this._def,minSize:{value:e,message:be.toString(r)}})}max(e,r){return new ma({...this._def,maxSize:{value:e,message:be.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}};ma.create=(t,e)=>new ma({valueType:t,minSize:null,maxSize:null,typeName:Oe.ZodSet,...Le(e)});var gl=class extends je{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==de.function)return oe(r,{code:ee.invalid_type,expected:de.function,received:r.parsedType}),Ae;function s(a,l){return bS({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,SS(),_f].filter(u=>!!u),issueData:{code:ee.invalid_arguments,argumentsError:l}})}function n(a,l){return bS({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,SS(),_f].filter(u=>!!u),issueData:{code:ee.invalid_return_type,returnTypeError:l}})}let i={errorMap:r.common.contextualErrorMap},o=r.data;if(this._def.returns instanceof vl){let a=this;return Ts(async function(...l){let u=new Wr([]),c=await a._def.args.parseAsync(l,i).catch(h=>{throw u.addIssue(s(l,h)),u}),d=await Reflect.apply(o,this,c);return await a._def.returns._def.type.parseAsync(d,i).catch(h=>{throw u.addIssue(n(d,h)),u})})}else{let a=this;return Ts(function(...l){let u=a._def.args.safeParse(l,i);if(!u.success)throw new Wr([s(l,u.error)]);let c=Reflect.apply(o,this,u.data),d=a._def.returns.safeParse(c,i);if(!d.success)throw new Wr([n(c,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new gl({...this._def,args:Fn.create(e).rest(ha.create())})}returns(e){return new gl({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,r,s){return new gl({args:e||Fn.create([]).rest(ha.create()),returns:r||ha.create(),typeName:Oe.ZodFunction,...Le(s)})}},pc=class extends je{get schema(){return this._def.getter()}_parse(e){let{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}};pc.create=(t,e)=>new pc({getter:t,typeName:Oe.ZodLazy,...Le(e)});var mc=class extends je{_parse(e){if(e.data!==this._def.value){let r=this._getOrReturnCtx(e);return oe(r,{received:r.data,code:ee.invalid_literal,expected:this._def.value}),Ae}return{status:"valid",value:e.data}}get value(){return this._def.value}};mc.create=(t,e)=>new mc({value:t,typeName:Oe.ZodLiteral,...Le(e)});function y8(t,e){return new po({values:t,typeName:Oe.ZodEnum,...Le(e)})}var po=class extends je{constructor(){super(...arguments),Zm.set(this,void 0)}_parse(e){if(typeof e.data!="string"){let r=this._getOrReturnCtx(e),s=this._def.values;return oe(r,{expected:ot.joinValues(s),received:r.parsedType,code:ee.invalid_type}),Ae}if(ES(this,Zm,"f")||h8(this,Zm,new Set(this._def.values),"f"),!ES(this,Zm,"f").has(e.data)){let r=this._getOrReturnCtx(e),s=this._def.values;return oe(r,{received:r.data,code:ee.invalid_enum_value,options:s}),Ae}return Ts(e.data)}get options(){return this._def.values}get enum(){let e={};for(let r of this._def.values)e[r]=r;return e}get Values(){let e={};for(let r of this._def.values)e[r]=r;return e}get Enum(){let e={};for(let r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return po.create(e,{...this._def,...r})}exclude(e,r=this._def){return po.create(this.options.filter(s=>!e.includes(s)),{...this._def,...r})}};Zm=new WeakMap;po.create=y8;var gc=class extends je{constructor(){super(...arguments),Ym.set(this,void 0)}_parse(e){let r=ot.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==de.string&&s.parsedType!==de.number){let n=ot.objectValues(r);return oe(s,{expected:ot.joinValues(n),received:s.parsedType,code:ee.invalid_type}),Ae}if(ES(this,Ym,"f")||h8(this,Ym,new Set(ot.getValidEnumValues(this._def.values)),"f"),!ES(this,Ym,"f").has(e.data)){let n=ot.objectValues(r);return oe(s,{received:s.data,code:ee.invalid_enum_value,options:n}),Ae}return Ts(e.data)}get enum(){return this._def.values}};Ym=new WeakMap;gc.create=(t,e)=>new gc({values:t,typeName:Oe.ZodNativeEnum,...Le(e)});var vl=class extends je{unwrap(){return this._def.type}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==de.promise&&r.common.async===!1)return oe(r,{code:ee.invalid_type,expected:de.promise,received:r.parsedType}),Ae;let s=r.parsedType===de.promise?r.data:Promise.resolve(r.data);return Ts(s.then(n=>this._def.type.parseAsync(n,{path:r.path,errorMap:r.common.contextualErrorMap})))}};vl.create=(t,e)=>new vl({type:t,typeName:Oe.ZodPromise,...Le(e)});var un=class extends je{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Oe.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:r,ctx:s}=this._processInputParams(e),n=this._def.effect||null,i={addIssue:o=>{oe(s,o),o.fatal?r.abort():r.dirty()},get path(){return s.path}};if(i.addIssue=i.addIssue.bind(i),n.type==="preprocess"){let o=n.transform(s.data,i);if(s.common.async)return Promise.resolve(o).then(async a=>{if(r.value==="aborted")return Ae;let l=await this._def.schema._parseAsync({data:a,path:s.path,parent:s});return l.status==="aborted"?Ae:l.status==="dirty"||r.value==="dirty"?vf(l.value):l});{if(r.value==="aborted")return Ae;let a=this._def.schema._parseSync({data:o,path:s.path,parent:s});return a.status==="aborted"?Ae:a.status==="dirty"||r.value==="dirty"?vf(a.value):a}}if(n.type==="refinement"){let o=a=>{let l=n.refinement(a,i);if(s.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(s.common.async===!1){let a=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return a.status==="aborted"?Ae:(a.status==="dirty"&&r.dirty(),o(a.value),{status:r.value,value:a.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(a=>a.status==="aborted"?Ae:(a.status==="dirty"&&r.dirty(),o(a.value).then(()=>({status:r.value,value:a.value}))))}if(n.type==="transform")if(s.common.async===!1){let o=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!Jm(o))return o;let a=n.transform(o.value,i);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:a}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(o=>Jm(o)?Promise.resolve(n.transform(o.value,i)).then(a=>({status:r.value,value:a})):o);ot.assertNever(n)}};un.create=(t,e,r)=>new un({schema:t,typeName:Oe.ZodEffects,effect:e,...Le(r)});un.createWithPreprocess=(t,e,r)=>new un({schema:e,effect:{type:"preprocess",transform:t},typeName:Oe.ZodEffects,...Le(r)});var Ln=class extends je{_parse(e){return this._getType(e)===de.undefined?Ts(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Ln.create=(t,e)=>new Ln({innerType:t,typeName:Oe.ZodOptional,...Le(e)});var mo=class extends je{_parse(e){return this._getType(e)===de.null?Ts(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};mo.create=(t,e)=>new mo({innerType:t,typeName:Oe.ZodNullable,...Le(e)});var yc=class extends je{_parse(e){let{ctx:r}=this._processInputParams(e),s=r.data;return r.parsedType===de.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:r.path,parent:r})}removeDefault(){return this._def.innerType}};yc.create=(t,e)=>new yc({innerType:t,typeName:Oe.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Le(e)});var vc=class extends je{_parse(e){let{ctx:r}=this._processInputParams(e),s={...r,common:{...r.common,issues:[]}},n=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return Xm(n)?n.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Wr(s.common.issues)},input:s.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new Wr(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}};vc.create=(t,e)=>new vc({innerType:t,typeName:Oe.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Le(e)});var Tf=class extends je{_parse(e){if(this._getType(e)!==de.nan){let s=this._getOrReturnCtx(e);return oe(s,{code:ee.invalid_type,expected:de.nan,received:s.parsedType}),Ae}return{status:"valid",value:e.data}}};Tf.create=t=>new Tf({typeName:Oe.ZodNaN,...Le(t)});var VAe=Symbol("zod_brand"),eg=class extends je{_parse(e){let{ctx:r}=this._processInputParams(e),s=r.data;return this._def.type._parse({data:s,path:r.path,parent:r})}unwrap(){return this._def.type}},_c=class extends je{_parse(e){let{status:r,ctx:s}=this._processInputParams(e);if(s.common.async)return(async()=>{let i=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return i.status==="aborted"?Ae:i.status==="dirty"?(r.dirty(),vf(i.value)):this._def.out._parseAsync({data:i.value,path:s.path,parent:s})})();{let n=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?Ae:n.status==="dirty"?(r.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:s.path,parent:s})}}static create(e,r){return new _c({in:e,out:r,typeName:Oe.ZodPipeline})}},Sc=class extends je{_parse(e){let r=this._def.innerType._parse(e),s=n=>(Jm(n)&&(n.value=Object.freeze(n.value)),n);return Xm(r)?r.then(n=>s(n)):s(r)}unwrap(){return this._def.innerType}};Sc.create=(t,e)=>new Sc({innerType:t,typeName:Oe.ZodReadonly,...Le(e)});function v8(t,e={},r){return t?yl.create().superRefine((s,n)=>{var i,o;if(!t(s)){let a=typeof e=="function"?e(s):typeof e=="string"?{message:e}:e,l=(o=(i=a.fatal)!==null&&i!==void 0?i:r)!==null&&o!==void 0?o:!0,u=typeof a=="string"?{message:a}:a;n.addIssue({code:"custom",...u,fatal:l})}}):yl.create()}var HAe={object:Ut.lazycreate},Oe;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(Oe||(Oe={}));var GAe=(t,e={message:`Input not instance of ${t.name}`})=>v8(r=>r instanceof t,e),_8=an.create,S8=fo.create,KAe=Tf.create,QAe=ho.create,b8=lc.create,WAe=pa.create,ZAe=Sf.create,YAe=uc.create,JAe=cc.create,XAe=yl.create,eke=ha.create,tke=Ci.create,rke=bf.create,ske=ln.create,nke=Ut.create,ike=Ut.strictCreate,oke=dc.create,ake=Ef.create,lke=fc.create,uke=Fn.create,cke=hc.create,dke=wf.create,fke=ma.create,hke=gl.create,pke=pc.create,mke=mc.create,gke=po.create,yke=gc.create,vke=vl.create,d8=un.create,_ke=Ln.create,Ske=mo.create,bke=un.createWithPreprocess,Eke=_c.create,wke=()=>_8().optional(),Tke=()=>S8().optional(),Cke=()=>b8().optional(),Rke={string:t=>an.create({...t,coerce:!0}),number:t=>fo.create({...t,coerce:!0}),boolean:t=>lc.create({...t,coerce:!0}),bigint:t=>ho.create({...t,coerce:!0}),date:t=>pa.create({...t,coerce:!0})},Oke=Ae,Fs=Object.freeze({__proto__:null,defaultErrorMap:_f,setErrorMap:OAe,getErrorMap:SS,makeIssue:bS,EMPTY_PATH:PAe,addIssueToContext:oe,ParseStatus:Nr,INVALID:Ae,DIRTY:vf,OK:Ts,isAborted:dk,isDirty:fk,isValid:Jm,isAsync:Xm,get util(){return ot},get objectUtil(){return ck},ZodParsedType:de,getParsedType:ml,ZodType:je,datetimeRegex:g8,ZodString:an,ZodNumber:fo,ZodBigInt:ho,ZodBoolean:lc,ZodDate:pa,ZodSymbol:Sf,ZodUndefined:uc,ZodNull:cc,ZodAny:yl,ZodUnknown:ha,ZodNever:Ci,ZodVoid:bf,ZodArray:ln,ZodObject:Ut,ZodUnion:dc,ZodDiscriminatedUnion:Ef,ZodIntersection:fc,ZodTuple:Fn,ZodRecord:hc,ZodMap:wf,ZodSet:ma,ZodFunction:gl,ZodLazy:pc,ZodLiteral:mc,ZodEnum:po,ZodNativeEnum:gc,ZodPromise:vl,ZodEffects:un,ZodTransformer:un,ZodOptional:Ln,ZodNullable:mo,ZodDefault:yc,ZodCatch:vc,ZodNaN:Tf,BRAND:VAe,ZodBranded:eg,ZodPipeline:_c,ZodReadonly:Sc,custom:v8,Schema:je,ZodSchema:je,late:HAe,get ZodFirstPartyTypeKind(){return Oe},coerce:Rke,any:XAe,array:ske,bigint:QAe,boolean:b8,date:WAe,discriminatedUnion:ake,effect:d8,enum:gke,function:hke,instanceof:GAe,intersection:lke,lazy:pke,literal:mke,map:dke,nan:KAe,nativeEnum:yke,never:tke,null:JAe,nullable:Ske,number:S8,object:nke,oboolean:Cke,onumber:Tke,optional:_ke,ostring:wke,pipeline:Eke,preprocess:bke,promise:vke,record:cke,set:fke,strictObject:ike,string:_8,symbol:ZAe,transformer:d8,tuple:uke,undefined:YAe,union:oke,unknown:eke,void:rke,NEVER:Oke,ZodIssueCode:ee,quotelessJson:RAe,ZodError:Wr});var wr=Object.freeze({SUCCESS:200,BAD_REQUEST:400,SERVER_INTERNAL:500,ACCESS_DENIED:401,NOT_FOUND:404}),E8=[wr.BAD_REQUEST,wr.NOT_FOUND,wr.ACCESS_DENIED,wr.SERVER_INTERNAL];var wS=class{constructor(e){this.$issue=e.issues}transformValidateHttp(){let e=[];for(let r=0;r<this.$issue.length;r++)e.some(n=>n.field===this.$issue[r].path?.[0])||e.push({code:this.$issue?.[r]?.code??"",field:this.$issue?.[r]?.path?.[0]?.toString()??"",message:this.$issue?.[r]?.message??""});return e}};var Pke=function(t,e,r){if(r.log.error({request:{method:e.method,url:e.url,headers:e.headers,body:e.body,query:e.query,params:e.params},error:t}),t instanceof nl){console.log("error",JSON.stringify(t)),r.code(wr.SUCCESS).send({message:ws.BAD_REQUEST,http_status:wr.BAD_REQUEST,error:t.stack,data:null});return}if(t instanceof Wr){r.code(wr.SUCCESS).send({message:ws.BAD_REQUEST,http_status:wr.BAD_REQUEST,error:new wS(t).transformValidateHttp(),data:null});return}if(t instanceof il){r.code(wr.SUCCESS).send({message:ws.NOT_FOUND,http_status:wr.NOT_FOUND,error:[],data:null});return}if(t instanceof ol){r.code(wr.SUCCESS).send({message:ws.BAD_REQUEST,http_status:wr.BAD_REQUEST,error:[],data:null});return}if(t instanceof al){r.code(wr.SUCCESS).send({message:ws.ACCESS_DENIED,http_status:wr.ACCESS_DENIED,error:[],data:null});return}r.code(wr.SUCCESS).send({message:ws.SERVER_INTERNAL,http_status:wr.SERVER_INTERNAL,error:[],data:null})},w8=Pke;var Ake=(t,e,r,s)=>{let n=JSON.parse(r);if(n.http_status&&E8.includes(n.http_status)){s(null,r);return}let o={http_status:wr.SUCCESS,message:ws.SUCCESS,data:n||null,error:[]};s(null,JSON.stringify(o))},T8=Ake;var EQ=kr(Uu()),wQ=kr(bQ()),dDe=(0,EQ.default)(async t=>{try{let e=new wQ.default({host:t.config.REDIS_CLIENT,port:t.config.REDIS_PORT,username:t.config.REDIS_USER,password:t.config.REDIS_PASSWORD});t.decorate("redis",e),t.addHook("onClose",(r,s)=>{r?.redis!==void 0&&r.redis?.disconnect(),s()}),t.log.info("Connect redis success")}catch(e){t.log.error(`Connect redis error ${e}`)}}),TQ=dDe;var t7=kr(Sg(),1);var j=Symbol.for("drizzle:entityKind"),fWe=Symbol.for("drizzle:hasOwnEntityKind");function Y(t,e){if(!t||typeof t!="object")return!1;if(t instanceof e)return!0;if(!Object.prototype.hasOwnProperty.call(e,j))throw new Error(`Class "${e.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let r=t.constructor;if(r)for(;r;){if(j in r&&r[j]===e[j])return!0;r=Object.getPrototypeOf(r)}return!1}var iqe,ub=class{write(e){console.log(e)}};iqe=j,F(ub,iqe,"ConsoleLogWriter");var oqe,Eg=class{writer;constructor(e){this.writer=e?.writer??new ub}logQuery(e,r){let s=r.map(i=>{try{return JSON.stringify(i)}catch{return String(i)}}),n=s.length?` -- params: [${s.join(", ")}]`:"";this.writer.write(`Query: ${e}${n}`)}};oqe=j,F(Eg,oqe,"DefaultLogger");var aqe,wg=class{logQuery(){}};aqe=j,F(wg,aqe,"NoopLogger");var lqe,Zr=class{[(lqe=j,Symbol.toStringTag)]="QueryPromise";catch(e){return this.then(void 0,e)}finally(e){return this.then(r=>(e?.(),r),r=>{throw e?.(),r})}then(e,r){return this.execute().then(e,r)}};F(Zr,lqe,"QueryPromise");var cb=Symbol.for("drizzle:Name"),DI=Symbol.for("drizzle:Schema"),lZ=Symbol.for("drizzle:Columns"),uZ=Symbol.for("drizzle:ExtraConfigColumns"),MI=Symbol.for("drizzle:OriginalName"),$I=Symbol.for("drizzle:BaseName"),cZ=Symbol.for("drizzle:IsAlias"),dZ=Symbol.for("drizzle:ExtraConfigBuilder"),fZ=Symbol.for("drizzle:IsDrizzleTable"),uqe,ue=class{[(uqe=j,cb)];[MI];[DI];[lZ];[uZ];[$I];[cZ]=!1;[dZ]=void 0;[fZ]=!0;constructor(e,r,s){this[cb]=this[MI]=e,this[DI]=r,this[$I]=s}};F(ue,uqe,"Table"),F(ue,"Symbol",{Name:cb,Schema:DI,OriginalName:MI,Columns:lZ,ExtraConfigColumns:uZ,BaseName:$I,IsAlias:cZ,ExtraConfigBuilder:dZ});function hZ(t){return typeof t=="object"&&t!==null&&fZ in t}function xl(t){return t[cb]}function db(t,...e){return t(...e)}var pZ="0.31.2";var qI,LI,At={startActiveSpan(t,e){return qI?(LI||(LI=qI.trace.getTracer("drizzle-orm",pZ)),db((r,s)=>s.startActiveSpan(t,n=>{try{return e(n)}catch(i){throw n.setStatus({code:r.SpanStatusCode.ERROR,message:i instanceof Error?i.message:"Unknown error"}),i}finally{n.end()}}),qI,LI)):e()}};var cqe,Ct=class{constructor(e,r){this.table=e,this.config=r,this.name=r.name,this.notNull=r.notNull,this.default=r.default,this.defaultFn=r.defaultFn,this.onUpdateFn=r.onUpdateFn,this.hasDefault=r.hasDefault,this.primary=r.primaryKey,this.isUnique=r.isUnique,this.uniqueName=r.uniqueName,this.uniqueType=r.uniqueType,this.dataType=r.dataType,this.columnType=r.columnType}name;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;config;mapFromDriverValue(e){return e}mapToDriverValue(e){return e}};cqe=j,F(Ct,cqe,"Column");var dqe,Tg=class{config;constructor(e,r,s){this.config={name:e,notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:r,columnType:s}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}};dqe=j,F(Tg,dqe,"ColumnBuilder");var jI=Symbol.for("drizzle:PgInlineForeignKeys"),fqe,Tr=class extends ue{[(fqe=j,jI)]=[];[ue.Symbol.ExtraConfigBuilder]=void 0};F(Tr,fqe,"PgTable"),F(Tr,"Symbol",Object.assign({},ue.Symbol,{InlineForeignKeys:jI}));function FI(t,e,r,s,n=t){let i=new Tr(t,s,n),o=Object.fromEntries(Object.entries(e).map(([u,c])=>{let d=c,f=d.build(i);return i[jI].push(...d.buildForeignKeys(f,i)),[u,f]})),a=Object.fromEntries(Object.entries(e).map(([u,c])=>{let f=c.buildExtraConfigColumn(i);return[u,f]})),l=Object.assign(i,o);return l[ue.Symbol.Columns]=o,l[ue.Symbol.ExtraConfigColumns]=a,r&&(l[Tr.Symbol.ExtraConfigBuilder]=r),l}var BI=(t,e,r)=>FI(t,e,r,void 0);var hqe,Cg=class{reference;_onUpdate="no action";_onDelete="no action";constructor(e,r){this.reference=()=>{let{name:s,columns:n,foreignColumns:i}=e();return{name:s,columns:n,foreignTable:i[0].table,foreignColumns:i}},r&&(this._onUpdate=r.onUpdate,this._onDelete=r.onDelete)}onUpdate(e){return this._onUpdate=e===void 0?"no action":e,this}onDelete(e){return this._onDelete=e===void 0?"no action":e,this}build(e){return new fb(e,this)}};hqe=j,F(Cg,hqe,"PgForeignKeyBuilder");var pqe,fb=class{constructor(e,r){this.table=e,this.reference=r.reference,this.onUpdate=r._onUpdate,this.onDelete=r._onDelete}reference;onUpdate;onDelete;getName(){let{name:e,columns:r,foreignColumns:s}=this.reference(),n=r.map(a=>a.name),i=s.map(a=>a.name),o=[this.table[Tr.Symbol.Name],...n,s[0].table[Tr.Symbol.Name],...i];return e??`${o.join("_")}_fk`}};pqe=j,F(fb,pqe,"PgForeignKey");function UI(t,e){return`${t[Tr.Symbol.Name]}_${e.join("_")}_unique`}var mqe,hb=class{constructor(e,r){this.name=r,this.columns=e}columns;nullsNotDistinctConfig=!1;nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(e){return new pb(e,this.columns,this.nullsNotDistinctConfig,this.name)}};mqe=j,F(hb,mqe,"PgUniqueConstraintBuilder");var gqe,zI=class{name;constructor(e){this.name=e}on(...e){return new hb(e,this.name)}};gqe=j,F(zI,gqe,"PgUniqueOnConstraintBuilder");var yqe,pb=class{constructor(e,r,s,n){this.table=e,this.columns=r,this.name=n??UI(this.table,this.columns.map(i=>i.name)),this.nullsNotDistinct=s}columns;name;nullsNotDistinct=!1;getName(){return this.name}};yqe=j,F(pb,yqe,"PgUniqueConstraint");function mZ(t,e,r){for(let s=e;s<t.length;s++){let n=t[s];if(n==="\\"){s++;continue}if(n==='"')return[t.slice(e,s).replace(/\\/g,""),s+1];if(!r&&(n===","||n==="}"))return[t.slice(e,s).replace(/\\/g,""),s]}return[t.slice(e).replace(/\\/g,""),t.length]}function gZ(t,e=0){let r=[],s=e,n=!1;for(;s<t.length;){let i=t[s];if(i===","){(n||s===e)&&r.push(""),n=!0,s++;continue}if(n=!1,i==="\\"){s+=2;continue}if(i==='"'){let[l,u]=mZ(t,s+1,!0);r.push(l),s=u;continue}if(i==="}")return[r,s+1];if(i==="{"){let[l,u]=gZ(t,s+1);r.push(l),s=u;continue}let[o,a]=mZ(t,s,!1);r.push(o),s=a}return[r,s]}function yZ(t){let[e]=gZ(t,1);return e}function VI(t){return`{${t.map(e=>Array.isArray(e)?VI(e):typeof e=="string"?`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${e}`).join(",")}}`}var vqe,Ht=class extends Tg{foreignKeyConfigs=[];array(e){return new gb(this.config.name,this,e)}references(e,r={}){return this.foreignKeyConfigs.push({ref:e,actions:r}),this}unique(e,r){return this.config.isUnique=!0,this.config.uniqueName=e,this.config.uniqueType=r?.nulls,this}buildForeignKeys(e,r){return this.foreignKeyConfigs.map(({ref:s,actions:n})=>db((i,o)=>{let a=new Cg(()=>{let l=i();return{columns:[e],foreignColumns:[l]}});return o.onUpdate&&a.onUpdate(o.onUpdate),o.onDelete&&a.onDelete(o.onDelete),a.build(r)},s,n))}buildExtraConfigColumn(e){return new mb(e,this.config)}};vqe=j,F(Ht,vqe,"PgColumnBuilder");var _qe,rt=class extends Ct{constructor(e,r){r.uniqueName||(r.uniqueName=UI(e,[r.name])),super(e,r),this.table=e}};_qe=j,F(rt,_qe,"PgColumn");var Sqe,mb=class extends rt{getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(e){return this.indexConfig.opClass=e,this}};Sqe=j,F(mb,Sqe,"ExtraConfigColumn");var bqe,Oc=class{constructor(e,r,s){this.name=e,this.type=r,this.indexConfig=s}name;type;indexConfig};bqe=j,F(Oc,bqe,"IndexedColumn");var Eqe,gb=class extends Ht{constructor(e,r,s){super(e,"array","PgArray"),this.config.baseBuilder=r,this.config.size=s}build(e){let r=this.config.baseBuilder.build(e);return new yb(e,this.config,r)}};Eqe=j,F(gb,Eqe,"PgArrayBuilder");var wqe,HI=class extends rt{constructor(e,r,s,n){super(e,r),this.baseColumn=s,this.range=n,this.size=r.size}size;getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(e){return typeof e=="string"&&(e=yZ(e)),e.map(r=>this.baseColumn.mapFromDriverValue(r))}mapToDriverValue(e,r=!1){let s=e.map(n=>n===null?null:Y(this.baseColumn,HI)?this.baseColumn.mapToDriverValue(n,!0):this.baseColumn.mapToDriverValue(n));return r?s:VI(s)}},yb=HI;wqe=j,F(yb,wqe,"PgArray");var GI=Symbol.for("drizzle:isPgEnum");function vZ(t){return!!t&&typeof t=="function"&&GI in t&&t[GI]===!0}var Tqe,vb=class extends Ht{constructor(e,r){super(e,"string","PgEnumColumn"),this.config.enum=r}build(e){return new _b(e,this.config)}};Tqe=j,F(vb,Tqe,"PgEnumColumnBuilder");var Cqe,_b=class extends rt{enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(e,r){super(e,r),this.enum=r.enum}getSQLType(){return this.enum.enumName}};Cqe=j,F(_b,Cqe,"PgEnumColumn");function _Z(t,e,r){let s=Object.assign(n=>new vb(n,s),{enumName:t,enumValues:e,schema:r,[GI]:!0});return s}var Rqe,Cr=class{constructor(e,r,s,n=!1){this._={brand:"Subquery",sql:e,selectedFields:r,alias:s,isWith:n}}};Rqe=j,F(Cr,Rqe,"Subquery");var Oqe,Pc=class extends Cr{};Oqe=j,F(Pc,Oqe,"WithSubquery");var Xt=Symbol.for("drizzle:ViewBaseConfig");var Aqe,KI=class{};Aqe=j,F(KI,Aqe,"FakePrimitiveParam");function QI(t){return t!=null&&typeof t.getSQL=="function"}function Pqe(t){let e={sql:"",params:[]};for(let r of t)e.sql+=r.sql,e.params.push(...r.params),r.typings?.length&&(e.typings||(e.typings=[]),e.typings.push(...r.typings));return e}var kqe,fr=class{value;constructor(e){this.value=Array.isArray(e)?e:[e]}getSQL(){return new me([this])}};kqe=j,F(fr,kqe,"StringChunk");var xqe,Vf=class{constructor(e){this.queryChunks=e}decoder=bZ;shouldInlineParams=!1;append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return At.startActiveSpan("drizzle.buildSQL",r=>{let s=this.buildQueryFromSourceParams(this.queryChunks,e);return r?.setAttributes({"drizzle.query.text":s.sql,"drizzle.query.params":JSON.stringify(s.params)}),s})}buildQueryFromSourceParams(e,r){let s=Object.assign({},r,{inlineParams:r.inlineParams||this.shouldInlineParams,paramStartIndex:r.paramStartIndex||{value:0}}),{escapeName:n,escapeParam:i,prepareTyping:o,inlineParams:a,paramStartIndex:l}=s;return Pqe(e.map(u=>{if(Y(u,fr))return{sql:u.value.join(""),params:[]};if(Y(u,Hf))return{sql:n(u.value),params:[]};if(u===void 0)return{sql:"",params:[]};if(Array.isArray(u)){let c=[new fr("(")];for(let[d,f]of u.entries())c.push(f),d<u.length-1&&c.push(new fr(", "));return c.push(new fr(")")),this.buildQueryFromSourceParams(c,s)}if(Y(u,Vf))return this.buildQueryFromSourceParams(u.queryChunks,{...s,inlineParams:a||u.shouldInlineParams});if(Y(u,ue)){let c=u[ue.Symbol.Schema],d=u[ue.Symbol.Name];return{sql:c===void 0?n(d):n(c)+"."+n(d),params:[]}}if(Y(u,Ct))return r.invokeSource==="indexes"?{sql:n(u.name),params:[]}:{sql:n(u.table[ue.Symbol.Name])+"."+n(u.name),params:[]};if(Y(u,gs)){let c=u[Xt].schema,d=u[Xt].name;return{sql:c===void 0?n(d):n(c)+"."+n(d),params:[]}}if(Y(u,Us)){let c=u.value===null?null:u.encoder.mapToDriverValue(u.value);if(Y(c,Vf))return this.buildQueryFromSourceParams([c],s);if(a)return{sql:this.mapInlineParam(c,s),params:[]};let d;return o!==void 0&&(d=[o(u.encoder)]),{sql:i(l.value++,c),params:[c],typings:d}}return Y(u,Il)?{sql:i(l.value++,u),params:[u]}:Y(u,Vf.Aliased)&&u.fieldAlias!==void 0?{sql:n(u.fieldAlias),params:[]}:Y(u,Cr)?u._.isWith?{sql:n(u._.alias),params:[]}:this.buildQueryFromSourceParams([new fr("("),u._.sql,new fr(") "),new Hf(u._.alias)],s):vZ(u)?u.schema?{sql:n(u.schema)+"."+n(u.enumName),params:[]}:{sql:n(u.enumName),params:[]}:QI(u)?this.buildQueryFromSourceParams([new fr("("),u.getSQL(),new fr(")")],s):a?{sql:this.mapInlineParam(u,s),params:[]}:{sql:i(l.value++,u),params:[u]}}))}mapInlineParam(e,{escapeString:r}){if(e===null)return"null";if(typeof e=="number"||typeof e=="boolean")return e.toString();if(typeof e=="string")return r(e);if(typeof e=="object"){let s=e.toString();return r(s==="[object Object]"?JSON.stringify(e):s)}throw new Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return e===void 0?this:new Vf.Aliased(this,e)}mapWith(e){return this.decoder=typeof e=="function"?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}},me=Vf;xqe=j,F(me,xqe,"SQL");var Iqe,Hf=class{constructor(e){this.value=e}brand;getSQL(){return new me([this])}};Iqe=j,F(Hf,Iqe,"Name");function SZ(t){return typeof t=="object"&&t!==null&&"mapToDriverValue"in t&&typeof t.mapToDriverValue=="function"}var bZ={mapFromDriverValue:t=>t},EZ={mapToDriverValue:t=>t},yZe={...bZ,...EZ},Nqe,Us=class{constructor(e,r=EZ){this.value=e,this.encoder=r}brand;getSQL(){return new me([this])}};Nqe=j,F(Us,Nqe,"Param");function x(t,...e){let r=[];(e.length>0||t.length>0&&t[0]!=="")&&r.push(new fr(t[0]));for(let[s,n]of e.entries())r.push(n,new fr(t[s+1]));return new me(r)}(t=>{function e(){return new me([])}t.empty=e;function r(l){return new me(l)}t.fromList=r;function s(l){return new me([new fr(l)])}t.raw=s;function n(l,u){let c=[];for(let[d,f]of l.entries())d>0&&u!==void 0&&c.push(u),c.push(f);return new me(c)}t.join=n;function i(l){return new Hf(l)}t.identifier=i;function o(l){return new Il(l)}t.placeholder=o;function a(l,u){return new Us(l,u)}t.param=a})(x||(x={}));(t=>{class e{constructor(s,n){this.sql=s,this.fieldAlias=n}static[j]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new e(this.sql,this.fieldAlias)}}t.Aliased=e})(me||(me={}));var Dqe,Il=class{constructor(e){this.name=e}getSQL(){return new me([this])}};Dqe=j,F(Il,Dqe,"Placeholder");function WI(t,e){return t.map(r=>{if(Y(r,Il)){if(!(r.name in e))throw new Error(`No value for placeholder "${r.name}" was provided`);return e[r.name]}return r})}var Mqe,gs=class{[(Mqe=j,Xt)];constructor({name:e,schema:r,selectedFields:s,query:n}){this[Xt]={name:e,originalName:e,schema:r,selectedFields:s,query:n,isExisting:!n,isAlias:!1}}getSQL(){return new me([this])}};F(gs,Mqe,"View");Ct.prototype.getSQL=function(){return new me([this])};ue.prototype.getSQL=function(){return new me([this])};Cr.prototype.getSQL=function(){return new me([this])};function wZ(t,e,r){let s={},n=t.reduce((i,{path:o,field:a},l)=>{let u;Y(a,Ct)?u=a:Y(a,me)?u=a.decoder:u=a.sql.decoder;let c=i;for(let[d,f]of o.entries())if(d<o.length-1)f in c||(c[f]={}),c=c[f];else{let h=e[l],p=c[f]=h===null?null:u.mapFromDriverValue(h);if(r&&Y(a,Ct)&&o.length===2){let g=o[0];g in s?typeof s[g]=="string"&&s[g]!==xl(a.table)&&(s[g]=!1):s[g]=p===null?xl(a.table):!1}}return i},{});if(r&&Object.keys(s).length>0)for(let[i,o]of Object.entries(s))typeof o=="string"&&!r[o]&&(n[i]=null);return n}function Hn(t,e){return Object.entries(t).reduce((r,[s,n])=>{if(typeof s!="string")return r;let i=e?[...e,s]:[s];return Y(n,Ct)||Y(n,me)||Y(n,me.Aliased)?r.push({path:i,field:n}):Y(n,ue)?r.push(...Hn(n[ue.Symbol.Columns],i)):r.push(...Hn(n,i)),r},[])}function ZI(t,e){let r=Object.keys(t),s=Object.keys(e);if(r.length!==s.length)return!1;for(let[n,i]of r.entries())if(i!==s[n])return!1;return!0}function Sb(t,e){let r=Object.entries(e).filter(([,s])=>s!==void 0).map(([s,n])=>Y(n,me)?[s,n]:[s,new Us(n,t[ue.Symbol.Columns][s])]);if(r.length===0)throw new Error("No values to set");return Object.fromEntries(r)}function TZ(t,e){for(let r of e)for(let s of Object.getOwnPropertyNames(r.prototype))s!=="constructor"&&Object.defineProperty(t.prototype,s,Object.getOwnPropertyDescriptor(r.prototype,s)||Object.create(null))}function Rg(t){return t[ue.Symbol.Columns]}function YI(t){return Y(t,Cr)?t._.alias:Y(t,gs)?t[Xt].name:Y(t,me)?void 0:t[ue.Symbol.IsAlias]?t[ue.Symbol.Name]:t[ue.Symbol.BaseName]}var $qe,Gf=class extends Zr{constructor(e,r,s,n){super(),this.session=r,this.dialect=s,this.config={table:e,withList:n}}config;where(e){return this.config.where=e,this}returning(e=this.config.table[ue.Symbol.Columns]){return this.config.returning=Hn(e),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return At.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}execute=e=>At.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e));$dynamic(){return this}};$qe=j,F(Gf,$qe,"PgDelete");var qqe,Kf=class{constructor(e,r,s,n){this.table=e,this.session=r,this.dialect=s,this.withList=n}values(e){if(e=Array.isArray(e)?e:[e],e.length===0)throw new Error("values() must be called with at least one value");let r=e.map(s=>{let n={},i=this.table[ue.Symbol.Columns];for(let o of Object.keys(s)){let a=s[o];n[o]=Y(a,me)?a:new Us(a,i[o])}return n});return new bb(this.table,r,this.session,this.dialect,this.withList)}};qqe=j,F(Kf,qqe,"PgInsertBuilder");var Lqe,bb=class extends Zr{constructor(e,r,s,n,i){super(),this.session=s,this.dialect=n,this.config={table:e,values:r,withList:i}}config;returning(e=this.config.table[ue.Symbol.Columns]){return this.config.returning=Hn(e),this}onConflictDoNothing(e={}){if(e.target===void 0)this.config.onConflict=x`do nothing`;else{let r="";r=Array.isArray(e.target)?e.target.map(n=>this.dialect.escapeName(n.name)).join(","):this.dialect.escapeName(e.target.name);let s=e.where?x` where ${e.where}`:void 0;this.config.onConflict=x`(${x.raw(r)})${s} do nothing`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw new Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');let r=e.where?x` where ${e.where}`:void 0,s=e.targetWhere?x` where ${e.targetWhere}`:void 0,n=e.setWhere?x` where ${e.setWhere}`:void 0,i=this.dialect.buildUpdateSet(this.config.table,Sb(this.config.table,e.set)),o="";return o=Array.isArray(e.target)?e.target.map(a=>this.dialect.escapeName(a.name)).join(","):this.dialect.escapeName(e.target.name),this.config.onConflict=x`(${x.raw(o)})${s} do update set ${i}${r}${n}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return At.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}execute=e=>At.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e));$dynamic(){return this}};Lqe=j,F(bb,Lqe,"PgInsert");var jqe,Nl=class{constructor(e){this.table=e}get(e,r){return r==="table"?this.table:e[r]}};jqe=j,F(Nl,jqe,"ColumnAliasProxyHandler");var Fqe,Ac=class{constructor(e,r){this.alias=e,this.replaceOriginalName=r}get(e,r){if(r===ue.Symbol.IsAlias)return!0;if(r===ue.Symbol.Name)return this.alias;if(this.replaceOriginalName&&r===ue.Symbol.OriginalName)return this.alias;if(r===Xt)return{...e[Xt],name:this.alias,isAlias:!0};if(r===ue.Symbol.Columns){let n=e[ue.Symbol.Columns];if(!n)return n;let i={};return Object.keys(n).map(o=>{i[o]=new Proxy(n[o],new Nl(new Proxy(e,this)))}),i}let s=e[r];return Y(s,Ct)?new Proxy(s,new Nl(new Proxy(e,this))):s}};Fqe=j,F(Ac,Fqe,"TableAliasProxyHandler");var Bqe,JI=class{constructor(e){this.alias=e}get(e,r){return r==="sourceTable"?Og(e.sourceTable,this.alias):e[r]}};Bqe=j,F(JI,Bqe,"RelationTableAliasProxyHandler");function Og(t,e){return new Proxy(t,new Ac(e,!1))}function yo(t,e){return new Proxy(t,new Nl(new Proxy(t.table,new Ac(e,!1))))}function XI(t,e){return new me.Aliased(Pg(t.sql,e),t.fieldAlias)}function Pg(t,e){return x.join(t.queryChunks.map(r=>Y(r,Ct)?yo(r,e):Y(r,me)?Pg(r,e):Y(r,me.Aliased)?XI(r,e):r))}var zqe,Qf=class extends Error{constructor({message:e,cause:r}){super(e),this.name="DrizzleError",this.cause=r}};zqe=j,F(Qf,zqe,"DrizzleError");var Uqe,Ag=class extends Qf{constructor(){super({message:"Rollback"})}};Uqe=j,F(Ag,Uqe,"TransactionRollbackError");var Vqe,Pi=class extends Ht{defaultNow(){return this.default(x`now()`)}};Vqe=j,F(Pi,Vqe,"PgDateColumnBaseBuilder");var Hqe,eN=class extends Pi{constructor(e){super(e,"date","PgDate")}build(e){return new Wf(e,this.config)}};Hqe=j,F(eN,Hqe,"PgDateBuilder");var Gqe,Wf=class extends rt{getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}mapToDriverValue(e){return e.toISOString()}};Gqe=j,F(Wf,Gqe,"PgDate");var Kqe,tN=class extends Pi{constructor(e){super(e,"string","PgDateString")}build(e){return new Zf(e,this.config)}};Kqe=j,F(tN,Kqe,"PgDateStringBuilder");var Qqe,Zf=class extends rt{getSQLType(){return"date"}};Qqe=j,F(Zf,Qqe,"PgDateString");var Wqe,Eb=class extends Ht{constructor(e){super(e,"number","PgInteger")}build(e){return new wb(e,this.config)}};Wqe=j,F(Eb,Wqe,"PgIntegerBuilder");var Zqe,wb=class extends rt{getSQLType(){return"integer"}mapFromDriverValue(e){return typeof e=="string"?Number.parseInt(e):e}};Zqe=j,F(wb,Zqe,"PgInteger");function kt(t){return new Eb(t)}var Yqe,rN=class extends Ht{constructor(e){super(e,"json","PgJson")}build(e){return new Yf(e,this.config)}};Yqe=j,F(rN,Yqe,"PgJsonBuilder");var Jqe,Yf=class extends rt{constructor(e,r){super(e,r)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}};Jqe=j,F(Yf,Jqe,"PgJson");var Xqe,sN=class extends Ht{constructor(e){super(e,"json","PgJsonb")}build(e){return new Jf(e,this.config)}};Xqe=j,F(sN,Xqe,"PgJsonbBuilder");var eLe,Jf=class extends rt{constructor(e,r){super(e,r)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}};eLe=j,F(Jf,eLe,"PgJsonb");var tLe,Tb=class extends Ht{constructor(e,r,s){super(e,"string","PgNumeric"),this.config.precision=r,this.config.scale=s}build(e){return new Xf(e,this.config)}};tLe=j,F(Tb,tLe,"PgNumericBuilder");var rLe,Xf=class extends rt{precision;scale;constructor(e,r){super(e,r),this.precision=r.precision,this.scale=r.scale}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}};rLe=j,F(Xf,rLe,"PgNumeric");function nN(t,e){return new Tb(t,e?.precision,e?.scale)}var sLe,Cb=class extends Ht{constructor(e,r){super(e,"number","PgReal"),this.config.length=r}build(e){return new Rb(e,this.config)}};sLe=j,F(Cb,sLe,"PgRealBuilder");var nLe,Rb=class extends rt{constructor(e,r){super(e,r)}getSQLType(){return"real"}mapFromDriverValue=e=>typeof e=="string"?Number.parseFloat(e):e};nLe=j,F(Rb,nLe,"PgReal");function Dl(t){return new Cb(t)}var iLe,Ob=class extends Ht{constructor(e,r){super(e,"string","PgText"),this.config.enumValues=r.enum}build(e){return new Pb(e,this.config)}};iLe=j,F(Ob,iLe,"PgTextBuilder");var oLe,Pb=class extends rt{enumValues=this.config.enumValues;getSQLType(){return"text"}};oLe=j,F(Pb,oLe,"PgText");function vo(t,e={}){return new Ob(t,e)}var aLe,iN=class extends Pi{constructor(e,r,s){super(e,"string","PgTime"),this.withTimezone=r,this.precision=s,this.config.withTimezone=r,this.config.precision=s}build(e){return new eh(e,this.config)}};aLe=j,F(iN,aLe,"PgTimeBuilder");var lLe,eh=class extends rt{withTimezone;precision;constructor(e,r){super(e,r),this.withTimezone=r.withTimezone,this.precision=r.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}};lLe=j,F(eh,lLe,"PgTime");var uLe,Ab=class extends Pi{constructor(e,r,s){super(e,"date","PgTimestamp"),this.config.withTimezone=r,this.config.precision=s}build(e){return new th(e,this.config)}};uLe=j,F(Ab,uLe,"PgTimestampBuilder");var cLe,th=class extends rt{withTimezone;precision;constructor(e,r){super(e,r),this.withTimezone=r.withTimezone,this.precision=r.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=e=>new Date(this.withTimezone?e:e+"+0000");mapToDriverValue=e=>e.toISOString()};cLe=j,F(th,cLe,"PgTimestamp");var dLe,kb=class extends Pi{constructor(e,r,s){super(e,"string","PgTimestampString"),this.config.withTimezone=r,this.config.precision=s}build(e){return new rh(e,this.config)}};dLe=j,F(kb,dLe,"PgTimestampStringBuilder");var fLe,rh=class extends rt{withTimezone;precision;constructor(e,r){super(e,r),this.withTimezone=r.withTimezone,this.precision=r.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}};fLe=j,F(rh,fLe,"PgTimestampString");function $r(t,e={}){return e.mode==="string"?new kb(t,e.withTimezone??!1,e.precision):new Ab(t,e.withTimezone??!1,e.precision)}var hLe,xb=class extends Ht{constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default(x`gen_random_uuid()`)}build(e){return new sh(e,this.config)}};hLe=j,F(xb,hLe,"PgUUIDBuilder");var pLe,sh=class extends rt{getSQLType(){return"uuid"}};pLe=j,F(sh,pLe,"PgUUID");function qr(t){return new xb(t)}var mLe,Ib=class extends Ht{constructor(e,r){super(e,"string","PgVarchar"),this.config.length=r.length,this.config.enumValues=r.enum}build(e){return new Nb(e,this.config)}};mLe=j,F(Ib,mLe,"PgVarcharBuilder");var gLe,Nb=class extends rt{length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}};gLe=j,F(Nb,gLe,"PgVarchar");function Ke(t,e={}){return new Ib(t,e)}var yLe,kg=class{columns;name;constructor(e,r){this.columns=e,this.name=r}build(e){return new Db(e,this.columns,this.name)}};yLe=j,F(kg,yLe,"PgPrimaryKeyBuilder");var vLe,Db=class{constructor(e,r,s){this.table=e,this.columns=r,this.name=s}columns;name;getName(){return this.name??`${this.table[Tr.Symbol.Name]}_${this.columns.map(e=>e.name).join("_")}_pk`}};vLe=j,F(Db,vLe,"PgPrimaryKey");function Vs(t,e){return SZ(e)&&!QI(t)&&!Y(t,Us)&&!Y(t,Il)&&!Y(t,Ct)&&!Y(t,ue)&&!Y(t,gs)?new Us(t,e):t}var Ml=(t,e)=>x`${t} = ${Vs(e,t)}`,CZ=(t,e)=>x`${t} <> ${Vs(e,t)}`;function $l(...t){let e=t.filter(r=>r!==void 0);if(e.length!==0)return e.length===1?new me(e):new me([new fr("("),x.join(e,new fr(" and ")),new fr(")")])}function RZ(...t){let e=t.filter(r=>r!==void 0);if(e.length!==0)return e.length===1?new me(e):new me([new fr("("),x.join(e,new fr(" or ")),new fr(")")])}function OZ(t){return x`not ${t}`}var PZ=(t,e)=>x`${t} > ${Vs(e,t)}`,AZ=(t,e)=>x`${t} >= ${Vs(e,t)}`,kZ=(t,e)=>x`${t} < ${Vs(e,t)}`,xZ=(t,e)=>x`${t} <= ${Vs(e,t)}`;function Mb(t,e){if(Array.isArray(e)){if(e.length===0)throw new Error("inArray requires at least one value");return x`${t} in ${e.map(r=>Vs(r,t))}`}return x`${t} in ${Vs(e,t)}`}function IZ(t,e){if(Array.isArray(e)){if(e.length===0)throw new Error("notInArray requires at least one value");return x`${t} not in ${e.map(r=>Vs(r,t))}`}return x`${t} not in ${Vs(e,t)}`}function NZ(t){return x`${t} is null`}function DZ(t){return x`${t} is not null`}function MZ(t){return x`exists ${t}`}function $Z(t){return x`not exists ${t}`}function qZ(t,e,r){return x`${t} between ${Vs(e,t)} and ${Vs(r,t)}`}function LZ(t,e,r){return x`${t} not between ${Vs(e,t)} and ${Vs(r,t)}`}function jZ(t,e){return x`${t} like ${e}`}function FZ(t,e){return x`${t} not like ${e}`}function BZ(t,e){return x`${t} ilike ${e}`}function zZ(t,e){return x`${t} not ilike ${e}`}function UZ(t){return x`${t} asc`}function VZ(t){return x`${t} desc`}var bLe,xg=class{constructor(e,r,s){this.sourceTable=e,this.referencedTable=r,this.relationName=s,this.referencedTableName=r[ue.Symbol.Name]}referencedTableName;fieldName};bLe=j,F(xg,bLe,"Relation");var ELe,$b=class{constructor(e,r){this.table=e,this.config=r}};ELe=j,F($b,ELe,"Relations");var wLe,oN=class extends xg{constructor(e,r,s,n){super(e,r,s?.relationName),this.config=s,this.isNullable=n}withFieldName(e){let r=new oN(this.sourceTable,this.referencedTable,this.config,this.isNullable);return r.fieldName=e,r}},Sa=oN;wLe=j,F(Sa,wLe,"One");var TLe,aN=class extends xg{constructor(e,r,s){super(e,r,s?.relationName),this.config=s}withFieldName(e){let r=new aN(this.sourceTable,this.referencedTable,this.config);return r.fieldName=e,r}},nh=aN;TLe=j,F(nh,TLe,"Many");function HZ(){return{and:$l,between:qZ,eq:Ml,exists:MZ,gt:PZ,gte:AZ,ilike:BZ,inArray:Mb,isNull:NZ,isNotNull:DZ,like:jZ,lt:kZ,lte:xZ,ne:CZ,not:OZ,notBetween:LZ,notExists:$Z,notLike:FZ,notIlike:zZ,notInArray:IZ,or:RZ,sql:x}}function GZ(){return{sql:x,asc:UZ,desc:VZ}}function KZ(t,e){Object.keys(t).length===1&&"default"in t&&!Y(t.default,ue)&&(t=t.default);let r={},s={},n={};for(let[i,o]of Object.entries(t))if(hZ(o)){let a=o[ue.Symbol.Name],l=s[a];r[a]=i,n[i]={tsName:i,dbName:o[ue.Symbol.Name],schema:o[ue.Symbol.Schema],columns:o[ue.Symbol.Columns],relations:l?.relations??{},primaryKey:l?.primaryKey??[]};for(let c of Object.values(o[ue.Symbol.Columns]))c.primary&&n[i].primaryKey.push(c);let u=o[ue.Symbol.ExtraConfigBuilder]?.(o[ue.Symbol.ExtraConfigColumns]);if(u)for(let c of Object.values(u))Y(c,kg)&&n[i].primaryKey.push(...c.columns)}else if(Y(o,$b)){let a=o.table[ue.Symbol.Name],l=r[a],u=o.config(e(o.table)),c;for(let[d,f]of Object.entries(u))if(l){let h=n[l];h.relations[d]=f,c&&h.primaryKey.push(...c)}else a in s||(s[a]={relations:{},primaryKey:c}),s[a].relations[d]=f}return{tables:n,tableNamesMap:r}}function _Le(t){return function(r,s){return new Sa(t,r,s,s?.fields.reduce((n,i)=>n&&i.notNull,!0)??!1)}}function SLe(t){return function(r,s){return new nh(t,r,s)}}function QZ(t,e,r){if(Y(r,Sa)&&r.config)return{fields:r.config.fields,references:r.config.references};let s=e[r.referencedTable[ue.Symbol.Name]];if(!s)throw new Error(`Table "${r.referencedTable[ue.Symbol.Name]}" not found in schema`);let n=t[s];if(!n)throw new Error(`Table "${s}" not found in schema`);let i=r.sourceTable,o=e[i[ue.Symbol.Name]];if(!o)throw new Error(`Table "${i[ue.Symbol.Name]}" not found in schema`);let a=[];for(let l of Object.values(n.relations))(r.relationName&&r!==l&&l.relationName===r.relationName||!r.relationName&&l.referencedTable===r.sourceTable)&&a.push(l);if(a.length>1)throw r.relationName?new Error(`There are multiple relations with name "${r.relationName}" in table "${s}"`):new Error(`There are multiple relations between "${s}" and "${r.sourceTable[ue.Symbol.Name]}". Please specify relation name`);if(a[0]&&Y(a[0],Sa)&&a[0].config)return{fields:a[0].config.references,references:a[0].config.fields};throw new Error(`There is not enough information to infer relation "${o}.${r.fieldName}"`)}function WZ(t){return{one:_Le(t),many:SLe(t)}}function qb(t,e,r,s,n=i=>i){let i={};for(let[o,a]of s.entries())if(a.isJson){let l=e.relations[a.tsKey],u=r[o],c=typeof u=="string"?JSON.parse(u):u;i[a.tsKey]=Y(l,Sa)?c&&qb(t,t[a.relationTableTsKey],c,a.selection,n):c.map(d=>qb(t,t[a.relationTableTsKey],d,a.selection,n))}else{let l=n(r[o]),u=a.field,c;Y(u,Ct)?c=u:Y(u,me)?c=u.decoder:c=u.sql.decoder,i[a.tsKey]=l===null?null:c.mapFromDriverValue(l)}return i}var CLe,_o=class extends gs{};CLe=j,F(_o,CLe,"PgViewBase");var RLe,kc=class{async migrate(e,r,s){let n=typeof s=="string"?"__drizzle_migrations":s.migrationsTable??"__drizzle_migrations",i=typeof s=="string"?"drizzle":s.migrationsSchema??"drizzle",o=x`
			CREATE TABLE IF NOT EXISTS ${x.identifier(i)}.${x.identifier(n)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at bigint
			)
		`;await r.execute(x`CREATE SCHEMA IF NOT EXISTS ${x.identifier(i)}`),await r.execute(o);let l=(await r.all(x`select id, hash, created_at from ${x.identifier(i)}.${x.identifier(n)} order by created_at desc limit 1`))[0];await r.transaction(async u=>{for await(let c of e)if(!l||Number(l.created_at)<c.folderMillis){for(let d of c.sql)await u.execute(x.raw(d));await u.execute(x`insert into ${x.identifier(i)}.${x.identifier(n)} ("hash", "created_at") values(${c.hash}, ${c.folderMillis})`)}})}escapeName(e){return`"${e}"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildWithCTE(e){if(!e?.length)return;let r=[x`with `];for(let[s,n]of e.entries())r.push(x`${x.identifier(n._.alias)} as (${n._.sql})`),s<e.length-1&&r.push(x`, `);return r.push(x` `),x.join(r)}buildDeleteQuery({table:e,where:r,returning:s,withList:n}){let i=this.buildWithCTE(n),o=s?x` returning ${this.buildSelection(s,{isSingleTable:!0})}`:void 0,a=r?x` where ${r}`:void 0;return x`${i}delete from ${e}${a}${o}`}buildUpdateSet(e,r){let s=e[ue.Symbol.Columns],n=Object.keys(s).filter(o=>r[o]!==void 0||s[o]?.onUpdateFn!==void 0),i=n.length;return x.join(n.flatMap((o,a)=>{let l=s[o],u=r[o]??x.param(l.onUpdateFn(),l),c=x`${x.identifier(l.name)} = ${u}`;return a<i-1?[c,x.raw(", ")]:[c]}))}buildUpdateQuery({table:e,set:r,where:s,returning:n,withList:i}){let o=this.buildWithCTE(i),a=this.buildUpdateSet(e,r),l=n?x` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0,u=s?x` where ${s}`:void 0;return x`${o}update ${e} set ${a}${u}${l}`}buildSelection(e,{isSingleTable:r=!1}={}){let s=e.length,n=e.flatMap(({field:i},o)=>{let a=[];if(Y(i,me.Aliased)&&i.isSelectionField)a.push(x.identifier(i.fieldAlias));else if(Y(i,me.Aliased)||Y(i,me)){let l=Y(i,me.Aliased)?i.sql:i;r?a.push(new me(l.queryChunks.map(u=>Y(u,rt)?x.identifier(u.name):u))):a.push(l),Y(i,me.Aliased)&&a.push(x` as ${x.identifier(i.fieldAlias)}`)}else Y(i,Ct)&&(r?a.push(x.identifier(i.name)):a.push(i));return o<s-1&&a.push(x`, `),a});return x.join(n)}buildSelectQuery({withList:e,fields:r,fieldsFlat:s,where:n,having:i,table:o,joins:a,orderBy:l,groupBy:u,limit:c,offset:d,lockingClause:f,distinct:h,setOperators:p}){let g=s??Hn(r);for(let V of g)if(Y(V.field,Ct)&&xl(V.field.table)!==(Y(o,Cr)?o._.alias:Y(o,_o)?o[Xt].name:Y(o,me)?void 0:xl(o))&&!(G=>a?.some(({alias:X})=>X===(G[ue.Symbol.IsAlias]?xl(G):G[ue.Symbol.BaseName])))(V.field.table)){let G=xl(V.field.table);throw new Error(`Your "${V.path.join("->")}" field references a column "${G}"."${V.field.name}", but the table "${G}" is not part of the query! Did you forget to join it?`)}let _=!a||a.length===0,S=this.buildWithCTE(e),b;h&&(b=h===!0?x` distinct`:x` distinct on (${x.join(h.on,x`, `)})`);let v=this.buildSelection(g,{isSingleTable:_}),y=(()=>{if(Y(o,ue)&&o[ue.Symbol.OriginalName]!==o[ue.Symbol.Name]){let V=x`${x.identifier(o[ue.Symbol.OriginalName])}`;return o[ue.Symbol.Schema]&&(V=x`${x.identifier(o[ue.Symbol.Schema])}.${V}`),x`${V} ${x.identifier(o[ue.Symbol.Name])}`}return o})(),R=[];if(a)for(let[V,G]of a.entries()){V===0&&R.push(x` `);let X=G.table,pe=G.lateral?x` lateral`:void 0;if(Y(X,Tr)){let J=X[Tr.Symbol.Name],ye=X[Tr.Symbol.Schema],st=X[Tr.Symbol.OriginalName],ve=J===st?void 0:G.alias;R.push(x`${x.raw(G.joinType)} join${pe} ${ye?x`${x.identifier(ye)}.`:void 0}${x.identifier(st)}${ve&&x` ${x.identifier(ve)}`} on ${G.on}`)}else if(Y(X,gs)){let J=X[Xt].name,ye=X[Xt].schema,st=X[Xt].originalName,ve=J===st?void 0:G.alias;R.push(x`${x.raw(G.joinType)} join${pe} ${ye?x`${x.identifier(ye)}.`:void 0}${x.identifier(st)}${ve&&x` ${x.identifier(ve)}`} on ${G.on}`)}else R.push(x`${x.raw(G.joinType)} join${pe} ${X} on ${G.on}`);V<a.length-1&&R.push(x` `)}let P=x.join(R),w=n?x` where ${n}`:void 0,O=i?x` having ${i}`:void 0,$;l&&l.length>0&&($=x` order by ${x.join(l,x`, `)}`);let C;u&&u.length>0&&(C=x` group by ${x.join(u,x`, `)}`);let k=c?x` limit ${c}`:void 0,z=d?x` offset ${d}`:void 0,A=x.empty();if(f){let V=x` for ${x.raw(f.strength)}`;f.config.of&&V.append(x` of ${x.join(Array.isArray(f.config.of)?f.config.of:[f.config.of],x`, `)}`),f.config.noWait?V.append(x` no wait`):f.config.skipLocked&&V.append(x` skip locked`),A.append(V)}let E=x`${S}select${b} ${v} from ${y}${P}${w}${C}${O}${$}${k}${z}${A}`;return p.length>0?this.buildSetOperations(E,p):E}buildSetOperations(e,r){let[s,...n]=r;if(!s)throw new Error("Cannot pass undefined values to any set operator");return n.length===0?this.buildSetOperationQuery({leftSelect:e,setOperator:s}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:s}),n)}buildSetOperationQuery({leftSelect:e,setOperator:{type:r,isAll:s,rightSelect:n,limit:i,orderBy:o,offset:a}}){let l=x`(${e.getSQL()}) `,u=x`(${n.getSQL()})`,c;if(o&&o.length>0){let p=[];for(let g of o)if(Y(g,rt))p.push(x.identifier(g.name));else if(Y(g,me)){for(let _=0;_<g.queryChunks.length;_++){let S=g.queryChunks[_];Y(S,rt)&&(g.queryChunks[_]=x.identifier(S.name))}p.push(x`${g}`)}else p.push(x`${g}`);c=x` order by ${x.join(p,x`, `)} `}let d=i?x` limit ${i}`:void 0,f=x.raw(`${r} ${s?"all ":""}`),h=a?x` offset ${a}`:void 0;return x`${l}${f}${u}${c}${d}${h}`}buildInsertQuery({table:e,values:r,onConflict:s,returning:n,withList:i}){let o=[],a=e[ue.Symbol.Columns],l=Object.entries(a),u=l.map(([,p])=>x.identifier(p.name));for(let[p,g]of r.entries()){let _=[];for(let[S,b]of l){let v=g[S];if(v===void 0||Y(v,Us)&&v.value===void 0)if(b.defaultFn!==void 0){let y=b.defaultFn(),R=Y(y,me)?y:x.param(y,b);_.push(R)}else if(!b.default&&b.onUpdateFn!==void 0){let y=b.onUpdateFn(),R=Y(y,me)?y:x.param(y,b);_.push(R)}else _.push(x`default`);else _.push(v)}o.push(_),p<r.length-1&&o.push(x`, `)}let c=this.buildWithCTE(i),d=x.join(o),f=n?x` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0,h=s?x` on conflict ${s}`:void 0;return x`${c}insert into ${e} ${u} values ${d}${h}${f}`}buildRefreshMaterializedViewQuery({view:e,concurrently:r,withNoData:s}){let n=r?x` concurrently`:void 0,i=s?x` with no data`:void 0;return x`refresh materialized view${n} ${e}${i}`}prepareTyping(e){return Y(e,Jf)||Y(e,Yf)?"json":Y(e,Xf)?"decimal":Y(e,eh)?"time":Y(e,th)||Y(e,rh)?"timestamp":Y(e,Wf)||Y(e,Zf)?"date":Y(e,sh)?"uuid":"none"}sqlToQuery(e,r){return e.toQuery({escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:r})}buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:s,table:n,tableConfig:i,queryConfig:o,tableAlias:a,nestedQueryRelation:l,joinOn:u}){let c=[],d,f,h=[],p,g=[];if(o===!0)c=Object.entries(i.columns).map(([b,v])=>({dbKey:v.name,tsKey:b,field:yo(v,a),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let S=Object.fromEntries(Object.entries(i.columns).map(([w,O])=>[w,yo(O,a)]));if(o.where){let w=typeof o.where=="function"?o.where(S,HZ()):o.where;p=w&&Pg(w,a)}let b=[],v=[];if(o.columns){let w=!1;for(let[O,$]of Object.entries(o.columns))$!==void 0&&O in i.columns&&(!w&&$===!0&&(w=!0),v.push(O));v.length>0&&(v=w?v.filter(O=>o.columns?.[O]===!0):Object.keys(i.columns).filter(O=>!v.includes(O)))}else v=Object.keys(i.columns);for(let w of v){let O=i.columns[w];b.push({tsKey:w,value:O})}let y=[];o.with&&(y=Object.entries(o.with).filter(w=>!!w[1]).map(([w,O])=>({tsKey:w,queryConfig:O,relation:i.relations[w]})));let R;if(o.extras){R=typeof o.extras=="function"?o.extras(S,{sql:x}):o.extras;for(let[w,O]of Object.entries(R))b.push({tsKey:w,value:XI(O,a)})}for(let{tsKey:w,value:O}of b)c.push({dbKey:Y(O,me.Aliased)?O.fieldAlias:i.columns[w].name,tsKey:w,field:Y(O,Ct)?yo(O,a):O,relationTableTsKey:void 0,isJson:!1,selection:[]});let P=typeof o.orderBy=="function"?o.orderBy(S,GZ()):o.orderBy??[];Array.isArray(P)||(P=[P]),h=P.map(w=>Y(w,Ct)?yo(w,a):Pg(w,a)),d=o.limit,f=o.offset;for(let{tsKey:w,queryConfig:O,relation:$}of y){let C=QZ(r,s,$),k=$.referencedTable[ue.Symbol.Name],z=s[k],A=`${a}_${w}`,E=$l(...C.fields.map((X,pe)=>Ml(yo(C.references[pe],A),yo(X,a)))),V=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:s,table:e[z],tableConfig:r[z],queryConfig:Y($,Sa)?O===!0?{limit:1}:{...O,limit:1}:O,tableAlias:A,joinOn:E,nestedQueryRelation:$}),G=x`${x.identifier(A)}.${x.identifier("data")}`.as(w);g.push({on:x`true`,table:new Cr(V.sql,{},A),alias:A,joinType:"left",lateral:!0}),c.push({dbKey:w,tsKey:w,field:G,relationTableTsKey:z,isJson:!0,selection:V.selection})}}if(c.length===0)throw new Qf({message:`No fields selected for table "${i.tsName}" ("${a}")`});let _;if(p=$l(u,p),l){let S=x`json_build_array(${x.join(c.map(({field:y,tsKey:R,isJson:P})=>P?x`${x.identifier(`${a}_${R}`)}.${x.identifier("data")}`:Y(y,me.Aliased)?y.sql:y),x`, `)})`;Y(l,nh)&&(S=x`coalesce(json_agg(${S}${h.length>0?x` order by ${x.join(h,x`, `)}`:void 0}), '[]'::json)`);let b=[{dbKey:"data",tsKey:"data",field:S.as("data"),isJson:!0,relationTableTsKey:i.tsName,selection:c}];d!==void 0||f!==void 0||h.length>0?(_=this.buildSelectQuery({table:Og(n,a),fields:{},fieldsFlat:[{path:[],field:x.raw("*")}],where:p,limit:d,offset:f,orderBy:h,setOperators:[]}),p=void 0,d=void 0,f=void 0,h=[]):_=Og(n,a),_=this.buildSelectQuery({table:Y(_,Tr)?_:new Cr(_,{},a),fields:{},fieldsFlat:b.map(({field:y})=>({path:[],field:Y(y,Ct)?yo(y,a):y})),joins:g,where:p,limit:d,offset:f,orderBy:h,setOperators:[]})}else _=this.buildSelectQuery({table:Og(n,a),fields:{},fieldsFlat:c.map(({field:S})=>({path:[],field:Y(S,Ct)?yo(S,a):S})),joins:g,where:p,limit:d,offset:f,orderBy:h,setOperators:[]});return{tableTsKey:i.tsName,sql:_,selection:c}}};RLe=j,F(kc,RLe,"PgDialect");var OLe,lN=class{config;constructor(e){this.config={...e}}get(e,r){if(r==="_")return{...e._,selectedFields:new Proxy(e._.selectedFields,this)};if(r===Xt)return{...e[Xt],selectedFields:new Proxy(e[Xt].selectedFields,this)};if(typeof r=="symbol")return e[r];let n=(Y(e,Cr)?e._.selectedFields:Y(e,gs)?e[Xt].selectedFields:e)[r];if(Y(n,me.Aliased)){if(this.config.sqlAliasedBehavior==="sql"&&!n.isSelectionField)return n.sql;let i=n.clone();return i.isSelectionField=!0,i}if(Y(n,me)){if(this.config.sqlBehavior==="sql")return n;throw new Error(`You tried to reference "${r}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return Y(n,Ct)?this.config.alias?new Proxy(n,new Nl(new Proxy(n.table,new Ac(this.config.alias,this.config.replaceOriginalName??!1)))):n:typeof n!="object"||n===null?n:new Proxy(n,new lN(this.config))}},nr=lN;OLe=j,F(nr,OLe,"SelectionProxyHandler");var PLe,Ig=class{getSelectedFields(){return this._.selectedFields}};PLe=j,F(Ig,PLe,"TypedQueryBuilder");var $Le,Yr=class{fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}from(e){let r=!!this.fields,s;return this.fields?s=this.fields:Y(e,Cr)?s=Object.fromEntries(Object.keys(e._.selectedFields).map(n=>[n,e[n]])):Y(e,_o)?s=e[Xt].selectedFields:Y(e,me)?s={}:s=Rg(e),new Ng({table:e,fields:s,isPartialSelect:r,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct})}};$Le=j,F(Yr,$Le,"PgSelectBuilder");var qLe,Lb=class extends Ig{_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:r,isPartialSelect:s,session:n,dialect:i,withList:o,distinct:a}){super(),this.config={withList:o,table:e,fields:{...r},distinct:a,setOperators:[]},this.isPartialSelect=s,this.session=n,this.dialect=i,this._={selectedFields:r},this.tableName=YI(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}createJoin(e){return(r,s)=>{let n=this.tableName,i=YI(r);if(typeof i=="string"&&this.config.joins?.some(o=>o.alias===i))throw new Error(`Alias "${i}" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof n=="string"&&(this.config.fields={[n]:this.config.fields}),typeof i=="string"&&!Y(r,me))){let o=Y(r,Cr)?r._.selectedFields:Y(r,gs)?r[Xt].selectedFields:r[ue.Symbol.Columns];this.config.fields[i]=o}if(typeof s=="function"&&(s=s(new Proxy(this.config.fields,new nr({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:s,table:r,joinType:e,alias:i}),typeof i=="string")switch(e){case"left":{this.joinsNotNullableMap[i]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([o])=>[o,!1])),this.joinsNotNullableMap[i]=!0;break}case"inner":{this.joinsNotNullableMap[i]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([o])=>[o,!1])),this.joinsNotNullableMap[i]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");createSetOperator(e,r){return s=>{let n=typeof s=="function"?s(ALe()):s;if(!ZI(this.getSelectedFields(),n.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:e,isAll:r,rightSelect:n}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new nr({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=e,this}having(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new nr({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=e,this}groupBy(...e){if(typeof e[0]=="function"){let r=e[0](new Proxy(this.config.fields,new nr({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(r)?r:[r]}else this.config.groupBy=e;return this}orderBy(...e){if(typeof e[0]=="function"){let r=e[0](new Proxy(this.config.fields,new nr({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),s=Array.isArray(r)?r:[r];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=s:this.config.orderBy=s}else{let r=e;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,r={}){return this.config.lockingClause={strength:e,config:r},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}as(e){return new Proxy(new Cr(this.getSQL(),this.config.fields,e),new nr({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new nr({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}};qLe=j,F(Lb,qLe,"PgSelectQueryBuilder");var LLe,Ng=class extends Lb{_prepare(e){let{session:r,config:s,dialect:n,joinsNotNullableMap:i}=this;if(!r)throw new Error("Cannot execute a query on a query builder. Please use a database instance instead.");return At.startActiveSpan("drizzle.prepareQuery",()=>{let o=Hn(s.fields),a=r.prepareQuery(n.sqlToQuery(this.getSQL()),o,e,!0);return a.joinsNotNullableMap=i,a})}prepare(e){return this._prepare(e)}execute=e=>At.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e))};LLe=j,F(Ng,LLe,"PgSelect");TZ(Ng,[Zr]);function ih(t,e){return(r,s,...n)=>{let i=[s,...n].map(o=>({type:t,isAll:e,rightSelect:o}));for(let o of i)if(!ZI(r.getSelectedFields(),o.rightSelect.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return r.addSetOperators(i)}}var ALe=()=>({union:kLe,unionAll:xLe,intersect:ILe,intersectAll:NLe,except:DLe,exceptAll:MLe}),kLe=ih("union",!1),xLe=ih("union",!0),ILe=ih("intersect",!1),NLe=ih("intersect",!0),DLe=ih("except",!1),MLe=ih("except",!0);var jLe,ql=class{dialect;$with(e){let r=this;return{as(s){return typeof s=="function"&&(s=s(r)),new Proxy(new Pc(s.getSQL(),s.getSelectedFields(),e,!0),new nr({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}}}with(...e){let r=this;function s(o){return new Yr({fields:o??void 0,session:void 0,dialect:r.getDialect(),withList:e})}function n(o){return new Yr({fields:o??void 0,session:void 0,dialect:r.getDialect(),distinct:!0})}function i(o,a){return new Yr({fields:a??void 0,session:void 0,dialect:r.getDialect(),distinct:{on:o}})}return{select:s,selectDistinct:n,selectDistinctOn:i}}select(e){return new Yr({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new Yr({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,r){return new Yr({fields:r??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new kc),this.dialect}};jLe=j,F(ql,jLe,"PgQueryBuilder");var FLe,Dg=class extends Zr{constructor(e,r,s){super(),this.session=r,this.dialect=s,this.config={view:e}}config;concurrently(){if(this.config.withNoData!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.concurrently=!0,this}withNoData(){if(this.config.concurrently!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return At.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,e,!0))}prepare(e){return this._prepare(e)}execute=e=>At.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e))};FLe=j,F(Dg,FLe,"PgRefreshMaterializedView");var BLe,oh=class{constructor(e,r,s,n){this.table=e,this.session=r,this.dialect=s,this.withList=n}set(e){return new jb(this.table,Sb(this.table,e),this.session,this.dialect,this.withList)}};BLe=j,F(oh,BLe,"PgUpdateBuilder");var zLe,jb=class extends Zr{constructor(e,r,s,n,i){super(),this.session=s,this.dialect=n,this.config={set:r,table:e,withList:i}}config;where(e){return this.config.where=e,this}returning(e=this.config.table[ue.Symbol.Columns]){return this.config.returning=Hn(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0)}prepare(e){return this._prepare(e)}execute=e=>this._prepare().execute(e);$dynamic(){return this}};zLe=j,F(jb,zLe,"PgUpdate");var ULe,Mg=class{constructor(e,r,s,n,i,o,a){this.fullSchema=e,this.schema=r,this.tableNamesMap=s,this.table=n,this.tableConfig=i,this.dialect=o,this.session=a}findMany(e){return new $g(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},"many")}findFirst(e){return new $g(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},"first")}};ULe=j,F(Mg,ULe,"PgRelationalQueryBuilder");var VLe,$g=class extends Zr{constructor(e,r,s,n,i,o,a,l,u){super(),this.fullSchema=e,this.schema=r,this.tableNamesMap=s,this.table=n,this.tableConfig=i,this.dialect=o,this.session=a,this.config=l,this.mode=u}_prepare(e){return At.startActiveSpan("drizzle.prepareQuery",()=>{let{query:r,builtQuery:s}=this._toSQL();return this.session.prepareQuery(s,void 0,e,!0,(n,i)=>{let o=n.map(a=>qb(this.schema,this.tableConfig,a,r.selection,i));return this.mode==="first"?o[0]:o})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let e=this._getQuery(),r=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:r}}toSQL(){return this._toSQL().builtQuery}execute(){return At.startActiveSpan("drizzle.operation",()=>this._prepare().execute())}};VLe=j,F($g,VLe,"PgRelationalQuery");var HLe,qg=class extends Zr{constructor(e,r,s,n){super(),this.execute=e,this.sql=r,this.query=s,this.mapBatchResult=n}getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,r){return r?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}};HLe=j,F(qg,HLe,"PgRaw");var GLe,xc=class{constructor(e,r,s){if(this.dialect=e,this.session=r,this._=s?{schema:s.schema,fullSchema:s.fullSchema,tableNamesMap:s.tableNamesMap,session:r}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:r},this.query={},this._.schema)for(let[n,i]of Object.entries(this._.schema))this.query[n]=new Mg(s.fullSchema,this._.schema,this._.tableNamesMap,s.fullSchema[n],i,e,r)}query;$with(e){return{as(r){return typeof r=="function"&&(r=r(new ql)),new Proxy(new Pc(r.getSQL(),r.getSelectedFields(),e,!0),new nr({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}}}with(...e){let r=this;function s(u){return new Yr({fields:u??void 0,session:r.session,dialect:r.dialect,withList:e})}function n(u){return new Yr({fields:u??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:!0})}function i(u,c){return new Yr({fields:c??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:{on:u}})}function o(u){return new oh(u,r.session,r.dialect,e)}function a(u){return new Kf(u,r.session,r.dialect,e)}function l(u){return new Gf(u,r.session,r.dialect,e)}return{select:s,selectDistinct:n,selectDistinctOn:i,update:o,insert:a,delete:l}}select(e){return new Yr({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new Yr({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,r){return new Yr({fields:r??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new oh(e,this.session,this.dialect)}insert(e){return new Kf(e,this.session,this.dialect)}delete(e){return new Gf(e,this.session,this.dialect)}refreshMaterializedView(e){return new Dg(e,this.session,this.dialect)}execute(e){let r=e.getSQL(),s=this.dialect.sqlToQuery(r),n=this.session.prepareQuery(s,void 0,void 0,!1);return new qg(()=>n.execute(),r,s,i=>n.mapResult(i,!0))}transaction(e,r){return this.session.transaction(e,r)}};GLe=j,F(xc,GLe,"PgDatabase");var e7=kr(Sg(),1);var KLe,Fb=class{constructor(e,r){this.unique=e,this.name=r}on(...e){return new ah(e.map(r=>{if(Y(r,me))return r;r=r;let s=new Oc(r.name,r.columnType,r.indexConfig);return r.indexConfig=JSON.parse(JSON.stringify(r.defaultConfig)),s}),this.unique,!1,this.name)}onOnly(...e){return new ah(e.map(r=>{if(Y(r,me))return r;r=r;let s=new Oc(r.name,r.columnType,r.indexConfig);return r.indexConfig=r.defaultConfig,s}),this.unique,!0,this.name)}using(e,...r){return new ah(r.map(s=>{if(Y(s,me))return s;s=s;let n=new Oc(s.name,s.columnType,s.indexConfig);return s.indexConfig=JSON.parse(JSON.stringify(s.defaultConfig)),n}),this.unique,!0,this.name,e)}};KLe=j,F(Fb,KLe,"PgIndexBuilderOn");var QLe,ah=class{config;constructor(e,r,s,n,i="btree"){this.config={name:n,columns:e,unique:r,only:s,method:i}}concurrently(){return this.config.concurrently=!0,this}with(e){return this.config.with=e,this}where(e){return this.config.where=e,this}build(e){return new Bb(this.config,e)}};QLe=j,F(ah,QLe,"PgIndexBuilder");var WLe,Bb=class{config;constructor(e,r){this.config={...e,table:r}}};WLe=j,F(Bb,WLe,"PgIndex");function So(t){return new Fb(!1,t)}var uN=Symbol.for("drizzle:PgViewConfig");var ZLe,Lg=class{constructor(e,r){this.name=e,this.schema=r}config={};with(e){return this.config.with=e,this}};ZLe=j,F(Lg,ZLe,"PgDefaultViewBuilderCore");var YLe,zb=class extends Lg{as(e){typeof e=="function"&&(e=e(new ql));let r=new nr({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}),s=new Proxy(e.getSelectedFields(),r);return new Proxy(new lh({pgConfig:this.config,config:{name:this.name,schema:this.schema,selectedFields:s,query:e.getSQL().inlineParams()}}),r)}};YLe=j,F(zb,YLe,"PgViewBuilder");var JLe,Ub=class extends Lg{columns;constructor(e,r,s){super(e,s),this.columns=Rg(BI(e,r))}existing(){return new Proxy(new lh({pgConfig:void 0,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:void 0}}),new nr({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}as(e){return new Proxy(new lh({pgConfig:this.config,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:e.inlineParams()}}),new nr({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}};JLe=j,F(Ub,JLe,"PgManualViewBuilder");var XLe,jg=class{constructor(e,r){this.name=e,this.schema=r}config={};using(e){return this.config.using=e,this}with(e){return this.config.with=e,this}tablespace(e){return this.config.tablespace=e,this}withNoData(){return this.config.withNoData=!0,this}};XLe=j,F(jg,XLe,"PgMaterializedViewBuilderCore");var eje,Vb=class extends jg{as(e){typeof e=="function"&&(e=e(new ql));let r=new nr({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}),s=new Proxy(e.getSelectedFields(),r);return new Proxy(new uh({pgConfig:{with:this.config.with,using:this.config.using,tablespace:this.config.tablespace,withNoData:this.config.withNoData},config:{name:this.name,schema:this.schema,selectedFields:s,query:e.getSQL().inlineParams()}}),r)}};eje=j,F(Vb,eje,"PgMaterializedViewBuilder");var tje,Hb=class extends jg{columns;constructor(e,r,s){super(e,s),this.columns=Rg(BI(e,r))}existing(){return new Proxy(new uh({pgConfig:void 0,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:void 0}}),new nr({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}as(e){return new Proxy(new uh({pgConfig:void 0,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:e.inlineParams()}}),new nr({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}};tje=j,F(Hb,tje,"PgManualMaterializedViewBuilder");var rje,lh=class extends _o{[(rje=j,uN)];constructor({pgConfig:e,config:r}){super(r),e&&(this[uN]={with:e.with})}};F(lh,rje,"PgView");var ZZ=Symbol.for("drizzle:PgMaterializedViewConfig"),sje,uh=class extends _o{[(sje=j,ZZ)];constructor({pgConfig:e,config:r}){super(r),this[ZZ]={with:e?.with,using:e?.using,tablespace:e?.tablespace,withNoData:e?.withNoData}}};F(uh,sje,"PgMaterializedView");function YZ(t,e,r){return e?new Ub(t,e,r):new zb(t,r)}function JZ(t,e,r){return e?new Hb(t,e,r):new Vb(t,r)}var nje,Gb=class{constructor(e){this.schemaName=e}table=(e,r,s)=>FI(e,r,s,this.schemaName);view=(e,r)=>YZ(e,r,this.schemaName);materializedView=(e,r)=>JZ(e,r,this.schemaName);enum=(e,r)=>_Z(e,r,this.schemaName)};nje=j,F(Gb,nje,"PgSchema");function Gn(t){if(t==="public")throw new Error("You can't specify 'public' as schema name. Postgres is using public schema by default. If you want to use 'public' schema, just use pgTable() instead of creating a schema");return new Gb(t)}var ije,Fg=class{constructor(e){this.query=e}getQuery(){return this.query}mapResult(e,r){return e}joinsNotNullableMap};ije=j,F(Fg,ije,"PgPreparedQuery");var oje,Bg=class{constructor(e){this.dialect=e}execute(e){return At.startActiveSpan("drizzle.operation",()=>At.startActiveSpan("drizzle.prepareQuery",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).execute())}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}};oje=j,F(Bg,oje,"PgSession");var aje,zg=class extends xc{constructor(e,r,s,n=0){super(e,r,s),this.schema=s,this.nestedIndex=n}rollback(){throw new Ag}getTransactionConfigSQL(e){let r=[];return e.isolationLevel&&r.push(`isolation level ${e.isolationLevel}`),e.accessMode&&r.push(e.accessMode),typeof e.deferrable=="boolean"&&r.push(e.deferrable?"deferrable":"not deferrable"),x.raw(r.join(" "))}setTransaction(e){return this.session.execute(x`set transaction ${this.getTransactionConfigSQL(e)}`)}};aje=j,F(zg,aje,"PgTransaction");var{Pool:XZ}=e7.default,lje,Kb=class extends Fg{constructor(e,r,s,n,i,o,a,l){super({sql:r,params:s}),this.client=e,this.params=s,this.logger=n,this.fields=i,this._isResponseInArrayMode=a,this.customResultMapper=l,this.rawQueryConfig={name:o,text:r},this.queryConfig={name:o,text:r,rowMode:"array"}}rawQueryConfig;queryConfig;async execute(e={}){return At.startActiveSpan("drizzle.execute",async()=>{let r=WI(this.params,e);this.logger.logQuery(this.rawQueryConfig.text,r);let{fields:s,rawQueryConfig:n,client:i,queryConfig:o,joinsNotNullableMap:a,customResultMapper:l}=this;if(!s&&!l)return At.startActiveSpan("drizzle.driver.execute",async c=>(c?.setAttributes({"drizzle.query.name":n.name,"drizzle.query.text":n.text,"drizzle.query.params":JSON.stringify(r)}),i.query(n,r)));let u=await At.startActiveSpan("drizzle.driver.execute",c=>(c?.setAttributes({"drizzle.query.name":o.name,"drizzle.query.text":o.text,"drizzle.query.params":JSON.stringify(r)}),i.query(o,r)));return At.startActiveSpan("drizzle.mapResponse",()=>l?l(u.rows):u.rows.map(c=>wZ(s,c,a)))})}all(e={}){return At.startActiveSpan("drizzle.execute",()=>{let r=WI(this.params,e);return this.logger.logQuery(this.rawQueryConfig.text,r),At.startActiveSpan("drizzle.driver.execute",s=>(s?.setAttributes({"drizzle.query.name":this.rawQueryConfig.name,"drizzle.query.text":this.rawQueryConfig.text,"drizzle.query.params":JSON.stringify(r)}),this.client.query(this.rawQueryConfig,r).then(n=>n.rows)))})}isResponseInArrayMode(){return this._isResponseInArrayMode}};lje=j,F(Kb,lje,"NodePgPreparedQuery");var uje,cN=class extends Bg{constructor(e,r,s,n={}){super(r),this.client=e,this.schema=s,this.options=n,this.logger=n.logger??new wg}logger;prepareQuery(e,r,s,n,i){return new Kb(this.client,e.sql,e.params,this.logger,r,s,n,i)}async transaction(e,r){let s=this.client instanceof XZ?new cN(await this.client.connect(),this.dialect,this.schema,this.options):this,n=new Qb(this.dialect,s,this.schema);await n.execute(x`begin${r?x` ${n.getTransactionConfigSQL(r)}`:void 0}`);try{let i=await e(n);return await n.execute(x`commit`),i}catch(i){throw await n.execute(x`rollback`),i}finally{this.client instanceof XZ&&s.client.release()}}},Ug=cN;uje=j,F(Ug,uje,"NodePgSession");var cje,dN=class extends zg{async transaction(e){let r=`sp${this.nestedIndex+1}`,s=new dN(this.dialect,this.session,this.schema,this.nestedIndex+1);await s.execute(x.raw(`savepoint ${r}`));try{let n=await e(s);return await s.execute(x.raw(`release savepoint ${r}`)),n}catch(n){throw await s.execute(x.raw(`rollback to savepoint ${r}`)),n}}},Qb=dN;cje=j,F(Qb,cje,"NodePgTransaction");var{types:Ll}=t7.default,dje,Wb=class{constructor(e,r,s={}){this.client=e,this.dialect=r,this.options=s,this.initMappers()}createSession(e){return new Ug(this.client,this.dialect,e,{logger:this.options.logger})}initMappers(){Ll.setTypeParser(Ll.builtins.TIMESTAMPTZ,e=>e),Ll.setTypeParser(Ll.builtins.TIMESTAMP,e=>e),Ll.setTypeParser(Ll.builtins.DATE,e=>e),Ll.setTypeParser(Ll.builtins.INTERVAL,e=>e)}};dje=j,F(Wb,dje,"NodePgDriver");function r7(t,e={}){let r=new kc,s;e.logger===!0?s=new Eg:e.logger!==!1&&(s=e.logger);let n;if(e.schema){let a=KZ(e.schema,WZ);n={fullSchema:e.schema,schema:a.tables,tableNamesMap:a.tableNamesMap}}let o=new Wb(t,r,{logger:s}).createSession(n);return new xc(r,o,n)}var a7=kr(Sg()),l7=kr(Uu());var jl=Gn(process.env.SCHEMA_POSTGRES||"").table("post_estate",{id:qr("id").default(x`gen_random_uuid()`).primaryKey(),title:Ke("title",{length:255}).notNull(),slug:Ke("slug",{length:255}).notNull(),code:Ke("code",{length:255}).notNull(),address:Ke("title",{length:255}),street:Ke("street",{length:255}),lat:Dl("lat").default(0),lang:Dl("lang").default(0),type:kt("type").notNull().default(0),youtubeUrl:vo("youtube_url"),point:Dl("point").notNull(),provinceCode:kt("province_code").notNull(),districtCode:kt("district_code").notNull(),wardCode:kt("ward_code").notNull(),customerId:qr("customer_id").notNull(),noteVerified:vo("note_verified"),isBlock:kt("is_block").notNull().default(0),isDelete:kt("is_delete").notNull().default(0),isOwner:kt("is_owner").notNull().default(0),createdBy:Ke("created_by",{length:255}),createdAt:$r("created_at").notNull().default(x`now()`),modifyBy:Ke("modify_by",{length:255}),modifyAt:$r("modify_at").notNull().default(x`now()`).$onUpdate(()=>new Date)},t=>({idxPostEstateNameSlugId:So("post_estate_name_slug_id_idx").on(t.title,t.slug,t.id)}));var s7=Gn(process.env.SCHEMA_POSTGRES||"").table("images",{id:qr("id").default(x`gen_random_uuid()`).primaryKey(),link:Ke("link",{length:255}).notNull(),type:kt("type").notNull().default(0),position:kt("position").default(0),isAvatar:kt("is_avatar").notNull().default(0),description:Ke("description",{length:255}),isUsed:kt("is_used").default(0),postEstateId:qr("post_estate_id").references(()=>jl.id,{onDelete:"cascade",onUpdate:"cascade"}),isConfirmUpdate:kt("is_confirm_update").notNull().default(0),createdBy:Ke("created_by",{length:255}),createdAt:$r("created_at").notNull().default(x`now()`),modifyBy:Ke("modify_by",{length:255}),modifyAt:$r("modify_at").notNull().default(x`now()`).$onUpdate(()=>new Date)},t=>({idxNameId:So("image_link_id_idx").on(t.link,t.id)}));var ch=Gn("bds_products").table("common_land",{id:qr("id").default(x`gen_random_uuid()`).primaryKey(),name:Ke("name",{length:255}).notNull(),code:Ke("code",{length:255}).notNull(),slug:Ke("slug",{length:255}).notNull(),content:vo("content"),provinceCode:kt("province_code").notNull(),districtCode:kt("district_code").notNull(),wardCode:kt("ward_code").notNull(),status:kt("status").default(1),createdBy:Ke("created_by",{length:255}),createdAt:$r("created_at").notNull().default(x`now()`),modifyBy:Ke("modify_by",{length:255}),modifyAt:$r("modify_at").notNull().default(x`now()`).$onUpdate(()=>new Date)},t=>({idxCommonLandNameSlugId:So("common_land_name_slug_id_idx").on(t.name,t.slug,t.id)}));var n7=Gn(process.env.SCHEMA_POSTGRES||"").table("post_estate_detail",{id:qr("id").default(x`gen_random_uuid()`).primaryKey(),postEstateId:qr("post_estate_id").references(()=>jl.id,{onDelete:"cascade"}),content:vo("content"),acreage:Dl("acreage"),facade:Dl("facade"),numWayIn:Dl("num_way_in"),price:nN("price"),unit:kt("unit").notNull().default(0),priceSquareMetre:nN("price_square_metre"),directionHouse:Ke("direction_house",{length:100}),directionBalcony:Ke("direction_balcony",{length:100}),numBedroom:kt("num_bedroom"),numRoadHouse:kt("num_road_House"),numFloors:kt("num_floors"),numBathroom:kt("num_bathroom"),furniture:Ke("furniture",{length:255}),houseOwningDocument:vo("house_owning_document"),contactName:Ke("contact_name",{length:255}),contactPhone:Ke("contact_phone",{length:255}),contactMail:Ke("contact_mail",{length:100}),createdBy:Ke("created_by",{length:255}),createdAt:$r("created_at").notNull().default(x`now()`),modifyBy:Ke("modify_by",{length:255}),modifyAt:$r("modify_at").notNull().default(x`now()`).$onUpdate(()=>new Date)},t=>({}));var i7=Gn(process.env.SCHEMA_POSTGRES||"").table("post_estate_report",{id:qr("id").default(x`gen_random_uuid()`).primaryKey(),description:Ke("description",{length:255}).notNull(),postEstateId:qr("post_estate_id").notNull(),customerId:qr("customer_id"),contactName:Ke("contact_name",{length:50}),contactPhone:Ke("contact_phone",{length:20}),contactMail:Ke("contact_mail",{length:50}),isConfirmed:kt("is_confirmed").notNull().default(0),createdBy:Ke("created_by",{length:255}),createdAt:$r("created_at").notNull().default(x`now()`),modifyBy:Ke("modify_by",{length:255}),modifyAt:$r("modify_at").notNull().default(x`now()`).$onUpdate(()=>new Date)},t=>({idxPostEstateReportNameId:So("post_estate_report_name_id_idx").on(t.contactName,t.id)}));var o7=Gn(process.env.SCHEMA_POSTGRES||"").table("post_estate_history",{id:qr("id").default(x`gen_random_uuid()`).primaryKey(),postEstateId:qr("post_estate_id").notNull().references(()=>jl.id,{onDelete:"cascade",onUpdate:"cascade"}),note:vo("node"),createdBy:Ke("created_by",{length:255}),createdAt:$r("created_at").notNull().default(x`now()`),modifyBy:Ke("modify_by",{length:255}),modifyAt:$r("modify_at").notNull().default(x`now()`).$onUpdate(()=>new Date)},t=>({idxPostEstateHistoryId:So("post_estate_history_id_idx").on(t.postEstateId,t.id)}));var fje={imageModel:s7,commonLandModel:ch,postEstateModel:jl,postEstateReportModel:i7,postEstateDetailModel:n7,postEstateHistoryModel:o7},hje=(0,l7.default)(async t=>{try{let e=new a7.Pool({connectionString:`postgresql://${t.config.USER_POSTGRES}:${t.config.PASSWORD_POSTGRES}@${t.config.HOST_POSTGRES}:${t.config.PORT_POSTGRES}/${t.config.DATABASE_POSTGRES}?schema=${t.config.SCHEMA_POSTGRES}`,ssl:!1}),r=r7(e,{schema:fje});await e.connect(),t.decorate("db",r),t.addHook("onClose",(s,n)=>{let i=s?.db;i?.onClose!==void 0&&i?.onClose(),n()}),t.log.info("Connect database successs")}catch(e){t.log.error(`Connect database error ${e}`)}}),u7=hje;var zw=kr(Wee()),Zee=kr(lM()),Yee=kr(Uu()),Jee=kr(require("path")),RVe=(0,Yee.default)(async t=>{try{let e=Jee.default.resolve(process.cwd(),"./proto/user.proto"),r=Zee.loadSync(e),s=zw.loadPackageDefinition(r);if(!t.config.GRPC_CLIENT_USER){t.log.error("Env config grpc client user empty or undifined");return}let i=new s.user.service.UserService(`${t.config.GRPC_CLIENT_USER}`,zw.credentials.createInsecure());t.grpcUserClient||(t.grpcUserClient=i);let a=new Date;a.setSeconds(a.getSeconds()+1),i.waitForReady(a,l=>{if(l){t.log.error("Grpc client user falsed to coonnect error",l.stack);return}i.Healcheck({},(u,c)=>{if(u){t.log.error("Grpc client user healcheck error",u.stack);return}t.log.info("Grpc client user healcheck success")})}),t&&t.log.info("Load config grpc client user successs")}catch(e){t.log.error("Connect grpc client user error",e)}}),Xee=RVe;var OVe=(t,e)=>{try{let s=t?.db?.session?.client;s&&typeof s?.end=="function"&&(s.end(),t.log.info("Database disconnect")),e()}catch(r){t.log.error(`Application on close hook error ${r} `)}},ete=OVe;var Uw=class{static convertStringToSlug(e){let{text:r,slugConvert:s="-"}=e;if(!r||r===null)return"";let n;return n=r.toLowerCase(),n=r.toLowerCase(),n=n.replace(/á|à|ả|ạ|ã|ă|ắ|ằ|ẳ|ẵ|ặ|â|ấ|ầ|ẩ|ẫ|ậ/gi,"a"),n=n.replace(/é|è|ẻ|ẽ|ẹ|ê|ế|ề|ể|ễ|ệ/gi,"e"),n=n.replace(/i|í|ì|ỉ|ĩ|ị/gi,"i"),n=n.replace(/ó|ò|ỏ|õ|ọ|ô|ố|ồ|ổ|ỗ|ộ|ơ|ớ|ờ|ở|ỡ|ợ/gi,"o"),n=n.replace(/ú|ù|ủ|ũ|ụ|ư|ứ|ừ|ử|ữ|ự/gi,"u"),n=n.replace(/ý|ỳ|ỷ|ỹ|ỵ/gi,"y"),n=n.replace(/đ/gi,"d"),n=n.replace(/\`|\~|\!|\@|\#|\||\$|\%|\^|\&|\*|\(|\)|\+|\=|\,|\.|\/|\?|\>|\<|\'|\"|\:|\;|_/gi,""),n=n.replace(/ /gi,s),n=n.replace(/\-\-\-\-\-/gi,"-"),n=n.replace(/\-\-\-\-/gi,"-"),n=n.replace(/\-\-\-/gi,"-"),n=n.replace(/\-\-/gi,"-"),n="@"+n+"@",n=n.replace(/\@\-|\-\@|\@/gi,""),n?.trim()}static isPathImage(e){return e.match(/\.(jpeg|jpg|gif|png)$/)!=null}};var Vw=class{constructor(e){this.db=e}transformArrayToObject(e){return Array.isArray(e)?e?.[0]??null:e||null}async insert(e,r){let s=await this.db.insert(e).values({...r}).returning();return this.transformArrayToObject(s)}async insertMany(e,r){return await this.db.insert(e).values([...r]).returning(),!0}async update(e,r){let s=await this.db.update(e).set({...r}).returning();return this.transformArrayToObject(s)}async updateMany(e,r){for(let s of r)await this.update(e,s);return!0}async deleteById(e,r){let n=Array.isArray(r)?Mb(e.id,r):Ml(e.id,r);return await this.db.delete(e).where(n),!0}async deleteByKey(e,r){let s=[];for(let n in r)r[n]!==void 0&&r[n]!==null&&s.push(Ml(e[n],r[n]));return await this.db.delete(e).where($l(x.join(s))),!0}async findByKey(e,r){let s=[];for(let i in r)r[i]!==void 0&&r[i]!==null&&s.push(Ml(e[i],r[i]));let n=await this.db.select().from(e).where($l(x.join(s))).limit(1);return this.transformArrayToObject(n)}async pagination(e,r,s){let n=e.as("sub"),o=await this.db.select({total:x`count(*)`}).from(n).execute(),a=Number(o[0].total),l=Math.ceil(a/s),u=(r-1)*s;return e.limit(s).offset(u),{data:await e.execute(),pagination:{totalRecords:a,totalPages:l,currentPage:r,limit:s}}}};var Hw=class extends Vw{constructor(r){super(r.db);this.app=r}async create(r){try{let s=Uw.convertStringToSlug({text:r.name}),n=await this.validate(r.name,r.code);if(n.length>0)throw new nl(n);let o={code:r.code,name:r.name,provinceCode:r.provinceCode,districtCode:r.districtCode,wardCode:r.wardCode,slug:s};return await this.insert(ch,o)}catch(s){throw s}}async delete(r){}async validate(r,s){let n=[],[i,o]=await Promise.allSettled([await this.findByKey(ch,{name:r}),await this.findByKey(ch,{code:s})]);return i!==null&&n.push({code:"INVALID",field:"name",message:"Invalid name"}),o!==null&&n.push({code:"INVALID",field:"code",message:"Invalid code"}),n}};var Iy,xy=class{constructor(e){this.app=e;Y$(this,Iy,void 0);this.create=async(e,r)=>{let s=e.body,n=await Z$(this,Iy).create({code:s.code,name:s.name,provinceCode:s.province_code,districtCode:s.district_code,wardCode:s.ward_code});r.send(n)};this.app=e,J$(this,Iy,new Hw(this.app))}};Iy=new WeakMap;var ep=class{};ep.createCommon={body:Fs.object({name:Fs.string(),code:Fs.string(),province_code:Fs.number(),district_code:Fs.number(),ward_code:Fs.number()})},ep.updateCommon={body:Fs.object({id:Fs.string(),name:Fs.string(),code:Fs.string(),province_code:Fs.number(),district_code:Fs.number(),ward_code:Fs.number()})};var tte=async t=>{let e=new xy(t);t.route({method:"POST",url:"/",schema:ep.createCommon,handler:e.create})};var Gw=class{constructor(){ste.config(),this.app=(0,rte.default)({disableRequestLogging:!0,logger:{stream:B$.default.multistream(this.getLoggerStreams()),level:"info"},querystringParser:e=>ate.parse(e,{parseNumbers:!0})}).withTypeProvider()}async start(){return await this.init(),await this.app.listen({port:this.app.config.PORT}),this.app.log.info("Server start running"),this.app}async init(){await this.setupEnvConfig(),this.setupCors(),this.setupCookie(),this.setupHook(),this.acceptPlugin(),this.setupZodSchemaValidate(),await this.registerRouter()}async setupEnvConfig(){await this.app.register(nte.default,{schema:SG,dotenv:!0})}setupCors(){this.app.register(ite.default,{credentials:!0,origin:["http://localhost:3000"]})}setupCookie(){this.app.register(ote.default,{hook:"preHandler",secret:this.app.config.COOKIE_SECRET,algorithm:"sha256",parseOptions:{path:"/",signed:!0,sameSite:"strict",secure:this.app.config.NODE_ENV==="production",httpOnly:this.app.config.NODE_ENV==="production"}})}acceptPlugin(){this.app.register(u7),this.app.register(TQ),this.app.register(Xee)}setupHook(){this.app.addHook("onSend",(e,r,s,n)=>T8(e,r,s,n)),this.app.addHook("onClose",(e,r)=>ete(e,r))}setupZodSchemaValidate(){this.app.withTypeProvider(),this.app.setValidatorCompiler(Kw.validatorCompiler),this.app.setSerializerCompiler(Kw.serializerCompiler),this.app.setErrorHandler(w8)}getLoggerStreams(){return[{level:"debug",stream:B$.default.transport({target:"pino-pretty",options:{colorize:!0,colorizeObjects:!0,translateTime:"SYS:hh:MM:ss TT",ignore:"pid,hostname"}})}]}async registerRouter(){this.app.register(_G,{prefix:"/"}),this.app.register(tte,{prefix:"/common-land"})}};var PVe=async()=>{let t=new Gw;try{await t.start()}catch(e){t.app.log.error(e),process.env.NODE_ENV==="production"&&process.exit(1)}};PVe();
/*! Bundled license information:

forwarded/index.js:
  (*!
   * forwarded
   * Copyright(c) 2014-2017 Douglas Christopher Wilson
   * MIT Licensed
   *)

proxy-addr/index.js:
  (*!
   * proxy-addr
   * Copyright(c) 2014-2016 Douglas Christopher Wilson
   * MIT Licensed
   *)

toad-cache/dist/toad-cache.cjs:
  (**
   * toad-cache
   *
   * @copyright 2024 Igor Savin <kibertoad@gmail.com>
   * @license MIT
   * @version 3.7.0
   *)

uri-js/dist/es5/uri.all.js:
  (** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js *)

cookie/index.js:
  (*!
   * cookie
   * Copyright(c) 2012-2014 Roman Shtylman
   * Copyright(c) 2015 Douglas Christopher Wilson
   * MIT Licensed
   *)

light-my-request/lib/form-data.js:
  (*! formdata-polyfill. MIT License. Jimmy Wärting <https://jimmy.warting.se/opensource> *)

@fastify/cookie/cookie.js:
  (*!
   * Adapted from https://github.com/jshttp/cookie
   *
   * (The MIT License)
   *
   * Copyright (c) 2012-2014 Roman Shtylman <shtylman@gmail.com>
   * Copyright (c) 2015 Douglas Christopher Wilson <doug@somethingdoug.com>
   *
   * Permission is hereby granted, free of charge, to any person obtaining
   * a copy of this software and associated documentation files (the
   * 'Software'), to deal in the Software without restriction, including
   * without limitation the rights to use, copy, modify, merge, publish,
   * distribute, sublicense, and/or sell copies of the Software, and to
   * permit persons to whom the Software is furnished to do so, subject to
   * the following conditions:
   *
   * The above copyright notice and this permission notice shall be
   * included in all copies or substantial portions of the Software.
   *
   * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND,
   * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
   * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
   * IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
   * CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
   * TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
   * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
   *)

@grpc/proto-loader/build/src/util.js:
  (**
   * @license
   * Copyright 2018 gRPC authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *
   *)

long/umd/index.js:
  (**
   * @license
   * Copyright 2009 The Closure Library Authors
   * Copyright 2020 Daniel Wirtz / The long.js Authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *
   * SPDX-License-Identifier: Apache-2.0
   *)

@grpc/proto-loader/build/src/index.js:
  (**
   * @license
   * Copyright 2018 gRPC authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *
   *)
*/
//# sourceMappingURL=server.js.map

"use strict";var Ze=Object.defineProperty;var ki=Object.getOwnPropertyDescriptor;var Xi=Object.getOwnPropertyNames;var Zi=Object.prototype.hasOwnProperty;var er=(i,e,t)=>e in i?Ze(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var tr=(i,e)=>{for(var t in e)Ze(i,t,{get:e[t],enumerable:!0})},ir=(i,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of Xi(e))!Zi.call(i,s)&&s!==t&&Ze(i,s,{get:()=>e[s],enumerable:!(r=ki(e,s))||r.enumerable});return i};var rr=i=>ir(Ze({},"__esModule",{value:!0}),i);var a=(i,e,t)=>(er(i,typeof e!="symbol"?e+"":e,t),t);var Mn={};tr(Mn,{postEstateDetailModel:()=>Un});module.exports=rr(Mn);var o=Symbol.for("drizzle:entityKind"),Jn=Symbol.for("drizzle:hasOwnEntityKind");function c(i,e){if(!i||typeof i!="object")return!1;if(i instanceof e)return!0;if(!Object.prototype.hasOwnProperty.call(e,o))throw new Error(`Class "${e.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let t=i.constructor;if(t)for(;t;){if(o in t&&t[o]===e[o])return!0;t=Object.getPrototypeOf(t)}return!1}var nr,T=class{constructor(e,t){this.table=e,this.config=t,this.name=t.name,this.notNull=t.notNull,this.default=t.default,this.defaultFn=t.defaultFn,this.onUpdateFn=t.onUpdateFn,this.hasDefault=t.hasDefault,this.primary=t.primaryKey,this.isUnique=t.isUnique,this.uniqueName=t.uniqueName,this.uniqueType=t.uniqueType,this.dataType=t.dataType,this.columnType=t.columnType}name;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;config;mapFromDriverValue(e){return e}mapToDriverValue(e){return e}};nr=o,a(T,nr,"Column");var sr,Ke=class{config;constructor(e,t,r){this.config={name:e,notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:t,columnType:r}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}};sr=o,a(Ke,sr,"ColumnBuilder");var et=Symbol.for("drizzle:Name"),Et=Symbol.for("drizzle:Schema"),ci=Symbol.for("drizzle:Columns"),mi=Symbol.for("drizzle:ExtraConfigColumns"),zt=Symbol.for("drizzle:OriginalName"),Dt=Symbol.for("drizzle:BaseName"),fi=Symbol.for("drizzle:IsAlias"),di=Symbol.for("drizzle:ExtraConfigBuilder"),or=Symbol.for("drizzle:IsDrizzleTable"),ar,h=class{[(ar=o,et)];[zt];[Et];[ci];[mi];[Dt];[fi]=!1;[di]=void 0;[or]=!0;constructor(e,t,r){this[et]=this[zt]=e,this[Et]=t,this[Dt]=r}};a(h,ar,"Table"),a(h,"Symbol",{Name:et,Schema:Et,OriginalName:zt,Columns:ci,ExtraConfigColumns:mi,BaseName:Dt,IsAlias:fi,ExtraConfigBuilder:di});function ce(i){return i[et]}var Kt=Symbol.for("drizzle:PgInlineForeignKeys"),lr,V=class extends h{[(lr=o,Kt)]=[];[h.Symbol.ExtraConfigBuilder]=void 0};a(V,lr,"PgTable"),a(V,"Symbol",Object.assign({},h.Symbol,{InlineForeignKeys:Kt}));function Ft(i,e,t,r,s=i){let l=new V(i,r,s),u=Object.fromEntries(Object.entries(e).map(([m,y])=>{let b=y,N=b.build(l);return l[Kt].push(...b.buildForeignKeys(N,l)),[m,N]})),f=Object.fromEntries(Object.entries(e).map(([m,y])=>{let N=y.buildExtraConfigColumn(l);return[m,N]})),d=Object.assign(l,u);return d[h.Symbol.Columns]=u,d[h.Symbol.ExtraConfigColumns]=f,t&&(d[V.Symbol.ExtraConfigBuilder]=t),d}var Qt=(i,e,t)=>Ft(i,e,t,void 0);var ur,Fe=class{reference;_onUpdate="no action";_onDelete="no action";constructor(e,t){this.reference=()=>{let{name:r,columns:s,foreignColumns:l}=e();return{name:r,columns:s,foreignTable:l[0].table,foreignColumns:l}},t&&(this._onUpdate=t.onUpdate,this._onDelete=t.onDelete)}onUpdate(e){return this._onUpdate=e===void 0?"no action":e,this}onDelete(e){return this._onDelete=e===void 0?"no action":e,this}build(e){return new tt(e,this)}};ur=o,a(Fe,ur,"PgForeignKeyBuilder");var cr,tt=class{constructor(e,t){this.table=e,this.reference=t.reference,this.onUpdate=t._onUpdate,this.onDelete=t._onDelete}reference;onUpdate;onDelete;getName(){let{name:e,columns:t,foreignColumns:r}=this.reference(),s=t.map(f=>f.name),l=r.map(f=>f.name),u=[this.table[V.Symbol.Name],...s,r[0].table[V.Symbol.Name],...l];return e??`${u.join("_")}_fk`}};cr=o,a(tt,cr,"PgForeignKey");function it(i,...e){return i(...e)}function Bt(i,e){return`${i[V.Symbol.Name]}_${e.join("_")}_unique`}var mr,rt=class{constructor(e,t){this.name=t,this.columns=e}columns;nullsNotDistinctConfig=!1;nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(e){return new nt(e,this.columns,this.nullsNotDistinctConfig,this.name)}};mr=o,a(rt,mr,"PgUniqueConstraintBuilder");var fr,Lt=class{name;constructor(e){this.name=e}on(...e){return new rt(e,this.name)}};fr=o,a(Lt,fr,"PgUniqueOnConstraintBuilder");var dr,nt=class{constructor(e,t,r,s){this.table=e,this.columns=t,this.name=s??Bt(this.table,this.columns.map(l=>l.name)),this.nullsNotDistinct=r}columns;name;nullsNotDistinct=!1;getName(){return this.name}};dr=o,a(nt,dr,"PgUniqueConstraint");function pi(i,e,t){for(let r=e;r<i.length;r++){let s=i[r];if(s==="\\"){r++;continue}if(s==='"')return[i.slice(e,r).replace(/\\/g,""),r+1];if(!t&&(s===","||s==="}"))return[i.slice(e,r).replace(/\\/g,""),r]}return[i.slice(e).replace(/\\/g,""),i.length]}function hi(i,e=0){let t=[],r=e,s=!1;for(;r<i.length;){let l=i[r];if(l===","){(s||r===e)&&t.push(""),s=!0,r++;continue}if(s=!1,l==="\\"){r+=2;continue}if(l==='"'){let[d,m]=pi(i,r+1,!0);t.push(d),r=m;continue}if(l==="}")return[t,r+1];if(l==="{"){let[d,m]=hi(i,r+1);t.push(d),r=m;continue}let[u,f]=pi(i,r,!1);t.push(u),r=f}return[t,r]}function yi(i){let[e]=hi(i,1);return e}function Vt(i){return`{${i.map(e=>Array.isArray(e)?Vt(e):typeof e=="string"?`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${e}`).join(",")}}`}var pr,v=class extends Ke{foreignKeyConfigs=[];array(e){return new ot(this.config.name,this,e)}references(e,t={}){return this.foreignKeyConfigs.push({ref:e,actions:t}),this}unique(e,t){return this.config.isUnique=!0,this.config.uniqueName=e,this.config.uniqueType=t?.nulls,this}buildForeignKeys(e,t){return this.foreignKeyConfigs.map(({ref:r,actions:s})=>it((l,u)=>{let f=new Fe(()=>{let d=l();return{columns:[e],foreignColumns:[d]}});return u.onUpdate&&f.onUpdate(u.onUpdate),u.onDelete&&f.onDelete(u.onDelete),f.build(t)},r,s))}buildExtraConfigColumn(e){return new st(e,this.config)}};pr=o,a(v,pr,"PgColumnBuilder");var hr,w=class extends T{constructor(e,t){t.uniqueName||(t.uniqueName=Bt(e,[t.name])),super(e,t),this.table=e}};hr=o,a(w,hr,"PgColumn");var yr,st=class extends w{getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(e){return this.indexConfig.opClass=e,this}};yr=o,a(st,yr,"ExtraConfigColumn");var gr,oe=class{constructor(e,t,r){this.name=e,this.type=t,this.indexConfig=r}name;type;indexConfig};gr=o,a(oe,gr,"IndexedColumn");var wr,ot=class extends v{constructor(e,t,r){super(e,"array","PgArray"),this.config.baseBuilder=t,this.config.size=r}build(e){let t=this.config.baseBuilder.build(e);return new at(e,this.config,t)}};wr=o,a(ot,wr,"PgArrayBuilder");var br,It=class extends w{constructor(e,t,r,s){super(e,t),this.baseColumn=r,this.range=s,this.size=t.size}size;getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(e){return typeof e=="string"&&(e=yi(e)),e.map(t=>this.baseColumn.mapFromDriverValue(t))}mapToDriverValue(e,t=!1){let r=e.map(s=>s===null?null:c(this.baseColumn,It)?this.baseColumn.mapToDriverValue(s,!0):this.baseColumn.mapToDriverValue(s));return t?r:Vt(r)}},at=It;br=o,a(at,br,"PgArray");var Ut=Symbol.for("drizzle:isPgEnum");function gi(i){return!!i&&typeof i=="function"&&Ut in i&&i[Ut]===!0}var Sr,lt=class extends v{constructor(e,t){super(e,"string","PgEnumColumn"),this.config.enum=t}build(e){return new ut(e,this.config)}};Sr=o,a(lt,Sr,"PgEnumColumnBuilder");var Nr,ut=class extends w{enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(e,t){super(e,t),this.enum=t.enum}getSQLType(){return this.enum.enumName}};Nr=o,a(ut,Nr,"PgEnumColumn");function wi(i,e,t){let r=Object.assign(s=>new lt(s,r),{enumName:i,enumValues:e,schema:t,[Ut]:!0});return r}var xr,D=class{constructor(e,t,r,s=!1){this._={brand:"Subquery",sql:e,selectedFields:t,alias:r,isWith:s}}};xr=o,a(D,xr,"Subquery");var $r,Qe=class extends D{};$r=o,a(Qe,$r,"WithSubquery");var bi="0.31.2";var Mt,Rt,Le={startActiveSpan(i,e){return Mt?(Rt||(Rt=Mt.trace.getTracer("drizzle-orm",bi)),it((t,r)=>r.startActiveSpan(i,s=>{try{return e(s)}catch(l){throw s.setStatus({code:t.SpanStatusCode.ERROR,message:l instanceof Error?l.message:"Unknown error"}),l}finally{s.end()}}),Mt,Rt)):e()}};var C=Symbol.for("drizzle:ViewBaseConfig");var vr,Jt=class{};vr=o,a(Jt,vr,"FakePrimitiveParam");function Wt(i){return i!=null&&typeof i.getSQL=="function"}function Tr(i){let e={sql:"",params:[]};for(let t of i)e.sql+=t.sql,e.params.push(...t.params),t.typings?.length&&(e.typings||(e.typings=[]),e.typings.push(...t.typings));return e}var Cr,O=class{value;constructor(e){this.value=Array.isArray(e)?e:[e]}getSQL(){return new p([this])}};Cr=o,a(O,Cr,"StringChunk");var qr,me=class{constructor(e){this.queryChunks=e}decoder=Ni;shouldInlineParams=!1;append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return Le.startActiveSpan("drizzle.buildSQL",t=>{let r=this.buildQueryFromSourceParams(this.queryChunks,e);return t?.setAttributes({"drizzle.query.text":r.sql,"drizzle.query.params":JSON.stringify(r.params)}),r})}buildQueryFromSourceParams(e,t){let r=Object.assign({},t,{inlineParams:t.inlineParams||this.shouldInlineParams,paramStartIndex:t.paramStartIndex||{value:0}}),{escapeName:s,escapeParam:l,prepareTyping:u,inlineParams:f,paramStartIndex:d}=r;return Tr(e.map(m=>{if(c(m,O))return{sql:m.value.join(""),params:[]};if(c(m,fe))return{sql:s(m.value),params:[]};if(m===void 0)return{sql:"",params:[]};if(Array.isArray(m)){let y=[new O("(")];for(let[b,N]of m.entries())y.push(N),b<m.length-1&&y.push(new O(", "));return y.push(new O(")")),this.buildQueryFromSourceParams(y,r)}if(c(m,me))return this.buildQueryFromSourceParams(m.queryChunks,{...r,inlineParams:f||m.shouldInlineParams});if(c(m,h)){let y=m[h.Symbol.Schema],b=m[h.Symbol.Name];return{sql:y===void 0?s(b):s(y)+"."+s(b),params:[]}}if(c(m,T))return t.invokeSource==="indexes"?{sql:s(m.name),params:[]}:{sql:s(m.table[h.Symbol.Name])+"."+s(m.name),params:[]};if(c(m,U)){let y=m[C].schema,b=m[C].name;return{sql:y===void 0?s(b):s(y)+"."+s(b),params:[]}}if(c(m,H)){let y=m.value===null?null:m.encoder.mapToDriverValue(m.value);if(c(y,me))return this.buildQueryFromSourceParams([y],r);if(f)return{sql:this.mapInlineParam(y,r),params:[]};let b;return u!==void 0&&(b=[u(m.encoder)]),{sql:l(d.value++,y),params:[y],typings:b}}return c(m,ae)?{sql:l(d.value++,m),params:[m]}:c(m,me.Aliased)&&m.fieldAlias!==void 0?{sql:s(m.fieldAlias),params:[]}:c(m,D)?m._.isWith?{sql:s(m._.alias),params:[]}:this.buildQueryFromSourceParams([new O("("),m._.sql,new O(") "),new fe(m._.alias)],r):gi(m)?m.schema?{sql:s(m.schema)+"."+s(m.enumName),params:[]}:{sql:s(m.enumName),params:[]}:Wt(m)?this.buildQueryFromSourceParams([new O("("),m.getSQL(),new O(")")],r):f?{sql:this.mapInlineParam(m,r),params:[]}:{sql:l(d.value++,m),params:[m]}}))}mapInlineParam(e,{escapeString:t}){if(e===null)return"null";if(typeof e=="number"||typeof e=="boolean")return e.toString();if(typeof e=="string")return t(e);if(typeof e=="object"){let r=e.toString();return t(r==="[object Object]"?JSON.stringify(e):r)}throw new Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return e===void 0?this:new me.Aliased(this,e)}mapWith(e){return this.decoder=typeof e=="function"?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}},p=me;qr=o,a(p,qr,"SQL");var _r,fe=class{constructor(e){this.value=e}brand;getSQL(){return new p([this])}};_r=o,a(fe,_r,"Name");function Si(i){return typeof i=="object"&&i!==null&&"mapToDriverValue"in i&&typeof i.mapToDriverValue=="function"}var Ni={mapFromDriverValue:i=>i},xi={mapToDriverValue:i=>i},Rs={...Ni,...xi},Or,H=class{constructor(e,t=xi){this.value=e,this.encoder=t}brand;getSQL(){return new p([this])}};Or=o,a(H,Or,"Param");function n(i,...e){let t=[];(e.length>0||i.length>0&&i[0]!=="")&&t.push(new O(i[0]));for(let[r,s]of e.entries())t.push(s,new O(i[r+1]));return new p(t)}(i=>{function e(){return new p([])}i.empty=e;function t(d){return new p(d)}i.fromList=t;function r(d){return new p([new O(d)])}i.raw=r;function s(d,m){let y=[];for(let[b,N]of d.entries())b>0&&m!==void 0&&y.push(m),y.push(N);return new p(y)}i.join=s;function l(d){return new fe(d)}i.identifier=l;function u(d){return new ae(d)}i.placeholder=u;function f(d,m){return new H(d,m)}i.param=f})(n||(n={}));(i=>{class e{constructor(r,s){this.sql=r,this.fieldAlias=s}static[o]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new e(this.sql,this.fieldAlias)}}i.Aliased=e})(p||(p={}));var Pr,ae=class{constructor(e){this.name=e}getSQL(){return new p([this])}};Pr=o,a(ae,Pr,"Placeholder");var Ar,U=class{[(Ar=o,C)];constructor({name:e,schema:t,selectedFields:r,query:s}){this[C]={name:e,originalName:e,schema:t,selectedFields:r,query:s,isExisting:!s,isAlias:!1}}getSQL(){return new p([this])}};a(U,Ar,"View");T.prototype.getSQL=function(){return new p([this])};h.prototype.getSQL=function(){return new p([this])};D.prototype.getSQL=function(){return new p([this])};var jr,ne=class{constructor(e){this.table=e}get(e,t){return t==="table"?this.table:e[t]}};jr=o,a(ne,jr,"ColumnAliasProxyHandler");var Er,le=class{constructor(e,t){this.alias=e,this.replaceOriginalName=t}get(e,t){if(t===h.Symbol.IsAlias)return!0;if(t===h.Symbol.Name)return this.alias;if(this.replaceOriginalName&&t===h.Symbol.OriginalName)return this.alias;if(t===C)return{...e[C],name:this.alias,isAlias:!0};if(t===h.Symbol.Columns){let s=e[h.Symbol.Columns];if(!s)return s;let l={};return Object.keys(s).map(u=>{l[u]=new Proxy(s[u],new ne(new Proxy(e,this)))}),l}let r=e[t];return c(r,T)?new Proxy(r,new ne(new Proxy(e,this))):r}};Er=o,a(le,Er,"TableAliasProxyHandler");var zr,Ht=class{constructor(e){this.alias=e}get(e,t){return t==="sourceTable"?Be(e.sourceTable,this.alias):e[t]}};zr=o,a(Ht,zr,"RelationTableAliasProxyHandler");function Be(i,e){return new Proxy(i,new le(e,!1))}function k(i,e){return new Proxy(i,new ne(new Proxy(i.table,new le(e,!1))))}function Gt(i,e){return new p.Aliased(Ve(i.sql,e),i.fieldAlias)}function Ve(i,e){return n.join(i.queryChunks.map(t=>c(t,T)?k(t,e):c(t,p)?Ve(t,e):c(t,p.Aliased)?Gt(t,e):t))}var Dr,G=class extends v{defaultNow(){return this.default(n`now()`)}};Dr=o,a(G,Dr,"PgDateColumnBaseBuilder");var Kr,Yt=class extends G{constructor(e){super(e,"date","PgDate")}build(e){return new de(e,this.config)}};Kr=o,a(Yt,Kr,"PgDateBuilder");var Fr,de=class extends w{getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}mapToDriverValue(e){return e.toISOString()}};Fr=o,a(de,Fr,"PgDate");var Qr,kt=class extends G{constructor(e){super(e,"string","PgDateString")}build(e){return new pe(e,this.config)}};Qr=o,a(kt,Qr,"PgDateStringBuilder");var Lr,pe=class extends w{getSQLType(){return"date"}};Lr=o,a(pe,Lr,"PgDateString");var Br,ct=class extends v{constructor(e){super(e,"number","PgInteger")}build(e){return new mt(e,this.config)}};Br=o,a(ct,Br,"PgIntegerBuilder");var Vr,mt=class extends w{getSQLType(){return"integer"}mapFromDriverValue(e){return typeof e=="string"?Number.parseInt(e):e}};Vr=o,a(mt,Vr,"PgInteger");function x(i){return new ct(i)}var Ir,Xt=class extends v{constructor(e){super(e,"json","PgJson")}build(e){return new he(e,this.config)}};Ir=o,a(Xt,Ir,"PgJsonBuilder");var Ur,he=class extends w{constructor(e,t){super(e,t)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}};Ur=o,a(he,Ur,"PgJson");var Mr,Zt=class extends v{constructor(e){super(e,"json","PgJsonb")}build(e){return new ye(e,this.config)}};Mr=o,a(Zt,Mr,"PgJsonbBuilder");var Rr,ye=class extends w{constructor(e,t){super(e,t)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}};Rr=o,a(ye,Rr,"PgJsonb");var Jr,ft=class extends v{constructor(e,t,r){super(e,"string","PgNumeric"),this.config.precision=t,this.config.scale=r}build(e){return new ge(e,this.config)}};Jr=o,a(ft,Jr,"PgNumericBuilder");var Wr,ge=class extends w{precision;scale;constructor(e,t){super(e,t),this.precision=t.precision,this.scale=t.scale}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}};Wr=o,a(ge,Wr,"PgNumeric");function ei(i,e){return new ft(i,e?.precision,e?.scale)}var Hr,dt=class extends v{constructor(e,t){super(e,"number","PgReal"),this.config.length=t}build(e){return new pt(e,this.config)}};Hr=o,a(dt,Hr,"PgRealBuilder");var Gr,pt=class extends w{constructor(e,t){super(e,t)}getSQLType(){return"real"}mapFromDriverValue=e=>typeof e=="string"?Number.parseFloat(e):e};Gr=o,a(pt,Gr,"PgReal");function se(i){return new dt(i)}var Yr,ht=class extends v{constructor(e,t){super(e,"string","PgText"),this.config.enumValues=t.enum}build(e){return new yt(e,this.config)}};Yr=o,a(ht,Yr,"PgTextBuilder");var kr,yt=class extends w{enumValues=this.config.enumValues;getSQLType(){return"text"}};kr=o,a(yt,kr,"PgText");function X(i,e={}){return new ht(i,e)}var Xr,ti=class extends G{constructor(e,t,r){super(e,"string","PgTime"),this.withTimezone=t,this.precision=r,this.config.withTimezone=t,this.config.precision=r}build(e){return new we(e,this.config)}};Xr=o,a(ti,Xr,"PgTimeBuilder");var Zr,we=class extends w{withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}};Zr=o,a(we,Zr,"PgTime");var en,gt=class extends G{constructor(e,t,r){super(e,"date","PgTimestamp"),this.config.withTimezone=t,this.config.precision=r}build(e){return new be(e,this.config)}};en=o,a(gt,en,"PgTimestampBuilder");var tn,be=class extends w{withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=e=>new Date(this.withTimezone?e:e+"+0000");mapToDriverValue=e=>e.toISOString()};tn=o,a(be,tn,"PgTimestamp");var rn,wt=class extends G{constructor(e,t,r){super(e,"string","PgTimestampString"),this.config.withTimezone=t,this.config.precision=r}build(e){return new Se(e,this.config)}};rn=o,a(wt,rn,"PgTimestampStringBuilder");var nn,Se=class extends w{withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}};nn=o,a(Se,nn,"PgTimestampString");function Q(i,e={}){return e.mode==="string"?new wt(i,e.withTimezone??!1,e.precision):new gt(i,e.withTimezone??!1,e.precision)}var sn,bt=class extends v{constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default(n`gen_random_uuid()`)}build(e){return new Ne(e,this.config)}};sn=o,a(bt,sn,"PgUUIDBuilder");var on,Ne=class extends w{getSQLType(){return"uuid"}};on=o,a(Ne,on,"PgUUID");function L(i){return new bt(i)}var an,St=class extends v{constructor(e,t){super(e,"string","PgVarchar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new Nt(e,this.config)}};an=o,a(St,an,"PgVarcharBuilder");var ln,Nt=class extends w{length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}};ln=o,a(Nt,ln,"PgVarchar");function g(i,e={}){return new St(i,e)}var un,Ie=class{[(un=o,Symbol.toStringTag)]="QueryPromise";catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}then(e,t){return this.execute().then(e,t)}};a(Ie,un,"QueryPromise");function xe(i,e){return Object.entries(i).reduce((t,[r,s])=>{if(typeof r!="string")return t;let l=e?[...e,r]:[r];return c(s,T)||c(s,p)||c(s,p.Aliased)?t.push({path:l,field:s}):c(s,h)?t.push(...xe(s[h.Symbol.Columns],l)):t.push(...xe(s,l)),t},[])}function ii(i,e){let t=Object.keys(i),r=Object.keys(e);if(t.length!==r.length)return!1;for(let[s,l]of t.entries())if(l!==r[s])return!1;return!0}function $i(i,e){for(let t of e)for(let r of Object.getOwnPropertyNames(t.prototype))r!=="constructor"&&Object.defineProperty(i.prototype,r,Object.getOwnPropertyDescriptor(t.prototype,r)||Object.create(null))}function Ue(i){return i[h.Symbol.Columns]}function ri(i){return c(i,D)?i._.alias:c(i,U)?i[C].name:c(i,p)?void 0:i[h.Symbol.IsAlias]?i[h.Symbol.Name]:i[h.Symbol.BaseName]}var cn,$e=class extends Error{constructor({message:e,cause:t}){super(e),this.name="DrizzleError",this.cause=t}};cn=o,a($e,cn,"DrizzleError");var mn,ni=class extends $e{constructor(){super({message:"Rollback"})}};mn=o,a(ni,mn,"TransactionRollbackError");function R(i,e){return Si(e)&&!Wt(i)&&!c(i,H)&&!c(i,ae)&&!c(i,T)&&!c(i,h)&&!c(i,U)?new H(i,e):i}var xt=(i,e)=>n`${i} = ${R(e,i)}`,Ti=(i,e)=>n`${i} <> ${R(e,i)}`;function Me(...i){let e=i.filter(t=>t!==void 0);if(e.length!==0)return e.length===1?new p(e):new p([new O("("),n.join(e,new O(" and ")),new O(")")])}function vi(...i){let e=i.filter(t=>t!==void 0);if(e.length!==0)return e.length===1?new p(e):new p([new O("("),n.join(e,new O(" or ")),new O(")")])}function Ci(i){return n`not ${i}`}var qi=(i,e)=>n`${i} > ${R(e,i)}`,_i=(i,e)=>n`${i} >= ${R(e,i)}`,Oi=(i,e)=>n`${i} < ${R(e,i)}`,Pi=(i,e)=>n`${i} <= ${R(e,i)}`;function Ai(i,e){if(Array.isArray(e)){if(e.length===0)throw new Error("inArray requires at least one value");return n`${i} in ${e.map(t=>R(t,i))}`}return n`${i} in ${R(e,i)}`}function ji(i,e){if(Array.isArray(e)){if(e.length===0)throw new Error("notInArray requires at least one value");return n`${i} not in ${e.map(t=>R(t,i))}`}return n`${i} not in ${R(e,i)}`}function Ei(i){return n`${i} is null`}function zi(i){return n`${i} is not null`}function Di(i){return n`exists ${i}`}function Ki(i){return n`not exists ${i}`}function Fi(i,e,t){return n`${i} between ${R(e,i)} and ${R(t,i)}`}function Qi(i,e,t){return n`${i} not between ${R(e,i)} and ${R(t,i)}`}function Li(i,e){return n`${i} like ${e}`}function Bi(i,e){return n`${i} not like ${e}`}function Vi(i,e){return n`${i} ilike ${e}`}function Ii(i,e){return n`${i} not ilike ${e}`}function Ui(i){return n`${i} asc`}function Mi(i){return n`${i} desc`}var fn,Re=class{constructor(e,t,r){this.sourceTable=e,this.referencedTable=t,this.relationName=r,this.referencedTableName=t[h.Symbol.Name]}referencedTableName;fieldName};fn=o,a(Re,fn,"Relation");var dn,si=class{constructor(e,t){this.table=e,this.config=t}};dn=o,a(si,dn,"Relations");var pn,oi=class extends Re{constructor(e,t,r,s){super(e,t,r?.relationName),this.config=r,this.isNullable=s}withFieldName(e){let t=new oi(this.sourceTable,this.referencedTable,this.config,this.isNullable);return t.fieldName=e,t}},ue=oi;pn=o,a(ue,pn,"One");var hn,ai=class extends Re{constructor(e,t,r){super(e,t,r?.relationName),this.config=r}withFieldName(e){let t=new ai(this.sourceTable,this.referencedTable,this.config);return t.fieldName=e,t}},Je=ai;hn=o,a(Je,hn,"Many");function Ri(){return{and:Me,between:Fi,eq:xt,exists:Di,gt:qi,gte:_i,ilike:Vi,inArray:Ai,isNull:Ei,isNotNull:zi,like:Li,lt:Oi,lte:Pi,ne:Ti,not:Ci,notBetween:Qi,notExists:Ki,notLike:Bi,notIlike:Ii,notInArray:ji,or:vi,sql:n}}function Ji(){return{sql:n,asc:Ui,desc:Mi}}function Wi(i,e,t){if(c(t,ue)&&t.config)return{fields:t.config.fields,references:t.config.references};let r=e[t.referencedTable[h.Symbol.Name]];if(!r)throw new Error(`Table "${t.referencedTable[h.Symbol.Name]}" not found in schema`);let s=i[r];if(!s)throw new Error(`Table "${r}" not found in schema`);let l=t.sourceTable,u=e[l[h.Symbol.Name]];if(!u)throw new Error(`Table "${l[h.Symbol.Name]}" not found in schema`);let f=[];for(let d of Object.values(s.relations))(t.relationName&&t!==d&&d.relationName===t.relationName||!t.relationName&&d.referencedTable===t.sourceTable)&&f.push(d);if(f.length>1)throw t.relationName?new Error(`There are multiple relations with name "${t.relationName}" in table "${r}"`):new Error(`There are multiple relations between "${r}" and "${t.sourceTable[h.Symbol.Name]}". Please specify relation name`);if(f[0]&&c(f[0],ue)&&f[0].config)return{fields:f[0].config.references,references:f[0].config.fields};throw new Error(`There is not enough information to infer relation "${u}.${t.fieldName}"`)}var yn,Z=class extends U{};yn=o,a(Z,yn,"PgViewBase");var gn,We=class{async migrate(e,t,r){let s=typeof r=="string"?"__drizzle_migrations":r.migrationsTable??"__drizzle_migrations",l=typeof r=="string"?"drizzle":r.migrationsSchema??"drizzle",u=n`
			CREATE TABLE IF NOT EXISTS ${n.identifier(l)}.${n.identifier(s)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at bigint
			)
		`;await t.execute(n`CREATE SCHEMA IF NOT EXISTS ${n.identifier(l)}`),await t.execute(u);let d=(await t.all(n`select id, hash, created_at from ${n.identifier(l)}.${n.identifier(s)} order by created_at desc limit 1`))[0];await t.transaction(async m=>{for await(let y of e)if(!d||Number(d.created_at)<y.folderMillis){for(let b of y.sql)await m.execute(n.raw(b));await m.execute(n`insert into ${n.identifier(l)}.${n.identifier(s)} ("hash", "created_at") values(${y.hash}, ${y.folderMillis})`)}})}escapeName(e){return`"${e}"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildWithCTE(e){if(!e?.length)return;let t=[n`with `];for(let[r,s]of e.entries())t.push(n`${n.identifier(s._.alias)} as (${s._.sql})`),r<e.length-1&&t.push(n`, `);return t.push(n` `),n.join(t)}buildDeleteQuery({table:e,where:t,returning:r,withList:s}){let l=this.buildWithCTE(s),u=r?n` returning ${this.buildSelection(r,{isSingleTable:!0})}`:void 0,f=t?n` where ${t}`:void 0;return n`${l}delete from ${e}${f}${u}`}buildUpdateSet(e,t){let r=e[h.Symbol.Columns],s=Object.keys(r).filter(u=>t[u]!==void 0||r[u]?.onUpdateFn!==void 0),l=s.length;return n.join(s.flatMap((u,f)=>{let d=r[u],m=t[u]??n.param(d.onUpdateFn(),d),y=n`${n.identifier(d.name)} = ${m}`;return f<l-1?[y,n.raw(", ")]:[y]}))}buildUpdateQuery({table:e,set:t,where:r,returning:s,withList:l}){let u=this.buildWithCTE(l),f=this.buildUpdateSet(e,t),d=s?n` returning ${this.buildSelection(s,{isSingleTable:!0})}`:void 0,m=r?n` where ${r}`:void 0;return n`${u}update ${e} set ${f}${m}${d}`}buildSelection(e,{isSingleTable:t=!1}={}){let r=e.length,s=e.flatMap(({field:l},u)=>{let f=[];if(c(l,p.Aliased)&&l.isSelectionField)f.push(n.identifier(l.fieldAlias));else if(c(l,p.Aliased)||c(l,p)){let d=c(l,p.Aliased)?l.sql:l;t?f.push(new p(d.queryChunks.map(m=>c(m,w)?n.identifier(m.name):m))):f.push(d),c(l,p.Aliased)&&f.push(n` as ${n.identifier(l.fieldAlias)}`)}else c(l,T)&&(t?f.push(n.identifier(l.name)):f.push(l));return u<r-1&&f.push(n`, `),f});return n.join(s)}buildSelectQuery({withList:e,fields:t,fieldsFlat:r,where:s,having:l,table:u,joins:f,orderBy:d,groupBy:m,limit:y,offset:b,lockingClause:N,distinct:I,setOperators:j}){let B=r??xe(t);for(let _ of B)if(c(_.field,T)&&ce(_.field.table)!==(c(u,D)?u._.alias:c(u,Z)?u[C].name:c(u,p)?void 0:ce(u))&&!(z=>f?.some(({alias:J})=>J===(z[h.Symbol.IsAlias]?ce(z):z[h.Symbol.BaseName])))(_.field.table)){let z=ce(_.field.table);throw new Error(`Your "${_.path.join("->")}" field references a column "${z}"."${_.field.name}", but the table "${z}" is not part of the query! Did you forget to join it?`)}let q=!f||f.length===0,E=this.buildWithCTE(e),K;I&&(K=I===!0?n` distinct`:n` distinct on (${n.join(I.on,n`, `)})`);let F=this.buildSelection(B,{isSingleTable:q}),P=(()=>{if(c(u,h)&&u[h.Symbol.OriginalName]!==u[h.Symbol.Name]){let _=n`${n.identifier(u[h.Symbol.OriginalName])}`;return u[h.Symbol.Schema]&&(_=n`${n.identifier(u[h.Symbol.Schema])}.${_}`),n`${_} ${n.identifier(u[h.Symbol.Name])}`}return u})(),M=[];if(f)for(let[_,z]of f.entries()){_===0&&M.push(n` `);let J=z.table,je=z.lateral?n` lateral`:void 0;if(c(J,V)){let jt=J[V.Symbol.Name],Ee=J[V.Symbol.Schema],ze=J[V.Symbol.OriginalName],De=jt===ze?void 0:z.alias;M.push(n`${n.raw(z.joinType)} join${je} ${Ee?n`${n.identifier(Ee)}.`:void 0}${n.identifier(ze)}${De&&n` ${n.identifier(De)}`} on ${z.on}`)}else if(c(J,U)){let jt=J[C].name,Ee=J[C].schema,ze=J[C].originalName,De=jt===ze?void 0:z.alias;M.push(n`${n.raw(z.joinType)} join${je} ${Ee?n`${n.identifier(Ee)}.`:void 0}${n.identifier(ze)}${De&&n` ${n.identifier(De)}`} on ${z.on}`)}else M.push(n`${n.raw(z.joinType)} join${je} ${J} on ${z.on}`);_<f.length-1&&M.push(n` `)}let ie=n.join(M),S=s?n` where ${s}`:void 0,$=l?n` having ${l}`:void 0,Y;d&&d.length>0&&(Y=n` order by ${n.join(d,n`, `)}`);let Pe;m&&m.length>0&&(Pe=n` group by ${n.join(m,n`, `)}`);let At=y?n` limit ${y}`:void 0,Ae=b?n` offset ${b}`:void 0,re=n.empty();if(N){let _=n` for ${n.raw(N.strength)}`;N.config.of&&_.append(n` of ${n.join(Array.isArray(N.config.of)?N.config.of:[N.config.of],n`, `)}`),N.config.noWait?_.append(n` no wait`):N.config.skipLocked&&_.append(n` skip locked`),re.append(_)}let Xe=n`${E}select${K} ${F} from ${P}${ie}${S}${Pe}${$}${Y}${At}${Ae}${re}`;return j.length>0?this.buildSetOperations(Xe,j):Xe}buildSetOperations(e,t){let[r,...s]=t;if(!r)throw new Error("Cannot pass undefined values to any set operator");return s.length===0?this.buildSetOperationQuery({leftSelect:e,setOperator:r}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:r}),s)}buildSetOperationQuery({leftSelect:e,setOperator:{type:t,isAll:r,rightSelect:s,limit:l,orderBy:u,offset:f}}){let d=n`(${e.getSQL()}) `,m=n`(${s.getSQL()})`,y;if(u&&u.length>0){let j=[];for(let B of u)if(c(B,w))j.push(n.identifier(B.name));else if(c(B,p)){for(let q=0;q<B.queryChunks.length;q++){let E=B.queryChunks[q];c(E,w)&&(B.queryChunks[q]=n.identifier(E.name))}j.push(n`${B}`)}else j.push(n`${B}`);y=n` order by ${n.join(j,n`, `)} `}let b=l?n` limit ${l}`:void 0,N=n.raw(`${t} ${r?"all ":""}`),I=f?n` offset ${f}`:void 0;return n`${d}${N}${m}${y}${b}${I}`}buildInsertQuery({table:e,values:t,onConflict:r,returning:s,withList:l}){let u=[],f=e[h.Symbol.Columns],d=Object.entries(f),m=d.map(([,j])=>n.identifier(j.name));for(let[j,B]of t.entries()){let q=[];for(let[E,K]of d){let F=B[E];if(F===void 0||c(F,H)&&F.value===void 0)if(K.defaultFn!==void 0){let P=K.defaultFn(),M=c(P,p)?P:n.param(P,K);q.push(M)}else if(!K.default&&K.onUpdateFn!==void 0){let P=K.onUpdateFn(),M=c(P,p)?P:n.param(P,K);q.push(M)}else q.push(n`default`);else q.push(F)}u.push(q),j<t.length-1&&u.push(n`, `)}let y=this.buildWithCTE(l),b=n.join(u),N=s?n` returning ${this.buildSelection(s,{isSingleTable:!0})}`:void 0,I=r?n` on conflict ${r}`:void 0;return n`${y}insert into ${e} ${m} values ${b}${I}${N}`}buildRefreshMaterializedViewQuery({view:e,concurrently:t,withNoData:r}){let s=t?n` concurrently`:void 0,l=r?n` with no data`:void 0;return n`refresh materialized view${s} ${e}${l}`}prepareTyping(e){return c(e,ye)||c(e,he)?"json":c(e,ge)?"decimal":c(e,we)?"time":c(e,be)||c(e,Se)?"timestamp":c(e,de)||c(e,pe)?"date":c(e,Ne)?"uuid":"none"}sqlToQuery(e,t){return e.toQuery({escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:t})}buildRelationalQueryWithoutPK({fullSchema:e,schema:t,tableNamesMap:r,table:s,tableConfig:l,queryConfig:u,tableAlias:f,nestedQueryRelation:d,joinOn:m}){let y=[],b,N,I=[],j,B=[];if(u===!0)y=Object.entries(l.columns).map(([K,F])=>({dbKey:F.name,tsKey:K,field:k(F,f),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let E=Object.fromEntries(Object.entries(l.columns).map(([S,$])=>[S,k($,f)]));if(u.where){let S=typeof u.where=="function"?u.where(E,Ri()):u.where;j=S&&Ve(S,f)}let K=[],F=[];if(u.columns){let S=!1;for(let[$,Y]of Object.entries(u.columns))Y!==void 0&&$ in l.columns&&(!S&&Y===!0&&(S=!0),F.push($));F.length>0&&(F=S?F.filter($=>u.columns?.[$]===!0):Object.keys(l.columns).filter($=>!F.includes($)))}else F=Object.keys(l.columns);for(let S of F){let $=l.columns[S];K.push({tsKey:S,value:$})}let P=[];u.with&&(P=Object.entries(u.with).filter(S=>!!S[1]).map(([S,$])=>({tsKey:S,queryConfig:$,relation:l.relations[S]})));let M;if(u.extras){M=typeof u.extras=="function"?u.extras(E,{sql:n}):u.extras;for(let[S,$]of Object.entries(M))K.push({tsKey:S,value:Gt($,f)})}for(let{tsKey:S,value:$}of K)y.push({dbKey:c($,p.Aliased)?$.fieldAlias:l.columns[S].name,tsKey:S,field:c($,T)?k($,f):$,relationTableTsKey:void 0,isJson:!1,selection:[]});let ie=typeof u.orderBy=="function"?u.orderBy(E,Ji()):u.orderBy??[];Array.isArray(ie)||(ie=[ie]),I=ie.map(S=>c(S,T)?k(S,f):Ve(S,f)),b=u.limit,N=u.offset;for(let{tsKey:S,queryConfig:$,relation:Y}of P){let Pe=Wi(t,r,Y),At=Y.referencedTable[h.Symbol.Name],Ae=r[At],re=`${f}_${S}`,Xe=Me(...Pe.fields.map((J,je)=>xt(k(Pe.references[je],re),k(J,f)))),_=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:t,tableNamesMap:r,table:e[Ae],tableConfig:t[Ae],queryConfig:c(Y,ue)?$===!0?{limit:1}:{...$,limit:1}:$,tableAlias:re,joinOn:Xe,nestedQueryRelation:Y}),z=n`${n.identifier(re)}.${n.identifier("data")}`.as(S);B.push({on:n`true`,table:new D(_.sql,{},re),alias:re,joinType:"left",lateral:!0}),y.push({dbKey:S,tsKey:S,field:z,relationTableTsKey:Ae,isJson:!0,selection:_.selection})}}if(y.length===0)throw new $e({message:`No fields selected for table "${l.tsName}" ("${f}")`});let q;if(j=Me(m,j),d){let E=n`json_build_array(${n.join(y.map(({field:P,tsKey:M,isJson:ie})=>ie?n`${n.identifier(`${f}_${M}`)}.${n.identifier("data")}`:c(P,p.Aliased)?P.sql:P),n`, `)})`;c(d,Je)&&(E=n`coalesce(json_agg(${E}${I.length>0?n` order by ${n.join(I,n`, `)}`:void 0}), '[]'::json)`);let K=[{dbKey:"data",tsKey:"data",field:E.as("data"),isJson:!0,relationTableTsKey:l.tsName,selection:y}];b!==void 0||N!==void 0||I.length>0?(q=this.buildSelectQuery({table:Be(s,f),fields:{},fieldsFlat:[{path:[],field:n.raw("*")}],where:j,limit:b,offset:N,orderBy:I,setOperators:[]}),j=void 0,b=void 0,N=void 0,I=[]):q=Be(s,f),q=this.buildSelectQuery({table:c(q,V)?q:new D(q,{},f),fields:{},fieldsFlat:K.map(({field:P})=>({path:[],field:c(P,T)?k(P,f):P})),joins:B,where:j,limit:b,offset:N,orderBy:I,setOperators:[]})}else q=this.buildSelectQuery({table:Be(s,f),fields:{},fieldsFlat:y.map(({field:E})=>({path:[],field:c(E,T)?k(E,f):E})),joins:B,where:j,limit:b,offset:N,orderBy:I,setOperators:[]});return{tableTsKey:l.tsName,sql:q,selection:y}}};gn=o,a(We,gn,"PgDialect");var wn,li=class{config;constructor(e){this.config={...e}}get(e,t){if(t==="_")return{...e._,selectedFields:new Proxy(e._.selectedFields,this)};if(t===C)return{...e[C],selectedFields:new Proxy(e[C].selectedFields,this)};if(typeof t=="symbol")return e[t];let s=(c(e,D)?e._.selectedFields:c(e,U)?e[C].selectedFields:e)[t];if(c(s,p.Aliased)){if(this.config.sqlAliasedBehavior==="sql"&&!s.isSelectionField)return s.sql;let l=s.clone();return l.isSelectionField=!0,l}if(c(s,p)){if(this.config.sqlBehavior==="sql")return s;throw new Error(`You tried to reference "${t}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return c(s,T)?this.config.alias?new Proxy(s,new ne(new Proxy(s.table,new le(this.config.alias,this.config.replaceOriginalName??!1)))):s:typeof s!="object"||s===null?s:new Proxy(s,new li(this.config))}},A=li;wn=o,a(A,wn,"SelectionProxyHandler");var bn,He=class{getSelectedFields(){return this._.selectedFields}};bn=o,a(He,bn,"TypedQueryBuilder");var qn,ee=class{fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}from(e){let t=!!this.fields,r;return this.fields?r=this.fields:c(e,D)?r=Object.fromEntries(Object.keys(e._.selectedFields).map(s=>[s,e[s]])):c(e,Z)?r=e[C].selectedFields:c(e,p)?r={}:r=Ue(e),new Ge({table:e,fields:r,isPartialSelect:t,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct})}};qn=o,a(ee,qn,"PgSelectBuilder");var _n,$t=class extends He{_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:t,isPartialSelect:r,session:s,dialect:l,withList:u,distinct:f}){super(),this.config={withList:u,table:e,fields:{...t},distinct:f,setOperators:[]},this.isPartialSelect=r,this.session=s,this.dialect=l,this._={selectedFields:t},this.tableName=ri(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}createJoin(e){return(t,r)=>{let s=this.tableName,l=ri(t);if(typeof l=="string"&&this.config.joins?.some(u=>u.alias===l))throw new Error(`Alias "${l}" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof s=="string"&&(this.config.fields={[s]:this.config.fields}),typeof l=="string"&&!c(t,p))){let u=c(t,D)?t._.selectedFields:c(t,U)?t[C].selectedFields:t[h.Symbol.Columns];this.config.fields[l]=u}if(typeof r=="function"&&(r=r(new Proxy(this.config.fields,new A({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:r,table:t,joinType:e,alias:l}),typeof l=="string")switch(e){case"left":{this.joinsNotNullableMap[l]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([u])=>[u,!1])),this.joinsNotNullableMap[l]=!0;break}case"inner":{this.joinsNotNullableMap[l]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([u])=>[u,!1])),this.joinsNotNullableMap[l]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");createSetOperator(e,t){return r=>{let s=typeof r=="function"?r(Sn()):r;if(!ii(this.getSelectedFields(),s.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:e,isAll:t,rightSelect:s}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new A({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=e,this}having(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new A({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=e,this}groupBy(...e){if(typeof e[0]=="function"){let t=e[0](new Proxy(this.config.fields,new A({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(t)?t:[t]}else this.config.groupBy=e;return this}orderBy(...e){if(typeof e[0]=="function"){let t=e[0](new Proxy(this.config.fields,new A({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),r=Array.isArray(t)?t:[t];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}else{let t=e;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=t:this.config.orderBy=t}return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,t={}){return this.config.lockingClause={strength:e,config:t},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}as(e){return new Proxy(new D(this.getSQL(),this.config.fields,e),new A({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new A({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}};_n=o,a($t,_n,"PgSelectQueryBuilder");var On,Ge=class extends $t{_prepare(e){let{session:t,config:r,dialect:s,joinsNotNullableMap:l}=this;if(!t)throw new Error("Cannot execute a query on a query builder. Please use a database instance instead.");return Le.startActiveSpan("drizzle.prepareQuery",()=>{let u=xe(r.fields),f=t.prepareQuery(s.sqlToQuery(this.getSQL()),u,e,!0);return f.joinsNotNullableMap=l,f})}prepare(e){return this._prepare(e)}execute=e=>Le.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e))};On=o,a(Ge,On,"PgSelect");$i(Ge,[Ie]);function Te(i,e){return(t,r,...s)=>{let l=[r,...s].map(u=>({type:i,isAll:e,rightSelect:u}));for(let u of l)if(!ii(t.getSelectedFields(),u.rightSelect.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return t.addSetOperators(l)}}var Sn=()=>({union:Nn,unionAll:xn,intersect:$n,intersectAll:Tn,except:vn,exceptAll:Cn}),Nn=Te("union",!1),xn=Te("union",!0),$n=Te("intersect",!1),Tn=Te("intersect",!0),vn=Te("except",!1),Cn=Te("except",!0);var Pn,ve=class{dialect;$with(e){let t=this;return{as(r){return typeof r=="function"&&(r=r(t)),new Proxy(new Qe(r.getSQL(),r.getSelectedFields(),e,!0),new A({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}}}with(...e){let t=this;function r(u){return new ee({fields:u??void 0,session:void 0,dialect:t.getDialect(),withList:e})}function s(u){return new ee({fields:u??void 0,session:void 0,dialect:t.getDialect(),distinct:!0})}function l(u,f){return new ee({fields:f??void 0,session:void 0,dialect:t.getDialect(),distinct:{on:u}})}return{select:r,selectDistinct:s,selectDistinctOn:l}}select(e){return new ee({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new ee({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,t){return new ee({fields:t??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new We),this.dialect}};Pn=o,a(ve,Pn,"PgQueryBuilder");var An,Tt=class{constructor(e,t){this.unique=e,this.name=t}on(...e){return new Ce(e.map(t=>{if(c(t,p))return t;t=t;let r=new oe(t.name,t.columnType,t.indexConfig);return t.indexConfig=JSON.parse(JSON.stringify(t.defaultConfig)),r}),this.unique,!1,this.name)}onOnly(...e){return new Ce(e.map(t=>{if(c(t,p))return t;t=t;let r=new oe(t.name,t.columnType,t.indexConfig);return t.indexConfig=t.defaultConfig,r}),this.unique,!0,this.name)}using(e,...t){return new Ce(t.map(r=>{if(c(r,p))return r;r=r;let s=new oe(r.name,r.columnType,r.indexConfig);return r.indexConfig=JSON.parse(JSON.stringify(r.defaultConfig)),s}),this.unique,!0,this.name,e)}};An=o,a(Tt,An,"PgIndexBuilderOn");var jn,Ce=class{config;constructor(e,t,r,s,l="btree"){this.config={name:s,columns:e,unique:t,only:r,method:l}}concurrently(){return this.config.concurrently=!0,this}with(e){return this.config.with=e,this}where(e){return this.config.where=e,this}build(e){return new vt(this.config,e)}};jn=o,a(Ce,jn,"PgIndexBuilder");var En,vt=class{config;constructor(e,t){this.config={...e,table:t}}};En=o,a(vt,En,"PgIndex");function te(i){return new Tt(!1,i)}var ui=Symbol.for("drizzle:PgViewConfig");var zn,Ye=class{constructor(e,t){this.name=e,this.schema=t}config={};with(e){return this.config.with=e,this}};zn=o,a(Ye,zn,"PgDefaultViewBuilderCore");var Dn,Ct=class extends Ye{as(e){typeof e=="function"&&(e=e(new ve));let t=new A({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}),r=new Proxy(e.getSelectedFields(),t);return new Proxy(new qe({pgConfig:this.config,config:{name:this.name,schema:this.schema,selectedFields:r,query:e.getSQL().inlineParams()}}),t)}};Dn=o,a(Ct,Dn,"PgViewBuilder");var Kn,qt=class extends Ye{columns;constructor(e,t,r){super(e,r),this.columns=Ue(Qt(e,t))}existing(){return new Proxy(new qe({pgConfig:void 0,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:void 0}}),new A({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}as(e){return new Proxy(new qe({pgConfig:this.config,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:e.inlineParams()}}),new A({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}};Kn=o,a(qt,Kn,"PgManualViewBuilder");var Fn,ke=class{constructor(e,t){this.name=e,this.schema=t}config={};using(e){return this.config.using=e,this}with(e){return this.config.with=e,this}tablespace(e){return this.config.tablespace=e,this}withNoData(){return this.config.withNoData=!0,this}};Fn=o,a(ke,Fn,"PgMaterializedViewBuilderCore");var Qn,_t=class extends ke{as(e){typeof e=="function"&&(e=e(new ve));let t=new A({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}),r=new Proxy(e.getSelectedFields(),t);return new Proxy(new _e({pgConfig:{with:this.config.with,using:this.config.using,tablespace:this.config.tablespace,withNoData:this.config.withNoData},config:{name:this.name,schema:this.schema,selectedFields:r,query:e.getSQL().inlineParams()}}),t)}};Qn=o,a(_t,Qn,"PgMaterializedViewBuilder");var Ln,Ot=class extends ke{columns;constructor(e,t,r){super(e,r),this.columns=Ue(Qt(e,t))}existing(){return new Proxy(new _e({pgConfig:void 0,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:void 0}}),new A({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}as(e){return new Proxy(new _e({pgConfig:void 0,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:e.inlineParams()}}),new A({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}};Ln=o,a(Ot,Ln,"PgManualMaterializedViewBuilder");var Bn,qe=class extends Z{[(Bn=o,ui)];constructor({pgConfig:e,config:t}){super(t),e&&(this[ui]={with:e.with})}};a(qe,Bn,"PgView");var Hi=Symbol.for("drizzle:PgMaterializedViewConfig"),Vn,_e=class extends Z{[(Vn=o,Hi)];constructor({pgConfig:e,config:t}){super(t),this[Hi]={with:e?.with,using:e?.using,tablespace:e?.tablespace,withNoData:e?.withNoData}}};a(_e,Vn,"PgMaterializedView");function Gi(i,e,t){return e?new qt(i,e,t):new Ct(i,t)}function Yi(i,e,t){return e?new Ot(i,e,t):new _t(i,t)}var In,Pt=class{constructor(e){this.schemaName=e}table=(e,t,r)=>Ft(e,t,r,this.schemaName);view=(e,t)=>Gi(e,t,this.schemaName);materializedView=(e,t)=>Yi(e,t,this.schemaName);enum=(e,t)=>wi(e,t,this.schemaName)};In=o,a(Pt,In,"PgSchema");function W(i){if(i==="public")throw new Error("You can't specify 'public' as schema name. Postgres is using public schema by default. If you want to use 'public' schema, just use pgTable() instead of creating a schema");return new Pt(i)}var Oe=W(process.env.SCHEMA_POSTGRES||"").table("post_estate",{id:L("id").default(n`gen_random_uuid()`).primaryKey(),title:g("title",{length:255}).notNull(),slug:g("slug",{length:255}).notNull(),code:g("code",{length:255}).notNull(),address:g("title",{length:255}),street:g("street",{length:255}),lat:se("lat").default(0),lang:se("lang").default(0),type:x("type").notNull().default(0),youtubeUrl:X("youtube_url"),point:se("point").notNull(),provinceCode:x("province_code").notNull(),districtCode:x("district_code").notNull(),wardCode:x("ward_code").notNull(),customerId:L("customer_id").notNull(),noteVerified:X("note_verified"),isBlock:x("is_block").notNull().default(0),isDelete:x("is_delete").notNull().default(0),isOwner:x("is_owner").notNull().default(0),createdBy:g("created_by",{length:255}),createdAt:Q("created_at").notNull().default(n`now()`),modifyBy:g("modify_by",{length:255}),modifyAt:Q("modify_at").notNull().default(n`now()`).$onUpdate(()=>new Date)},i=>({idxPostEstateNameSlugId:te("post_estate_name_slug_id_idx").on(i.title,i.slug,i.id)}));var Zl=W(process.env.SCHEMA_POSTGRES||"").table("images",{id:L("id").default(n`gen_random_uuid()`).primaryKey(),link:g("link",{length:255}).notNull(),type:x("type").notNull().default(0),position:x("position").default(0),isAvatar:x("is_avatar").notNull().default(0),description:g("description",{length:255}),isUsed:x("is_used").default(0),postEstateId:L("post_estate_id").references(()=>Oe.id,{onDelete:"cascade",onUpdate:"cascade"}),isConfirmUpdate:x("is_confirm_update").notNull().default(0),createdBy:g("created_by",{length:255}),createdAt:Q("created_at").notNull().default(n`now()`),modifyBy:g("modify_by",{length:255}),modifyAt:Q("modify_at").notNull().default(n`now()`).$onUpdate(()=>new Date)},i=>({idxNameId:te("image_link_id_idx").on(i.link,i.id)}));var ru=W("bds_products").table("common_land",{id:L("id").default(n`gen_random_uuid()`).primaryKey(),name:g("name",{length:255}).notNull(),code:g("code",{length:255}).notNull(),slug:g("slug",{length:255}).notNull(),content:X("content"),provinceCode:x("province_code").notNull(),districtCode:x("district_code").notNull(),wardCode:x("ward_code").notNull(),status:x("status").default(1),createdBy:g("created_by",{length:255}),createdAt:Q("created_at").notNull().default(n`now()`),modifyBy:g("modify_by",{length:255}),modifyAt:Q("modify_at").notNull().default(n`now()`).$onUpdate(()=>new Date)},i=>({idxCommonLandNameSlugId:te("common_land_name_slug_id_idx").on(i.name,i.slug,i.id)}));var au=W(process.env.SCHEMA_POSTGRES||"").table("post_estate_report",{id:L("id").default(n`gen_random_uuid()`).primaryKey(),description:g("description",{length:255}).notNull(),postEstateId:L("post_estate_id").notNull(),customerId:L("customer_id"),contactName:g("contact_name",{length:50}),contactPhone:g("contact_phone",{length:20}),contactMail:g("contact_mail",{length:50}),isConfirmed:x("is_confirmed").notNull().default(0),createdBy:g("created_by",{length:255}),createdAt:Q("created_at").notNull().default(n`now()`),modifyBy:g("modify_by",{length:255}),modifyAt:Q("modify_at").notNull().default(n`now()`).$onUpdate(()=>new Date)},i=>({idxPostEstateReportNameId:te("post_estate_report_name_id_idx").on(i.contactName,i.id)}));var du=W(process.env.SCHEMA_POSTGRES||"").table("post_estate_history",{id:L("id").default(n`gen_random_uuid()`).primaryKey(),postEstateId:L("post_estate_id").notNull().references(()=>Oe.id,{onDelete:"cascade",onUpdate:"cascade"}),note:X("node"),createdBy:g("created_by",{length:255}),createdAt:Q("created_at").notNull().default(n`now()`),modifyBy:g("modify_by",{length:255}),modifyAt:Q("modify_at").notNull().default(n`now()`).$onUpdate(()=>new Date)},i=>({idxPostEstateHistoryId:te("post_estate_history_id_idx").on(i.postEstateId,i.id)}));var Un=W(process.env.SCHEMA_POSTGRES||"").table("post_estate_detail",{id:L("id").default(n`gen_random_uuid()`).primaryKey(),postEstateId:L("post_estate_id").references(()=>Oe.id,{onDelete:"cascade"}),content:X("content"),acreage:se("acreage"),facade:se("facade"),numWayIn:se("num_way_in"),price:ei("price"),unit:x("unit").notNull().default(0),priceSquareMetre:ei("price_square_metre"),directionHouse:g("direction_house",{length:100}),directionBalcony:g("direction_balcony",{length:100}),numBedroom:x("num_bedroom"),numRoadHouse:x("num_road_House"),numFloors:x("num_floors"),numBathroom:x("num_bathroom"),furniture:g("furniture",{length:255}),houseOwningDocument:X("house_owning_document"),contactName:g("contact_name",{length:255}),contactPhone:g("contact_phone",{length:255}),contactMail:g("contact_mail",{length:100}),createdBy:g("created_by",{length:255}),createdAt:Q("created_at").notNull().default(n`now()`),modifyBy:g("modify_by",{length:255}),modifyAt:Q("modify_at").notNull().default(n`now()`).$onUpdate(()=>new Date)},i=>({}));0&&(module.exports={postEstateDetailModel});
//# sourceMappingURL=postEstateDetail.model.js.map

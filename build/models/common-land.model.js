"use strict";var Je=Object.defineProperty;var Ji=Object.getOwnPropertyDescriptor;var Wi=Object.getOwnPropertyNames;var Yi=Object.prototype.hasOwnProperty;var Hi=(i,e,t)=>e in i?Je(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var Xi=(i,e)=>{for(var t in e)Je(i,t,{get:e[t],enumerable:!0})},Gi=(i,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of Wi(e))!Yi.call(i,s)&&s!==t&&Je(i,s,{get:()=>e[s],enumerable:!(r=Ji(e,s))||r.enumerable});return i};var Zi=i=>Gi(Je({},"__esModule",{value:!0}),i);var a=(i,e,t)=>(Hi(i,typeof e!="symbol"?e+"":e,t),t);var Ln={};Xi(Ln,{commonLandModel:()=>Dn});module.exports=Zi(Ln);var o=Symbol.for("drizzle:entityKind"),Vn=Symbol.for("drizzle:hasOwnEntityKind");function c(i,e){if(!i||typeof i!="object")return!1;if(i instanceof e)return!0;if(!Object.prototype.hasOwnProperty.call(e,o))throw new Error(`Class "${e.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let t=i.constructor;if(t)for(;t;){if(o in t&&t[o]===e[o])return!0;t=Object.getPrototypeOf(t)}return!1}var ki,N=class{constructor(e,t){this.table=e,this.config=t,this.name=t.name,this.notNull=t.notNull,this.default=t.default,this.defaultFn=t.defaultFn,this.onUpdateFn=t.onUpdateFn,this.hasDefault=t.hasDefault,this.primary=t.primaryKey,this.isUnique=t.isUnique,this.uniqueName=t.uniqueName,this.uniqueType=t.uniqueType,this.dataType=t.dataType,this.columnType=t.columnType}name;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;config;mapFromDriverValue(e){return e}mapToDriverValue(e){return e}};ki=o,a(N,ki,"Column");var er,Oe=class{config;constructor(e,t,r){this.config={name:e,notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:t,columnType:r}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}};er=o,a(Oe,er,"ColumnBuilder");var We=Symbol.for("drizzle:Name"),xt=Symbol.for("drizzle:Schema"),ti=Symbol.for("drizzle:Columns"),ii=Symbol.for("drizzle:ExtraConfigColumns"),Tt=Symbol.for("drizzle:OriginalName"),vt=Symbol.for("drizzle:BaseName"),ri=Symbol.for("drizzle:IsAlias"),ni=Symbol.for("drizzle:ExtraConfigBuilder"),tr=Symbol.for("drizzle:IsDrizzleTable"),ir,p=class{[(ir=o,We)];[Tt];[xt];[ti];[ii];[vt];[ri]=!1;[ni]=void 0;[tr]=!0;constructor(e,t,r){this[We]=this[Tt]=e,this[xt]=t,this[vt]=r}};a(p,ir,"Table"),a(p,"Symbol",{Name:We,Schema:xt,OriginalName:Tt,Columns:ti,ExtraConfigColumns:ii,BaseName:vt,IsAlias:ri,ExtraConfigBuilder:ni});function ie(i){return i[We]}var qt=Symbol.for("drizzle:PgInlineForeignKeys"),rr,L=class extends p{[(rr=o,qt)]=[];[p.Symbol.ExtraConfigBuilder]=void 0};a(L,rr,"PgTable"),a(L,"Symbol",Object.assign({},p.Symbol,{InlineForeignKeys:qt}));function Ct(i,e,t,r,s=i){let l=new L(i,r,s),u=Object.fromEntries(Object.entries(e).map(([f,y])=>{let w=y,S=w.build(l);return l[qt].push(...w.buildForeignKeys(S,l)),[f,S]})),m=Object.fromEntries(Object.entries(e).map(([f,y])=>{let S=y.buildExtraConfigColumn(l);return[f,S]})),d=Object.assign(l,u);return d[p.Symbol.Columns]=u,d[p.Symbol.ExtraConfigColumns]=m,t&&(d[L.Symbol.ExtraConfigBuilder]=t),d}var Ot=(i,e,t)=>Ct(i,e,t,void 0);var nr,Pe=class{reference;_onUpdate="no action";_onDelete="no action";constructor(e,t){this.reference=()=>{let{name:r,columns:s,foreignColumns:l}=e();return{name:r,columns:s,foreignTable:l[0].table,foreignColumns:l}},t&&(this._onUpdate=t.onUpdate,this._onDelete=t.onDelete)}onUpdate(e){return this._onUpdate=e===void 0?"no action":e,this}onDelete(e){return this._onDelete=e===void 0?"no action":e,this}build(e){return new Ye(e,this)}};nr=o,a(Pe,nr,"PgForeignKeyBuilder");var sr,Ye=class{constructor(e,t){this.table=e,this.reference=t.reference,this.onUpdate=t._onUpdate,this.onDelete=t._onDelete}reference;onUpdate;onDelete;getName(){let{name:e,columns:t,foreignColumns:r}=this.reference(),s=t.map(m=>m.name),l=r.map(m=>m.name),u=[this.table[L.Symbol.Name],...s,r[0].table[L.Symbol.Name],...l];return e??`${u.join("_")}_fk`}};sr=o,a(Ye,sr,"PgForeignKey");function He(i,...e){return i(...e)}function jt(i,e){return`${i[L.Symbol.Name]}_${e.join("_")}_unique`}var or,Xe=class{constructor(e,t){this.name=t,this.columns=e}columns;nullsNotDistinctConfig=!1;nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(e){return new Ge(e,this.columns,this.nullsNotDistinctConfig,this.name)}};or=o,a(Xe,or,"PgUniqueConstraintBuilder");var ar,Pt=class{name;constructor(e){this.name=e}on(...e){return new Xe(e,this.name)}};ar=o,a(Pt,ar,"PgUniqueOnConstraintBuilder");var lr,Ge=class{constructor(e,t,r,s){this.table=e,this.columns=t,this.name=s??jt(this.table,this.columns.map(l=>l.name)),this.nullsNotDistinct=r}columns;name;nullsNotDistinct=!1;getName(){return this.name}};lr=o,a(Ge,lr,"PgUniqueConstraint");function si(i,e,t){for(let r=e;r<i.length;r++){let s=i[r];if(s==="\\"){r++;continue}if(s==='"')return[i.slice(e,r).replace(/\\/g,""),r+1];if(!t&&(s===","||s==="}"))return[i.slice(e,r).replace(/\\/g,""),r]}return[i.slice(e).replace(/\\/g,""),i.length]}function oi(i,e=0){let t=[],r=e,s=!1;for(;r<i.length;){let l=i[r];if(l===","){(s||r===e)&&t.push(""),s=!0,r++;continue}if(s=!1,l==="\\"){r+=2;continue}if(l==='"'){let[d,f]=si(i,r+1,!0);t.push(d),r=f;continue}if(l==="}")return[t,r+1];if(l==="{"){let[d,f]=oi(i,r+1);t.push(d),r=f;continue}let[u,m]=si(i,r,!1);t.push(u),r=m}return[t,r]}function ai(i){let[e]=oi(i,1);return e}function zt(i){return`{${i.map(e=>Array.isArray(e)?zt(e):typeof e=="string"?`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${e}`).join(",")}}`}var ur,T=class extends Oe{foreignKeyConfigs=[];array(e){return new ke(this.config.name,this,e)}references(e,t={}){return this.foreignKeyConfigs.push({ref:e,actions:t}),this}unique(e,t){return this.config.isUnique=!0,this.config.uniqueName=e,this.config.uniqueType=t?.nulls,this}buildForeignKeys(e,t){return this.foreignKeyConfigs.map(({ref:r,actions:s})=>He((l,u)=>{let m=new Pe(()=>{let d=l();return{columns:[e],foreignColumns:[d]}});return u.onUpdate&&m.onUpdate(u.onUpdate),u.onDelete&&m.onDelete(u.onDelete),m.build(t)},r,s))}buildExtraConfigColumn(e){return new Ze(e,this.config)}};ur=o,a(T,ur,"PgColumnBuilder");var cr,g=class extends N{constructor(e,t){t.uniqueName||(t.uniqueName=jt(e,[t.name])),super(e,t),this.table=e}};cr=o,a(g,cr,"PgColumn");var fr,Ze=class extends g{getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(e){return this.indexConfig.opClass=e,this}};fr=o,a(Ze,fr,"ExtraConfigColumn");var mr,Z=class{constructor(e,t,r){this.name=e,this.type=t,this.indexConfig=r}name;type;indexConfig};mr=o,a(Z,mr,"IndexedColumn");var dr,ke=class extends T{constructor(e,t,r){super(e,"array","PgArray"),this.config.baseBuilder=t,this.config.size=r}build(e){let t=this.config.baseBuilder.build(e);return new et(e,this.config,t)}};dr=o,a(ke,dr,"PgArrayBuilder");var hr,At=class extends g{constructor(e,t,r,s){super(e,t),this.baseColumn=r,this.range=s,this.size=t.size}size;getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(e){return typeof e=="string"&&(e=ai(e)),e.map(t=>this.baseColumn.mapFromDriverValue(t))}mapToDriverValue(e,t=!1){let r=e.map(s=>s===null?null:c(this.baseColumn,At)?this.baseColumn.mapToDriverValue(s,!0):this.baseColumn.mapToDriverValue(s));return t?r:zt(r)}},et=At;hr=o,a(et,hr,"PgArray");var Kt=Symbol.for("drizzle:isPgEnum");function li(i){return!!i&&typeof i=="function"&&Kt in i&&i[Kt]===!0}var pr,tt=class extends T{constructor(e,t){super(e,"string","PgEnumColumn"),this.config.enum=t}build(e){return new it(e,this.config)}};pr=o,a(tt,pr,"PgEnumColumnBuilder");var yr,it=class extends g{enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(e,t){super(e,t),this.enum=t.enum}getSQLType(){return this.enum.enumName}};yr=o,a(it,yr,"PgEnumColumn");function ui(i,e,t){let r=Object.assign(s=>new tt(s,r),{enumName:i,enumValues:e,schema:t,[Kt]:!0});return r}var gr,K=class{constructor(e,t,r,s=!1){this._={brand:"Subquery",sql:e,selectedFields:t,alias:r,isWith:s}}};gr=o,a(K,gr,"Subquery");var wr,je=class extends K{};wr=o,a(je,wr,"WithSubquery");var ci="0.31.2";var Qt,Ft,ze={startActiveSpan(i,e){return Qt?(Ft||(Ft=Qt.trace.getTracer("drizzle-orm",ci)),He((t,r)=>r.startActiveSpan(i,s=>{try{return e(s)}catch(l){throw s.setStatus({code:t.SpanStatusCode.ERROR,message:l instanceof Error?l.message:"Unknown error"}),l}finally{s.end()}}),Qt,Ft)):e()}};var x=Symbol.for("drizzle:ViewBaseConfig");var Sr,Dt=class{};Sr=o,a(Dt,Sr,"FakePrimitiveParam");function Lt(i){return i!=null&&typeof i.getSQL=="function"}function br(i){let e={sql:"",params:[]};for(let t of i)e.sql+=t.sql,e.params.push(...t.params),t.typings?.length&&(e.typings||(e.typings=[]),e.typings.push(...t.typings));return e}var $r,C=class{value;constructor(e){this.value=Array.isArray(e)?e:[e]}getSQL(){return new h([this])}};$r=o,a(C,$r,"StringChunk");var Nr,re=class{constructor(e){this.queryChunks=e}decoder=mi;shouldInlineParams=!1;append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return ze.startActiveSpan("drizzle.buildSQL",t=>{let r=this.buildQueryFromSourceParams(this.queryChunks,e);return t?.setAttributes({"drizzle.query.text":r.sql,"drizzle.query.params":JSON.stringify(r.params)}),r})}buildQueryFromSourceParams(e,t){let r=Object.assign({},t,{inlineParams:t.inlineParams||this.shouldInlineParams,paramStartIndex:t.paramStartIndex||{value:0}}),{escapeName:s,escapeParam:l,prepareTyping:u,inlineParams:m,paramStartIndex:d}=r;return br(e.map(f=>{if(c(f,C))return{sql:f.value.join(""),params:[]};if(c(f,ne))return{sql:s(f.value),params:[]};if(f===void 0)return{sql:"",params:[]};if(Array.isArray(f)){let y=[new C("(")];for(let[w,S]of f.entries())y.push(S),w<f.length-1&&y.push(new C(", "));return y.push(new C(")")),this.buildQueryFromSourceParams(y,r)}if(c(f,re))return this.buildQueryFromSourceParams(f.queryChunks,{...r,inlineParams:m||f.shouldInlineParams});if(c(f,p)){let y=f[p.Symbol.Schema],w=f[p.Symbol.Name];return{sql:y===void 0?s(w):s(y)+"."+s(w),params:[]}}if(c(f,N))return t.invokeSource==="indexes"?{sql:s(f.name),params:[]}:{sql:s(f.table[p.Symbol.Name])+"."+s(f.name),params:[]};if(c(f,V)){let y=f[x].schema,w=f[x].name;return{sql:y===void 0?s(w):s(y)+"."+s(w),params:[]}}if(c(f,U)){let y=f.value===null?null:f.encoder.mapToDriverValue(f.value);if(c(y,re))return this.buildQueryFromSourceParams([y],r);if(m)return{sql:this.mapInlineParam(y,r),params:[]};let w;return u!==void 0&&(w=[u(f.encoder)]),{sql:l(d.value++,y),params:[y],typings:w}}return c(f,k)?{sql:l(d.value++,f),params:[f]}:c(f,re.Aliased)&&f.fieldAlias!==void 0?{sql:s(f.fieldAlias),params:[]}:c(f,K)?f._.isWith?{sql:s(f._.alias),params:[]}:this.buildQueryFromSourceParams([new C("("),f._.sql,new C(") "),new ne(f._.alias)],r):li(f)?f.schema?{sql:s(f.schema)+"."+s(f.enumName),params:[]}:{sql:s(f.enumName),params:[]}:Lt(f)?this.buildQueryFromSourceParams([new C("("),f.getSQL(),new C(")")],r):m?{sql:this.mapInlineParam(f,r),params:[]}:{sql:l(d.value++,f),params:[f]}}))}mapInlineParam(e,{escapeString:t}){if(e===null)return"null";if(typeof e=="number"||typeof e=="boolean")return e.toString();if(typeof e=="string")return t(e);if(typeof e=="object"){let r=e.toString();return t(r==="[object Object]"?JSON.stringify(e):r)}throw new Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return e===void 0?this:new re.Aliased(this,e)}mapWith(e){return this.decoder=typeof e=="function"?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}},h=re;Nr=o,a(h,Nr,"SQL");var xr,ne=class{constructor(e){this.value=e}brand;getSQL(){return new h([this])}};xr=o,a(ne,xr,"Name");function fi(i){return typeof i=="object"&&i!==null&&"mapToDriverValue"in i&&typeof i.mapToDriverValue=="function"}var mi={mapFromDriverValue:i=>i},di={mapToDriverValue:i=>i},Es={...mi,...di},Tr,U=class{constructor(e,t=di){this.value=e,this.encoder=t}brand;getSQL(){return new h([this])}};Tr=o,a(U,Tr,"Param");function n(i,...e){let t=[];(e.length>0||i.length>0&&i[0]!=="")&&t.push(new C(i[0]));for(let[r,s]of e.entries())t.push(s,new C(i[r+1]));return new h(t)}(i=>{function e(){return new h([])}i.empty=e;function t(d){return new h(d)}i.fromList=t;function r(d){return new h([new C(d)])}i.raw=r;function s(d,f){let y=[];for(let[w,S]of d.entries())w>0&&f!==void 0&&y.push(f),y.push(S);return new h(y)}i.join=s;function l(d){return new ne(d)}i.identifier=l;function u(d){return new k(d)}i.placeholder=u;function m(d,f){return new U(d,f)}i.param=m})(n||(n={}));(i=>{class e{constructor(r,s){this.sql=r,this.fieldAlias=s}static[o]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new e(this.sql,this.fieldAlias)}}i.Aliased=e})(h||(h={}));var vr,k=class{constructor(e){this.name=e}getSQL(){return new h([this])}};vr=o,a(k,vr,"Placeholder");var qr,V=class{[(qr=o,x)];constructor({name:e,schema:t,selectedFields:r,query:s}){this[x]={name:e,originalName:e,schema:t,selectedFields:r,query:s,isExisting:!s,isAlias:!1}}getSQL(){return new h([this])}};a(V,qr,"View");N.prototype.getSQL=function(){return new h([this])};p.prototype.getSQL=function(){return new h([this])};K.prototype.getSQL=function(){return new h([this])};var Cr,G=class{constructor(e){this.table=e}get(e,t){return t==="table"?this.table:e[t]}};Cr=o,a(G,Cr,"ColumnAliasProxyHandler");var Or,ee=class{constructor(e,t){this.alias=e,this.replaceOriginalName=t}get(e,t){if(t===p.Symbol.IsAlias)return!0;if(t===p.Symbol.Name)return this.alias;if(this.replaceOriginalName&&t===p.Symbol.OriginalName)return this.alias;if(t===x)return{...e[x],name:this.alias,isAlias:!0};if(t===p.Symbol.Columns){let s=e[p.Symbol.Columns];if(!s)return s;let l={};return Object.keys(s).map(u=>{l[u]=new Proxy(s[u],new G(new Proxy(e,this)))}),l}let r=e[t];return c(r,N)?new Proxy(r,new G(new Proxy(e,this))):r}};Or=o,a(ee,Or,"TableAliasProxyHandler");var Pr,Et=class{constructor(e){this.alias=e}get(e,t){return t==="sourceTable"?Ae(e.sourceTable,this.alias):e[t]}};Pr=o,a(Et,Pr,"RelationTableAliasProxyHandler");function Ae(i,e){return new Proxy(i,new ee(e,!1))}function J(i,e){return new Proxy(i,new G(new Proxy(i.table,new ee(e,!1))))}function Vt(i,e){return new h.Aliased(Ke(i.sql,e),i.fieldAlias)}function Ke(i,e){return n.join(i.queryChunks.map(t=>c(t,N)?J(t,e):c(t,h)?Ke(t,e):c(t,h.Aliased)?Vt(t,e):t))}var jr,R=class extends T{defaultNow(){return this.default(n`now()`)}};jr=o,a(R,jr,"PgDateColumnBaseBuilder");var zr,Bt=class extends R{constructor(e){super(e,"date","PgDate")}build(e){return new se(e,this.config)}};zr=o,a(Bt,zr,"PgDateBuilder");var Ar,se=class extends g{getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}mapToDriverValue(e){return e.toISOString()}};Ar=o,a(se,Ar,"PgDate");var Kr,_t=class extends R{constructor(e){super(e,"string","PgDateString")}build(e){return new oe(e,this.config)}};Kr=o,a(_t,Kr,"PgDateStringBuilder");var Qr,oe=class extends g{getSQLType(){return"date"}};Qr=o,a(oe,Qr,"PgDateString");var Fr,rt=class extends T{constructor(e){super(e,"number","PgInteger")}build(e){return new nt(e,this.config)}};Fr=o,a(rt,Fr,"PgIntegerBuilder");var Dr,nt=class extends g{getSQLType(){return"integer"}mapFromDriverValue(e){return typeof e=="string"?Number.parseInt(e):e}};Dr=o,a(nt,Dr,"PgInteger");function Qe(i){return new rt(i)}var Lr,It=class extends T{constructor(e){super(e,"json","PgJson")}build(e){return new ae(e,this.config)}};Lr=o,a(It,Lr,"PgJsonBuilder");var Er,ae=class extends g{constructor(e,t){super(e,t)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}};Er=o,a(ae,Er,"PgJson");var Vr,Ut=class extends T{constructor(e){super(e,"json","PgJsonb")}build(e){return new le(e,this.config)}};Vr=o,a(Ut,Vr,"PgJsonbBuilder");var Br,le=class extends g{constructor(e,t){super(e,t)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}};Br=o,a(le,Br,"PgJsonb");var _r,Rt=class extends T{constructor(e,t,r){super(e,"string","PgNumeric"),this.config.precision=t,this.config.scale=r}build(e){return new ue(e,this.config)}};_r=o,a(Rt,_r,"PgNumericBuilder");var Ir,ue=class extends g{precision;scale;constructor(e,t){super(e,t),this.precision=t.precision,this.scale=t.scale}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}};Ir=o,a(ue,Ir,"PgNumeric");var Ur,st=class extends T{constructor(e,t){super(e,"string","PgText"),this.config.enumValues=t.enum}build(e){return new ot(e,this.config)}};Ur=o,a(st,Ur,"PgTextBuilder");var Rr,ot=class extends g{enumValues=this.config.enumValues;getSQLType(){return"text"}};Rr=o,a(ot,Rr,"PgText");function hi(i,e={}){return new st(i,e)}var Mr,Mt=class extends R{constructor(e,t,r){super(e,"string","PgTime"),this.withTimezone=t,this.precision=r,this.config.withTimezone=t,this.config.precision=r}build(e){return new ce(e,this.config)}};Mr=o,a(Mt,Mr,"PgTimeBuilder");var Jr,ce=class extends g{withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}};Jr=o,a(ce,Jr,"PgTime");var Wr,at=class extends R{constructor(e,t,r){super(e,"date","PgTimestamp"),this.config.withTimezone=t,this.config.precision=r}build(e){return new fe(e,this.config)}};Wr=o,a(at,Wr,"PgTimestampBuilder");var Yr,fe=class extends g{withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=e=>new Date(this.withTimezone?e:e+"+0000");mapToDriverValue=e=>e.toISOString()};Yr=o,a(fe,Yr,"PgTimestamp");var Hr,lt=class extends R{constructor(e,t,r){super(e,"string","PgTimestampString"),this.config.withTimezone=t,this.config.precision=r}build(e){return new me(e,this.config)}};Hr=o,a(lt,Hr,"PgTimestampStringBuilder");var Xr,me=class extends g{withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}};Xr=o,a(me,Xr,"PgTimestampString");function Jt(i,e={}){return e.mode==="string"?new lt(i,e.withTimezone??!1,e.precision):new at(i,e.withTimezone??!1,e.precision)}var Gr,ut=class extends T{constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default(n`gen_random_uuid()`)}build(e){return new de(e,this.config)}};Gr=o,a(ut,Gr,"PgUUIDBuilder");var Zr,de=class extends g{getSQLType(){return"uuid"}};Zr=o,a(de,Zr,"PgUUID");function pi(i){return new ut(i)}var kr,ct=class extends T{constructor(e,t){super(e,"string","PgVarchar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new ft(e,this.config)}};kr=o,a(ct,kr,"PgVarcharBuilder");var en,ft=class extends g{length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}};en=o,a(ft,en,"PgVarchar");function he(i,e={}){return new ct(i,e)}var tn,Fe=class{[(tn=o,Symbol.toStringTag)]="QueryPromise";catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}then(e,t){return this.execute().then(e,t)}};a(Fe,tn,"QueryPromise");function pe(i,e){return Object.entries(i).reduce((t,[r,s])=>{if(typeof r!="string")return t;let l=e?[...e,r]:[r];return c(s,N)||c(s,h)||c(s,h.Aliased)?t.push({path:l,field:s}):c(s,p)?t.push(...pe(s[p.Symbol.Columns],l)):t.push(...pe(s,l)),t},[])}function Wt(i,e){let t=Object.keys(i),r=Object.keys(e);if(t.length!==r.length)return!1;for(let[s,l]of t.entries())if(l!==r[s])return!1;return!0}function yi(i,e){for(let t of e)for(let r of Object.getOwnPropertyNames(t.prototype))r!=="constructor"&&Object.defineProperty(i.prototype,r,Object.getOwnPropertyDescriptor(t.prototype,r)||Object.create(null))}function De(i){return i[p.Symbol.Columns]}function Yt(i){return c(i,K)?i._.alias:c(i,V)?i[x].name:c(i,h)?void 0:i[p.Symbol.IsAlias]?i[p.Symbol.Name]:i[p.Symbol.BaseName]}var rn,ye=class extends Error{constructor({message:e,cause:t}){super(e),this.name="DrizzleError",this.cause=t}};rn=o,a(ye,rn,"DrizzleError");var nn,Ht=class extends ye{constructor(){super({message:"Rollback"})}};nn=o,a(Ht,nn,"TransactionRollbackError");function _(i,e){return fi(e)&&!Lt(i)&&!c(i,U)&&!c(i,k)&&!c(i,N)&&!c(i,p)&&!c(i,V)?new U(i,e):i}var mt=(i,e)=>n`${i} = ${_(e,i)}`,gi=(i,e)=>n`${i} <> ${_(e,i)}`;function Le(...i){let e=i.filter(t=>t!==void 0);if(e.length!==0)return e.length===1?new h(e):new h([new C("("),n.join(e,new C(" and ")),new C(")")])}function wi(...i){let e=i.filter(t=>t!==void 0);if(e.length!==0)return e.length===1?new h(e):new h([new C("("),n.join(e,new C(" or ")),new C(")")])}function bi(i){return n`not ${i}`}var Si=(i,e)=>n`${i} > ${_(e,i)}`,$i=(i,e)=>n`${i} >= ${_(e,i)}`,Ni=(i,e)=>n`${i} < ${_(e,i)}`,xi=(i,e)=>n`${i} <= ${_(e,i)}`;function Ti(i,e){if(Array.isArray(e)){if(e.length===0)throw new Error("inArray requires at least one value");return n`${i} in ${e.map(t=>_(t,i))}`}return n`${i} in ${_(e,i)}`}function vi(i,e){if(Array.isArray(e)){if(e.length===0)throw new Error("notInArray requires at least one value");return n`${i} not in ${e.map(t=>_(t,i))}`}return n`${i} not in ${_(e,i)}`}function qi(i){return n`${i} is null`}function Ci(i){return n`${i} is not null`}function Oi(i){return n`exists ${i}`}function Pi(i){return n`not exists ${i}`}function ji(i,e,t){return n`${i} between ${_(e,i)} and ${_(t,i)}`}function zi(i,e,t){return n`${i} not between ${_(e,i)} and ${_(t,i)}`}function Ai(i,e){return n`${i} like ${e}`}function Ki(i,e){return n`${i} not like ${e}`}function Qi(i,e){return n`${i} ilike ${e}`}function Fi(i,e){return n`${i} not ilike ${e}`}function Di(i){return n`${i} asc`}function Li(i){return n`${i} desc`}var sn,Ee=class{constructor(e,t,r){this.sourceTable=e,this.referencedTable=t,this.relationName=r,this.referencedTableName=t[p.Symbol.Name]}referencedTableName;fieldName};sn=o,a(Ee,sn,"Relation");var on,Xt=class{constructor(e,t){this.table=e,this.config=t}};on=o,a(Xt,on,"Relations");var an,Gt=class extends Ee{constructor(e,t,r,s){super(e,t,r?.relationName),this.config=r,this.isNullable=s}withFieldName(e){let t=new Gt(this.sourceTable,this.referencedTable,this.config,this.isNullable);return t.fieldName=e,t}},te=Gt;an=o,a(te,an,"One");var ln,Zt=class extends Ee{constructor(e,t,r){super(e,t,r?.relationName),this.config=r}withFieldName(e){let t=new Zt(this.sourceTable,this.referencedTable,this.config);return t.fieldName=e,t}},Ve=Zt;ln=o,a(Ve,ln,"Many");function Ei(){return{and:Le,between:ji,eq:mt,exists:Oi,gt:Si,gte:$i,ilike:Qi,inArray:Ti,isNull:qi,isNotNull:Ci,like:Ai,lt:Ni,lte:xi,ne:gi,not:bi,notBetween:zi,notExists:Pi,notLike:Ki,notIlike:Fi,notInArray:vi,or:wi,sql:n}}function Vi(){return{sql:n,asc:Di,desc:Li}}function Bi(i,e,t){if(c(t,te)&&t.config)return{fields:t.config.fields,references:t.config.references};let r=e[t.referencedTable[p.Symbol.Name]];if(!r)throw new Error(`Table "${t.referencedTable[p.Symbol.Name]}" not found in schema`);let s=i[r];if(!s)throw new Error(`Table "${r}" not found in schema`);let l=t.sourceTable,u=e[l[p.Symbol.Name]];if(!u)throw new Error(`Table "${l[p.Symbol.Name]}" not found in schema`);let m=[];for(let d of Object.values(s.relations))(t.relationName&&t!==d&&d.relationName===t.relationName||!t.relationName&&d.referencedTable===t.sourceTable)&&m.push(d);if(m.length>1)throw t.relationName?new Error(`There are multiple relations with name "${t.relationName}" in table "${r}"`):new Error(`There are multiple relations between "${r}" and "${t.sourceTable[p.Symbol.Name]}". Please specify relation name`);if(m[0]&&c(m[0],te)&&m[0].config)return{fields:m[0].config.references,references:m[0].config.fields};throw new Error(`There is not enough information to infer relation "${u}.${t.fieldName}"`)}var un,W=class extends V{};un=o,a(W,un,"PgViewBase");var cn,Be=class{async migrate(e,t,r){let s=typeof r=="string"?"__drizzle_migrations":r.migrationsTable??"__drizzle_migrations",l=typeof r=="string"?"drizzle":r.migrationsSchema??"drizzle",u=n`
			CREATE TABLE IF NOT EXISTS ${n.identifier(l)}.${n.identifier(s)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at bigint
			)
		`;await t.execute(n`CREATE SCHEMA IF NOT EXISTS ${n.identifier(l)}`),await t.execute(u);let d=(await t.all(n`select id, hash, created_at from ${n.identifier(l)}.${n.identifier(s)} order by created_at desc limit 1`))[0];await t.transaction(async f=>{for await(let y of e)if(!d||Number(d.created_at)<y.folderMillis){for(let w of y.sql)await f.execute(n.raw(w));await f.execute(n`insert into ${n.identifier(l)}.${n.identifier(s)} ("hash", "created_at") values(${y.hash}, ${y.folderMillis})`)}})}escapeName(e){return`"${e}"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildWithCTE(e){if(!e?.length)return;let t=[n`with `];for(let[r,s]of e.entries())t.push(n`${n.identifier(s._.alias)} as (${s._.sql})`),r<e.length-1&&t.push(n`, `);return t.push(n` `),n.join(t)}buildDeleteQuery({table:e,where:t,returning:r,withList:s}){let l=this.buildWithCTE(s),u=r?n` returning ${this.buildSelection(r,{isSingleTable:!0})}`:void 0,m=t?n` where ${t}`:void 0;return n`${l}delete from ${e}${m}${u}`}buildUpdateSet(e,t){let r=e[p.Symbol.Columns],s=Object.keys(r).filter(u=>t[u]!==void 0||r[u]?.onUpdateFn!==void 0),l=s.length;return n.join(s.flatMap((u,m)=>{let d=r[u],f=t[u]??n.param(d.onUpdateFn(),d),y=n`${n.identifier(d.name)} = ${f}`;return m<l-1?[y,n.raw(", ")]:[y]}))}buildUpdateQuery({table:e,set:t,where:r,returning:s,withList:l}){let u=this.buildWithCTE(l),m=this.buildUpdateSet(e,t),d=s?n` returning ${this.buildSelection(s,{isSingleTable:!0})}`:void 0,f=r?n` where ${r}`:void 0;return n`${u}update ${e} set ${m}${f}${d}`}buildSelection(e,{isSingleTable:t=!1}={}){let r=e.length,s=e.flatMap(({field:l},u)=>{let m=[];if(c(l,h.Aliased)&&l.isSelectionField)m.push(n.identifier(l.fieldAlias));else if(c(l,h.Aliased)||c(l,h)){let d=c(l,h.Aliased)?l.sql:l;t?m.push(new h(d.queryChunks.map(f=>c(f,g)?n.identifier(f.name):f))):m.push(d),c(l,h.Aliased)&&m.push(n` as ${n.identifier(l.fieldAlias)}`)}else c(l,N)&&(t?m.push(n.identifier(l.name)):m.push(l));return u<r-1&&m.push(n`, `),m});return n.join(s)}buildSelectQuery({withList:e,fields:t,fieldsFlat:r,where:s,having:l,table:u,joins:m,orderBy:d,groupBy:f,limit:y,offset:w,lockingClause:S,distinct:E,setOperators:j}){let D=r??pe(t);for(let q of D)if(c(q.field,N)&&ie(q.field.table)!==(c(u,K)?u._.alias:c(u,W)?u[x].name:c(u,h)?void 0:ie(u))&&!(A=>m?.some(({alias:I})=>I===(A[p.Symbol.IsAlias]?ie(A):A[p.Symbol.BaseName])))(q.field.table)){let A=ie(q.field.table);throw new Error(`Your "${q.path.join("->")}" field references a column "${A}"."${q.field.name}", but the table "${A}" is not part of the query! Did you forget to join it?`)}let v=!m||m.length===0,z=this.buildWithCTE(e),Q;E&&(Q=E===!0?n` distinct`:n` distinct on (${n.join(E.on,n`, `)})`);let F=this.buildSelection(D,{isSingleTable:v}),O=(()=>{if(c(u,p)&&u[p.Symbol.OriginalName]!==u[p.Symbol.Name]){let q=n`${n.identifier(u[p.Symbol.OriginalName])}`;return u[p.Symbol.Schema]&&(q=n`${n.identifier(u[p.Symbol.Schema])}.${q}`),n`${q} ${n.identifier(u[p.Symbol.Name])}`}return u})(),B=[];if(m)for(let[q,A]of m.entries()){q===0&&B.push(n` `);let I=A.table,Te=A.lateral?n` lateral`:void 0;if(c(I,L)){let Nt=I[L.Symbol.Name],ve=I[L.Symbol.Schema],qe=I[L.Symbol.OriginalName],Ce=Nt===qe?void 0:A.alias;B.push(n`${n.raw(A.joinType)} join${Te} ${ve?n`${n.identifier(ve)}.`:void 0}${n.identifier(qe)}${Ce&&n` ${n.identifier(Ce)}`} on ${A.on}`)}else if(c(I,V)){let Nt=I[x].name,ve=I[x].schema,qe=I[x].originalName,Ce=Nt===qe?void 0:A.alias;B.push(n`${n.raw(A.joinType)} join${Te} ${ve?n`${n.identifier(ve)}.`:void 0}${n.identifier(qe)}${Ce&&n` ${n.identifier(Ce)}`} on ${A.on}`)}else B.push(n`${n.raw(A.joinType)} join${Te} ${I} on ${A.on}`);q<m.length-1&&B.push(n` `)}let H=n.join(B),b=s?n` where ${s}`:void 0,$=l?n` having ${l}`:void 0,M;d&&d.length>0&&(M=n` order by ${n.join(d,n`, `)}`);let Ne;f&&f.length>0&&(Ne=n` group by ${n.join(f,n`, `)}`);let $t=y?n` limit ${y}`:void 0,xe=w?n` offset ${w}`:void 0,X=n.empty();if(S){let q=n` for ${n.raw(S.strength)}`;S.config.of&&q.append(n` of ${n.join(Array.isArray(S.config.of)?S.config.of:[S.config.of],n`, `)}`),S.config.noWait?q.append(n` no wait`):S.config.skipLocked&&q.append(n` skip locked`),X.append(q)}let Me=n`${z}select${Q} ${F} from ${O}${H}${b}${Ne}${$}${M}${$t}${xe}${X}`;return j.length>0?this.buildSetOperations(Me,j):Me}buildSetOperations(e,t){let[r,...s]=t;if(!r)throw new Error("Cannot pass undefined values to any set operator");return s.length===0?this.buildSetOperationQuery({leftSelect:e,setOperator:r}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:r}),s)}buildSetOperationQuery({leftSelect:e,setOperator:{type:t,isAll:r,rightSelect:s,limit:l,orderBy:u,offset:m}}){let d=n`(${e.getSQL()}) `,f=n`(${s.getSQL()})`,y;if(u&&u.length>0){let j=[];for(let D of u)if(c(D,g))j.push(n.identifier(D.name));else if(c(D,h)){for(let v=0;v<D.queryChunks.length;v++){let z=D.queryChunks[v];c(z,g)&&(D.queryChunks[v]=n.identifier(z.name))}j.push(n`${D}`)}else j.push(n`${D}`);y=n` order by ${n.join(j,n`, `)} `}let w=l?n` limit ${l}`:void 0,S=n.raw(`${t} ${r?"all ":""}`),E=m?n` offset ${m}`:void 0;return n`${d}${S}${f}${y}${w}${E}`}buildInsertQuery({table:e,values:t,onConflict:r,returning:s,withList:l}){let u=[],m=e[p.Symbol.Columns],d=Object.entries(m),f=d.map(([,j])=>n.identifier(j.name));for(let[j,D]of t.entries()){let v=[];for(let[z,Q]of d){let F=D[z];if(F===void 0||c(F,U)&&F.value===void 0)if(Q.defaultFn!==void 0){let O=Q.defaultFn(),B=c(O,h)?O:n.param(O,Q);v.push(B)}else if(!Q.default&&Q.onUpdateFn!==void 0){let O=Q.onUpdateFn(),B=c(O,h)?O:n.param(O,Q);v.push(B)}else v.push(n`default`);else v.push(F)}u.push(v),j<t.length-1&&u.push(n`, `)}let y=this.buildWithCTE(l),w=n.join(u),S=s?n` returning ${this.buildSelection(s,{isSingleTable:!0})}`:void 0,E=r?n` on conflict ${r}`:void 0;return n`${y}insert into ${e} ${f} values ${w}${E}${S}`}buildRefreshMaterializedViewQuery({view:e,concurrently:t,withNoData:r}){let s=t?n` concurrently`:void 0,l=r?n` with no data`:void 0;return n`refresh materialized view${s} ${e}${l}`}prepareTyping(e){return c(e,le)||c(e,ae)?"json":c(e,ue)?"decimal":c(e,ce)?"time":c(e,fe)||c(e,me)?"timestamp":c(e,se)||c(e,oe)?"date":c(e,de)?"uuid":"none"}sqlToQuery(e,t){return e.toQuery({escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:t})}buildRelationalQueryWithoutPK({fullSchema:e,schema:t,tableNamesMap:r,table:s,tableConfig:l,queryConfig:u,tableAlias:m,nestedQueryRelation:d,joinOn:f}){let y=[],w,S,E=[],j,D=[];if(u===!0)y=Object.entries(l.columns).map(([Q,F])=>({dbKey:F.name,tsKey:Q,field:J(F,m),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let z=Object.fromEntries(Object.entries(l.columns).map(([b,$])=>[b,J($,m)]));if(u.where){let b=typeof u.where=="function"?u.where(z,Ei()):u.where;j=b&&Ke(b,m)}let Q=[],F=[];if(u.columns){let b=!1;for(let[$,M]of Object.entries(u.columns))M!==void 0&&$ in l.columns&&(!b&&M===!0&&(b=!0),F.push($));F.length>0&&(F=b?F.filter($=>u.columns?.[$]===!0):Object.keys(l.columns).filter($=>!F.includes($)))}else F=Object.keys(l.columns);for(let b of F){let $=l.columns[b];Q.push({tsKey:b,value:$})}let O=[];u.with&&(O=Object.entries(u.with).filter(b=>!!b[1]).map(([b,$])=>({tsKey:b,queryConfig:$,relation:l.relations[b]})));let B;if(u.extras){B=typeof u.extras=="function"?u.extras(z,{sql:n}):u.extras;for(let[b,$]of Object.entries(B))Q.push({tsKey:b,value:Vt($,m)})}for(let{tsKey:b,value:$}of Q)y.push({dbKey:c($,h.Aliased)?$.fieldAlias:l.columns[b].name,tsKey:b,field:c($,N)?J($,m):$,relationTableTsKey:void 0,isJson:!1,selection:[]});let H=typeof u.orderBy=="function"?u.orderBy(z,Vi()):u.orderBy??[];Array.isArray(H)||(H=[H]),E=H.map(b=>c(b,N)?J(b,m):Ke(b,m)),w=u.limit,S=u.offset;for(let{tsKey:b,queryConfig:$,relation:M}of O){let Ne=Bi(t,r,M),$t=M.referencedTable[p.Symbol.Name],xe=r[$t],X=`${m}_${b}`,Me=Le(...Ne.fields.map((I,Te)=>mt(J(Ne.references[Te],X),J(I,m)))),q=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:t,tableNamesMap:r,table:e[xe],tableConfig:t[xe],queryConfig:c(M,te)?$===!0?{limit:1}:{...$,limit:1}:$,tableAlias:X,joinOn:Me,nestedQueryRelation:M}),A=n`${n.identifier(X)}.${n.identifier("data")}`.as(b);D.push({on:n`true`,table:new K(q.sql,{},X),alias:X,joinType:"left",lateral:!0}),y.push({dbKey:b,tsKey:b,field:A,relationTableTsKey:xe,isJson:!0,selection:q.selection})}}if(y.length===0)throw new ye({message:`No fields selected for table "${l.tsName}" ("${m}")`});let v;if(j=Le(f,j),d){let z=n`json_build_array(${n.join(y.map(({field:O,tsKey:B,isJson:H})=>H?n`${n.identifier(`${m}_${B}`)}.${n.identifier("data")}`:c(O,h.Aliased)?O.sql:O),n`, `)})`;c(d,Ve)&&(z=n`coalesce(json_agg(${z}${E.length>0?n` order by ${n.join(E,n`, `)}`:void 0}), '[]'::json)`);let Q=[{dbKey:"data",tsKey:"data",field:z.as("data"),isJson:!0,relationTableTsKey:l.tsName,selection:y}];w!==void 0||S!==void 0||E.length>0?(v=this.buildSelectQuery({table:Ae(s,m),fields:{},fieldsFlat:[{path:[],field:n.raw("*")}],where:j,limit:w,offset:S,orderBy:E,setOperators:[]}),j=void 0,w=void 0,S=void 0,E=[]):v=Ae(s,m),v=this.buildSelectQuery({table:c(v,L)?v:new K(v,{},m),fields:{},fieldsFlat:Q.map(({field:O})=>({path:[],field:c(O,N)?J(O,m):O})),joins:D,where:j,limit:w,offset:S,orderBy:E,setOperators:[]})}else v=this.buildSelectQuery({table:Ae(s,m),fields:{},fieldsFlat:y.map(({field:z})=>({path:[],field:c(z,N)?J(z,m):z})),joins:D,where:j,limit:w,offset:S,orderBy:E,setOperators:[]});return{tableTsKey:l.tsName,sql:v,selection:y}}};cn=o,a(Be,cn,"PgDialect");var fn,kt=class{config;constructor(e){this.config={...e}}get(e,t){if(t==="_")return{...e._,selectedFields:new Proxy(e._.selectedFields,this)};if(t===x)return{...e[x],selectedFields:new Proxy(e[x].selectedFields,this)};if(typeof t=="symbol")return e[t];let s=(c(e,K)?e._.selectedFields:c(e,V)?e[x].selectedFields:e)[t];if(c(s,h.Aliased)){if(this.config.sqlAliasedBehavior==="sql"&&!s.isSelectionField)return s.sql;let l=s.clone();return l.isSelectionField=!0,l}if(c(s,h)){if(this.config.sqlBehavior==="sql")return s;throw new Error(`You tried to reference "${t}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return c(s,N)?this.config.alias?new Proxy(s,new G(new Proxy(s.table,new ee(this.config.alias,this.config.replaceOriginalName??!1)))):s:typeof s!="object"||s===null?s:new Proxy(s,new kt(this.config))}},P=kt;fn=o,a(P,fn,"SelectionProxyHandler");var mn,_e=class{getSelectedFields(){return this._.selectedFields}};mn=o,a(_e,mn,"TypedQueryBuilder");var Sn,Y=class{fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}from(e){let t=!!this.fields,r;return this.fields?r=this.fields:c(e,K)?r=Object.fromEntries(Object.keys(e._.selectedFields).map(s=>[s,e[s]])):c(e,W)?r=e[x].selectedFields:c(e,h)?r={}:r=De(e),new Ie({table:e,fields:r,isPartialSelect:t,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct})}};Sn=o,a(Y,Sn,"PgSelectBuilder");var $n,dt=class extends _e{_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:t,isPartialSelect:r,session:s,dialect:l,withList:u,distinct:m}){super(),this.config={withList:u,table:e,fields:{...t},distinct:m,setOperators:[]},this.isPartialSelect=r,this.session=s,this.dialect=l,this._={selectedFields:t},this.tableName=Yt(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}createJoin(e){return(t,r)=>{let s=this.tableName,l=Yt(t);if(typeof l=="string"&&this.config.joins?.some(u=>u.alias===l))throw new Error(`Alias "${l}" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof s=="string"&&(this.config.fields={[s]:this.config.fields}),typeof l=="string"&&!c(t,h))){let u=c(t,K)?t._.selectedFields:c(t,V)?t[x].selectedFields:t[p.Symbol.Columns];this.config.fields[l]=u}if(typeof r=="function"&&(r=r(new Proxy(this.config.fields,new P({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:r,table:t,joinType:e,alias:l}),typeof l=="string")switch(e){case"left":{this.joinsNotNullableMap[l]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([u])=>[u,!1])),this.joinsNotNullableMap[l]=!0;break}case"inner":{this.joinsNotNullableMap[l]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([u])=>[u,!1])),this.joinsNotNullableMap[l]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");createSetOperator(e,t){return r=>{let s=typeof r=="function"?r(dn()):r;if(!Wt(this.getSelectedFields(),s.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:e,isAll:t,rightSelect:s}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new P({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=e,this}having(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new P({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=e,this}groupBy(...e){if(typeof e[0]=="function"){let t=e[0](new Proxy(this.config.fields,new P({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(t)?t:[t]}else this.config.groupBy=e;return this}orderBy(...e){if(typeof e[0]=="function"){let t=e[0](new Proxy(this.config.fields,new P({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),r=Array.isArray(t)?t:[t];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}else{let t=e;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=t:this.config.orderBy=t}return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,t={}){return this.config.lockingClause={strength:e,config:t},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}as(e){return new Proxy(new K(this.getSQL(),this.config.fields,e),new P({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new P({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}};$n=o,a(dt,$n,"PgSelectQueryBuilder");var Nn,Ie=class extends dt{_prepare(e){let{session:t,config:r,dialect:s,joinsNotNullableMap:l}=this;if(!t)throw new Error("Cannot execute a query on a query builder. Please use a database instance instead.");return ze.startActiveSpan("drizzle.prepareQuery",()=>{let u=pe(r.fields),m=t.prepareQuery(s.sqlToQuery(this.getSQL()),u,e,!0);return m.joinsNotNullableMap=l,m})}prepare(e){return this._prepare(e)}execute=e=>ze.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e))};Nn=o,a(Ie,Nn,"PgSelect");yi(Ie,[Fe]);function ge(i,e){return(t,r,...s)=>{let l=[r,...s].map(u=>({type:i,isAll:e,rightSelect:u}));for(let u of l)if(!Wt(t.getSelectedFields(),u.rightSelect.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return t.addSetOperators(l)}}var dn=()=>({union:hn,unionAll:pn,intersect:yn,intersectAll:gn,except:wn,exceptAll:bn}),hn=ge("union",!1),pn=ge("union",!0),yn=ge("intersect",!1),gn=ge("intersect",!0),wn=ge("except",!1),bn=ge("except",!0);var xn,we=class{dialect;$with(e){let t=this;return{as(r){return typeof r=="function"&&(r=r(t)),new Proxy(new je(r.getSQL(),r.getSelectedFields(),e,!0),new P({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}}}with(...e){let t=this;function r(u){return new Y({fields:u??void 0,session:void 0,dialect:t.getDialect(),withList:e})}function s(u){return new Y({fields:u??void 0,session:void 0,dialect:t.getDialect(),distinct:!0})}function l(u,m){return new Y({fields:m??void 0,session:void 0,dialect:t.getDialect(),distinct:{on:u}})}return{select:r,selectDistinct:s,selectDistinctOn:l}}select(e){return new Y({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new Y({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,t){return new Y({fields:t??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new Be),this.dialect}};xn=o,a(we,xn,"PgQueryBuilder");var Tn,ht=class{constructor(e,t){this.unique=e,this.name=t}on(...e){return new be(e.map(t=>{if(c(t,h))return t;t=t;let r=new Z(t.name,t.columnType,t.indexConfig);return t.indexConfig=JSON.parse(JSON.stringify(t.defaultConfig)),r}),this.unique,!1,this.name)}onOnly(...e){return new be(e.map(t=>{if(c(t,h))return t;t=t;let r=new Z(t.name,t.columnType,t.indexConfig);return t.indexConfig=t.defaultConfig,r}),this.unique,!0,this.name)}using(e,...t){return new be(t.map(r=>{if(c(r,h))return r;r=r;let s=new Z(r.name,r.columnType,r.indexConfig);return r.indexConfig=JSON.parse(JSON.stringify(r.defaultConfig)),s}),this.unique,!0,this.name,e)}};Tn=o,a(ht,Tn,"PgIndexBuilderOn");var vn,be=class{config;constructor(e,t,r,s,l="btree"){this.config={name:s,columns:e,unique:t,only:r,method:l}}concurrently(){return this.config.concurrently=!0,this}with(e){return this.config.with=e,this}where(e){return this.config.where=e,this}build(e){return new pt(this.config,e)}};vn=o,a(be,vn,"PgIndexBuilder");var qn,pt=class{config;constructor(e,t){this.config={...e,table:t}}};qn=o,a(pt,qn,"PgIndex");function _i(i){return new ht(!1,i)}var ei=Symbol.for("drizzle:PgViewConfig");var Cn,Ue=class{constructor(e,t){this.name=e,this.schema=t}config={};with(e){return this.config.with=e,this}};Cn=o,a(Ue,Cn,"PgDefaultViewBuilderCore");var On,yt=class extends Ue{as(e){typeof e=="function"&&(e=e(new we));let t=new P({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}),r=new Proxy(e.getSelectedFields(),t);return new Proxy(new Se({pgConfig:this.config,config:{name:this.name,schema:this.schema,selectedFields:r,query:e.getSQL().inlineParams()}}),t)}};On=o,a(yt,On,"PgViewBuilder");var Pn,gt=class extends Ue{columns;constructor(e,t,r){super(e,r),this.columns=De(Ot(e,t))}existing(){return new Proxy(new Se({pgConfig:void 0,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:void 0}}),new P({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}as(e){return new Proxy(new Se({pgConfig:this.config,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:e.inlineParams()}}),new P({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}};Pn=o,a(gt,Pn,"PgManualViewBuilder");var jn,Re=class{constructor(e,t){this.name=e,this.schema=t}config={};using(e){return this.config.using=e,this}with(e){return this.config.with=e,this}tablespace(e){return this.config.tablespace=e,this}withNoData(){return this.config.withNoData=!0,this}};jn=o,a(Re,jn,"PgMaterializedViewBuilderCore");var zn,wt=class extends Re{as(e){typeof e=="function"&&(e=e(new we));let t=new P({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}),r=new Proxy(e.getSelectedFields(),t);return new Proxy(new $e({pgConfig:{with:this.config.with,using:this.config.using,tablespace:this.config.tablespace,withNoData:this.config.withNoData},config:{name:this.name,schema:this.schema,selectedFields:r,query:e.getSQL().inlineParams()}}),t)}};zn=o,a(wt,zn,"PgMaterializedViewBuilder");var An,bt=class extends Re{columns;constructor(e,t,r){super(e,r),this.columns=De(Ot(e,t))}existing(){return new Proxy(new $e({pgConfig:void 0,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:void 0}}),new P({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}as(e){return new Proxy(new $e({pgConfig:void 0,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:e.inlineParams()}}),new P({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}};An=o,a(bt,An,"PgManualMaterializedViewBuilder");var Kn,Se=class extends W{[(Kn=o,ei)];constructor({pgConfig:e,config:t}){super(t),e&&(this[ei]={with:e.with})}};a(Se,Kn,"PgView");var Ii=Symbol.for("drizzle:PgMaterializedViewConfig"),Qn,$e=class extends W{[(Qn=o,Ii)];constructor({pgConfig:e,config:t}){super(t),this[Ii]={with:e?.with,using:e?.using,tablespace:e?.tablespace,withNoData:e?.withNoData}}};a($e,Qn,"PgMaterializedView");function Ui(i,e,t){return e?new gt(i,e,t):new yt(i,t)}function Ri(i,e,t){return e?new bt(i,e,t):new wt(i,t)}var Fn,St=class{constructor(e){this.schemaName=e}table=(e,t,r)=>Ct(e,t,r,this.schemaName);view=(e,t)=>Ui(e,t,this.schemaName);materializedView=(e,t)=>Ri(e,t,this.schemaName);enum=(e,t)=>ui(e,t,this.schemaName)};Fn=o,a(St,Fn,"PgSchema");function Mi(i){if(i==="public")throw new Error("You can't specify 'public' as schema name. Postgres is using public schema by default. If you want to use 'public' schema, just use pgTable() instead of creating a schema");return new St(i)}var Dn=Mi("bds_products").table("common_land",{id:pi("id").default(n`gen_random_uuid()`).primaryKey(),name:he("name",{length:255}).notNull(),code:he("code",{length:255}).notNull(),slug:he("slug",{length:255}).notNull(),content:hi("content"),provinceCode:Qe("province_code").notNull(),districtCode:Qe("district_code").notNull(),wardCode:Qe("ward_code").notNull(),status:Qe("status").default(1),createdBy:he("created_by",{length:255}),createdAt:Jt("created_at").notNull().default(n`now()`),modifyBy:he("modify_by",{length:255}),modifyAt:Jt("modify_at").notNull().default(n`now()`).$onUpdate(()=>new Date)},i=>({idxCommonLandNameSlugId:_i("common_land_name_slug_id_idx").on(i.name,i.slug,i.id)}));0&&(module.exports={commonLandModel});
//# sourceMappingURL=common-land.model.js.map

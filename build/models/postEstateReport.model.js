"use strict";var Me=Object.defineProperty;var Ri=Object.getOwnPropertyDescriptor;var Ui=Object.getOwnPropertyNames;var Mi=Object.prototype.hasOwnProperty;var Ji=(i,e,t)=>e in i?Me(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var Wi=(i,e)=>{for(var t in e)Me(i,t,{get:e[t],enumerable:!0})},Yi=(i,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of Ui(e))!Mi.call(i,s)&&s!==t&&Me(i,s,{get:()=>e[s],enumerable:!(r=Ri(e,s))||r.enumerable});return i};var Hi=i=>Yi(Me({},"__esModule",{value:!0}),i);var l=(i,e,t)=>(Ji(i,typeof e!="symbol"?e+"":e,t),t);var An={};Wi(An,{postEstateReportModel:()=>zn});module.exports=Hi(An);var o=Symbol.for("drizzle:entityKind"),Fn=Symbol.for("drizzle:hasOwnEntityKind");function c(i,e){if(!i||typeof i!="object")return!1;if(i instanceof e)return!0;if(!Object.prototype.hasOwnProperty.call(e,o))throw new Error(`Class "${e.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let t=i.constructor;if(t)for(;t;){if(o in t&&t[o]===e[o])return!0;t=Object.getPrototypeOf(t)}return!1}var Xi,N=class{constructor(e,t){this.table=e,this.config=t,this.name=t.name,this.notNull=t.notNull,this.default=t.default,this.defaultFn=t.defaultFn,this.onUpdateFn=t.onUpdateFn,this.hasDefault=t.hasDefault,this.primary=t.primaryKey,this.isUnique=t.isUnique,this.uniqueName=t.uniqueName,this.uniqueType=t.uniqueType,this.dataType=t.dataType,this.columnType=t.columnType}name;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;config;mapFromDriverValue(e){return e}mapToDriverValue(e){return e}};Xi=o,l(N,Xi,"Column");var Gi,Oe=class{config;constructor(e,t,r){this.config={name:e,notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:t,columnType:r}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}};Gi=o,l(Oe,Gi,"ColumnBuilder");var Je=Symbol.for("drizzle:Name"),$t=Symbol.for("drizzle:Schema"),kt=Symbol.for("drizzle:Columns"),ei=Symbol.for("drizzle:ExtraConfigColumns"),Nt=Symbol.for("drizzle:OriginalName"),xt=Symbol.for("drizzle:BaseName"),ti=Symbol.for("drizzle:IsAlias"),ii=Symbol.for("drizzle:ExtraConfigBuilder"),Zi=Symbol.for("drizzle:IsDrizzleTable"),ki,p=class{[(ki=o,Je)];[Nt];[$t];[kt];[ei];[xt];[ti]=!1;[ii]=void 0;[Zi]=!0;constructor(e,t,r){this[Je]=this[Nt]=e,this[$t]=t,this[xt]=r}};l(p,ki,"Table"),l(p,"Symbol",{Name:Je,Schema:$t,OriginalName:Nt,Columns:kt,ExtraConfigColumns:ei,BaseName:xt,IsAlias:ti,ExtraConfigBuilder:ii});function re(i){return i[Je]}var Tt=Symbol.for("drizzle:PgInlineForeignKeys"),er,D=class extends p{[(er=o,Tt)]=[];[p.Symbol.ExtraConfigBuilder]=void 0};l(D,er,"PgTable"),l(D,"Symbol",Object.assign({},p.Symbol,{InlineForeignKeys:Tt}));function vt(i,e,t,r,s=i){let a=new D(i,r,s),u=Object.fromEntries(Object.entries(e).map(([f,y])=>{let g=y,S=g.build(a);return a[Tt].push(...g.buildForeignKeys(S,a)),[f,S]})),m=Object.fromEntries(Object.entries(e).map(([f,y])=>{let S=y.buildExtraConfigColumn(a);return[f,S]})),d=Object.assign(a,u);return d[p.Symbol.Columns]=u,d[p.Symbol.ExtraConfigColumns]=m,t&&(d[D.Symbol.ExtraConfigBuilder]=t),d}var qt=(i,e,t)=>vt(i,e,t,void 0);var tr,Pe=class{reference;_onUpdate="no action";_onDelete="no action";constructor(e,t){this.reference=()=>{let{name:r,columns:s,foreignColumns:a}=e();return{name:r,columns:s,foreignTable:a[0].table,foreignColumns:a}},t&&(this._onUpdate=t.onUpdate,this._onDelete=t.onDelete)}onUpdate(e){return this._onUpdate=e===void 0?"no action":e,this}onDelete(e){return this._onDelete=e===void 0?"no action":e,this}build(e){return new We(e,this)}};tr=o,l(Pe,tr,"PgForeignKeyBuilder");var ir,We=class{constructor(e,t){this.table=e,this.reference=t.reference,this.onUpdate=t._onUpdate,this.onDelete=t._onDelete}reference;onUpdate;onDelete;getName(){let{name:e,columns:t,foreignColumns:r}=this.reference(),s=t.map(m=>m.name),a=r.map(m=>m.name),u=[this.table[D.Symbol.Name],...s,r[0].table[D.Symbol.Name],...a];return e??`${u.join("_")}_fk`}};ir=o,l(We,ir,"PgForeignKey");function Ye(i,...e){return i(...e)}function Ot(i,e){return`${i[D.Symbol.Name]}_${e.join("_")}_unique`}var rr,He=class{constructor(e,t){this.name=t,this.columns=e}columns;nullsNotDistinctConfig=!1;nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(e){return new Xe(e,this.columns,this.nullsNotDistinctConfig,this.name)}};rr=o,l(He,rr,"PgUniqueConstraintBuilder");var nr,Ct=class{name;constructor(e){this.name=e}on(...e){return new He(e,this.name)}};nr=o,l(Ct,nr,"PgUniqueOnConstraintBuilder");var sr,Xe=class{constructor(e,t,r,s){this.table=e,this.columns=t,this.name=s??Ot(this.table,this.columns.map(a=>a.name)),this.nullsNotDistinct=r}columns;name;nullsNotDistinct=!1;getName(){return this.name}};sr=o,l(Xe,sr,"PgUniqueConstraint");function ri(i,e,t){for(let r=e;r<i.length;r++){let s=i[r];if(s==="\\"){r++;continue}if(s==='"')return[i.slice(e,r).replace(/\\/g,""),r+1];if(!t&&(s===","||s==="}"))return[i.slice(e,r).replace(/\\/g,""),r]}return[i.slice(e).replace(/\\/g,""),i.length]}function ni(i,e=0){let t=[],r=e,s=!1;for(;r<i.length;){let a=i[r];if(a===","){(s||r===e)&&t.push(""),s=!0,r++;continue}if(s=!1,a==="\\"){r+=2;continue}if(a==='"'){let[d,f]=ri(i,r+1,!0);t.push(d),r=f;continue}if(a==="}")return[t,r+1];if(a==="{"){let[d,f]=ni(i,r+1);t.push(d),r=f;continue}let[u,m]=ri(i,r,!1);t.push(u),r=m}return[t,r]}function si(i){let[e]=ni(i,1);return e}function Pt(i){return`{${i.map(e=>Array.isArray(e)?Pt(e):typeof e=="string"?`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${e}`).join(",")}}`}var or,O=class extends Oe{foreignKeyConfigs=[];array(e){return new Ze(this.config.name,this,e)}references(e,t={}){return this.foreignKeyConfigs.push({ref:e,actions:t}),this}unique(e,t){return this.config.isUnique=!0,this.config.uniqueName=e,this.config.uniqueType=t?.nulls,this}buildForeignKeys(e,t){return this.foreignKeyConfigs.map(({ref:r,actions:s})=>Ye((a,u)=>{let m=new Pe(()=>{let d=a();return{columns:[e],foreignColumns:[d]}});return u.onUpdate&&m.onUpdate(u.onUpdate),u.onDelete&&m.onDelete(u.onDelete),m.build(t)},r,s))}buildExtraConfigColumn(e){return new Ge(e,this.config)}};or=o,l(O,or,"PgColumnBuilder");var ar,b=class extends N{constructor(e,t){t.uniqueName||(t.uniqueName=Ot(e,[t.name])),super(e,t),this.table=e}};ar=o,l(b,ar,"PgColumn");var lr,Ge=class extends b{getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(e){return this.indexConfig.opClass=e,this}};lr=o,l(Ge,lr,"ExtraConfigColumn");var ur,Z=class{constructor(e,t,r){this.name=e,this.type=t,this.indexConfig=r}name;type;indexConfig};ur=o,l(Z,ur,"IndexedColumn");var cr,Ze=class extends O{constructor(e,t,r){super(e,"array","PgArray"),this.config.baseBuilder=t,this.config.size=r}build(e){let t=this.config.baseBuilder.build(e);return new ke(e,this.config,t)}};cr=o,l(Ze,cr,"PgArrayBuilder");var fr,jt=class extends b{constructor(e,t,r,s){super(e,t),this.baseColumn=r,this.range=s,this.size=t.size}size;getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(e){return typeof e=="string"&&(e=si(e)),e.map(t=>this.baseColumn.mapFromDriverValue(t))}mapToDriverValue(e,t=!1){let r=e.map(s=>s===null?null:c(this.baseColumn,jt)?this.baseColumn.mapToDriverValue(s,!0):this.baseColumn.mapToDriverValue(s));return t?r:Pt(r)}},ke=jt;fr=o,l(ke,fr,"PgArray");var zt=Symbol.for("drizzle:isPgEnum");function oi(i){return!!i&&typeof i=="function"&&zt in i&&i[zt]===!0}var mr,et=class extends O{constructor(e,t){super(e,"string","PgEnumColumn"),this.config.enum=t}build(e){return new tt(e,this.config)}};mr=o,l(et,mr,"PgEnumColumnBuilder");var dr,tt=class extends b{enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(e,t){super(e,t),this.enum=t.enum}getSQLType(){return this.enum.enumName}};dr=o,l(tt,dr,"PgEnumColumn");function ai(i,e,t){let r=Object.assign(s=>new et(s,r),{enumName:i,enumValues:e,schema:t,[zt]:!0});return r}var hr,K=class{constructor(e,t,r,s=!1){this._={brand:"Subquery",sql:e,selectedFields:t,alias:r,isWith:s}}};hr=o,l(K,hr,"Subquery");var pr,je=class extends K{};pr=o,l(je,pr,"WithSubquery");var li="0.31.2";var At,Kt,ze={startActiveSpan(i,e){return At?(Kt||(Kt=At.trace.getTracer("drizzle-orm",li)),Ye((t,r)=>r.startActiveSpan(i,s=>{try{return e(s)}catch(a){throw s.setStatus({code:t.SpanStatusCode.ERROR,message:a instanceof Error?a.message:"Unknown error"}),a}finally{s.end()}}),At,Kt)):e()}};var x=Symbol.for("drizzle:ViewBaseConfig");var gr,Ft=class{};gr=o,l(Ft,gr,"FakePrimitiveParam");function Qt(i){return i!=null&&typeof i.getSQL=="function"}function yr(i){let e={sql:"",params:[]};for(let t of i)e.sql+=t.sql,e.params.push(...t.params),t.typings?.length&&(e.typings||(e.typings=[]),e.typings.push(...t.typings));return e}var wr,q=class{value;constructor(e){this.value=Array.isArray(e)?e:[e]}getSQL(){return new h([this])}};wr=o,l(q,wr,"StringChunk");var br,ne=class{constructor(e){this.queryChunks=e}decoder=ci;shouldInlineParams=!1;append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return ze.startActiveSpan("drizzle.buildSQL",t=>{let r=this.buildQueryFromSourceParams(this.queryChunks,e);return t?.setAttributes({"drizzle.query.text":r.sql,"drizzle.query.params":JSON.stringify(r.params)}),r})}buildQueryFromSourceParams(e,t){let r=Object.assign({},t,{inlineParams:t.inlineParams||this.shouldInlineParams,paramStartIndex:t.paramStartIndex||{value:0}}),{escapeName:s,escapeParam:a,prepareTyping:u,inlineParams:m,paramStartIndex:d}=r;return yr(e.map(f=>{if(c(f,q))return{sql:f.value.join(""),params:[]};if(c(f,se))return{sql:s(f.value),params:[]};if(f===void 0)return{sql:"",params:[]};if(Array.isArray(f)){let y=[new q("(")];for(let[g,S]of f.entries())y.push(S),g<f.length-1&&y.push(new q(", "));return y.push(new q(")")),this.buildQueryFromSourceParams(y,r)}if(c(f,ne))return this.buildQueryFromSourceParams(f.queryChunks,{...r,inlineParams:m||f.shouldInlineParams});if(c(f,p)){let y=f[p.Symbol.Schema],g=f[p.Symbol.Name];return{sql:y===void 0?s(g):s(y)+"."+s(g),params:[]}}if(c(f,N))return t.invokeSource==="indexes"?{sql:s(f.name),params:[]}:{sql:s(f.table[p.Symbol.Name])+"."+s(f.name),params:[]};if(c(f,V)){let y=f[x].schema,g=f[x].name;return{sql:y===void 0?s(g):s(y)+"."+s(g),params:[]}}if(c(f,R)){let y=f.value===null?null:f.encoder.mapToDriverValue(f.value);if(c(y,ne))return this.buildQueryFromSourceParams([y],r);if(m)return{sql:this.mapInlineParam(y,r),params:[]};let g;return u!==void 0&&(g=[u(f.encoder)]),{sql:a(d.value++,y),params:[y],typings:g}}return c(f,k)?{sql:a(d.value++,f),params:[f]}:c(f,ne.Aliased)&&f.fieldAlias!==void 0?{sql:s(f.fieldAlias),params:[]}:c(f,K)?f._.isWith?{sql:s(f._.alias),params:[]}:this.buildQueryFromSourceParams([new q("("),f._.sql,new q(") "),new se(f._.alias)],r):oi(f)?f.schema?{sql:s(f.schema)+"."+s(f.enumName),params:[]}:{sql:s(f.enumName),params:[]}:Qt(f)?this.buildQueryFromSourceParams([new q("("),f.getSQL(),new q(")")],r):m?{sql:this.mapInlineParam(f,r),params:[]}:{sql:a(d.value++,f),params:[f]}}))}mapInlineParam(e,{escapeString:t}){if(e===null)return"null";if(typeof e=="number"||typeof e=="boolean")return e.toString();if(typeof e=="string")return t(e);if(typeof e=="object"){let r=e.toString();return t(r==="[object Object]"?JSON.stringify(e):r)}throw new Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return e===void 0?this:new ne.Aliased(this,e)}mapWith(e){return this.decoder=typeof e=="function"?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}},h=ne;br=o,l(h,br,"SQL");var Sr,se=class{constructor(e){this.value=e}brand;getSQL(){return new h([this])}};Sr=o,l(se,Sr,"Name");function ui(i){return typeof i=="object"&&i!==null&&"mapToDriverValue"in i&&typeof i.mapToDriverValue=="function"}var ci={mapFromDriverValue:i=>i},fi={mapToDriverValue:i=>i},Ks={...ci,...fi},$r,R=class{constructor(e,t=fi){this.value=e,this.encoder=t}brand;getSQL(){return new h([this])}};$r=o,l(R,$r,"Param");function n(i,...e){let t=[];(e.length>0||i.length>0&&i[0]!=="")&&t.push(new q(i[0]));for(let[r,s]of e.entries())t.push(s,new q(i[r+1]));return new h(t)}(i=>{function e(){return new h([])}i.empty=e;function t(d){return new h(d)}i.fromList=t;function r(d){return new h([new q(d)])}i.raw=r;function s(d,f){let y=[];for(let[g,S]of d.entries())g>0&&f!==void 0&&y.push(f),y.push(S);return new h(y)}i.join=s;function a(d){return new se(d)}i.identifier=a;function u(d){return new k(d)}i.placeholder=u;function m(d,f){return new R(d,f)}i.param=m})(n||(n={}));(i=>{class e{constructor(r,s){this.sql=r,this.fieldAlias=s}static[o]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new e(this.sql,this.fieldAlias)}}i.Aliased=e})(h||(h={}));var Nr,k=class{constructor(e){this.name=e}getSQL(){return new h([this])}};Nr=o,l(k,Nr,"Placeholder");var xr,V=class{[(xr=o,x)];constructor({name:e,schema:t,selectedFields:r,query:s}){this[x]={name:e,originalName:e,schema:t,selectedFields:r,query:s,isExisting:!s,isAlias:!1}}getSQL(){return new h([this])}};l(V,xr,"View");N.prototype.getSQL=function(){return new h([this])};p.prototype.getSQL=function(){return new h([this])};K.prototype.getSQL=function(){return new h([this])};var Tr,G=class{constructor(e){this.table=e}get(e,t){return t==="table"?this.table:e[t]}};Tr=o,l(G,Tr,"ColumnAliasProxyHandler");var vr,ee=class{constructor(e,t){this.alias=e,this.replaceOriginalName=t}get(e,t){if(t===p.Symbol.IsAlias)return!0;if(t===p.Symbol.Name)return this.alias;if(this.replaceOriginalName&&t===p.Symbol.OriginalName)return this.alias;if(t===x)return{...e[x],name:this.alias,isAlias:!0};if(t===p.Symbol.Columns){let s=e[p.Symbol.Columns];if(!s)return s;let a={};return Object.keys(s).map(u=>{a[u]=new Proxy(s[u],new G(new Proxy(e,this)))}),a}let r=e[t];return c(r,N)?new Proxy(r,new G(new Proxy(e,this))):r}};vr=o,l(ee,vr,"TableAliasProxyHandler");var qr,Et=class{constructor(e){this.alias=e}get(e,t){return t==="sourceTable"?Ae(e.sourceTable,this.alias):e[t]}};qr=o,l(Et,qr,"RelationTableAliasProxyHandler");function Ae(i,e){return new Proxy(i,new ee(e,!1))}function J(i,e){return new Proxy(i,new G(new Proxy(i.table,new ee(e,!1))))}function Dt(i,e){return new h.Aliased(Ke(i.sql,e),i.fieldAlias)}function Ke(i,e){return n.join(i.queryChunks.map(t=>c(t,N)?J(t,e):c(t,h)?Ke(t,e):c(t,h.Aliased)?Dt(t,e):t))}var Cr,U=class extends O{defaultNow(){return this.default(n`now()`)}};Cr=o,l(U,Cr,"PgDateColumnBaseBuilder");var Or,Lt=class extends U{constructor(e){super(e,"date","PgDate")}build(e){return new oe(e,this.config)}};Or=o,l(Lt,Or,"PgDateBuilder");var Pr,oe=class extends b{getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}mapToDriverValue(e){return e.toISOString()}};Pr=o,l(oe,Pr,"PgDate");var jr,Vt=class extends U{constructor(e){super(e,"string","PgDateString")}build(e){return new ae(e,this.config)}};jr=o,l(Vt,jr,"PgDateStringBuilder");var zr,ae=class extends b{getSQLType(){return"date"}};zr=o,l(ae,zr,"PgDateString");var Ar,it=class extends O{constructor(e){super(e,"number","PgInteger")}build(e){return new rt(e,this.config)}};Ar=o,l(it,Ar,"PgIntegerBuilder");var Kr,rt=class extends b{getSQLType(){return"integer"}mapFromDriverValue(e){return typeof e=="string"?Number.parseInt(e):e}};Kr=o,l(rt,Kr,"PgInteger");function mi(i){return new it(i)}var Fr,_t=class extends O{constructor(e){super(e,"json","PgJson")}build(e){return new le(e,this.config)}};Fr=o,l(_t,Fr,"PgJsonBuilder");var Qr,le=class extends b{constructor(e,t){super(e,t)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}};Qr=o,l(le,Qr,"PgJson");var Er,Bt=class extends O{constructor(e){super(e,"json","PgJsonb")}build(e){return new ue(e,this.config)}};Er=o,l(Bt,Er,"PgJsonbBuilder");var Dr,ue=class extends b{constructor(e,t){super(e,t)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}};Dr=o,l(ue,Dr,"PgJsonb");var Lr,It=class extends O{constructor(e,t,r){super(e,"string","PgNumeric"),this.config.precision=t,this.config.scale=r}build(e){return new ce(e,this.config)}};Lr=o,l(It,Lr,"PgNumericBuilder");var Vr,ce=class extends b{precision;scale;constructor(e,t){super(e,t),this.precision=t.precision,this.scale=t.scale}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}};Vr=o,l(ce,Vr,"PgNumeric");var _r,Rt=class extends U{constructor(e,t,r){super(e,"string","PgTime"),this.withTimezone=t,this.precision=r,this.config.withTimezone=t,this.config.precision=r}build(e){return new fe(e,this.config)}};_r=o,l(Rt,_r,"PgTimeBuilder");var Br,fe=class extends b{withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}};Br=o,l(fe,Br,"PgTime");var Ir,nt=class extends U{constructor(e,t,r){super(e,"date","PgTimestamp"),this.config.withTimezone=t,this.config.precision=r}build(e){return new me(e,this.config)}};Ir=o,l(nt,Ir,"PgTimestampBuilder");var Rr,me=class extends b{withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=e=>new Date(this.withTimezone?e:e+"+0000");mapToDriverValue=e=>e.toISOString()};Rr=o,l(me,Rr,"PgTimestamp");var Ur,st=class extends U{constructor(e,t,r){super(e,"string","PgTimestampString"),this.config.withTimezone=t,this.config.precision=r}build(e){return new de(e,this.config)}};Ur=o,l(st,Ur,"PgTimestampStringBuilder");var Mr,de=class extends b{withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}};Mr=o,l(de,Mr,"PgTimestampString");function Ut(i,e={}){return e.mode==="string"?new st(i,e.withTimezone??!1,e.precision):new nt(i,e.withTimezone??!1,e.precision)}var Jr,ot=class extends O{constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default(n`gen_random_uuid()`)}build(e){return new he(e,this.config)}};Jr=o,l(ot,Jr,"PgUUIDBuilder");var Wr,he=class extends b{getSQLType(){return"uuid"}};Wr=o,l(he,Wr,"PgUUID");function at(i){return new ot(i)}var Yr,lt=class extends O{constructor(e,t){super(e,"string","PgVarchar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new ut(e,this.config)}};Yr=o,l(lt,Yr,"PgVarcharBuilder");var Hr,ut=class extends b{length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}};Hr=o,l(ut,Hr,"PgVarchar");function te(i,e={}){return new lt(i,e)}var Xr,Fe=class{[(Xr=o,Symbol.toStringTag)]="QueryPromise";catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}then(e,t){return this.execute().then(e,t)}};l(Fe,Xr,"QueryPromise");function pe(i,e){return Object.entries(i).reduce((t,[r,s])=>{if(typeof r!="string")return t;let a=e?[...e,r]:[r];return c(s,N)||c(s,h)||c(s,h.Aliased)?t.push({path:a,field:s}):c(s,p)?t.push(...pe(s[p.Symbol.Columns],a)):t.push(...pe(s,a)),t},[])}function Mt(i,e){let t=Object.keys(i),r=Object.keys(e);if(t.length!==r.length)return!1;for(let[s,a]of t.entries())if(a!==r[s])return!1;return!0}function di(i,e){for(let t of e)for(let r of Object.getOwnPropertyNames(t.prototype))r!=="constructor"&&Object.defineProperty(i.prototype,r,Object.getOwnPropertyDescriptor(t.prototype,r)||Object.create(null))}function Qe(i){return i[p.Symbol.Columns]}function Jt(i){return c(i,K)?i._.alias:c(i,V)?i[x].name:c(i,h)?void 0:i[p.Symbol.IsAlias]?i[p.Symbol.Name]:i[p.Symbol.BaseName]}var Gr,ye=class extends Error{constructor({message:e,cause:t}){super(e),this.name="DrizzleError",this.cause=t}};Gr=o,l(ye,Gr,"DrizzleError");var Zr,Wt=class extends ye{constructor(){super({message:"Rollback"})}};Zr=o,l(Wt,Zr,"TransactionRollbackError");function B(i,e){return ui(e)&&!Qt(i)&&!c(i,R)&&!c(i,k)&&!c(i,N)&&!c(i,p)&&!c(i,V)?new R(i,e):i}var ct=(i,e)=>n`${i} = ${B(e,i)}`,hi=(i,e)=>n`${i} <> ${B(e,i)}`;function Ee(...i){let e=i.filter(t=>t!==void 0);if(e.length!==0)return e.length===1?new h(e):new h([new q("("),n.join(e,new q(" and ")),new q(")")])}function pi(...i){let e=i.filter(t=>t!==void 0);if(e.length!==0)return e.length===1?new h(e):new h([new q("("),n.join(e,new q(" or ")),new q(")")])}function yi(i){return n`not ${i}`}var gi=(i,e)=>n`${i} > ${B(e,i)}`,wi=(i,e)=>n`${i} >= ${B(e,i)}`,bi=(i,e)=>n`${i} < ${B(e,i)}`,Si=(i,e)=>n`${i} <= ${B(e,i)}`;function $i(i,e){if(Array.isArray(e)){if(e.length===0)throw new Error("inArray requires at least one value");return n`${i} in ${e.map(t=>B(t,i))}`}return n`${i} in ${B(e,i)}`}function Ni(i,e){if(Array.isArray(e)){if(e.length===0)throw new Error("notInArray requires at least one value");return n`${i} not in ${e.map(t=>B(t,i))}`}return n`${i} not in ${B(e,i)}`}function xi(i){return n`${i} is null`}function Ti(i){return n`${i} is not null`}function vi(i){return n`exists ${i}`}function qi(i){return n`not exists ${i}`}function Ci(i,e,t){return n`${i} between ${B(e,i)} and ${B(t,i)}`}function Oi(i,e,t){return n`${i} not between ${B(e,i)} and ${B(t,i)}`}function Pi(i,e){return n`${i} like ${e}`}function ji(i,e){return n`${i} not like ${e}`}function zi(i,e){return n`${i} ilike ${e}`}function Ai(i,e){return n`${i} not ilike ${e}`}function Ki(i){return n`${i} asc`}function Fi(i){return n`${i} desc`}var kr,De=class{constructor(e,t,r){this.sourceTable=e,this.referencedTable=t,this.relationName=r,this.referencedTableName=t[p.Symbol.Name]}referencedTableName;fieldName};kr=o,l(De,kr,"Relation");var en,Yt=class{constructor(e,t){this.table=e,this.config=t}};en=o,l(Yt,en,"Relations");var tn,Ht=class extends De{constructor(e,t,r,s){super(e,t,r?.relationName),this.config=r,this.isNullable=s}withFieldName(e){let t=new Ht(this.sourceTable,this.referencedTable,this.config,this.isNullable);return t.fieldName=e,t}},ie=Ht;tn=o,l(ie,tn,"One");var rn,Xt=class extends De{constructor(e,t,r){super(e,t,r?.relationName),this.config=r}withFieldName(e){let t=new Xt(this.sourceTable,this.referencedTable,this.config);return t.fieldName=e,t}},Le=Xt;rn=o,l(Le,rn,"Many");function Qi(){return{and:Ee,between:Ci,eq:ct,exists:vi,gt:gi,gte:wi,ilike:zi,inArray:$i,isNull:xi,isNotNull:Ti,like:Pi,lt:bi,lte:Si,ne:hi,not:yi,notBetween:Oi,notExists:qi,notLike:ji,notIlike:Ai,notInArray:Ni,or:pi,sql:n}}function Ei(){return{sql:n,asc:Ki,desc:Fi}}function Di(i,e,t){if(c(t,ie)&&t.config)return{fields:t.config.fields,references:t.config.references};let r=e[t.referencedTable[p.Symbol.Name]];if(!r)throw new Error(`Table "${t.referencedTable[p.Symbol.Name]}" not found in schema`);let s=i[r];if(!s)throw new Error(`Table "${r}" not found in schema`);let a=t.sourceTable,u=e[a[p.Symbol.Name]];if(!u)throw new Error(`Table "${a[p.Symbol.Name]}" not found in schema`);let m=[];for(let d of Object.values(s.relations))(t.relationName&&t!==d&&d.relationName===t.relationName||!t.relationName&&d.referencedTable===t.sourceTable)&&m.push(d);if(m.length>1)throw t.relationName?new Error(`There are multiple relations with name "${t.relationName}" in table "${r}"`):new Error(`There are multiple relations between "${r}" and "${t.sourceTable[p.Symbol.Name]}". Please specify relation name`);if(m[0]&&c(m[0],ie)&&m[0].config)return{fields:m[0].config.references,references:m[0].config.fields};throw new Error(`There is not enough information to infer relation "${u}.${t.fieldName}"`)}var nn,W=class extends V{};nn=o,l(W,nn,"PgViewBase");var sn,Ve=class{async migrate(e,t,r){let s=typeof r=="string"?"__drizzle_migrations":r.migrationsTable??"__drizzle_migrations",a=typeof r=="string"?"drizzle":r.migrationsSchema??"drizzle",u=n`
			CREATE TABLE IF NOT EXISTS ${n.identifier(a)}.${n.identifier(s)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at bigint
			)
		`;await t.execute(n`CREATE SCHEMA IF NOT EXISTS ${n.identifier(a)}`),await t.execute(u);let d=(await t.all(n`select id, hash, created_at from ${n.identifier(a)}.${n.identifier(s)} order by created_at desc limit 1`))[0];await t.transaction(async f=>{for await(let y of e)if(!d||Number(d.created_at)<y.folderMillis){for(let g of y.sql)await f.execute(n.raw(g));await f.execute(n`insert into ${n.identifier(a)}.${n.identifier(s)} ("hash", "created_at") values(${y.hash}, ${y.folderMillis})`)}})}escapeName(e){return`"${e}"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildWithCTE(e){if(!e?.length)return;let t=[n`with `];for(let[r,s]of e.entries())t.push(n`${n.identifier(s._.alias)} as (${s._.sql})`),r<e.length-1&&t.push(n`, `);return t.push(n` `),n.join(t)}buildDeleteQuery({table:e,where:t,returning:r,withList:s}){let a=this.buildWithCTE(s),u=r?n` returning ${this.buildSelection(r,{isSingleTable:!0})}`:void 0,m=t?n` where ${t}`:void 0;return n`${a}delete from ${e}${m}${u}`}buildUpdateSet(e,t){let r=e[p.Symbol.Columns],s=Object.keys(r).filter(u=>t[u]!==void 0||r[u]?.onUpdateFn!==void 0),a=s.length;return n.join(s.flatMap((u,m)=>{let d=r[u],f=t[u]??n.param(d.onUpdateFn(),d),y=n`${n.identifier(d.name)} = ${f}`;return m<a-1?[y,n.raw(", ")]:[y]}))}buildUpdateQuery({table:e,set:t,where:r,returning:s,withList:a}){let u=this.buildWithCTE(a),m=this.buildUpdateSet(e,t),d=s?n` returning ${this.buildSelection(s,{isSingleTable:!0})}`:void 0,f=r?n` where ${r}`:void 0;return n`${u}update ${e} set ${m}${f}${d}`}buildSelection(e,{isSingleTable:t=!1}={}){let r=e.length,s=e.flatMap(({field:a},u)=>{let m=[];if(c(a,h.Aliased)&&a.isSelectionField)m.push(n.identifier(a.fieldAlias));else if(c(a,h.Aliased)||c(a,h)){let d=c(a,h.Aliased)?a.sql:a;t?m.push(new h(d.queryChunks.map(f=>c(f,b)?n.identifier(f.name):f))):m.push(d),c(a,h.Aliased)&&m.push(n` as ${n.identifier(a.fieldAlias)}`)}else c(a,N)&&(t?m.push(n.identifier(a.name)):m.push(a));return u<r-1&&m.push(n`, `),m});return n.join(s)}buildSelectQuery({withList:e,fields:t,fieldsFlat:r,where:s,having:a,table:u,joins:m,orderBy:d,groupBy:f,limit:y,offset:g,lockingClause:S,distinct:L,setOperators:j}){let E=r??pe(t);for(let v of E)if(c(v.field,N)&&re(v.field.table)!==(c(u,K)?u._.alias:c(u,W)?u[x].name:c(u,h)?void 0:re(u))&&!(A=>m?.some(({alias:I})=>I===(A[p.Symbol.IsAlias]?re(A):A[p.Symbol.BaseName])))(v.field.table)){let A=re(v.field.table);throw new Error(`Your "${v.path.join("->")}" field references a column "${A}"."${v.field.name}", but the table "${A}" is not part of the query! Did you forget to join it?`)}let T=!m||m.length===0,z=this.buildWithCTE(e),F;L&&(F=L===!0?n` distinct`:n` distinct on (${n.join(L.on,n`, `)})`);let Q=this.buildSelection(E,{isSingleTable:T}),C=(()=>{if(c(u,p)&&u[p.Symbol.OriginalName]!==u[p.Symbol.Name]){let v=n`${n.identifier(u[p.Symbol.OriginalName])}`;return u[p.Symbol.Schema]&&(v=n`${n.identifier(u[p.Symbol.Schema])}.${v}`),n`${v} ${n.identifier(u[p.Symbol.Name])}`}return u})(),_=[];if(m)for(let[v,A]of m.entries()){v===0&&_.push(n` `);let I=A.table,Te=A.lateral?n` lateral`:void 0;if(c(I,D)){let St=I[D.Symbol.Name],ve=I[D.Symbol.Schema],qe=I[D.Symbol.OriginalName],Ce=St===qe?void 0:A.alias;_.push(n`${n.raw(A.joinType)} join${Te} ${ve?n`${n.identifier(ve)}.`:void 0}${n.identifier(qe)}${Ce&&n` ${n.identifier(Ce)}`} on ${A.on}`)}else if(c(I,V)){let St=I[x].name,ve=I[x].schema,qe=I[x].originalName,Ce=St===qe?void 0:A.alias;_.push(n`${n.raw(A.joinType)} join${Te} ${ve?n`${n.identifier(ve)}.`:void 0}${n.identifier(qe)}${Ce&&n` ${n.identifier(Ce)}`} on ${A.on}`)}else _.push(n`${n.raw(A.joinType)} join${Te} ${I} on ${A.on}`);v<m.length-1&&_.push(n` `)}let H=n.join(_),w=s?n` where ${s}`:void 0,$=a?n` having ${a}`:void 0,M;d&&d.length>0&&(M=n` order by ${n.join(d,n`, `)}`);let Ne;f&&f.length>0&&(Ne=n` group by ${n.join(f,n`, `)}`);let bt=y?n` limit ${y}`:void 0,xe=g?n` offset ${g}`:void 0,X=n.empty();if(S){let v=n` for ${n.raw(S.strength)}`;S.config.of&&v.append(n` of ${n.join(Array.isArray(S.config.of)?S.config.of:[S.config.of],n`, `)}`),S.config.noWait?v.append(n` no wait`):S.config.skipLocked&&v.append(n` skip locked`),X.append(v)}let Ue=n`${z}select${F} ${Q} from ${C}${H}${w}${Ne}${$}${M}${bt}${xe}${X}`;return j.length>0?this.buildSetOperations(Ue,j):Ue}buildSetOperations(e,t){let[r,...s]=t;if(!r)throw new Error("Cannot pass undefined values to any set operator");return s.length===0?this.buildSetOperationQuery({leftSelect:e,setOperator:r}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:r}),s)}buildSetOperationQuery({leftSelect:e,setOperator:{type:t,isAll:r,rightSelect:s,limit:a,orderBy:u,offset:m}}){let d=n`(${e.getSQL()}) `,f=n`(${s.getSQL()})`,y;if(u&&u.length>0){let j=[];for(let E of u)if(c(E,b))j.push(n.identifier(E.name));else if(c(E,h)){for(let T=0;T<E.queryChunks.length;T++){let z=E.queryChunks[T];c(z,b)&&(E.queryChunks[T]=n.identifier(z.name))}j.push(n`${E}`)}else j.push(n`${E}`);y=n` order by ${n.join(j,n`, `)} `}let g=a?n` limit ${a}`:void 0,S=n.raw(`${t} ${r?"all ":""}`),L=m?n` offset ${m}`:void 0;return n`${d}${S}${f}${y}${g}${L}`}buildInsertQuery({table:e,values:t,onConflict:r,returning:s,withList:a}){let u=[],m=e[p.Symbol.Columns],d=Object.entries(m),f=d.map(([,j])=>n.identifier(j.name));for(let[j,E]of t.entries()){let T=[];for(let[z,F]of d){let Q=E[z];if(Q===void 0||c(Q,R)&&Q.value===void 0)if(F.defaultFn!==void 0){let C=F.defaultFn(),_=c(C,h)?C:n.param(C,F);T.push(_)}else if(!F.default&&F.onUpdateFn!==void 0){let C=F.onUpdateFn(),_=c(C,h)?C:n.param(C,F);T.push(_)}else T.push(n`default`);else T.push(Q)}u.push(T),j<t.length-1&&u.push(n`, `)}let y=this.buildWithCTE(a),g=n.join(u),S=s?n` returning ${this.buildSelection(s,{isSingleTable:!0})}`:void 0,L=r?n` on conflict ${r}`:void 0;return n`${y}insert into ${e} ${f} values ${g}${L}${S}`}buildRefreshMaterializedViewQuery({view:e,concurrently:t,withNoData:r}){let s=t?n` concurrently`:void 0,a=r?n` with no data`:void 0;return n`refresh materialized view${s} ${e}${a}`}prepareTyping(e){return c(e,ue)||c(e,le)?"json":c(e,ce)?"decimal":c(e,fe)?"time":c(e,me)||c(e,de)?"timestamp":c(e,oe)||c(e,ae)?"date":c(e,he)?"uuid":"none"}sqlToQuery(e,t){return e.toQuery({escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:t})}buildRelationalQueryWithoutPK({fullSchema:e,schema:t,tableNamesMap:r,table:s,tableConfig:a,queryConfig:u,tableAlias:m,nestedQueryRelation:d,joinOn:f}){let y=[],g,S,L=[],j,E=[];if(u===!0)y=Object.entries(a.columns).map(([F,Q])=>({dbKey:Q.name,tsKey:F,field:J(Q,m),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let z=Object.fromEntries(Object.entries(a.columns).map(([w,$])=>[w,J($,m)]));if(u.where){let w=typeof u.where=="function"?u.where(z,Qi()):u.where;j=w&&Ke(w,m)}let F=[],Q=[];if(u.columns){let w=!1;for(let[$,M]of Object.entries(u.columns))M!==void 0&&$ in a.columns&&(!w&&M===!0&&(w=!0),Q.push($));Q.length>0&&(Q=w?Q.filter($=>u.columns?.[$]===!0):Object.keys(a.columns).filter($=>!Q.includes($)))}else Q=Object.keys(a.columns);for(let w of Q){let $=a.columns[w];F.push({tsKey:w,value:$})}let C=[];u.with&&(C=Object.entries(u.with).filter(w=>!!w[1]).map(([w,$])=>({tsKey:w,queryConfig:$,relation:a.relations[w]})));let _;if(u.extras){_=typeof u.extras=="function"?u.extras(z,{sql:n}):u.extras;for(let[w,$]of Object.entries(_))F.push({tsKey:w,value:Dt($,m)})}for(let{tsKey:w,value:$}of F)y.push({dbKey:c($,h.Aliased)?$.fieldAlias:a.columns[w].name,tsKey:w,field:c($,N)?J($,m):$,relationTableTsKey:void 0,isJson:!1,selection:[]});let H=typeof u.orderBy=="function"?u.orderBy(z,Ei()):u.orderBy??[];Array.isArray(H)||(H=[H]),L=H.map(w=>c(w,N)?J(w,m):Ke(w,m)),g=u.limit,S=u.offset;for(let{tsKey:w,queryConfig:$,relation:M}of C){let Ne=Di(t,r,M),bt=M.referencedTable[p.Symbol.Name],xe=r[bt],X=`${m}_${w}`,Ue=Ee(...Ne.fields.map((I,Te)=>ct(J(Ne.references[Te],X),J(I,m)))),v=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:t,tableNamesMap:r,table:e[xe],tableConfig:t[xe],queryConfig:c(M,ie)?$===!0?{limit:1}:{...$,limit:1}:$,tableAlias:X,joinOn:Ue,nestedQueryRelation:M}),A=n`${n.identifier(X)}.${n.identifier("data")}`.as(w);E.push({on:n`true`,table:new K(v.sql,{},X),alias:X,joinType:"left",lateral:!0}),y.push({dbKey:w,tsKey:w,field:A,relationTableTsKey:xe,isJson:!0,selection:v.selection})}}if(y.length===0)throw new ye({message:`No fields selected for table "${a.tsName}" ("${m}")`});let T;if(j=Ee(f,j),d){let z=n`json_build_array(${n.join(y.map(({field:C,tsKey:_,isJson:H})=>H?n`${n.identifier(`${m}_${_}`)}.${n.identifier("data")}`:c(C,h.Aliased)?C.sql:C),n`, `)})`;c(d,Le)&&(z=n`coalesce(json_agg(${z}${L.length>0?n` order by ${n.join(L,n`, `)}`:void 0}), '[]'::json)`);let F=[{dbKey:"data",tsKey:"data",field:z.as("data"),isJson:!0,relationTableTsKey:a.tsName,selection:y}];g!==void 0||S!==void 0||L.length>0?(T=this.buildSelectQuery({table:Ae(s,m),fields:{},fieldsFlat:[{path:[],field:n.raw("*")}],where:j,limit:g,offset:S,orderBy:L,setOperators:[]}),j=void 0,g=void 0,S=void 0,L=[]):T=Ae(s,m),T=this.buildSelectQuery({table:c(T,D)?T:new K(T,{},m),fields:{},fieldsFlat:F.map(({field:C})=>({path:[],field:c(C,N)?J(C,m):C})),joins:E,where:j,limit:g,offset:S,orderBy:L,setOperators:[]})}else T=this.buildSelectQuery({table:Ae(s,m),fields:{},fieldsFlat:y.map(({field:z})=>({path:[],field:c(z,N)?J(z,m):z})),joins:E,where:j,limit:g,offset:S,orderBy:L,setOperators:[]});return{tableTsKey:a.tsName,sql:T,selection:y}}};sn=o,l(Ve,sn,"PgDialect");var on,Gt=class{config;constructor(e){this.config={...e}}get(e,t){if(t==="_")return{...e._,selectedFields:new Proxy(e._.selectedFields,this)};if(t===x)return{...e[x],selectedFields:new Proxy(e[x].selectedFields,this)};if(typeof t=="symbol")return e[t];let s=(c(e,K)?e._.selectedFields:c(e,V)?e[x].selectedFields:e)[t];if(c(s,h.Aliased)){if(this.config.sqlAliasedBehavior==="sql"&&!s.isSelectionField)return s.sql;let a=s.clone();return a.isSelectionField=!0,a}if(c(s,h)){if(this.config.sqlBehavior==="sql")return s;throw new Error(`You tried to reference "${t}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return c(s,N)?this.config.alias?new Proxy(s,new G(new Proxy(s.table,new ee(this.config.alias,this.config.replaceOriginalName??!1)))):s:typeof s!="object"||s===null?s:new Proxy(s,new Gt(this.config))}},P=Gt;on=o,l(P,on,"SelectionProxyHandler");var an,_e=class{getSelectedFields(){return this._.selectedFields}};an=o,l(_e,an,"TypedQueryBuilder");var pn,Y=class{fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}from(e){let t=!!this.fields,r;return this.fields?r=this.fields:c(e,K)?r=Object.fromEntries(Object.keys(e._.selectedFields).map(s=>[s,e[s]])):c(e,W)?r=e[x].selectedFields:c(e,h)?r={}:r=Qe(e),new Be({table:e,fields:r,isPartialSelect:t,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct})}};pn=o,l(Y,pn,"PgSelectBuilder");var yn,ft=class extends _e{_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:t,isPartialSelect:r,session:s,dialect:a,withList:u,distinct:m}){super(),this.config={withList:u,table:e,fields:{...t},distinct:m,setOperators:[]},this.isPartialSelect=r,this.session=s,this.dialect=a,this._={selectedFields:t},this.tableName=Jt(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}createJoin(e){return(t,r)=>{let s=this.tableName,a=Jt(t);if(typeof a=="string"&&this.config.joins?.some(u=>u.alias===a))throw new Error(`Alias "${a}" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof s=="string"&&(this.config.fields={[s]:this.config.fields}),typeof a=="string"&&!c(t,h))){let u=c(t,K)?t._.selectedFields:c(t,V)?t[x].selectedFields:t[p.Symbol.Columns];this.config.fields[a]=u}if(typeof r=="function"&&(r=r(new Proxy(this.config.fields,new P({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:r,table:t,joinType:e,alias:a}),typeof a=="string")switch(e){case"left":{this.joinsNotNullableMap[a]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([u])=>[u,!1])),this.joinsNotNullableMap[a]=!0;break}case"inner":{this.joinsNotNullableMap[a]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([u])=>[u,!1])),this.joinsNotNullableMap[a]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");createSetOperator(e,t){return r=>{let s=typeof r=="function"?r(ln()):r;if(!Mt(this.getSelectedFields(),s.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:e,isAll:t,rightSelect:s}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new P({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=e,this}having(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new P({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=e,this}groupBy(...e){if(typeof e[0]=="function"){let t=e[0](new Proxy(this.config.fields,new P({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(t)?t:[t]}else this.config.groupBy=e;return this}orderBy(...e){if(typeof e[0]=="function"){let t=e[0](new Proxy(this.config.fields,new P({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),r=Array.isArray(t)?t:[t];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}else{let t=e;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=t:this.config.orderBy=t}return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,t={}){return this.config.lockingClause={strength:e,config:t},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}as(e){return new Proxy(new K(this.getSQL(),this.config.fields,e),new P({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new P({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}};yn=o,l(ft,yn,"PgSelectQueryBuilder");var gn,Be=class extends ft{_prepare(e){let{session:t,config:r,dialect:s,joinsNotNullableMap:a}=this;if(!t)throw new Error("Cannot execute a query on a query builder. Please use a database instance instead.");return ze.startActiveSpan("drizzle.prepareQuery",()=>{let u=pe(r.fields),m=t.prepareQuery(s.sqlToQuery(this.getSQL()),u,e,!0);return m.joinsNotNullableMap=a,m})}prepare(e){return this._prepare(e)}execute=e=>ze.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e))};gn=o,l(Be,gn,"PgSelect");di(Be,[Fe]);function ge(i,e){return(t,r,...s)=>{let a=[r,...s].map(u=>({type:i,isAll:e,rightSelect:u}));for(let u of a)if(!Mt(t.getSelectedFields(),u.rightSelect.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return t.addSetOperators(a)}}var ln=()=>({union:un,unionAll:cn,intersect:fn,intersectAll:mn,except:dn,exceptAll:hn}),un=ge("union",!1),cn=ge("union",!0),fn=ge("intersect",!1),mn=ge("intersect",!0),dn=ge("except",!1),hn=ge("except",!0);var wn,we=class{dialect;$with(e){let t=this;return{as(r){return typeof r=="function"&&(r=r(t)),new Proxy(new je(r.getSQL(),r.getSelectedFields(),e,!0),new P({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}}}with(...e){let t=this;function r(u){return new Y({fields:u??void 0,session:void 0,dialect:t.getDialect(),withList:e})}function s(u){return new Y({fields:u??void 0,session:void 0,dialect:t.getDialect(),distinct:!0})}function a(u,m){return new Y({fields:m??void 0,session:void 0,dialect:t.getDialect(),distinct:{on:u}})}return{select:r,selectDistinct:s,selectDistinctOn:a}}select(e){return new Y({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new Y({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,t){return new Y({fields:t??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new Ve),this.dialect}};wn=o,l(we,wn,"PgQueryBuilder");var bn,mt=class{constructor(e,t){this.unique=e,this.name=t}on(...e){return new be(e.map(t=>{if(c(t,h))return t;t=t;let r=new Z(t.name,t.columnType,t.indexConfig);return t.indexConfig=JSON.parse(JSON.stringify(t.defaultConfig)),r}),this.unique,!1,this.name)}onOnly(...e){return new be(e.map(t=>{if(c(t,h))return t;t=t;let r=new Z(t.name,t.columnType,t.indexConfig);return t.indexConfig=t.defaultConfig,r}),this.unique,!0,this.name)}using(e,...t){return new be(t.map(r=>{if(c(r,h))return r;r=r;let s=new Z(r.name,r.columnType,r.indexConfig);return r.indexConfig=JSON.parse(JSON.stringify(r.defaultConfig)),s}),this.unique,!0,this.name,e)}};bn=o,l(mt,bn,"PgIndexBuilderOn");var Sn,be=class{config;constructor(e,t,r,s,a="btree"){this.config={name:s,columns:e,unique:t,only:r,method:a}}concurrently(){return this.config.concurrently=!0,this}with(e){return this.config.with=e,this}where(e){return this.config.where=e,this}build(e){return new dt(this.config,e)}};Sn=o,l(be,Sn,"PgIndexBuilder");var $n,dt=class{config;constructor(e,t){this.config={...e,table:t}}};$n=o,l(dt,$n,"PgIndex");function Li(i){return new mt(!1,i)}var Zt=Symbol.for("drizzle:PgViewConfig");var Nn,Ie=class{constructor(e,t){this.name=e,this.schema=t}config={};with(e){return this.config.with=e,this}};Nn=o,l(Ie,Nn,"PgDefaultViewBuilderCore");var xn,ht=class extends Ie{as(e){typeof e=="function"&&(e=e(new we));let t=new P({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}),r=new Proxy(e.getSelectedFields(),t);return new Proxy(new Se({pgConfig:this.config,config:{name:this.name,schema:this.schema,selectedFields:r,query:e.getSQL().inlineParams()}}),t)}};xn=o,l(ht,xn,"PgViewBuilder");var Tn,pt=class extends Ie{columns;constructor(e,t,r){super(e,r),this.columns=Qe(qt(e,t))}existing(){return new Proxy(new Se({pgConfig:void 0,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:void 0}}),new P({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}as(e){return new Proxy(new Se({pgConfig:this.config,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:e.inlineParams()}}),new P({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}};Tn=o,l(pt,Tn,"PgManualViewBuilder");var vn,Re=class{constructor(e,t){this.name=e,this.schema=t}config={};using(e){return this.config.using=e,this}with(e){return this.config.with=e,this}tablespace(e){return this.config.tablespace=e,this}withNoData(){return this.config.withNoData=!0,this}};vn=o,l(Re,vn,"PgMaterializedViewBuilderCore");var qn,yt=class extends Re{as(e){typeof e=="function"&&(e=e(new we));let t=new P({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}),r=new Proxy(e.getSelectedFields(),t);return new Proxy(new $e({pgConfig:{with:this.config.with,using:this.config.using,tablespace:this.config.tablespace,withNoData:this.config.withNoData},config:{name:this.name,schema:this.schema,selectedFields:r,query:e.getSQL().inlineParams()}}),t)}};qn=o,l(yt,qn,"PgMaterializedViewBuilder");var Cn,gt=class extends Re{columns;constructor(e,t,r){super(e,r),this.columns=Qe(qt(e,t))}existing(){return new Proxy(new $e({pgConfig:void 0,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:void 0}}),new P({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}as(e){return new Proxy(new $e({pgConfig:void 0,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:e.inlineParams()}}),new P({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}};Cn=o,l(gt,Cn,"PgManualMaterializedViewBuilder");var On,Se=class extends W{[(On=o,Zt)];constructor({pgConfig:e,config:t}){super(t),e&&(this[Zt]={with:e.with})}};l(Se,On,"PgView");var Vi=Symbol.for("drizzle:PgMaterializedViewConfig"),Pn,$e=class extends W{[(Pn=o,Vi)];constructor({pgConfig:e,config:t}){super(t),this[Vi]={with:e?.with,using:e?.using,tablespace:e?.tablespace,withNoData:e?.withNoData}}};l($e,Pn,"PgMaterializedView");function _i(i,e,t){return e?new pt(i,e,t):new ht(i,t)}function Bi(i,e,t){return e?new gt(i,e,t):new yt(i,t)}var jn,wt=class{constructor(e){this.schemaName=e}table=(e,t,r)=>vt(e,t,r,this.schemaName);view=(e,t)=>_i(e,t,this.schemaName);materializedView=(e,t)=>Bi(e,t,this.schemaName);enum=(e,t)=>ai(e,t,this.schemaName)};jn=o,l(wt,jn,"PgSchema");function Ii(i){if(i==="public")throw new Error("You can't specify 'public' as schema name. Postgres is using public schema by default. If you want to use 'public' schema, just use pgTable() instead of creating a schema");return new wt(i)}var zn=Ii(process.env.SCHEMA_POSTGRES||"").table("post_estate_report",{id:at("id").default(n`gen_random_uuid()`).primaryKey(),description:te("description",{length:255}).notNull(),postEstateId:at("post_estate_id").notNull(),customerId:at("customer_id"),contactName:te("contact_name",{length:50}),contactPhone:te("contact_phone",{length:20}),contactMail:te("contact_mail",{length:50}),isConfirmed:mi("is_confirmed").notNull().default(0),createdBy:te("created_by",{length:255}),createdAt:Ut("created_at").notNull().default(n`now()`),modifyBy:te("modify_by",{length:255}),modifyAt:Ut("modify_at").notNull().default(n`now()`).$onUpdate(()=>new Date)},i=>({idxPostEstateReportNameId:Li("post_estate_report_name_id_idx").on(i.contactName,i.id)}));0&&(module.exports={postEstateReportModel});
//# sourceMappingURL=postEstateReport.model.js.map
